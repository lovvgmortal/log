(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))l(u);new MutationObserver(u=>{for(const h of u)if(h.type==="childList")for(const f of h.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&l(f)}).observe(document,{childList:!0,subtree:!0});function i(u){const h={};return u.integrity&&(h.integrity=u.integrity),u.referrerPolicy&&(h.referrerPolicy=u.referrerPolicy),u.crossOrigin==="use-credentials"?h.credentials="include":u.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function l(u){if(u.ep)return;u.ep=!0;const h=i(u);fetch(u.href,h)}})();function Xm(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var iu={exports:{}},Li={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var t0;function uv(){if(t0)return Li;t0=1;var a=Symbol.for("react.transitional.element"),n=Symbol.for("react.fragment");function i(l,u,h){var f=null;if(h!==void 0&&(f=""+h),u.key!==void 0&&(f=""+u.key),"key"in u){h={};for(var g in u)g!=="key"&&(h[g]=u[g])}else h=u;return u=h.ref,{$$typeof:a,type:l,key:f,ref:u!==void 0?u:null,props:h}}return Li.Fragment=n,Li.jsx=i,Li.jsxs=i,Li}var n0;function dv(){return n0||(n0=1,iu.exports=uv()),iu.exports}var o=dv(),ru={exports:{}},ge={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var a0;function hv(){if(a0)return ge;a0=1;var a=Symbol.for("react.transitional.element"),n=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),l=Symbol.for("react.strict_mode"),u=Symbol.for("react.profiler"),h=Symbol.for("react.consumer"),f=Symbol.for("react.context"),g=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),b=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),y=Symbol.for("react.activity"),E=Symbol.iterator;function _(O){return O===null||typeof O!="object"?null:(O=E&&O[E]||O["@@iterator"],typeof O=="function"?O:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,N={};function k(O,A,L){this.props=O,this.context=A,this.refs=N,this.updater=L||w}k.prototype.isReactComponent={},k.prototype.setState=function(O,A){if(typeof O!="object"&&typeof O!="function"&&O!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,O,A,"setState")},k.prototype.forceUpdate=function(O){this.updater.enqueueForceUpdate(this,O,"forceUpdate")};function K(){}K.prototype=k.prototype;function H(O,A,L){this.props=O,this.context=A,this.refs=N,this.updater=L||w}var P=H.prototype=new K;P.constructor=H,S(P,k.prototype),P.isPureReactComponent=!0;var ee=Array.isArray;function te(){}var W={H:null,A:null,T:null,S:null},ye=Object.prototype.hasOwnProperty;function pe(O,A,L){var $=L.ref;return{$$typeof:a,type:O,key:A,ref:$!==void 0?$:null,props:L}}function Be(O,A){return pe(O.type,A,O.props)}function Ve(O){return typeof O=="object"&&O!==null&&O.$$typeof===a}function De(O){var A={"=":"=0",":":"=2"};return"$"+O.replace(/[=:]/g,function(L){return A[L]})}var Ke=/\/+/g;function Le(O,A){return typeof O=="object"&&O!==null&&O.key!=null?De(""+O.key):A.toString(36)}function oe(O){switch(O.status){case"fulfilled":return O.value;case"rejected":throw O.reason;default:switch(typeof O.status=="string"?O.then(te,te):(O.status="pending",O.then(function(A){O.status==="pending"&&(O.status="fulfilled",O.value=A)},function(A){O.status==="pending"&&(O.status="rejected",O.reason=A)})),O.status){case"fulfilled":return O.value;case"rejected":throw O.reason}}throw O}function z(O,A,L,$,C){var B=typeof O;(B==="undefined"||B==="boolean")&&(O=null);var q=!1;if(O===null)q=!0;else switch(B){case"bigint":case"string":case"number":q=!0;break;case"object":switch(O.$$typeof){case a:case n:q=!0;break;case x:return q=O._init,z(q(O._payload),A,L,$,C)}}if(q)return C=C(O),q=$===""?"."+Le(O,0):$,ee(C)?(L="",q!=null&&(L=q.replace(Ke,"$&/")+"/"),z(C,A,L,"",function(bt){return bt})):C!=null&&(Ve(C)&&(C=Be(C,L+(C.key==null||O&&O.key===C.key?"":(""+C.key).replace(Ke,"$&/")+"/")+q)),A.push(C)),1;q=0;var ne=$===""?".":$+":";if(ee(O))for(var me=0;me<O.length;me++)$=O[me],B=ne+Le($,me),q+=z($,A,L,B,C);else if(me=_(O),typeof me=="function")for(O=me.call(O),me=0;!($=O.next()).done;)$=$.value,B=ne+Le($,me++),q+=z($,A,L,B,C);else if(B==="object"){if(typeof O.then=="function")return z(oe(O),A,L,$,C);throw A=String(O),Error("Objects are not valid as a React child (found: "+(A==="[object Object]"?"object with keys {"+Object.keys(O).join(", ")+"}":A)+"). If you meant to render a collection of children, use an array instead.")}return q}function J(O,A,L){if(O==null)return O;var $=[],C=0;return z(O,$,"","",function(B){return A.call(L,B,C++)}),$}function Y(O){if(O._status===-1){var A=O._result;A=A(),A.then(function(L){(O._status===0||O._status===-1)&&(O._status=1,O._result=L)},function(L){(O._status===0||O._status===-1)&&(O._status=2,O._result=L)}),O._status===-1&&(O._status=0,O._result=A)}if(O._status===1)return O._result.default;throw O._result}var ae=typeof reportError=="function"?reportError:function(O){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var A=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof O=="object"&&O!==null&&typeof O.message=="string"?String(O.message):String(O),error:O});if(!window.dispatchEvent(A))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",O);return}console.error(O)},xe={map:J,forEach:function(O,A,L){J(O,function(){A.apply(this,arguments)},L)},count:function(O){var A=0;return J(O,function(){A++}),A},toArray:function(O){return J(O,function(A){return A})||[]},only:function(O){if(!Ve(O))throw Error("React.Children.only expected to receive a single React element child.");return O}};return ge.Activity=y,ge.Children=xe,ge.Component=k,ge.Fragment=i,ge.Profiler=u,ge.PureComponent=H,ge.StrictMode=l,ge.Suspense=p,ge.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=W,ge.__COMPILER_RUNTIME={__proto__:null,c:function(O){return W.H.useMemoCache(O)}},ge.cache=function(O){return function(){return O.apply(null,arguments)}},ge.cacheSignal=function(){return null},ge.cloneElement=function(O,A,L){if(O==null)throw Error("The argument must be a React element, but you passed "+O+".");var $=S({},O.props),C=O.key;if(A!=null)for(B in A.key!==void 0&&(C=""+A.key),A)!ye.call(A,B)||B==="key"||B==="__self"||B==="__source"||B==="ref"&&A.ref===void 0||($[B]=A[B]);var B=arguments.length-2;if(B===1)$.children=L;else if(1<B){for(var q=Array(B),ne=0;ne<B;ne++)q[ne]=arguments[ne+2];$.children=q}return pe(O.type,C,$)},ge.createContext=function(O){return O={$$typeof:f,_currentValue:O,_currentValue2:O,_threadCount:0,Provider:null,Consumer:null},O.Provider=O,O.Consumer={$$typeof:h,_context:O},O},ge.createElement=function(O,A,L){var $,C={},B=null;if(A!=null)for($ in A.key!==void 0&&(B=""+A.key),A)ye.call(A,$)&&$!=="key"&&$!=="__self"&&$!=="__source"&&(C[$]=A[$]);var q=arguments.length-2;if(q===1)C.children=L;else if(1<q){for(var ne=Array(q),me=0;me<q;me++)ne[me]=arguments[me+2];C.children=ne}if(O&&O.defaultProps)for($ in q=O.defaultProps,q)C[$]===void 0&&(C[$]=q[$]);return pe(O,B,C)},ge.createRef=function(){return{current:null}},ge.forwardRef=function(O){return{$$typeof:g,render:O}},ge.isValidElement=Ve,ge.lazy=function(O){return{$$typeof:x,_payload:{_status:-1,_result:O},_init:Y}},ge.memo=function(O,A){return{$$typeof:b,type:O,compare:A===void 0?null:A}},ge.startTransition=function(O){var A=W.T,L={};W.T=L;try{var $=O(),C=W.S;C!==null&&C(L,$),typeof $=="object"&&$!==null&&typeof $.then=="function"&&$.then(te,ae)}catch(B){ae(B)}finally{A!==null&&L.types!==null&&(A.types=L.types),W.T=A}},ge.unstable_useCacheRefresh=function(){return W.H.useCacheRefresh()},ge.use=function(O){return W.H.use(O)},ge.useActionState=function(O,A,L){return W.H.useActionState(O,A,L)},ge.useCallback=function(O,A){return W.H.useCallback(O,A)},ge.useContext=function(O){return W.H.useContext(O)},ge.useDebugValue=function(){},ge.useDeferredValue=function(O,A){return W.H.useDeferredValue(O,A)},ge.useEffect=function(O,A){return W.H.useEffect(O,A)},ge.useEffectEvent=function(O){return W.H.useEffectEvent(O)},ge.useId=function(){return W.H.useId()},ge.useImperativeHandle=function(O,A,L){return W.H.useImperativeHandle(O,A,L)},ge.useInsertionEffect=function(O,A){return W.H.useInsertionEffect(O,A)},ge.useLayoutEffect=function(O,A){return W.H.useLayoutEffect(O,A)},ge.useMemo=function(O,A){return W.H.useMemo(O,A)},ge.useOptimistic=function(O,A){return W.H.useOptimistic(O,A)},ge.useReducer=function(O,A,L){return W.H.useReducer(O,A,L)},ge.useRef=function(O){return W.H.useRef(O)},ge.useState=function(O){return W.H.useState(O)},ge.useSyncExternalStore=function(O,A,L){return W.H.useSyncExternalStore(O,A,L)},ge.useTransition=function(){return W.H.useTransition()},ge.version="19.2.3",ge}var s0;function Vu(){return s0||(s0=1,ru.exports=hv()),ru.exports}var ie=Vu();const fv=Xm(ie);var lu={exports:{}},Mi={},ou={exports:{}},cu={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var i0;function pv(){return i0||(i0=1,(function(a){function n(z,J){var Y=z.length;z.push(J);e:for(;0<Y;){var ae=Y-1>>>1,xe=z[ae];if(0<u(xe,J))z[ae]=J,z[Y]=xe,Y=ae;else break e}}function i(z){return z.length===0?null:z[0]}function l(z){if(z.length===0)return null;var J=z[0],Y=z.pop();if(Y!==J){z[0]=Y;e:for(var ae=0,xe=z.length,O=xe>>>1;ae<O;){var A=2*(ae+1)-1,L=z[A],$=A+1,C=z[$];if(0>u(L,Y))$<xe&&0>u(C,L)?(z[ae]=C,z[$]=Y,ae=$):(z[ae]=L,z[A]=Y,ae=A);else if($<xe&&0>u(C,Y))z[ae]=C,z[$]=Y,ae=$;else break e}}return J}function u(z,J){var Y=z.sortIndex-J.sortIndex;return Y!==0?Y:z.id-J.id}if(a.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var h=performance;a.unstable_now=function(){return h.now()}}else{var f=Date,g=f.now();a.unstable_now=function(){return f.now()-g}}var p=[],b=[],x=1,y=null,E=3,_=!1,w=!1,S=!1,N=!1,k=typeof setTimeout=="function"?setTimeout:null,K=typeof clearTimeout=="function"?clearTimeout:null,H=typeof setImmediate<"u"?setImmediate:null;function P(z){for(var J=i(b);J!==null;){if(J.callback===null)l(b);else if(J.startTime<=z)l(b),J.sortIndex=J.expirationTime,n(p,J);else break;J=i(b)}}function ee(z){if(S=!1,P(z),!w)if(i(p)!==null)w=!0,te||(te=!0,De());else{var J=i(b);J!==null&&oe(ee,J.startTime-z)}}var te=!1,W=-1,ye=5,pe=-1;function Be(){return N?!0:!(a.unstable_now()-pe<ye)}function Ve(){if(N=!1,te){var z=a.unstable_now();pe=z;var J=!0;try{e:{w=!1,S&&(S=!1,K(W),W=-1),_=!0;var Y=E;try{t:{for(P(z),y=i(p);y!==null&&!(y.expirationTime>z&&Be());){var ae=y.callback;if(typeof ae=="function"){y.callback=null,E=y.priorityLevel;var xe=ae(y.expirationTime<=z);if(z=a.unstable_now(),typeof xe=="function"){y.callback=xe,P(z),J=!0;break t}y===i(p)&&l(p),P(z)}else l(p);y=i(p)}if(y!==null)J=!0;else{var O=i(b);O!==null&&oe(ee,O.startTime-z),J=!1}}break e}finally{y=null,E=Y,_=!1}J=void 0}}finally{J?De():te=!1}}}var De;if(typeof H=="function")De=function(){H(Ve)};else if(typeof MessageChannel<"u"){var Ke=new MessageChannel,Le=Ke.port2;Ke.port1.onmessage=Ve,De=function(){Le.postMessage(null)}}else De=function(){k(Ve,0)};function oe(z,J){W=k(function(){z(a.unstable_now())},J)}a.unstable_IdlePriority=5,a.unstable_ImmediatePriority=1,a.unstable_LowPriority=4,a.unstable_NormalPriority=3,a.unstable_Profiling=null,a.unstable_UserBlockingPriority=2,a.unstable_cancelCallback=function(z){z.callback=null},a.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ye=0<z?Math.floor(1e3/z):5},a.unstable_getCurrentPriorityLevel=function(){return E},a.unstable_next=function(z){switch(E){case 1:case 2:case 3:var J=3;break;default:J=E}var Y=E;E=J;try{return z()}finally{E=Y}},a.unstable_requestPaint=function(){N=!0},a.unstable_runWithPriority=function(z,J){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var Y=E;E=z;try{return J()}finally{E=Y}},a.unstable_scheduleCallback=function(z,J,Y){var ae=a.unstable_now();switch(typeof Y=="object"&&Y!==null?(Y=Y.delay,Y=typeof Y=="number"&&0<Y?ae+Y:ae):Y=ae,z){case 1:var xe=-1;break;case 2:xe=250;break;case 5:xe=1073741823;break;case 4:xe=1e4;break;default:xe=5e3}return xe=Y+xe,z={id:x++,callback:J,priorityLevel:z,startTime:Y,expirationTime:xe,sortIndex:-1},Y>ae?(z.sortIndex=Y,n(b,z),i(p)===null&&z===i(b)&&(S?(K(W),W=-1):S=!0,oe(ee,Y-ae))):(z.sortIndex=xe,n(p,z),w||_||(w=!0,te||(te=!0,De()))),z},a.unstable_shouldYield=Be,a.unstable_wrapCallback=function(z){var J=E;return function(){var Y=E;E=J;try{return z.apply(this,arguments)}finally{E=Y}}}})(cu)),cu}var r0;function mv(){return r0||(r0=1,ou.exports=pv()),ou.exports}var uu={exports:{}},vt={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l0;function gv(){if(l0)return vt;l0=1;var a=Vu();function n(p){var b="https://react.dev/errors/"+p;if(1<arguments.length){b+="?args[]="+encodeURIComponent(arguments[1]);for(var x=2;x<arguments.length;x++)b+="&args[]="+encodeURIComponent(arguments[x])}return"Minified React error #"+p+"; visit "+b+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(){}var l={d:{f:i,r:function(){throw Error(n(522))},D:i,C:i,L:i,m:i,X:i,S:i,M:i},p:0,findDOMNode:null},u=Symbol.for("react.portal");function h(p,b,x){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:u,key:y==null?null:""+y,children:p,containerInfo:b,implementation:x}}var f=a.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function g(p,b){if(p==="font")return"";if(typeof b=="string")return b==="use-credentials"?b:""}return vt.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=l,vt.createPortal=function(p,b){var x=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!b||b.nodeType!==1&&b.nodeType!==9&&b.nodeType!==11)throw Error(n(299));return h(p,b,null,x)},vt.flushSync=function(p){var b=f.T,x=l.p;try{if(f.T=null,l.p=2,p)return p()}finally{f.T=b,l.p=x,l.d.f()}},vt.preconnect=function(p,b){typeof p=="string"&&(b?(b=b.crossOrigin,b=typeof b=="string"?b==="use-credentials"?b:"":void 0):b=null,l.d.C(p,b))},vt.prefetchDNS=function(p){typeof p=="string"&&l.d.D(p)},vt.preinit=function(p,b){if(typeof p=="string"&&b&&typeof b.as=="string"){var x=b.as,y=g(x,b.crossOrigin),E=typeof b.integrity=="string"?b.integrity:void 0,_=typeof b.fetchPriority=="string"?b.fetchPriority:void 0;x==="style"?l.d.S(p,typeof b.precedence=="string"?b.precedence:void 0,{crossOrigin:y,integrity:E,fetchPriority:_}):x==="script"&&l.d.X(p,{crossOrigin:y,integrity:E,fetchPriority:_,nonce:typeof b.nonce=="string"?b.nonce:void 0})}},vt.preinitModule=function(p,b){if(typeof p=="string")if(typeof b=="object"&&b!==null){if(b.as==null||b.as==="script"){var x=g(b.as,b.crossOrigin);l.d.M(p,{crossOrigin:x,integrity:typeof b.integrity=="string"?b.integrity:void 0,nonce:typeof b.nonce=="string"?b.nonce:void 0})}}else b==null&&l.d.M(p)},vt.preload=function(p,b){if(typeof p=="string"&&typeof b=="object"&&b!==null&&typeof b.as=="string"){var x=b.as,y=g(x,b.crossOrigin);l.d.L(p,x,{crossOrigin:y,integrity:typeof b.integrity=="string"?b.integrity:void 0,nonce:typeof b.nonce=="string"?b.nonce:void 0,type:typeof b.type=="string"?b.type:void 0,fetchPriority:typeof b.fetchPriority=="string"?b.fetchPriority:void 0,referrerPolicy:typeof b.referrerPolicy=="string"?b.referrerPolicy:void 0,imageSrcSet:typeof b.imageSrcSet=="string"?b.imageSrcSet:void 0,imageSizes:typeof b.imageSizes=="string"?b.imageSizes:void 0,media:typeof b.media=="string"?b.media:void 0})}},vt.preloadModule=function(p,b){if(typeof p=="string")if(b){var x=g(b.as,b.crossOrigin);l.d.m(p,{as:typeof b.as=="string"&&b.as!=="script"?b.as:void 0,crossOrigin:x,integrity:typeof b.integrity=="string"?b.integrity:void 0})}else l.d.m(p)},vt.requestFormReset=function(p){l.d.r(p)},vt.unstable_batchedUpdates=function(p,b){return p(b)},vt.useFormState=function(p,b,x){return f.H.useFormState(p,b,x)},vt.useFormStatus=function(){return f.H.useHostTransitionStatus()},vt.version="19.2.3",vt}var o0;function bv(){if(o0)return uu.exports;o0=1;function a(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(a)}catch(n){console.error(n)}}return a(),uu.exports=gv(),uu.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var c0;function yv(){if(c0)return Mi;c0=1;var a=mv(),n=Vu(),i=bv();function l(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var s=2;s<arguments.length;s++)t+="&args[]="+encodeURIComponent(arguments[s])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function u(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function h(e){var t=e,s=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(s=t.return),e=t.return;while(e)}return t.tag===3?s:null}function f(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function g(e){if(e.tag===31){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function p(e){if(h(e)!==e)throw Error(l(188))}function b(e){var t=e.alternate;if(!t){if(t=h(e),t===null)throw Error(l(188));return t!==e?null:e}for(var s=e,r=t;;){var c=s.return;if(c===null)break;var d=c.alternate;if(d===null){if(r=c.return,r!==null){s=r;continue}break}if(c.child===d.child){for(d=c.child;d;){if(d===s)return p(c),e;if(d===r)return p(c),t;d=d.sibling}throw Error(l(188))}if(s.return!==r.return)s=c,r=d;else{for(var m=!1,v=c.child;v;){if(v===s){m=!0,s=c,r=d;break}if(v===r){m=!0,r=c,s=d;break}v=v.sibling}if(!m){for(v=d.child;v;){if(v===s){m=!0,s=d,r=c;break}if(v===r){m=!0,r=d,s=c;break}v=v.sibling}if(!m)throw Error(l(189))}}if(s.alternate!==r)throw Error(l(190))}if(s.tag!==3)throw Error(l(188));return s.stateNode.current===s?e:t}function x(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=x(e),t!==null)return t;e=e.sibling}return null}var y=Object.assign,E=Symbol.for("react.element"),_=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),N=Symbol.for("react.strict_mode"),k=Symbol.for("react.profiler"),K=Symbol.for("react.consumer"),H=Symbol.for("react.context"),P=Symbol.for("react.forward_ref"),ee=Symbol.for("react.suspense"),te=Symbol.for("react.suspense_list"),W=Symbol.for("react.memo"),ye=Symbol.for("react.lazy"),pe=Symbol.for("react.activity"),Be=Symbol.for("react.memo_cache_sentinel"),Ve=Symbol.iterator;function De(e){return e===null||typeof e!="object"?null:(e=Ve&&e[Ve]||e["@@iterator"],typeof e=="function"?e:null)}var Ke=Symbol.for("react.client.reference");function Le(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===Ke?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case S:return"Fragment";case k:return"Profiler";case N:return"StrictMode";case ee:return"Suspense";case te:return"SuspenseList";case pe:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case w:return"Portal";case H:return e.displayName||"Context";case K:return(e._context.displayName||"Context")+".Consumer";case P:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case W:return t=e.displayName||null,t!==null?t:Le(e.type)||"Memo";case ye:t=e._payload,e=e._init;try{return Le(e(t))}catch{}}return null}var oe=Array.isArray,z=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,J=i.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Y={pending:!1,data:null,method:null,action:null},ae=[],xe=-1;function O(e){return{current:e}}function A(e){0>xe||(e.current=ae[xe],ae[xe]=null,xe--)}function L(e,t){xe++,ae[xe]=e.current,e.current=t}var $=O(null),C=O(null),B=O(null),q=O(null);function ne(e,t){switch(L(B,t),L(C,e),L($,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?Np(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)t=Np(t),e=Sp(t,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}A($),L($,e)}function me(){A($),A(C),A(B)}function bt(e){e.memoizedState!==null&&L(q,e);var t=$.current,s=Sp(t,e.type);t!==s&&(L(C,e),L($,s))}function cn(e){C.current===e&&(A($),A(C)),q.current===e&&(A(q),Di._currentValue=Y)}var Q,X;function Z(e){if(Q===void 0)try{throw Error()}catch(s){var t=s.stack.trim().match(/\n( *(at )?)/);Q=t&&t[1]||"",X=-1<s.stack.indexOf(`
    at`)?" (<anonymous>)":-1<s.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Q+e+X}var Se=!1;function re(e,t){if(!e||Se)return"";Se=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var r={DetermineComponentFrameRoot:function(){try{if(t){var F=function(){throw Error()};if(Object.defineProperty(F.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(F,[])}catch(M){var U=M}Reflect.construct(e,[],F)}else{try{F.call()}catch(M){U=M}e.call(F.prototype)}}else{try{throw Error()}catch(M){U=M}(F=e())&&typeof F.catch=="function"&&F.catch(function(){})}}catch(M){if(M&&U&&typeof M.stack=="string")return[M.stack,U.stack]}return[null,null]}};r.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var c=Object.getOwnPropertyDescriptor(r.DetermineComponentFrameRoot,"name");c&&c.configurable&&Object.defineProperty(r.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var d=r.DetermineComponentFrameRoot(),m=d[0],v=d[1];if(m&&v){var T=m.split(`
`),D=v.split(`
`);for(c=r=0;r<T.length&&!T[r].includes("DetermineComponentFrameRoot");)r++;for(;c<D.length&&!D[c].includes("DetermineComponentFrameRoot");)c++;if(r===T.length||c===D.length)for(r=T.length-1,c=D.length-1;1<=r&&0<=c&&T[r]!==D[c];)c--;for(;1<=r&&0<=c;r--,c--)if(T[r]!==D[c]){if(r!==1||c!==1)do if(r--,c--,0>c||T[r]!==D[c]){var G=`
`+T[r].replace(" at new "," at ");return e.displayName&&G.includes("<anonymous>")&&(G=G.replace("<anonymous>",e.displayName)),G}while(1<=r&&0<=c);break}}}finally{Se=!1,Error.prepareStackTrace=s}return(s=e?e.displayName||e.name:"")?Z(s):""}function yt(e,t){switch(e.tag){case 26:case 27:case 5:return Z(e.type);case 16:return Z("Lazy");case 13:return e.child!==t&&t!==null?Z("Suspense Fallback"):Z("Suspense");case 19:return Z("SuspenseList");case 0:case 15:return re(e.type,!1);case 11:return re(e.type.render,!1);case 1:return re(e.type,!0);case 31:return Z("Activity");default:return""}}function ar(e){try{var t="",s=null;do t+=yt(e,s),s=e,e=e.return;while(e);return t}catch(r){return`
Error generating stack: `+r.message+`
`+r.stack}}var Vs=Object.prototype.hasOwnProperty,$a=a.unstable_scheduleCallback,bn=a.unstable_cancelCallback,yn=a.unstable_shouldYield,Gn=a.unstable_requestPaint,Rt=a.unstable_now,Vg=a.unstable_getCurrentPriorityLevel,td=a.unstable_ImmediatePriority,nd=a.unstable_UserBlockingPriority,sr=a.unstable_NormalPriority,Yg=a.unstable_LowPriority,ad=a.unstable_IdlePriority,qg=a.log,Kg=a.unstable_setDisableYieldValue,Ys=null,Ct=null;function Pn(e){if(typeof qg=="function"&&Kg(e),Ct&&typeof Ct.setStrictMode=="function")try{Ct.setStrictMode(Ys,e)}catch{}}var It=Math.clz32?Math.clz32:Xg,Fg=Math.log,Jg=Math.LN2;function Xg(e){return e>>>=0,e===0?32:31-(Fg(e)/Jg|0)|0}var ir=256,rr=262144,lr=4194304;function ga(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function or(e,t,s){var r=e.pendingLanes;if(r===0)return 0;var c=0,d=e.suspendedLanes,m=e.pingedLanes;e=e.warmLanes;var v=r&134217727;return v!==0?(r=v&~d,r!==0?c=ga(r):(m&=v,m!==0?c=ga(m):s||(s=v&~e,s!==0&&(c=ga(s))))):(v=r&~d,v!==0?c=ga(v):m!==0?c=ga(m):s||(s=r&~e,s!==0&&(c=ga(s)))),c===0?0:t!==0&&t!==c&&(t&d)===0&&(d=c&-c,s=t&-t,d>=s||d===32&&(s&4194048)!==0)?t:c}function qs(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function Qg(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function sd(){var e=lr;return lr<<=1,(lr&62914560)===0&&(lr=4194304),e}function ql(e){for(var t=[],s=0;31>s;s++)t.push(e);return t}function Ks(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Wg(e,t,s,r,c,d){var m=e.pendingLanes;e.pendingLanes=s,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=s,e.entangledLanes&=s,e.errorRecoveryDisabledLanes&=s,e.shellSuspendCounter=0;var v=e.entanglements,T=e.expirationTimes,D=e.hiddenUpdates;for(s=m&~s;0<s;){var G=31-It(s),F=1<<G;v[G]=0,T[G]=-1;var U=D[G];if(U!==null)for(D[G]=null,G=0;G<U.length;G++){var M=U[G];M!==null&&(M.lane&=-536870913)}s&=~F}r!==0&&id(e,r,0),d!==0&&c===0&&e.tag!==0&&(e.suspendedLanes|=d&~(m&~t))}function id(e,t,s){e.pendingLanes|=t,e.suspendedLanes&=~t;var r=31-It(t);e.entangledLanes|=t,e.entanglements[r]=e.entanglements[r]|1073741824|s&261930}function rd(e,t){var s=e.entangledLanes|=t;for(e=e.entanglements;s;){var r=31-It(s),c=1<<r;c&t|e[r]&t&&(e[r]|=t),s&=~c}}function ld(e,t){var s=t&-t;return s=(s&42)!==0?1:Kl(s),(s&(e.suspendedLanes|t))!==0?0:s}function Kl(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Fl(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function od(){var e=J.p;return e!==0?e:(e=window.event,e===void 0?32:Fp(e.type))}function cd(e,t){var s=J.p;try{return J.p=e,t()}finally{J.p=s}}var $n=Math.random().toString(36).slice(2),ct="__reactFiber$"+$n,Et="__reactProps$"+$n,Va="__reactContainer$"+$n,Jl="__reactEvents$"+$n,Zg="__reactListeners$"+$n,eb="__reactHandles$"+$n,ud="__reactResources$"+$n,Fs="__reactMarker$"+$n;function Xl(e){delete e[ct],delete e[Et],delete e[Jl],delete e[Zg],delete e[eb]}function Ya(e){var t=e[ct];if(t)return t;for(var s=e.parentNode;s;){if(t=s[Va]||s[ct]){if(s=t.alternate,t.child!==null||s!==null&&s.child!==null)for(e=Ip(e);e!==null;){if(s=e[ct])return s;e=Ip(e)}return t}e=s,s=e.parentNode}return null}function qa(e){if(e=e[ct]||e[Va]){var t=e.tag;if(t===5||t===6||t===13||t===31||t===26||t===27||t===3)return e}return null}function Js(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(l(33))}function Ka(e){var t=e[ud];return t||(t=e[ud]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function lt(e){e[Fs]=!0}var dd=new Set,hd={};function ba(e,t){Fa(e,t),Fa(e+"Capture",t)}function Fa(e,t){for(hd[e]=t,e=0;e<t.length;e++)dd.add(t[e])}var tb=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),fd={},pd={};function nb(e){return Vs.call(pd,e)?!0:Vs.call(fd,e)?!1:tb.test(e)?pd[e]=!0:(fd[e]=!0,!1)}function cr(e,t,s){if(nb(t))if(s===null)e.removeAttribute(t);else{switch(typeof s){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var r=t.toLowerCase().slice(0,5);if(r!=="data-"&&r!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+s)}}function ur(e,t,s){if(s===null)e.removeAttribute(t);else{switch(typeof s){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+s)}}function vn(e,t,s,r){if(r===null)e.removeAttribute(s);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(s);return}e.setAttributeNS(t,s,""+r)}}function $t(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function md(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function ab(e,t,s){var r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var c=r.get,d=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return c.call(this)},set:function(m){s=""+m,d.call(this,m)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return s},setValue:function(m){s=""+m},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Ql(e){if(!e._valueTracker){var t=md(e)?"checked":"value";e._valueTracker=ab(e,t,""+e[t])}}function gd(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var s=t.getValue(),r="";return e&&(r=md(e)?e.checked?"true":"false":e.value),e=r,e!==s?(t.setValue(e),!0):!1}function dr(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var sb=/[\n"\\]/g;function Vt(e){return e.replace(sb,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function Wl(e,t,s,r,c,d,m,v){e.name="",m!=null&&typeof m!="function"&&typeof m!="symbol"&&typeof m!="boolean"?e.type=m:e.removeAttribute("type"),t!=null?m==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+$t(t)):e.value!==""+$t(t)&&(e.value=""+$t(t)):m!=="submit"&&m!=="reset"||e.removeAttribute("value"),t!=null?Zl(e,m,$t(t)):s!=null?Zl(e,m,$t(s)):r!=null&&e.removeAttribute("value"),c==null&&d!=null&&(e.defaultChecked=!!d),c!=null&&(e.checked=c&&typeof c!="function"&&typeof c!="symbol"),v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"?e.name=""+$t(v):e.removeAttribute("name")}function bd(e,t,s,r,c,d,m,v){if(d!=null&&typeof d!="function"&&typeof d!="symbol"&&typeof d!="boolean"&&(e.type=d),t!=null||s!=null){if(!(d!=="submit"&&d!=="reset"||t!=null)){Ql(e);return}s=s!=null?""+$t(s):"",t=t!=null?""+$t(t):s,v||t===e.value||(e.value=t),e.defaultValue=t}r=r??c,r=typeof r!="function"&&typeof r!="symbol"&&!!r,e.checked=v?e.checked:!!r,e.defaultChecked=!!r,m!=null&&typeof m!="function"&&typeof m!="symbol"&&typeof m!="boolean"&&(e.name=m),Ql(e)}function Zl(e,t,s){t==="number"&&dr(e.ownerDocument)===e||e.defaultValue===""+s||(e.defaultValue=""+s)}function Ja(e,t,s,r){if(e=e.options,t){t={};for(var c=0;c<s.length;c++)t["$"+s[c]]=!0;for(s=0;s<e.length;s++)c=t.hasOwnProperty("$"+e[s].value),e[s].selected!==c&&(e[s].selected=c),c&&r&&(e[s].defaultSelected=!0)}else{for(s=""+$t(s),t=null,c=0;c<e.length;c++){if(e[c].value===s){e[c].selected=!0,r&&(e[c].defaultSelected=!0);return}t!==null||e[c].disabled||(t=e[c])}t!==null&&(t.selected=!0)}}function yd(e,t,s){if(t!=null&&(t=""+$t(t),t!==e.value&&(e.value=t),s==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=s!=null?""+$t(s):""}function vd(e,t,s,r){if(t==null){if(r!=null){if(s!=null)throw Error(l(92));if(oe(r)){if(1<r.length)throw Error(l(93));r=r[0]}s=r}s==null&&(s=""),t=s}s=$t(t),e.defaultValue=s,r=e.textContent,r===s&&r!==""&&r!==null&&(e.value=r),Ql(e)}function Xa(e,t){if(t){var s=e.firstChild;if(s&&s===e.lastChild&&s.nodeType===3){s.nodeValue=t;return}}e.textContent=t}var ib=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function xd(e,t,s){var r=t.indexOf("--")===0;s==null||typeof s=="boolean"||s===""?r?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":r?e.setProperty(t,s):typeof s!="number"||s===0||ib.has(t)?t==="float"?e.cssFloat=s:e[t]=(""+s).trim():e[t]=s+"px"}function _d(e,t,s){if(t!=null&&typeof t!="object")throw Error(l(62));if(e=e.style,s!=null){for(var r in s)!s.hasOwnProperty(r)||t!=null&&t.hasOwnProperty(r)||(r.indexOf("--")===0?e.setProperty(r,""):r==="float"?e.cssFloat="":e[r]="");for(var c in t)r=t[c],t.hasOwnProperty(c)&&s[c]!==r&&xd(e,c,r)}else for(var d in t)t.hasOwnProperty(d)&&xd(e,d,t[d])}function eo(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var rb=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),lb=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function hr(e){return lb.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function xn(){}var to=null;function no(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Qa=null,Wa=null;function wd(e){var t=qa(e);if(t&&(e=t.stateNode)){var s=e[Et]||null;e:switch(e=t.stateNode,t.type){case"input":if(Wl(e,s.value,s.defaultValue,s.defaultValue,s.checked,s.defaultChecked,s.type,s.name),t=s.name,s.type==="radio"&&t!=null){for(s=e;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll('input[name="'+Vt(""+t)+'"][type="radio"]'),t=0;t<s.length;t++){var r=s[t];if(r!==e&&r.form===e.form){var c=r[Et]||null;if(!c)throw Error(l(90));Wl(r,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name)}}for(t=0;t<s.length;t++)r=s[t],r.form===e.form&&gd(r)}break e;case"textarea":yd(e,s.value,s.defaultValue);break e;case"select":t=s.value,t!=null&&Ja(e,!!s.multiple,t,!1)}}}var ao=!1;function Ed(e,t,s){if(ao)return e(t,s);ao=!0;try{var r=e(t);return r}finally{if(ao=!1,(Qa!==null||Wa!==null)&&(Zr(),Qa&&(t=Qa,e=Wa,Wa=Qa=null,wd(t),e)))for(t=0;t<e.length;t++)wd(e[t])}}function Xs(e,t){var s=e.stateNode;if(s===null)return null;var r=s[Et]||null;if(r===null)return null;s=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(s&&typeof s!="function")throw Error(l(231,t,typeof s));return s}var _n=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),so=!1;if(_n)try{var Qs={};Object.defineProperty(Qs,"passive",{get:function(){so=!0}}),window.addEventListener("test",Qs,Qs),window.removeEventListener("test",Qs,Qs)}catch{so=!1}var Vn=null,io=null,fr=null;function Nd(){if(fr)return fr;var e,t=io,s=t.length,r,c="value"in Vn?Vn.value:Vn.textContent,d=c.length;for(e=0;e<s&&t[e]===c[e];e++);var m=s-e;for(r=1;r<=m&&t[s-r]===c[d-r];r++);return fr=c.slice(e,1<r?1-r:void 0)}function pr(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function mr(){return!0}function Sd(){return!1}function Nt(e){function t(s,r,c,d,m){this._reactName=s,this._targetInst=c,this.type=r,this.nativeEvent=d,this.target=m,this.currentTarget=null;for(var v in e)e.hasOwnProperty(v)&&(s=e[v],this[v]=s?s(d):d[v]);return this.isDefaultPrevented=(d.defaultPrevented!=null?d.defaultPrevented:d.returnValue===!1)?mr:Sd,this.isPropagationStopped=Sd,this}return y(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var s=this.nativeEvent;s&&(s.preventDefault?s.preventDefault():typeof s.returnValue!="unknown"&&(s.returnValue=!1),this.isDefaultPrevented=mr)},stopPropagation:function(){var s=this.nativeEvent;s&&(s.stopPropagation?s.stopPropagation():typeof s.cancelBubble!="unknown"&&(s.cancelBubble=!0),this.isPropagationStopped=mr)},persist:function(){},isPersistent:mr}),t}var ya={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},gr=Nt(ya),Ws=y({},ya,{view:0,detail:0}),ob=Nt(Ws),ro,lo,Zs,br=y({},Ws,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:co,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Zs&&(Zs&&e.type==="mousemove"?(ro=e.screenX-Zs.screenX,lo=e.screenY-Zs.screenY):lo=ro=0,Zs=e),ro)},movementY:function(e){return"movementY"in e?e.movementY:lo}}),Td=Nt(br),cb=y({},br,{dataTransfer:0}),ub=Nt(cb),db=y({},Ws,{relatedTarget:0}),oo=Nt(db),hb=y({},ya,{animationName:0,elapsedTime:0,pseudoElement:0}),fb=Nt(hb),pb=y({},ya,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),mb=Nt(pb),gb=y({},ya,{data:0}),Ad=Nt(gb),bb={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},yb={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},vb={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function xb(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=vb[e])?!!t[e]:!1}function co(){return xb}var _b=y({},Ws,{key:function(e){if(e.key){var t=bb[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=pr(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?yb[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:co,charCode:function(e){return e.type==="keypress"?pr(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?pr(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),wb=Nt(_b),Eb=y({},br,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Od=Nt(Eb),Nb=y({},Ws,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:co}),Sb=Nt(Nb),Tb=y({},ya,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ab=Nt(Tb),Ob=y({},br,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),jb=Nt(Ob),Rb=y({},ya,{newState:0,oldState:0}),Cb=Nt(Rb),Ib=[9,13,27,32],uo=_n&&"CompositionEvent"in window,ei=null;_n&&"documentMode"in document&&(ei=document.documentMode);var Db=_n&&"TextEvent"in window&&!ei,jd=_n&&(!uo||ei&&8<ei&&11>=ei),Rd=" ",Cd=!1;function Id(e,t){switch(e){case"keyup":return Ib.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Dd(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Za=!1;function Ub(e,t){switch(e){case"compositionend":return Dd(t);case"keypress":return t.which!==32?null:(Cd=!0,Rd);case"textInput":return e=t.data,e===Rd&&Cd?null:e;default:return null}}function zb(e,t){if(Za)return e==="compositionend"||!uo&&Id(e,t)?(e=Nd(),fr=io=Vn=null,Za=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return jd&&t.locale!=="ko"?null:t.data;default:return null}}var kb={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ud(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!kb[e.type]:t==="textarea"}function zd(e,t,s,r){Qa?Wa?Wa.push(r):Wa=[r]:Qa=r,t=rl(t,"onChange"),0<t.length&&(s=new gr("onChange","change",null,s,r),e.push({event:s,listeners:t}))}var ti=null,ni=null;function Lb(e){yp(e,0)}function yr(e){var t=Js(e);if(gd(t))return e}function kd(e,t){if(e==="change")return t}var Ld=!1;if(_n){var ho;if(_n){var fo="oninput"in document;if(!fo){var Md=document.createElement("div");Md.setAttribute("oninput","return;"),fo=typeof Md.oninput=="function"}ho=fo}else ho=!1;Ld=ho&&(!document.documentMode||9<document.documentMode)}function Bd(){ti&&(ti.detachEvent("onpropertychange",Hd),ni=ti=null)}function Hd(e){if(e.propertyName==="value"&&yr(ni)){var t=[];zd(t,ni,e,no(e)),Ed(Lb,t)}}function Mb(e,t,s){e==="focusin"?(Bd(),ti=t,ni=s,ti.attachEvent("onpropertychange",Hd)):e==="focusout"&&Bd()}function Bb(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return yr(ni)}function Hb(e,t){if(e==="click")return yr(t)}function Gb(e,t){if(e==="input"||e==="change")return yr(t)}function Pb(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Dt=typeof Object.is=="function"?Object.is:Pb;function ai(e,t){if(Dt(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var s=Object.keys(e),r=Object.keys(t);if(s.length!==r.length)return!1;for(r=0;r<s.length;r++){var c=s[r];if(!Vs.call(t,c)||!Dt(e[c],t[c]))return!1}return!0}function Gd(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Pd(e,t){var s=Gd(e);e=0;for(var r;s;){if(s.nodeType===3){if(r=e+s.textContent.length,e<=t&&r>=t)return{node:s,offset:t-e};e=r}e:{for(;s;){if(s.nextSibling){s=s.nextSibling;break e}s=s.parentNode}s=void 0}s=Gd(s)}}function $d(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?$d(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Vd(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=dr(e.document);t instanceof e.HTMLIFrameElement;){try{var s=typeof t.contentWindow.location.href=="string"}catch{s=!1}if(s)e=t.contentWindow;else break;t=dr(e.document)}return t}function po(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}var $b=_n&&"documentMode"in document&&11>=document.documentMode,es=null,mo=null,si=null,go=!1;function Yd(e,t,s){var r=s.window===s?s.document:s.nodeType===9?s:s.ownerDocument;go||es==null||es!==dr(r)||(r=es,"selectionStart"in r&&po(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),si&&ai(si,r)||(si=r,r=rl(mo,"onSelect"),0<r.length&&(t=new gr("onSelect","select",null,t,s),e.push({event:t,listeners:r}),t.target=es)))}function va(e,t){var s={};return s[e.toLowerCase()]=t.toLowerCase(),s["Webkit"+e]="webkit"+t,s["Moz"+e]="moz"+t,s}var ts={animationend:va("Animation","AnimationEnd"),animationiteration:va("Animation","AnimationIteration"),animationstart:va("Animation","AnimationStart"),transitionrun:va("Transition","TransitionRun"),transitionstart:va("Transition","TransitionStart"),transitioncancel:va("Transition","TransitionCancel"),transitionend:va("Transition","TransitionEnd")},bo={},qd={};_n&&(qd=document.createElement("div").style,"AnimationEvent"in window||(delete ts.animationend.animation,delete ts.animationiteration.animation,delete ts.animationstart.animation),"TransitionEvent"in window||delete ts.transitionend.transition);function xa(e){if(bo[e])return bo[e];if(!ts[e])return e;var t=ts[e],s;for(s in t)if(t.hasOwnProperty(s)&&s in qd)return bo[e]=t[s];return e}var Kd=xa("animationend"),Fd=xa("animationiteration"),Jd=xa("animationstart"),Vb=xa("transitionrun"),Yb=xa("transitionstart"),qb=xa("transitioncancel"),Xd=xa("transitionend"),Qd=new Map,yo="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");yo.push("scrollEnd");function tn(e,t){Qd.set(e,t),ba(t,[e])}var vr=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},Yt=[],ns=0,vo=0;function xr(){for(var e=ns,t=vo=ns=0;t<e;){var s=Yt[t];Yt[t++]=null;var r=Yt[t];Yt[t++]=null;var c=Yt[t];Yt[t++]=null;var d=Yt[t];if(Yt[t++]=null,r!==null&&c!==null){var m=r.pending;m===null?c.next=c:(c.next=m.next,m.next=c),r.pending=c}d!==0&&Wd(s,c,d)}}function _r(e,t,s,r){Yt[ns++]=e,Yt[ns++]=t,Yt[ns++]=s,Yt[ns++]=r,vo|=r,e.lanes|=r,e=e.alternate,e!==null&&(e.lanes|=r)}function xo(e,t,s,r){return _r(e,t,s,r),wr(e)}function _a(e,t){return _r(e,null,null,t),wr(e)}function Wd(e,t,s){e.lanes|=s;var r=e.alternate;r!==null&&(r.lanes|=s);for(var c=!1,d=e.return;d!==null;)d.childLanes|=s,r=d.alternate,r!==null&&(r.childLanes|=s),d.tag===22&&(e=d.stateNode,e===null||e._visibility&1||(c=!0)),e=d,d=d.return;return e.tag===3?(d=e.stateNode,c&&t!==null&&(c=31-It(s),e=d.hiddenUpdates,r=e[c],r===null?e[c]=[t]:r.push(t),t.lane=s|536870912),d):null}function wr(e){if(50<Ti)throw Ti=0,jc=null,Error(l(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var as={};function Kb(e,t,s,r){this.tag=e,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ut(e,t,s,r){return new Kb(e,t,s,r)}function _o(e){return e=e.prototype,!(!e||!e.isReactComponent)}function wn(e,t){var s=e.alternate;return s===null?(s=Ut(e.tag,t,e.key,e.mode),s.elementType=e.elementType,s.type=e.type,s.stateNode=e.stateNode,s.alternate=e,e.alternate=s):(s.pendingProps=t,s.type=e.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=e.flags&65011712,s.childLanes=e.childLanes,s.lanes=e.lanes,s.child=e.child,s.memoizedProps=e.memoizedProps,s.memoizedState=e.memoizedState,s.updateQueue=e.updateQueue,t=e.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},s.sibling=e.sibling,s.index=e.index,s.ref=e.ref,s.refCleanup=e.refCleanup,s}function Zd(e,t){e.flags&=65011714;var s=e.alternate;return s===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=s.childLanes,e.lanes=s.lanes,e.child=s.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=s.memoizedProps,e.memoizedState=s.memoizedState,e.updateQueue=s.updateQueue,e.type=s.type,t=s.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Er(e,t,s,r,c,d){var m=0;if(r=e,typeof e=="function")_o(e)&&(m=1);else if(typeof e=="string")m=Wy(e,s,$.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case pe:return e=Ut(31,s,t,c),e.elementType=pe,e.lanes=d,e;case S:return wa(s.children,c,d,t);case N:m=8,c|=24;break;case k:return e=Ut(12,s,t,c|2),e.elementType=k,e.lanes=d,e;case ee:return e=Ut(13,s,t,c),e.elementType=ee,e.lanes=d,e;case te:return e=Ut(19,s,t,c),e.elementType=te,e.lanes=d,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case H:m=10;break e;case K:m=9;break e;case P:m=11;break e;case W:m=14;break e;case ye:m=16,r=null;break e}m=29,s=Error(l(130,e===null?"null":typeof e,"")),r=null}return t=Ut(m,s,t,c),t.elementType=e,t.type=r,t.lanes=d,t}function wa(e,t,s,r){return e=Ut(7,e,r,t),e.lanes=s,e}function wo(e,t,s){return e=Ut(6,e,null,t),e.lanes=s,e}function eh(e){var t=Ut(18,null,null,0);return t.stateNode=e,t}function Eo(e,t,s){return t=Ut(4,e.children!==null?e.children:[],e.key,t),t.lanes=s,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var th=new WeakMap;function qt(e,t){if(typeof e=="object"&&e!==null){var s=th.get(e);return s!==void 0?s:(t={value:e,source:t,stack:ar(t)},th.set(e,t),t)}return{value:e,source:t,stack:ar(t)}}var ss=[],is=0,Nr=null,ii=0,Kt=[],Ft=0,Yn=null,un=1,dn="";function En(e,t){ss[is++]=ii,ss[is++]=Nr,Nr=e,ii=t}function nh(e,t,s){Kt[Ft++]=un,Kt[Ft++]=dn,Kt[Ft++]=Yn,Yn=e;var r=un;e=dn;var c=32-It(r)-1;r&=~(1<<c),s+=1;var d=32-It(t)+c;if(30<d){var m=c-c%5;d=(r&(1<<m)-1).toString(32),r>>=m,c-=m,un=1<<32-It(t)+c|s<<c|r,dn=d+e}else un=1<<d|s<<c|r,dn=e}function No(e){e.return!==null&&(En(e,1),nh(e,1,0))}function So(e){for(;e===Nr;)Nr=ss[--is],ss[is]=null,ii=ss[--is],ss[is]=null;for(;e===Yn;)Yn=Kt[--Ft],Kt[Ft]=null,dn=Kt[--Ft],Kt[Ft]=null,un=Kt[--Ft],Kt[Ft]=null}function ah(e,t){Kt[Ft++]=un,Kt[Ft++]=dn,Kt[Ft++]=Yn,un=t.id,dn=t.overflow,Yn=e}var ut=null,Ge=null,Te=!1,qn=null,Jt=!1,To=Error(l(519));function Kn(e){var t=Error(l(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw ri(qt(t,e)),To}function sh(e){var t=e.stateNode,s=e.type,r=e.memoizedProps;switch(t[ct]=e,t[Et]=r,s){case"dialog":we("cancel",t),we("close",t);break;case"iframe":case"object":case"embed":we("load",t);break;case"video":case"audio":for(s=0;s<Oi.length;s++)we(Oi[s],t);break;case"source":we("error",t);break;case"img":case"image":case"link":we("error",t),we("load",t);break;case"details":we("toggle",t);break;case"input":we("invalid",t),bd(t,r.value,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name,!0);break;case"select":we("invalid",t);break;case"textarea":we("invalid",t),vd(t,r.value,r.defaultValue,r.children)}s=r.children,typeof s!="string"&&typeof s!="number"&&typeof s!="bigint"||t.textContent===""+s||r.suppressHydrationWarning===!0||wp(t.textContent,s)?(r.popover!=null&&(we("beforetoggle",t),we("toggle",t)),r.onScroll!=null&&we("scroll",t),r.onScrollEnd!=null&&we("scrollend",t),r.onClick!=null&&(t.onclick=xn),t=!0):t=!1,t||Kn(e,!0)}function ih(e){for(ut=e.return;ut;)switch(ut.tag){case 5:case 31:case 13:Jt=!1;return;case 27:case 3:Jt=!0;return;default:ut=ut.return}}function rs(e){if(e!==ut)return!1;if(!Te)return ih(e),Te=!0,!1;var t=e.tag,s;if((s=t!==3&&t!==27)&&((s=t===5)&&(s=e.type,s=!(s!=="form"&&s!=="button")||Vc(e.type,e.memoizedProps)),s=!s),s&&Ge&&Kn(e),ih(e),t===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(l(317));Ge=Cp(e)}else if(t===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(l(317));Ge=Cp(e)}else t===27?(t=Ge,la(e.type)?(e=Jc,Jc=null,Ge=e):Ge=t):Ge=ut?Qt(e.stateNode.nextSibling):null;return!0}function Ea(){Ge=ut=null,Te=!1}function Ao(){var e=qn;return e!==null&&(Ot===null?Ot=e:Ot.push.apply(Ot,e),qn=null),e}function ri(e){qn===null?qn=[e]:qn.push(e)}var Oo=O(null),Na=null,Nn=null;function Fn(e,t,s){L(Oo,t._currentValue),t._currentValue=s}function Sn(e){e._currentValue=Oo.current,A(Oo)}function jo(e,t,s){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===s)break;e=e.return}}function Ro(e,t,s,r){var c=e.child;for(c!==null&&(c.return=e);c!==null;){var d=c.dependencies;if(d!==null){var m=c.child;d=d.firstContext;e:for(;d!==null;){var v=d;d=c;for(var T=0;T<t.length;T++)if(v.context===t[T]){d.lanes|=s,v=d.alternate,v!==null&&(v.lanes|=s),jo(d.return,s,e),r||(m=null);break e}d=v.next}}else if(c.tag===18){if(m=c.return,m===null)throw Error(l(341));m.lanes|=s,d=m.alternate,d!==null&&(d.lanes|=s),jo(m,s,e),m=null}else m=c.child;if(m!==null)m.return=c;else for(m=c;m!==null;){if(m===e){m=null;break}if(c=m.sibling,c!==null){c.return=m.return,m=c;break}m=m.return}c=m}}function ls(e,t,s,r){e=null;for(var c=t,d=!1;c!==null;){if(!d){if((c.flags&524288)!==0)d=!0;else if((c.flags&262144)!==0)break}if(c.tag===10){var m=c.alternate;if(m===null)throw Error(l(387));if(m=m.memoizedProps,m!==null){var v=c.type;Dt(c.pendingProps.value,m.value)||(e!==null?e.push(v):e=[v])}}else if(c===q.current){if(m=c.alternate,m===null)throw Error(l(387));m.memoizedState.memoizedState!==c.memoizedState.memoizedState&&(e!==null?e.push(Di):e=[Di])}c=c.return}e!==null&&Ro(t,e,s,r),t.flags|=262144}function Sr(e){for(e=e.firstContext;e!==null;){if(!Dt(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Sa(e){Na=e,Nn=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function dt(e){return rh(Na,e)}function Tr(e,t){return Na===null&&Sa(e),rh(e,t)}function rh(e,t){var s=t._currentValue;if(t={context:t,memoizedValue:s,next:null},Nn===null){if(e===null)throw Error(l(308));Nn=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else Nn=Nn.next=t;return s}var Fb=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(s,r){e.push(r)}};this.abort=function(){t.aborted=!0,e.forEach(function(s){return s()})}},Jb=a.unstable_scheduleCallback,Xb=a.unstable_NormalPriority,Ze={$$typeof:H,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Co(){return{controller:new Fb,data:new Map,refCount:0}}function li(e){e.refCount--,e.refCount===0&&Jb(Xb,function(){e.controller.abort()})}var oi=null,Io=0,os=0,cs=null;function Qb(e,t){if(oi===null){var s=oi=[];Io=0,os=zc(),cs={status:"pending",value:void 0,then:function(r){s.push(r)}}}return Io++,t.then(lh,lh),t}function lh(){if(--Io===0&&oi!==null){cs!==null&&(cs.status="fulfilled");var e=oi;oi=null,os=0,cs=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function Wb(e,t){var s=[],r={status:"pending",value:null,reason:null,then:function(c){s.push(c)}};return e.then(function(){r.status="fulfilled",r.value=t;for(var c=0;c<s.length;c++)(0,s[c])(t)},function(c){for(r.status="rejected",r.reason=c,c=0;c<s.length;c++)(0,s[c])(void 0)}),r}var oh=z.S;z.S=function(e,t){qf=Rt(),typeof t=="object"&&t!==null&&typeof t.then=="function"&&Qb(e,t),oh!==null&&oh(e,t)};var Ta=O(null);function Do(){var e=Ta.current;return e!==null?e:Me.pooledCache}function Ar(e,t){t===null?L(Ta,Ta.current):L(Ta,t.pool)}function ch(){var e=Do();return e===null?null:{parent:Ze._currentValue,pool:e}}var us=Error(l(460)),Uo=Error(l(474)),Or=Error(l(542)),jr={then:function(){}};function uh(e){return e=e.status,e==="fulfilled"||e==="rejected"}function dh(e,t,s){switch(s=e[s],s===void 0?e.push(t):s!==t&&(t.then(xn,xn),t=s),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,fh(e),e;default:if(typeof t.status=="string")t.then(xn,xn);else{if(e=Me,e!==null&&100<e.shellSuspendCounter)throw Error(l(482));e=t,e.status="pending",e.then(function(r){if(t.status==="pending"){var c=t;c.status="fulfilled",c.value=r}},function(r){if(t.status==="pending"){var c=t;c.status="rejected",c.reason=r}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,fh(e),e}throw Oa=t,us}}function Aa(e){try{var t=e._init;return t(e._payload)}catch(s){throw s!==null&&typeof s=="object"&&typeof s.then=="function"?(Oa=s,us):s}}var Oa=null;function hh(){if(Oa===null)throw Error(l(459));var e=Oa;return Oa=null,e}function fh(e){if(e===us||e===Or)throw Error(l(483))}var ds=null,ci=0;function Rr(e){var t=ci;return ci+=1,ds===null&&(ds=[]),dh(ds,e,t)}function ui(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function Cr(e,t){throw t.$$typeof===E?Error(l(525)):(e=Object.prototype.toString.call(t),Error(l(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function ph(e){function t(R,j){if(e){var I=R.deletions;I===null?(R.deletions=[j],R.flags|=16):I.push(j)}}function s(R,j){if(!e)return null;for(;j!==null;)t(R,j),j=j.sibling;return null}function r(R){for(var j=new Map;R!==null;)R.key!==null?j.set(R.key,R):j.set(R.index,R),R=R.sibling;return j}function c(R,j){return R=wn(R,j),R.index=0,R.sibling=null,R}function d(R,j,I){return R.index=I,e?(I=R.alternate,I!==null?(I=I.index,I<j?(R.flags|=67108866,j):I):(R.flags|=67108866,j)):(R.flags|=1048576,j)}function m(R){return e&&R.alternate===null&&(R.flags|=67108866),R}function v(R,j,I,V){return j===null||j.tag!==6?(j=wo(I,R.mode,V),j.return=R,j):(j=c(j,I),j.return=R,j)}function T(R,j,I,V){var ue=I.type;return ue===S?G(R,j,I.props.children,V,I.key):j!==null&&(j.elementType===ue||typeof ue=="object"&&ue!==null&&ue.$$typeof===ye&&Aa(ue)===j.type)?(j=c(j,I.props),ui(j,I),j.return=R,j):(j=Er(I.type,I.key,I.props,null,R.mode,V),ui(j,I),j.return=R,j)}function D(R,j,I,V){return j===null||j.tag!==4||j.stateNode.containerInfo!==I.containerInfo||j.stateNode.implementation!==I.implementation?(j=Eo(I,R.mode,V),j.return=R,j):(j=c(j,I.children||[]),j.return=R,j)}function G(R,j,I,V,ue){return j===null||j.tag!==7?(j=wa(I,R.mode,V,ue),j.return=R,j):(j=c(j,I),j.return=R,j)}function F(R,j,I){if(typeof j=="string"&&j!==""||typeof j=="number"||typeof j=="bigint")return j=wo(""+j,R.mode,I),j.return=R,j;if(typeof j=="object"&&j!==null){switch(j.$$typeof){case _:return I=Er(j.type,j.key,j.props,null,R.mode,I),ui(I,j),I.return=R,I;case w:return j=Eo(j,R.mode,I),j.return=R,j;case ye:return j=Aa(j),F(R,j,I)}if(oe(j)||De(j))return j=wa(j,R.mode,I,null),j.return=R,j;if(typeof j.then=="function")return F(R,Rr(j),I);if(j.$$typeof===H)return F(R,Tr(R,j),I);Cr(R,j)}return null}function U(R,j,I,V){var ue=j!==null?j.key:null;if(typeof I=="string"&&I!==""||typeof I=="number"||typeof I=="bigint")return ue!==null?null:v(R,j,""+I,V);if(typeof I=="object"&&I!==null){switch(I.$$typeof){case _:return I.key===ue?T(R,j,I,V):null;case w:return I.key===ue?D(R,j,I,V):null;case ye:return I=Aa(I),U(R,j,I,V)}if(oe(I)||De(I))return ue!==null?null:G(R,j,I,V,null);if(typeof I.then=="function")return U(R,j,Rr(I),V);if(I.$$typeof===H)return U(R,j,Tr(R,I),V);Cr(R,I)}return null}function M(R,j,I,V,ue){if(typeof V=="string"&&V!==""||typeof V=="number"||typeof V=="bigint")return R=R.get(I)||null,v(j,R,""+V,ue);if(typeof V=="object"&&V!==null){switch(V.$$typeof){case _:return R=R.get(V.key===null?I:V.key)||null,T(j,R,V,ue);case w:return R=R.get(V.key===null?I:V.key)||null,D(j,R,V,ue);case ye:return V=Aa(V),M(R,j,I,V,ue)}if(oe(V)||De(V))return R=R.get(I)||null,G(j,R,V,ue,null);if(typeof V.then=="function")return M(R,j,I,Rr(V),ue);if(V.$$typeof===H)return M(R,j,I,Tr(j,V),ue);Cr(j,V)}return null}function se(R,j,I,V){for(var ue=null,Ae=null,le=j,ve=j=0,Ne=null;le!==null&&ve<I.length;ve++){le.index>ve?(Ne=le,le=null):Ne=le.sibling;var Oe=U(R,le,I[ve],V);if(Oe===null){le===null&&(le=Ne);break}e&&le&&Oe.alternate===null&&t(R,le),j=d(Oe,j,ve),Ae===null?ue=Oe:Ae.sibling=Oe,Ae=Oe,le=Ne}if(ve===I.length)return s(R,le),Te&&En(R,ve),ue;if(le===null){for(;ve<I.length;ve++)le=F(R,I[ve],V),le!==null&&(j=d(le,j,ve),Ae===null?ue=le:Ae.sibling=le,Ae=le);return Te&&En(R,ve),ue}for(le=r(le);ve<I.length;ve++)Ne=M(le,R,ve,I[ve],V),Ne!==null&&(e&&Ne.alternate!==null&&le.delete(Ne.key===null?ve:Ne.key),j=d(Ne,j,ve),Ae===null?ue=Ne:Ae.sibling=Ne,Ae=Ne);return e&&le.forEach(function(ha){return t(R,ha)}),Te&&En(R,ve),ue}function de(R,j,I,V){if(I==null)throw Error(l(151));for(var ue=null,Ae=null,le=j,ve=j=0,Ne=null,Oe=I.next();le!==null&&!Oe.done;ve++,Oe=I.next()){le.index>ve?(Ne=le,le=null):Ne=le.sibling;var ha=U(R,le,Oe.value,V);if(ha===null){le===null&&(le=Ne);break}e&&le&&ha.alternate===null&&t(R,le),j=d(ha,j,ve),Ae===null?ue=ha:Ae.sibling=ha,Ae=ha,le=Ne}if(Oe.done)return s(R,le),Te&&En(R,ve),ue;if(le===null){for(;!Oe.done;ve++,Oe=I.next())Oe=F(R,Oe.value,V),Oe!==null&&(j=d(Oe,j,ve),Ae===null?ue=Oe:Ae.sibling=Oe,Ae=Oe);return Te&&En(R,ve),ue}for(le=r(le);!Oe.done;ve++,Oe=I.next())Oe=M(le,R,ve,Oe.value,V),Oe!==null&&(e&&Oe.alternate!==null&&le.delete(Oe.key===null?ve:Oe.key),j=d(Oe,j,ve),Ae===null?ue=Oe:Ae.sibling=Oe,Ae=Oe);return e&&le.forEach(function(cv){return t(R,cv)}),Te&&En(R,ve),ue}function ke(R,j,I,V){if(typeof I=="object"&&I!==null&&I.type===S&&I.key===null&&(I=I.props.children),typeof I=="object"&&I!==null){switch(I.$$typeof){case _:e:{for(var ue=I.key;j!==null;){if(j.key===ue){if(ue=I.type,ue===S){if(j.tag===7){s(R,j.sibling),V=c(j,I.props.children),V.return=R,R=V;break e}}else if(j.elementType===ue||typeof ue=="object"&&ue!==null&&ue.$$typeof===ye&&Aa(ue)===j.type){s(R,j.sibling),V=c(j,I.props),ui(V,I),V.return=R,R=V;break e}s(R,j);break}else t(R,j);j=j.sibling}I.type===S?(V=wa(I.props.children,R.mode,V,I.key),V.return=R,R=V):(V=Er(I.type,I.key,I.props,null,R.mode,V),ui(V,I),V.return=R,R=V)}return m(R);case w:e:{for(ue=I.key;j!==null;){if(j.key===ue)if(j.tag===4&&j.stateNode.containerInfo===I.containerInfo&&j.stateNode.implementation===I.implementation){s(R,j.sibling),V=c(j,I.children||[]),V.return=R,R=V;break e}else{s(R,j);break}else t(R,j);j=j.sibling}V=Eo(I,R.mode,V),V.return=R,R=V}return m(R);case ye:return I=Aa(I),ke(R,j,I,V)}if(oe(I))return se(R,j,I,V);if(De(I)){if(ue=De(I),typeof ue!="function")throw Error(l(150));return I=ue.call(I),de(R,j,I,V)}if(typeof I.then=="function")return ke(R,j,Rr(I),V);if(I.$$typeof===H)return ke(R,j,Tr(R,I),V);Cr(R,I)}return typeof I=="string"&&I!==""||typeof I=="number"||typeof I=="bigint"?(I=""+I,j!==null&&j.tag===6?(s(R,j.sibling),V=c(j,I),V.return=R,R=V):(s(R,j),V=wo(I,R.mode,V),V.return=R,R=V),m(R)):s(R,j)}return function(R,j,I,V){try{ci=0;var ue=ke(R,j,I,V);return ds=null,ue}catch(le){if(le===us||le===Or)throw le;var Ae=Ut(29,le,null,R.mode);return Ae.lanes=V,Ae.return=R,Ae}finally{}}}var ja=ph(!0),mh=ph(!1),Jn=!1;function zo(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ko(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function Xn(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function Qn(e,t,s){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,(je&2)!==0){var c=r.pending;return c===null?t.next=t:(t.next=c.next,c.next=t),r.pending=t,t=wr(e),Wd(e,null,s),t}return _r(e,r,t,s),wr(e)}function di(e,t,s){if(t=t.updateQueue,t!==null&&(t=t.shared,(s&4194048)!==0)){var r=t.lanes;r&=e.pendingLanes,s|=r,t.lanes=s,rd(e,s)}}function Lo(e,t){var s=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,s===r)){var c=null,d=null;if(s=s.firstBaseUpdate,s!==null){do{var m={lane:s.lane,tag:s.tag,payload:s.payload,callback:null,next:null};d===null?c=d=m:d=d.next=m,s=s.next}while(s!==null);d===null?c=d=t:d=d.next=t}else c=d=t;s={baseState:r.baseState,firstBaseUpdate:c,lastBaseUpdate:d,shared:r.shared,callbacks:r.callbacks},e.updateQueue=s;return}e=s.lastBaseUpdate,e===null?s.firstBaseUpdate=t:e.next=t,s.lastBaseUpdate=t}var Mo=!1;function hi(){if(Mo){var e=cs;if(e!==null)throw e}}function fi(e,t,s,r){Mo=!1;var c=e.updateQueue;Jn=!1;var d=c.firstBaseUpdate,m=c.lastBaseUpdate,v=c.shared.pending;if(v!==null){c.shared.pending=null;var T=v,D=T.next;T.next=null,m===null?d=D:m.next=D,m=T;var G=e.alternate;G!==null&&(G=G.updateQueue,v=G.lastBaseUpdate,v!==m&&(v===null?G.firstBaseUpdate=D:v.next=D,G.lastBaseUpdate=T))}if(d!==null){var F=c.baseState;m=0,G=D=T=null,v=d;do{var U=v.lane&-536870913,M=U!==v.lane;if(M?(Ee&U)===U:(r&U)===U){U!==0&&U===os&&(Mo=!0),G!==null&&(G=G.next={lane:0,tag:v.tag,payload:v.payload,callback:null,next:null});e:{var se=e,de=v;U=t;var ke=s;switch(de.tag){case 1:if(se=de.payload,typeof se=="function"){F=se.call(ke,F,U);break e}F=se;break e;case 3:se.flags=se.flags&-65537|128;case 0:if(se=de.payload,U=typeof se=="function"?se.call(ke,F,U):se,U==null)break e;F=y({},F,U);break e;case 2:Jn=!0}}U=v.callback,U!==null&&(e.flags|=64,M&&(e.flags|=8192),M=c.callbacks,M===null?c.callbacks=[U]:M.push(U))}else M={lane:U,tag:v.tag,payload:v.payload,callback:v.callback,next:null},G===null?(D=G=M,T=F):G=G.next=M,m|=U;if(v=v.next,v===null){if(v=c.shared.pending,v===null)break;M=v,v=M.next,M.next=null,c.lastBaseUpdate=M,c.shared.pending=null}}while(!0);G===null&&(T=F),c.baseState=T,c.firstBaseUpdate=D,c.lastBaseUpdate=G,d===null&&(c.shared.lanes=0),na|=m,e.lanes=m,e.memoizedState=F}}function gh(e,t){if(typeof e!="function")throw Error(l(191,e));e.call(t)}function bh(e,t){var s=e.callbacks;if(s!==null)for(e.callbacks=null,e=0;e<s.length;e++)gh(s[e],t)}var hs=O(null),Ir=O(0);function yh(e,t){e=Un,L(Ir,e),L(hs,t),Un=e|t.baseLanes}function Bo(){L(Ir,Un),L(hs,hs.current)}function Ho(){Un=Ir.current,A(hs),A(Ir)}var zt=O(null),Xt=null;function Wn(e){var t=e.alternate;L(Qe,Qe.current&1),L(zt,e),Xt===null&&(t===null||hs.current!==null||t.memoizedState!==null)&&(Xt=e)}function Go(e){L(Qe,Qe.current),L(zt,e),Xt===null&&(Xt=e)}function vh(e){e.tag===22?(L(Qe,Qe.current),L(zt,e),Xt===null&&(Xt=e)):Zn()}function Zn(){L(Qe,Qe.current),L(zt,zt.current)}function kt(e){A(zt),Xt===e&&(Xt=null),A(Qe)}var Qe=O(0);function Dr(e){for(var t=e;t!==null;){if(t.tag===13){var s=t.memoizedState;if(s!==null&&(s=s.dehydrated,s===null||Kc(s)||Fc(s)))return t}else if(t.tag===19&&(t.memoizedProps.revealOrder==="forwards"||t.memoizedProps.revealOrder==="backwards"||t.memoizedProps.revealOrder==="unstable_legacy-backwards"||t.memoizedProps.revealOrder==="together")){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Tn=0,be=null,Ue=null,et=null,Ur=!1,fs=!1,Ra=!1,zr=0,pi=0,ps=null,Zb=0;function Fe(){throw Error(l(321))}function Po(e,t){if(t===null)return!1;for(var s=0;s<t.length&&s<e.length;s++)if(!Dt(e[s],t[s]))return!1;return!0}function $o(e,t,s,r,c,d){return Tn=d,be=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,z.H=e===null||e.memoizedState===null?nf:sc,Ra=!1,d=s(r,c),Ra=!1,fs&&(d=_h(t,s,r,c)),xh(e),d}function xh(e){z.H=bi;var t=Ue!==null&&Ue.next!==null;if(Tn=0,et=Ue=be=null,Ur=!1,pi=0,ps=null,t)throw Error(l(300));e===null||tt||(e=e.dependencies,e!==null&&Sr(e)&&(tt=!0))}function _h(e,t,s,r){be=e;var c=0;do{if(fs&&(ps=null),pi=0,fs=!1,25<=c)throw Error(l(301));if(c+=1,et=Ue=null,e.updateQueue!=null){var d=e.updateQueue;d.lastEffect=null,d.events=null,d.stores=null,d.memoCache!=null&&(d.memoCache.index=0)}z.H=af,d=t(s,r)}while(fs);return d}function ey(){var e=z.H,t=e.useState()[0];return t=typeof t.then=="function"?mi(t):t,e=e.useState()[0],(Ue!==null?Ue.memoizedState:null)!==e&&(be.flags|=1024),t}function Vo(){var e=zr!==0;return zr=0,e}function Yo(e,t,s){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s}function qo(e){if(Ur){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}Ur=!1}Tn=0,et=Ue=be=null,fs=!1,pi=zr=0,ps=null}function xt(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return et===null?be.memoizedState=et=e:et=et.next=e,et}function We(){if(Ue===null){var e=be.alternate;e=e!==null?e.memoizedState:null}else e=Ue.next;var t=et===null?be.memoizedState:et.next;if(t!==null)et=t,Ue=e;else{if(e===null)throw be.alternate===null?Error(l(467)):Error(l(310));Ue=e,e={memoizedState:Ue.memoizedState,baseState:Ue.baseState,baseQueue:Ue.baseQueue,queue:Ue.queue,next:null},et===null?be.memoizedState=et=e:et=et.next=e}return et}function kr(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function mi(e){var t=pi;return pi+=1,ps===null&&(ps=[]),e=dh(ps,e,t),t=be,(et===null?t.memoizedState:et.next)===null&&(t=t.alternate,z.H=t===null||t.memoizedState===null?nf:sc),e}function Lr(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return mi(e);if(e.$$typeof===H)return dt(e)}throw Error(l(438,String(e)))}function Ko(e){var t=null,s=be.updateQueue;if(s!==null&&(t=s.memoCache),t==null){var r=be.alternate;r!==null&&(r=r.updateQueue,r!==null&&(r=r.memoCache,r!=null&&(t={data:r.data.map(function(c){return c.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),s===null&&(s=kr(),be.updateQueue=s),s.memoCache=t,s=t.data[t.index],s===void 0)for(s=t.data[t.index]=Array(e),r=0;r<e;r++)s[r]=Be;return t.index++,s}function An(e,t){return typeof t=="function"?t(e):t}function Mr(e){var t=We();return Fo(t,Ue,e)}function Fo(e,t,s){var r=e.queue;if(r===null)throw Error(l(311));r.lastRenderedReducer=s;var c=e.baseQueue,d=r.pending;if(d!==null){if(c!==null){var m=c.next;c.next=d.next,d.next=m}t.baseQueue=c=d,r.pending=null}if(d=e.baseState,c===null)e.memoizedState=d;else{t=c.next;var v=m=null,T=null,D=t,G=!1;do{var F=D.lane&-536870913;if(F!==D.lane?(Ee&F)===F:(Tn&F)===F){var U=D.revertLane;if(U===0)T!==null&&(T=T.next={lane:0,revertLane:0,gesture:null,action:D.action,hasEagerState:D.hasEagerState,eagerState:D.eagerState,next:null}),F===os&&(G=!0);else if((Tn&U)===U){D=D.next,U===os&&(G=!0);continue}else F={lane:0,revertLane:D.revertLane,gesture:null,action:D.action,hasEagerState:D.hasEagerState,eagerState:D.eagerState,next:null},T===null?(v=T=F,m=d):T=T.next=F,be.lanes|=U,na|=U;F=D.action,Ra&&s(d,F),d=D.hasEagerState?D.eagerState:s(d,F)}else U={lane:F,revertLane:D.revertLane,gesture:D.gesture,action:D.action,hasEagerState:D.hasEagerState,eagerState:D.eagerState,next:null},T===null?(v=T=U,m=d):T=T.next=U,be.lanes|=F,na|=F;D=D.next}while(D!==null&&D!==t);if(T===null?m=d:T.next=v,!Dt(d,e.memoizedState)&&(tt=!0,G&&(s=cs,s!==null)))throw s;e.memoizedState=d,e.baseState=m,e.baseQueue=T,r.lastRenderedState=d}return c===null&&(r.lanes=0),[e.memoizedState,r.dispatch]}function Jo(e){var t=We(),s=t.queue;if(s===null)throw Error(l(311));s.lastRenderedReducer=e;var r=s.dispatch,c=s.pending,d=t.memoizedState;if(c!==null){s.pending=null;var m=c=c.next;do d=e(d,m.action),m=m.next;while(m!==c);Dt(d,t.memoizedState)||(tt=!0),t.memoizedState=d,t.baseQueue===null&&(t.baseState=d),s.lastRenderedState=d}return[d,r]}function wh(e,t,s){var r=be,c=We(),d=Te;if(d){if(s===void 0)throw Error(l(407));s=s()}else s=t();var m=!Dt((Ue||c).memoizedState,s);if(m&&(c.memoizedState=s,tt=!0),c=c.queue,Wo(Sh.bind(null,r,c,e),[e]),c.getSnapshot!==t||m||et!==null&&et.memoizedState.tag&1){if(r.flags|=2048,ms(9,{destroy:void 0},Nh.bind(null,r,c,s,t),null),Me===null)throw Error(l(349));d||(Tn&127)!==0||Eh(r,t,s)}return s}function Eh(e,t,s){e.flags|=16384,e={getSnapshot:t,value:s},t=be.updateQueue,t===null?(t=kr(),be.updateQueue=t,t.stores=[e]):(s=t.stores,s===null?t.stores=[e]:s.push(e))}function Nh(e,t,s,r){t.value=s,t.getSnapshot=r,Th(t)&&Ah(e)}function Sh(e,t,s){return s(function(){Th(t)&&Ah(e)})}function Th(e){var t=e.getSnapshot;e=e.value;try{var s=t();return!Dt(e,s)}catch{return!0}}function Ah(e){var t=_a(e,2);t!==null&&jt(t,e,2)}function Xo(e){var t=xt();if(typeof e=="function"){var s=e;if(e=s(),Ra){Pn(!0);try{s()}finally{Pn(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:An,lastRenderedState:e},t}function Oh(e,t,s,r){return e.baseState=s,Fo(e,Ue,typeof r=="function"?r:An)}function ty(e,t,s,r,c){if(Gr(e))throw Error(l(485));if(e=t.action,e!==null){var d={payload:c,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(m){d.listeners.push(m)}};z.T!==null?s(!0):d.isTransition=!1,r(d),s=t.pending,s===null?(d.next=t.pending=d,jh(t,d)):(d.next=s.next,t.pending=s.next=d)}}function jh(e,t){var s=t.action,r=t.payload,c=e.state;if(t.isTransition){var d=z.T,m={};z.T=m;try{var v=s(c,r),T=z.S;T!==null&&T(m,v),Rh(e,t,v)}catch(D){Qo(e,t,D)}finally{d!==null&&m.types!==null&&(d.types=m.types),z.T=d}}else try{d=s(c,r),Rh(e,t,d)}catch(D){Qo(e,t,D)}}function Rh(e,t,s){s!==null&&typeof s=="object"&&typeof s.then=="function"?s.then(function(r){Ch(e,t,r)},function(r){return Qo(e,t,r)}):Ch(e,t,s)}function Ch(e,t,s){t.status="fulfilled",t.value=s,Ih(t),e.state=s,t=e.pending,t!==null&&(s=t.next,s===t?e.pending=null:(s=s.next,t.next=s,jh(e,s)))}function Qo(e,t,s){var r=e.pending;if(e.pending=null,r!==null){r=r.next;do t.status="rejected",t.reason=s,Ih(t),t=t.next;while(t!==r)}e.action=null}function Ih(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function Dh(e,t){return t}function Uh(e,t){if(Te){var s=Me.formState;if(s!==null){e:{var r=be;if(Te){if(Ge){t:{for(var c=Ge,d=Jt;c.nodeType!==8;){if(!d){c=null;break t}if(c=Qt(c.nextSibling),c===null){c=null;break t}}d=c.data,c=d==="F!"||d==="F"?c:null}if(c){Ge=Qt(c.nextSibling),r=c.data==="F!";break e}}Kn(r)}r=!1}r&&(t=s[0])}}return s=xt(),s.memoizedState=s.baseState=t,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Dh,lastRenderedState:t},s.queue=r,s=Zh.bind(null,be,r),r.dispatch=s,r=Xo(!1),d=ac.bind(null,be,!1,r.queue),r=xt(),c={state:t,dispatch:null,action:e,pending:null},r.queue=c,s=ty.bind(null,be,c,d,s),c.dispatch=s,r.memoizedState=e,[t,s,!1]}function zh(e){var t=We();return kh(t,Ue,e)}function kh(e,t,s){if(t=Fo(e,t,Dh)[0],e=Mr(An)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var r=mi(t)}catch(m){throw m===us?Or:m}else r=t;t=We();var c=t.queue,d=c.dispatch;return s!==t.memoizedState&&(be.flags|=2048,ms(9,{destroy:void 0},ny.bind(null,c,s),null)),[r,d,e]}function ny(e,t){e.action=t}function Lh(e){var t=We(),s=Ue;if(s!==null)return kh(t,s,e);We(),t=t.memoizedState,s=We();var r=s.queue.dispatch;return s.memoizedState=e,[t,r,!1]}function ms(e,t,s,r){return e={tag:e,create:s,deps:r,inst:t,next:null},t=be.updateQueue,t===null&&(t=kr(),be.updateQueue=t),s=t.lastEffect,s===null?t.lastEffect=e.next=e:(r=s.next,s.next=e,e.next=r,t.lastEffect=e),e}function Mh(){return We().memoizedState}function Br(e,t,s,r){var c=xt();be.flags|=e,c.memoizedState=ms(1|t,{destroy:void 0},s,r===void 0?null:r)}function Hr(e,t,s,r){var c=We();r=r===void 0?null:r;var d=c.memoizedState.inst;Ue!==null&&r!==null&&Po(r,Ue.memoizedState.deps)?c.memoizedState=ms(t,d,s,r):(be.flags|=e,c.memoizedState=ms(1|t,d,s,r))}function Bh(e,t){Br(8390656,8,e,t)}function Wo(e,t){Hr(2048,8,e,t)}function ay(e){be.flags|=4;var t=be.updateQueue;if(t===null)t=kr(),be.updateQueue=t,t.events=[e];else{var s=t.events;s===null?t.events=[e]:s.push(e)}}function Hh(e){var t=We().memoizedState;return ay({ref:t,nextImpl:e}),function(){if((je&2)!==0)throw Error(l(440));return t.impl.apply(void 0,arguments)}}function Gh(e,t){return Hr(4,2,e,t)}function Ph(e,t){return Hr(4,4,e,t)}function $h(e,t){if(typeof t=="function"){e=e();var s=t(e);return function(){typeof s=="function"?s():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Vh(e,t,s){s=s!=null?s.concat([e]):null,Hr(4,4,$h.bind(null,t,e),s)}function Zo(){}function Yh(e,t){var s=We();t=t===void 0?null:t;var r=s.memoizedState;return t!==null&&Po(t,r[1])?r[0]:(s.memoizedState=[e,t],e)}function qh(e,t){var s=We();t=t===void 0?null:t;var r=s.memoizedState;if(t!==null&&Po(t,r[1]))return r[0];if(r=e(),Ra){Pn(!0);try{e()}finally{Pn(!1)}}return s.memoizedState=[r,t],r}function ec(e,t,s){return s===void 0||(Tn&1073741824)!==0&&(Ee&261930)===0?e.memoizedState=t:(e.memoizedState=s,e=Ff(),be.lanes|=e,na|=e,s)}function Kh(e,t,s,r){return Dt(s,t)?s:hs.current!==null?(e=ec(e,s,r),Dt(e,t)||(tt=!0),e):(Tn&42)===0||(Tn&1073741824)!==0&&(Ee&261930)===0?(tt=!0,e.memoizedState=s):(e=Ff(),be.lanes|=e,na|=e,t)}function Fh(e,t,s,r,c){var d=J.p;J.p=d!==0&&8>d?d:8;var m=z.T,v={};z.T=v,ac(e,!1,t,s);try{var T=c(),D=z.S;if(D!==null&&D(v,T),T!==null&&typeof T=="object"&&typeof T.then=="function"){var G=Wb(T,r);gi(e,t,G,Bt(e))}else gi(e,t,r,Bt(e))}catch(F){gi(e,t,{then:function(){},status:"rejected",reason:F},Bt())}finally{J.p=d,m!==null&&v.types!==null&&(m.types=v.types),z.T=m}}function sy(){}function tc(e,t,s,r){if(e.tag!==5)throw Error(l(476));var c=Jh(e).queue;Fh(e,c,t,Y,s===null?sy:function(){return Xh(e),s(r)})}function Jh(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:Y,baseState:Y,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:An,lastRenderedState:Y},next:null};var s={};return t.next={memoizedState:s,baseState:s,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:An,lastRenderedState:s},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function Xh(e){var t=Jh(e);t.next===null&&(t=e.alternate.memoizedState),gi(e,t.next.queue,{},Bt())}function nc(){return dt(Di)}function Qh(){return We().memoizedState}function Wh(){return We().memoizedState}function iy(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var s=Bt();e=Xn(s);var r=Qn(t,e,s);r!==null&&(jt(r,t,s),di(r,t,s)),t={cache:Co()},e.payload=t;return}t=t.return}}function ry(e,t,s){var r=Bt();s={lane:r,revertLane:0,gesture:null,action:s,hasEagerState:!1,eagerState:null,next:null},Gr(e)?ef(t,s):(s=xo(e,t,s,r),s!==null&&(jt(s,e,r),tf(s,t,r)))}function Zh(e,t,s){var r=Bt();gi(e,t,s,r)}function gi(e,t,s,r){var c={lane:r,revertLane:0,gesture:null,action:s,hasEagerState:!1,eagerState:null,next:null};if(Gr(e))ef(t,c);else{var d=e.alternate;if(e.lanes===0&&(d===null||d.lanes===0)&&(d=t.lastRenderedReducer,d!==null))try{var m=t.lastRenderedState,v=d(m,s);if(c.hasEagerState=!0,c.eagerState=v,Dt(v,m))return _r(e,t,c,0),Me===null&&xr(),!1}catch{}finally{}if(s=xo(e,t,c,r),s!==null)return jt(s,e,r),tf(s,t,r),!0}return!1}function ac(e,t,s,r){if(r={lane:2,revertLane:zc(),gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null},Gr(e)){if(t)throw Error(l(479))}else t=xo(e,s,r,2),t!==null&&jt(t,e,2)}function Gr(e){var t=e.alternate;return e===be||t!==null&&t===be}function ef(e,t){fs=Ur=!0;var s=e.pending;s===null?t.next=t:(t.next=s.next,s.next=t),e.pending=t}function tf(e,t,s){if((s&4194048)!==0){var r=t.lanes;r&=e.pendingLanes,s|=r,t.lanes=s,rd(e,s)}}var bi={readContext:dt,use:Lr,useCallback:Fe,useContext:Fe,useEffect:Fe,useImperativeHandle:Fe,useLayoutEffect:Fe,useInsertionEffect:Fe,useMemo:Fe,useReducer:Fe,useRef:Fe,useState:Fe,useDebugValue:Fe,useDeferredValue:Fe,useTransition:Fe,useSyncExternalStore:Fe,useId:Fe,useHostTransitionStatus:Fe,useFormState:Fe,useActionState:Fe,useOptimistic:Fe,useMemoCache:Fe,useCacheRefresh:Fe};bi.useEffectEvent=Fe;var nf={readContext:dt,use:Lr,useCallback:function(e,t){return xt().memoizedState=[e,t===void 0?null:t],e},useContext:dt,useEffect:Bh,useImperativeHandle:function(e,t,s){s=s!=null?s.concat([e]):null,Br(4194308,4,$h.bind(null,t,e),s)},useLayoutEffect:function(e,t){return Br(4194308,4,e,t)},useInsertionEffect:function(e,t){Br(4,2,e,t)},useMemo:function(e,t){var s=xt();t=t===void 0?null:t;var r=e();if(Ra){Pn(!0);try{e()}finally{Pn(!1)}}return s.memoizedState=[r,t],r},useReducer:function(e,t,s){var r=xt();if(s!==void 0){var c=s(t);if(Ra){Pn(!0);try{s(t)}finally{Pn(!1)}}}else c=t;return r.memoizedState=r.baseState=c,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:c},r.queue=e,e=e.dispatch=ry.bind(null,be,e),[r.memoizedState,e]},useRef:function(e){var t=xt();return e={current:e},t.memoizedState=e},useState:function(e){e=Xo(e);var t=e.queue,s=Zh.bind(null,be,t);return t.dispatch=s,[e.memoizedState,s]},useDebugValue:Zo,useDeferredValue:function(e,t){var s=xt();return ec(s,e,t)},useTransition:function(){var e=Xo(!1);return e=Fh.bind(null,be,e.queue,!0,!1),xt().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,s){var r=be,c=xt();if(Te){if(s===void 0)throw Error(l(407));s=s()}else{if(s=t(),Me===null)throw Error(l(349));(Ee&127)!==0||Eh(r,t,s)}c.memoizedState=s;var d={value:s,getSnapshot:t};return c.queue=d,Bh(Sh.bind(null,r,d,e),[e]),r.flags|=2048,ms(9,{destroy:void 0},Nh.bind(null,r,d,s,t),null),s},useId:function(){var e=xt(),t=Me.identifierPrefix;if(Te){var s=dn,r=un;s=(r&~(1<<32-It(r)-1)).toString(32)+s,t="_"+t+"R_"+s,s=zr++,0<s&&(t+="H"+s.toString(32)),t+="_"}else s=Zb++,t="_"+t+"r_"+s.toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:nc,useFormState:Uh,useActionState:Uh,useOptimistic:function(e){var t=xt();t.memoizedState=t.baseState=e;var s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=s,t=ac.bind(null,be,!0,s),s.dispatch=t,[e,t]},useMemoCache:Ko,useCacheRefresh:function(){return xt().memoizedState=iy.bind(null,be)},useEffectEvent:function(e){var t=xt(),s={impl:e};return t.memoizedState=s,function(){if((je&2)!==0)throw Error(l(440));return s.impl.apply(void 0,arguments)}}},sc={readContext:dt,use:Lr,useCallback:Yh,useContext:dt,useEffect:Wo,useImperativeHandle:Vh,useInsertionEffect:Gh,useLayoutEffect:Ph,useMemo:qh,useReducer:Mr,useRef:Mh,useState:function(){return Mr(An)},useDebugValue:Zo,useDeferredValue:function(e,t){var s=We();return Kh(s,Ue.memoizedState,e,t)},useTransition:function(){var e=Mr(An)[0],t=We().memoizedState;return[typeof e=="boolean"?e:mi(e),t]},useSyncExternalStore:wh,useId:Qh,useHostTransitionStatus:nc,useFormState:zh,useActionState:zh,useOptimistic:function(e,t){var s=We();return Oh(s,Ue,e,t)},useMemoCache:Ko,useCacheRefresh:Wh};sc.useEffectEvent=Hh;var af={readContext:dt,use:Lr,useCallback:Yh,useContext:dt,useEffect:Wo,useImperativeHandle:Vh,useInsertionEffect:Gh,useLayoutEffect:Ph,useMemo:qh,useReducer:Jo,useRef:Mh,useState:function(){return Jo(An)},useDebugValue:Zo,useDeferredValue:function(e,t){var s=We();return Ue===null?ec(s,e,t):Kh(s,Ue.memoizedState,e,t)},useTransition:function(){var e=Jo(An)[0],t=We().memoizedState;return[typeof e=="boolean"?e:mi(e),t]},useSyncExternalStore:wh,useId:Qh,useHostTransitionStatus:nc,useFormState:Lh,useActionState:Lh,useOptimistic:function(e,t){var s=We();return Ue!==null?Oh(s,Ue,e,t):(s.baseState=e,[e,s.queue.dispatch])},useMemoCache:Ko,useCacheRefresh:Wh};af.useEffectEvent=Hh;function ic(e,t,s,r){t=e.memoizedState,s=s(r,t),s=s==null?t:y({},t,s),e.memoizedState=s,e.lanes===0&&(e.updateQueue.baseState=s)}var rc={enqueueSetState:function(e,t,s){e=e._reactInternals;var r=Bt(),c=Xn(r);c.payload=t,s!=null&&(c.callback=s),t=Qn(e,c,r),t!==null&&(jt(t,e,r),di(t,e,r))},enqueueReplaceState:function(e,t,s){e=e._reactInternals;var r=Bt(),c=Xn(r);c.tag=1,c.payload=t,s!=null&&(c.callback=s),t=Qn(e,c,r),t!==null&&(jt(t,e,r),di(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var s=Bt(),r=Xn(s);r.tag=2,t!=null&&(r.callback=t),t=Qn(e,r,s),t!==null&&(jt(t,e,s),di(t,e,s))}};function sf(e,t,s,r,c,d,m){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,d,m):t.prototype&&t.prototype.isPureReactComponent?!ai(s,r)||!ai(c,d):!0}function rf(e,t,s,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(s,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(s,r),t.state!==e&&rc.enqueueReplaceState(t,t.state,null)}function Ca(e,t){var s=t;if("ref"in t){s={};for(var r in t)r!=="ref"&&(s[r]=t[r])}if(e=e.defaultProps){s===t&&(s=y({},s));for(var c in e)s[c]===void 0&&(s[c]=e[c])}return s}function lf(e){vr(e)}function of(e){console.error(e)}function cf(e){vr(e)}function Pr(e,t){try{var s=e.onUncaughtError;s(t.value,{componentStack:t.stack})}catch(r){setTimeout(function(){throw r})}}function uf(e,t,s){try{var r=e.onCaughtError;r(s.value,{componentStack:s.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(c){setTimeout(function(){throw c})}}function lc(e,t,s){return s=Xn(s),s.tag=3,s.payload={element:null},s.callback=function(){Pr(e,t)},s}function df(e){return e=Xn(e),e.tag=3,e}function hf(e,t,s,r){var c=s.type.getDerivedStateFromError;if(typeof c=="function"){var d=r.value;e.payload=function(){return c(d)},e.callback=function(){uf(t,s,r)}}var m=s.stateNode;m!==null&&typeof m.componentDidCatch=="function"&&(e.callback=function(){uf(t,s,r),typeof c!="function"&&(aa===null?aa=new Set([this]):aa.add(this));var v=r.stack;this.componentDidCatch(r.value,{componentStack:v!==null?v:""})})}function ly(e,t,s,r,c){if(s.flags|=32768,r!==null&&typeof r=="object"&&typeof r.then=="function"){if(t=s.alternate,t!==null&&ls(t,s,c,!0),s=zt.current,s!==null){switch(s.tag){case 31:case 13:return Xt===null?el():s.alternate===null&&Je===0&&(Je=3),s.flags&=-257,s.flags|=65536,s.lanes=c,r===jr?s.flags|=16384:(t=s.updateQueue,t===null?s.updateQueue=new Set([r]):t.add(r),Ic(e,r,c)),!1;case 22:return s.flags|=65536,r===jr?s.flags|=16384:(t=s.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([r])},s.updateQueue=t):(s=t.retryQueue,s===null?t.retryQueue=new Set([r]):s.add(r)),Ic(e,r,c)),!1}throw Error(l(435,s.tag))}return Ic(e,r,c),el(),!1}if(Te)return t=zt.current,t!==null?((t.flags&65536)===0&&(t.flags|=256),t.flags|=65536,t.lanes=c,r!==To&&(e=Error(l(422),{cause:r}),ri(qt(e,s)))):(r!==To&&(t=Error(l(423),{cause:r}),ri(qt(t,s))),e=e.current.alternate,e.flags|=65536,c&=-c,e.lanes|=c,r=qt(r,s),c=lc(e.stateNode,r,c),Lo(e,c),Je!==4&&(Je=2)),!1;var d=Error(l(520),{cause:r});if(d=qt(d,s),Si===null?Si=[d]:Si.push(d),Je!==4&&(Je=2),t===null)return!0;r=qt(r,s),s=t;do{switch(s.tag){case 3:return s.flags|=65536,e=c&-c,s.lanes|=e,e=lc(s.stateNode,r,e),Lo(s,e),!1;case 1:if(t=s.type,d=s.stateNode,(s.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||d!==null&&typeof d.componentDidCatch=="function"&&(aa===null||!aa.has(d))))return s.flags|=65536,c&=-c,s.lanes|=c,c=df(c),hf(c,e,s,r),Lo(s,c),!1}s=s.return}while(s!==null);return!1}var oc=Error(l(461)),tt=!1;function ht(e,t,s,r){t.child=e===null?mh(t,null,s,r):ja(t,e.child,s,r)}function ff(e,t,s,r,c){s=s.render;var d=t.ref;if("ref"in r){var m={};for(var v in r)v!=="ref"&&(m[v]=r[v])}else m=r;return Sa(t),r=$o(e,t,s,m,d,c),v=Vo(),e!==null&&!tt?(Yo(e,t,c),On(e,t,c)):(Te&&v&&No(t),t.flags|=1,ht(e,t,r,c),t.child)}function pf(e,t,s,r,c){if(e===null){var d=s.type;return typeof d=="function"&&!_o(d)&&d.defaultProps===void 0&&s.compare===null?(t.tag=15,t.type=d,mf(e,t,d,r,c)):(e=Er(s.type,null,r,t,t.mode,c),e.ref=t.ref,e.return=t,t.child=e)}if(d=e.child,!gc(e,c)){var m=d.memoizedProps;if(s=s.compare,s=s!==null?s:ai,s(m,r)&&e.ref===t.ref)return On(e,t,c)}return t.flags|=1,e=wn(d,r),e.ref=t.ref,e.return=t,t.child=e}function mf(e,t,s,r,c){if(e!==null){var d=e.memoizedProps;if(ai(d,r)&&e.ref===t.ref)if(tt=!1,t.pendingProps=r=d,gc(e,c))(e.flags&131072)!==0&&(tt=!0);else return t.lanes=e.lanes,On(e,t,c)}return cc(e,t,s,r,c)}function gf(e,t,s,r){var c=r.children,d=e!==null?e.memoizedState:null;if(e===null&&t.stateNode===null&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.mode==="hidden"){if((t.flags&128)!==0){if(d=d!==null?d.baseLanes|s:s,e!==null){for(r=t.child=e.child,c=0;r!==null;)c=c|r.lanes|r.childLanes,r=r.sibling;r=c&~d}else r=0,t.child=null;return bf(e,t,d,s,r)}if((s&536870912)!==0)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&Ar(t,d!==null?d.cachePool:null),d!==null?yh(t,d):Bo(),vh(t);else return r=t.lanes=536870912,bf(e,t,d!==null?d.baseLanes|s:s,s,r)}else d!==null?(Ar(t,d.cachePool),yh(t,d),Zn(),t.memoizedState=null):(e!==null&&Ar(t,null),Bo(),Zn());return ht(e,t,c,s),t.child}function yi(e,t){return e!==null&&e.tag===22||t.stateNode!==null||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function bf(e,t,s,r,c){var d=Do();return d=d===null?null:{parent:Ze._currentValue,pool:d},t.memoizedState={baseLanes:s,cachePool:d},e!==null&&Ar(t,null),Bo(),vh(t),e!==null&&ls(e,t,r,!0),t.childLanes=c,null}function $r(e,t){return t=Yr({mode:t.mode,children:t.children},e.mode),t.ref=e.ref,e.child=t,t.return=e,t}function yf(e,t,s){return ja(t,e.child,null,s),e=$r(t,t.pendingProps),e.flags|=2,kt(t),t.memoizedState=null,e}function oy(e,t,s){var r=t.pendingProps,c=(t.flags&128)!==0;if(t.flags&=-129,e===null){if(Te){if(r.mode==="hidden")return e=$r(t,r),t.lanes=536870912,yi(null,e);if(Go(t),(e=Ge)?(e=Rp(e,Jt),e=e!==null&&e.data==="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:Yn!==null?{id:un,overflow:dn}:null,retryLane:536870912,hydrationErrors:null},s=eh(e),s.return=t,t.child=s,ut=t,Ge=null)):e=null,e===null)throw Kn(t);return t.lanes=536870912,null}return $r(t,r)}var d=e.memoizedState;if(d!==null){var m=d.dehydrated;if(Go(t),c)if(t.flags&256)t.flags&=-257,t=yf(e,t,s);else if(t.memoizedState!==null)t.child=e.child,t.flags|=128,t=null;else throw Error(l(558));else if(tt||ls(e,t,s,!1),c=(s&e.childLanes)!==0,tt||c){if(r=Me,r!==null&&(m=ld(r,s),m!==0&&m!==d.retryLane))throw d.retryLane=m,_a(e,m),jt(r,e,m),oc;el(),t=yf(e,t,s)}else e=d.treeContext,Ge=Qt(m.nextSibling),ut=t,Te=!0,qn=null,Jt=!1,e!==null&&ah(t,e),t=$r(t,r),t.flags|=4096;return t}return e=wn(e.child,{mode:r.mode,children:r.children}),e.ref=t.ref,t.child=e,e.return=t,e}function Vr(e,t){var s=t.ref;if(s===null)e!==null&&e.ref!==null&&(t.flags|=4194816);else{if(typeof s!="function"&&typeof s!="object")throw Error(l(284));(e===null||e.ref!==s)&&(t.flags|=4194816)}}function cc(e,t,s,r,c){return Sa(t),s=$o(e,t,s,r,void 0,c),r=Vo(),e!==null&&!tt?(Yo(e,t,c),On(e,t,c)):(Te&&r&&No(t),t.flags|=1,ht(e,t,s,c),t.child)}function vf(e,t,s,r,c,d){return Sa(t),t.updateQueue=null,s=_h(t,r,s,c),xh(e),r=Vo(),e!==null&&!tt?(Yo(e,t,d),On(e,t,d)):(Te&&r&&No(t),t.flags|=1,ht(e,t,s,d),t.child)}function xf(e,t,s,r,c){if(Sa(t),t.stateNode===null){var d=as,m=s.contextType;typeof m=="object"&&m!==null&&(d=dt(m)),d=new s(r,d),t.memoizedState=d.state!==null&&d.state!==void 0?d.state:null,d.updater=rc,t.stateNode=d,d._reactInternals=t,d=t.stateNode,d.props=r,d.state=t.memoizedState,d.refs={},zo(t),m=s.contextType,d.context=typeof m=="object"&&m!==null?dt(m):as,d.state=t.memoizedState,m=s.getDerivedStateFromProps,typeof m=="function"&&(ic(t,s,m,r),d.state=t.memoizedState),typeof s.getDerivedStateFromProps=="function"||typeof d.getSnapshotBeforeUpdate=="function"||typeof d.UNSAFE_componentWillMount!="function"&&typeof d.componentWillMount!="function"||(m=d.state,typeof d.componentWillMount=="function"&&d.componentWillMount(),typeof d.UNSAFE_componentWillMount=="function"&&d.UNSAFE_componentWillMount(),m!==d.state&&rc.enqueueReplaceState(d,d.state,null),fi(t,r,d,c),hi(),d.state=t.memoizedState),typeof d.componentDidMount=="function"&&(t.flags|=4194308),r=!0}else if(e===null){d=t.stateNode;var v=t.memoizedProps,T=Ca(s,v);d.props=T;var D=d.context,G=s.contextType;m=as,typeof G=="object"&&G!==null&&(m=dt(G));var F=s.getDerivedStateFromProps;G=typeof F=="function"||typeof d.getSnapshotBeforeUpdate=="function",v=t.pendingProps!==v,G||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(v||D!==m)&&rf(t,d,r,m),Jn=!1;var U=t.memoizedState;d.state=U,fi(t,r,d,c),hi(),D=t.memoizedState,v||U!==D||Jn?(typeof F=="function"&&(ic(t,s,F,r),D=t.memoizedState),(T=Jn||sf(t,s,T,r,U,D,m))?(G||typeof d.UNSAFE_componentWillMount!="function"&&typeof d.componentWillMount!="function"||(typeof d.componentWillMount=="function"&&d.componentWillMount(),typeof d.UNSAFE_componentWillMount=="function"&&d.UNSAFE_componentWillMount()),typeof d.componentDidMount=="function"&&(t.flags|=4194308)):(typeof d.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=D),d.props=r,d.state=D,d.context=m,r=T):(typeof d.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{d=t.stateNode,ko(e,t),m=t.memoizedProps,G=Ca(s,m),d.props=G,F=t.pendingProps,U=d.context,D=s.contextType,T=as,typeof D=="object"&&D!==null&&(T=dt(D)),v=s.getDerivedStateFromProps,(D=typeof v=="function"||typeof d.getSnapshotBeforeUpdate=="function")||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(m!==F||U!==T)&&rf(t,d,r,T),Jn=!1,U=t.memoizedState,d.state=U,fi(t,r,d,c),hi();var M=t.memoizedState;m!==F||U!==M||Jn||e!==null&&e.dependencies!==null&&Sr(e.dependencies)?(typeof v=="function"&&(ic(t,s,v,r),M=t.memoizedState),(G=Jn||sf(t,s,G,r,U,M,T)||e!==null&&e.dependencies!==null&&Sr(e.dependencies))?(D||typeof d.UNSAFE_componentWillUpdate!="function"&&typeof d.componentWillUpdate!="function"||(typeof d.componentWillUpdate=="function"&&d.componentWillUpdate(r,M,T),typeof d.UNSAFE_componentWillUpdate=="function"&&d.UNSAFE_componentWillUpdate(r,M,T)),typeof d.componentDidUpdate=="function"&&(t.flags|=4),typeof d.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof d.componentDidUpdate!="function"||m===e.memoizedProps&&U===e.memoizedState||(t.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||m===e.memoizedProps&&U===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=M),d.props=r,d.state=M,d.context=T,r=G):(typeof d.componentDidUpdate!="function"||m===e.memoizedProps&&U===e.memoizedState||(t.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||m===e.memoizedProps&&U===e.memoizedState||(t.flags|=1024),r=!1)}return d=r,Vr(e,t),r=(t.flags&128)!==0,d||r?(d=t.stateNode,s=r&&typeof s.getDerivedStateFromError!="function"?null:d.render(),t.flags|=1,e!==null&&r?(t.child=ja(t,e.child,null,c),t.child=ja(t,null,s,c)):ht(e,t,s,c),t.memoizedState=d.state,e=t.child):e=On(e,t,c),e}function _f(e,t,s,r){return Ea(),t.flags|=256,ht(e,t,s,r),t.child}var uc={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function dc(e){return{baseLanes:e,cachePool:ch()}}function hc(e,t,s){return e=e!==null?e.childLanes&~s:0,t&&(e|=Mt),e}function wf(e,t,s){var r=t.pendingProps,c=!1,d=(t.flags&128)!==0,m;if((m=d)||(m=e!==null&&e.memoizedState===null?!1:(Qe.current&2)!==0),m&&(c=!0,t.flags&=-129),m=(t.flags&32)!==0,t.flags&=-33,e===null){if(Te){if(c?Wn(t):Zn(),(e=Ge)?(e=Rp(e,Jt),e=e!==null&&e.data!=="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:Yn!==null?{id:un,overflow:dn}:null,retryLane:536870912,hydrationErrors:null},s=eh(e),s.return=t,t.child=s,ut=t,Ge=null)):e=null,e===null)throw Kn(t);return Fc(e)?t.lanes=32:t.lanes=536870912,null}var v=r.children;return r=r.fallback,c?(Zn(),c=t.mode,v=Yr({mode:"hidden",children:v},c),r=wa(r,c,s,null),v.return=t,r.return=t,v.sibling=r,t.child=v,r=t.child,r.memoizedState=dc(s),r.childLanes=hc(e,m,s),t.memoizedState=uc,yi(null,r)):(Wn(t),fc(t,v))}var T=e.memoizedState;if(T!==null&&(v=T.dehydrated,v!==null)){if(d)t.flags&256?(Wn(t),t.flags&=-257,t=pc(e,t,s)):t.memoizedState!==null?(Zn(),t.child=e.child,t.flags|=128,t=null):(Zn(),v=r.fallback,c=t.mode,r=Yr({mode:"visible",children:r.children},c),v=wa(v,c,s,null),v.flags|=2,r.return=t,v.return=t,r.sibling=v,t.child=r,ja(t,e.child,null,s),r=t.child,r.memoizedState=dc(s),r.childLanes=hc(e,m,s),t.memoizedState=uc,t=yi(null,r));else if(Wn(t),Fc(v)){if(m=v.nextSibling&&v.nextSibling.dataset,m)var D=m.dgst;m=D,r=Error(l(419)),r.stack="",r.digest=m,ri({value:r,source:null,stack:null}),t=pc(e,t,s)}else if(tt||ls(e,t,s,!1),m=(s&e.childLanes)!==0,tt||m){if(m=Me,m!==null&&(r=ld(m,s),r!==0&&r!==T.retryLane))throw T.retryLane=r,_a(e,r),jt(m,e,r),oc;Kc(v)||el(),t=pc(e,t,s)}else Kc(v)?(t.flags|=192,t.child=e.child,t=null):(e=T.treeContext,Ge=Qt(v.nextSibling),ut=t,Te=!0,qn=null,Jt=!1,e!==null&&ah(t,e),t=fc(t,r.children),t.flags|=4096);return t}return c?(Zn(),v=r.fallback,c=t.mode,T=e.child,D=T.sibling,r=wn(T,{mode:"hidden",children:r.children}),r.subtreeFlags=T.subtreeFlags&65011712,D!==null?v=wn(D,v):(v=wa(v,c,s,null),v.flags|=2),v.return=t,r.return=t,r.sibling=v,t.child=r,yi(null,r),r=t.child,v=e.child.memoizedState,v===null?v=dc(s):(c=v.cachePool,c!==null?(T=Ze._currentValue,c=c.parent!==T?{parent:T,pool:T}:c):c=ch(),v={baseLanes:v.baseLanes|s,cachePool:c}),r.memoizedState=v,r.childLanes=hc(e,m,s),t.memoizedState=uc,yi(e.child,r)):(Wn(t),s=e.child,e=s.sibling,s=wn(s,{mode:"visible",children:r.children}),s.return=t,s.sibling=null,e!==null&&(m=t.deletions,m===null?(t.deletions=[e],t.flags|=16):m.push(e)),t.child=s,t.memoizedState=null,s)}function fc(e,t){return t=Yr({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function Yr(e,t){return e=Ut(22,e,null,t),e.lanes=0,e}function pc(e,t,s){return ja(t,e.child,null,s),e=fc(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Ef(e,t,s){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),jo(e.return,t,s)}function mc(e,t,s,r,c,d){var m=e.memoizedState;m===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:s,tailMode:c,treeForkCount:d}:(m.isBackwards=t,m.rendering=null,m.renderingStartTime=0,m.last=r,m.tail=s,m.tailMode=c,m.treeForkCount=d)}function Nf(e,t,s){var r=t.pendingProps,c=r.revealOrder,d=r.tail;r=r.children;var m=Qe.current,v=(m&2)!==0;if(v?(m=m&1|2,t.flags|=128):m&=1,L(Qe,m),ht(e,t,r,s),r=Te?ii:0,!v&&e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Ef(e,s,t);else if(e.tag===19)Ef(e,s,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(c){case"forwards":for(s=t.child,c=null;s!==null;)e=s.alternate,e!==null&&Dr(e)===null&&(c=s),s=s.sibling;s=c,s===null?(c=t.child,t.child=null):(c=s.sibling,s.sibling=null),mc(t,!1,c,s,d,r);break;case"backwards":case"unstable_legacy-backwards":for(s=null,c=t.child,t.child=null;c!==null;){if(e=c.alternate,e!==null&&Dr(e)===null){t.child=c;break}e=c.sibling,c.sibling=s,s=c,c=e}mc(t,!0,s,null,d,r);break;case"together":mc(t,!1,null,null,void 0,r);break;default:t.memoizedState=null}return t.child}function On(e,t,s){if(e!==null&&(t.dependencies=e.dependencies),na|=t.lanes,(s&t.childLanes)===0)if(e!==null){if(ls(e,t,s,!1),(s&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(l(153));if(t.child!==null){for(e=t.child,s=wn(e,e.pendingProps),t.child=s,s.return=t;e.sibling!==null;)e=e.sibling,s=s.sibling=wn(e,e.pendingProps),s.return=t;s.sibling=null}return t.child}function gc(e,t){return(e.lanes&t)!==0?!0:(e=e.dependencies,!!(e!==null&&Sr(e)))}function cy(e,t,s){switch(t.tag){case 3:ne(t,t.stateNode.containerInfo),Fn(t,Ze,e.memoizedState.cache),Ea();break;case 27:case 5:bt(t);break;case 4:ne(t,t.stateNode.containerInfo);break;case 10:Fn(t,t.type,t.memoizedProps.value);break;case 31:if(t.memoizedState!==null)return t.flags|=128,Go(t),null;break;case 13:var r=t.memoizedState;if(r!==null)return r.dehydrated!==null?(Wn(t),t.flags|=128,null):(s&t.child.childLanes)!==0?wf(e,t,s):(Wn(t),e=On(e,t,s),e!==null?e.sibling:null);Wn(t);break;case 19:var c=(e.flags&128)!==0;if(r=(s&t.childLanes)!==0,r||(ls(e,t,s,!1),r=(s&t.childLanes)!==0),c){if(r)return Nf(e,t,s);t.flags|=128}if(c=t.memoizedState,c!==null&&(c.rendering=null,c.tail=null,c.lastEffect=null),L(Qe,Qe.current),r)break;return null;case 22:return t.lanes=0,gf(e,t,s,t.pendingProps);case 24:Fn(t,Ze,e.memoizedState.cache)}return On(e,t,s)}function Sf(e,t,s){if(e!==null)if(e.memoizedProps!==t.pendingProps)tt=!0;else{if(!gc(e,s)&&(t.flags&128)===0)return tt=!1,cy(e,t,s);tt=(e.flags&131072)!==0}else tt=!1,Te&&(t.flags&1048576)!==0&&nh(t,ii,t.index);switch(t.lanes=0,t.tag){case 16:e:{var r=t.pendingProps;if(e=Aa(t.elementType),t.type=e,typeof e=="function")_o(e)?(r=Ca(e,r),t.tag=1,t=xf(null,t,e,r,s)):(t.tag=0,t=cc(null,t,e,r,s));else{if(e!=null){var c=e.$$typeof;if(c===P){t.tag=11,t=ff(null,t,e,r,s);break e}else if(c===W){t.tag=14,t=pf(null,t,e,r,s);break e}}throw t=Le(e)||e,Error(l(306,t,""))}}return t;case 0:return cc(e,t,t.type,t.pendingProps,s);case 1:return r=t.type,c=Ca(r,t.pendingProps),xf(e,t,r,c,s);case 3:e:{if(ne(t,t.stateNode.containerInfo),e===null)throw Error(l(387));r=t.pendingProps;var d=t.memoizedState;c=d.element,ko(e,t),fi(t,r,null,s);var m=t.memoizedState;if(r=m.cache,Fn(t,Ze,r),r!==d.cache&&Ro(t,[Ze],s,!0),hi(),r=m.element,d.isDehydrated)if(d={element:r,isDehydrated:!1,cache:m.cache},t.updateQueue.baseState=d,t.memoizedState=d,t.flags&256){t=_f(e,t,r,s);break e}else if(r!==c){c=qt(Error(l(424)),t),ri(c),t=_f(e,t,r,s);break e}else{switch(e=t.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(Ge=Qt(e.firstChild),ut=t,Te=!0,qn=null,Jt=!0,s=mh(t,null,r,s),t.child=s;s;)s.flags=s.flags&-3|4096,s=s.sibling}else{if(Ea(),r===c){t=On(e,t,s);break e}ht(e,t,r,s)}t=t.child}return t;case 26:return Vr(e,t),e===null?(s=kp(t.type,null,t.pendingProps,null))?t.memoizedState=s:Te||(s=t.type,e=t.pendingProps,r=ll(B.current).createElement(s),r[ct]=t,r[Et]=e,ft(r,s,e),lt(r),t.stateNode=r):t.memoizedState=kp(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return bt(t),e===null&&Te&&(r=t.stateNode=Dp(t.type,t.pendingProps,B.current),ut=t,Jt=!0,c=Ge,la(t.type)?(Jc=c,Ge=Qt(r.firstChild)):Ge=c),ht(e,t,t.pendingProps.children,s),Vr(e,t),e===null&&(t.flags|=4194304),t.child;case 5:return e===null&&Te&&((c=r=Ge)&&(r=By(r,t.type,t.pendingProps,Jt),r!==null?(t.stateNode=r,ut=t,Ge=Qt(r.firstChild),Jt=!1,c=!0):c=!1),c||Kn(t)),bt(t),c=t.type,d=t.pendingProps,m=e!==null?e.memoizedProps:null,r=d.children,Vc(c,d)?r=null:m!==null&&Vc(c,m)&&(t.flags|=32),t.memoizedState!==null&&(c=$o(e,t,ey,null,null,s),Di._currentValue=c),Vr(e,t),ht(e,t,r,s),t.child;case 6:return e===null&&Te&&((e=s=Ge)&&(s=Hy(s,t.pendingProps,Jt),s!==null?(t.stateNode=s,ut=t,Ge=null,e=!0):e=!1),e||Kn(t)),null;case 13:return wf(e,t,s);case 4:return ne(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=ja(t,null,r,s):ht(e,t,r,s),t.child;case 11:return ff(e,t,t.type,t.pendingProps,s);case 7:return ht(e,t,t.pendingProps,s),t.child;case 8:return ht(e,t,t.pendingProps.children,s),t.child;case 12:return ht(e,t,t.pendingProps.children,s),t.child;case 10:return r=t.pendingProps,Fn(t,t.type,r.value),ht(e,t,r.children,s),t.child;case 9:return c=t.type._context,r=t.pendingProps.children,Sa(t),c=dt(c),r=r(c),t.flags|=1,ht(e,t,r,s),t.child;case 14:return pf(e,t,t.type,t.pendingProps,s);case 15:return mf(e,t,t.type,t.pendingProps,s);case 19:return Nf(e,t,s);case 31:return oy(e,t,s);case 22:return gf(e,t,s,t.pendingProps);case 24:return Sa(t),r=dt(Ze),e===null?(c=Do(),c===null&&(c=Me,d=Co(),c.pooledCache=d,d.refCount++,d!==null&&(c.pooledCacheLanes|=s),c=d),t.memoizedState={parent:r,cache:c},zo(t),Fn(t,Ze,c)):((e.lanes&s)!==0&&(ko(e,t),fi(t,null,null,s),hi()),c=e.memoizedState,d=t.memoizedState,c.parent!==r?(c={parent:r,cache:r},t.memoizedState=c,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=c),Fn(t,Ze,r)):(r=d.cache,Fn(t,Ze,r),r!==c.cache&&Ro(t,[Ze],s,!0))),ht(e,t,t.pendingProps.children,s),t.child;case 29:throw t.pendingProps}throw Error(l(156,t.tag))}function jn(e){e.flags|=4}function bc(e,t,s,r,c){if((t=(e.mode&32)!==0)&&(t=!1),t){if(e.flags|=16777216,(c&335544128)===c)if(e.stateNode.complete)e.flags|=8192;else if(Wf())e.flags|=8192;else throw Oa=jr,Uo}else e.flags&=-16777217}function Tf(e,t){if(t.type!=="stylesheet"||(t.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!Gp(t))if(Wf())e.flags|=8192;else throw Oa=jr,Uo}function qr(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?sd():536870912,e.lanes|=t,vs|=t)}function vi(e,t){if(!Te)switch(e.tailMode){case"hidden":t=e.tail;for(var s=null;t!==null;)t.alternate!==null&&(s=t),t=t.sibling;s===null?e.tail=null:s.sibling=null;break;case"collapsed":s=e.tail;for(var r=null;s!==null;)s.alternate!==null&&(r=s),s=s.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Pe(e){var t=e.alternate!==null&&e.alternate.child===e.child,s=0,r=0;if(t)for(var c=e.child;c!==null;)s|=c.lanes|c.childLanes,r|=c.subtreeFlags&65011712,r|=c.flags&65011712,c.return=e,c=c.sibling;else for(c=e.child;c!==null;)s|=c.lanes|c.childLanes,r|=c.subtreeFlags,r|=c.flags,c.return=e,c=c.sibling;return e.subtreeFlags|=r,e.childLanes=s,t}function uy(e,t,s){var r=t.pendingProps;switch(So(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Pe(t),null;case 1:return Pe(t),null;case 3:return s=t.stateNode,r=null,e!==null&&(r=e.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),Sn(Ze),me(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(e===null||e.child===null)&&(rs(t)?jn(t):e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,Ao())),Pe(t),null;case 26:var c=t.type,d=t.memoizedState;return e===null?(jn(t),d!==null?(Pe(t),Tf(t,d)):(Pe(t),bc(t,c,null,r,s))):d?d!==e.memoizedState?(jn(t),Pe(t),Tf(t,d)):(Pe(t),t.flags&=-16777217):(e=e.memoizedProps,e!==r&&jn(t),Pe(t),bc(t,c,e,r,s)),null;case 27:if(cn(t),s=B.current,c=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==r&&jn(t);else{if(!r){if(t.stateNode===null)throw Error(l(166));return Pe(t),null}e=$.current,rs(t)?sh(t):(e=Dp(c,r,s),t.stateNode=e,jn(t))}return Pe(t),null;case 5:if(cn(t),c=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==r&&jn(t);else{if(!r){if(t.stateNode===null)throw Error(l(166));return Pe(t),null}if(d=$.current,rs(t))sh(t);else{var m=ll(B.current);switch(d){case 1:d=m.createElementNS("http://www.w3.org/2000/svg",c);break;case 2:d=m.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;default:switch(c){case"svg":d=m.createElementNS("http://www.w3.org/2000/svg",c);break;case"math":d=m.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;case"script":d=m.createElement("div"),d.innerHTML="<script><\/script>",d=d.removeChild(d.firstChild);break;case"select":d=typeof r.is=="string"?m.createElement("select",{is:r.is}):m.createElement("select"),r.multiple?d.multiple=!0:r.size&&(d.size=r.size);break;default:d=typeof r.is=="string"?m.createElement(c,{is:r.is}):m.createElement(c)}}d[ct]=t,d[Et]=r;e:for(m=t.child;m!==null;){if(m.tag===5||m.tag===6)d.appendChild(m.stateNode);else if(m.tag!==4&&m.tag!==27&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===t)break e;for(;m.sibling===null;){if(m.return===null||m.return===t)break e;m=m.return}m.sibling.return=m.return,m=m.sibling}t.stateNode=d;e:switch(ft(d,c,r),c){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}r&&jn(t)}}return Pe(t),bc(t,t.type,e===null?null:e.memoizedProps,t.pendingProps,s),null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==r&&jn(t);else{if(typeof r!="string"&&t.stateNode===null)throw Error(l(166));if(e=B.current,rs(t)){if(e=t.stateNode,s=t.memoizedProps,r=null,c=ut,c!==null)switch(c.tag){case 27:case 5:r=c.memoizedProps}e[ct]=t,e=!!(e.nodeValue===s||r!==null&&r.suppressHydrationWarning===!0||wp(e.nodeValue,s)),e||Kn(t,!0)}else e=ll(e).createTextNode(r),e[ct]=t,t.stateNode=e}return Pe(t),null;case 31:if(s=t.memoizedState,e===null||e.memoizedState!==null){if(r=rs(t),s!==null){if(e===null){if(!r)throw Error(l(318));if(e=t.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(l(557));e[ct]=t}else Ea(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;Pe(t),e=!1}else s=Ao(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=s),e=!0;if(!e)return t.flags&256?(kt(t),t):(kt(t),null);if((t.flags&128)!==0)throw Error(l(558))}return Pe(t),null;case 13:if(r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(c=rs(t),r!==null&&r.dehydrated!==null){if(e===null){if(!c)throw Error(l(318));if(c=t.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(l(317));c[ct]=t}else Ea(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;Pe(t),c=!1}else c=Ao(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=c),c=!0;if(!c)return t.flags&256?(kt(t),t):(kt(t),null)}return kt(t),(t.flags&128)!==0?(t.lanes=s,t):(s=r!==null,e=e!==null&&e.memoizedState!==null,s&&(r=t.child,c=null,r.alternate!==null&&r.alternate.memoizedState!==null&&r.alternate.memoizedState.cachePool!==null&&(c=r.alternate.memoizedState.cachePool.pool),d=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(d=r.memoizedState.cachePool.pool),d!==c&&(r.flags|=2048)),s!==e&&s&&(t.child.flags|=8192),qr(t,t.updateQueue),Pe(t),null);case 4:return me(),e===null&&Bc(t.stateNode.containerInfo),Pe(t),null;case 10:return Sn(t.type),Pe(t),null;case 19:if(A(Qe),r=t.memoizedState,r===null)return Pe(t),null;if(c=(t.flags&128)!==0,d=r.rendering,d===null)if(c)vi(r,!1);else{if(Je!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(d=Dr(e),d!==null){for(t.flags|=128,vi(r,!1),e=d.updateQueue,t.updateQueue=e,qr(t,e),t.subtreeFlags=0,e=s,s=t.child;s!==null;)Zd(s,e),s=s.sibling;return L(Qe,Qe.current&1|2),Te&&En(t,r.treeForkCount),t.child}e=e.sibling}r.tail!==null&&Rt()>Qr&&(t.flags|=128,c=!0,vi(r,!1),t.lanes=4194304)}else{if(!c)if(e=Dr(d),e!==null){if(t.flags|=128,c=!0,e=e.updateQueue,t.updateQueue=e,qr(t,e),vi(r,!0),r.tail===null&&r.tailMode==="hidden"&&!d.alternate&&!Te)return Pe(t),null}else 2*Rt()-r.renderingStartTime>Qr&&s!==536870912&&(t.flags|=128,c=!0,vi(r,!1),t.lanes=4194304);r.isBackwards?(d.sibling=t.child,t.child=d):(e=r.last,e!==null?e.sibling=d:t.child=d,r.last=d)}return r.tail!==null?(e=r.tail,r.rendering=e,r.tail=e.sibling,r.renderingStartTime=Rt(),e.sibling=null,s=Qe.current,L(Qe,c?s&1|2:s&1),Te&&En(t,r.treeForkCount),e):(Pe(t),null);case 22:case 23:return kt(t),Ho(),r=t.memoizedState!==null,e!==null?e.memoizedState!==null!==r&&(t.flags|=8192):r&&(t.flags|=8192),r?(s&536870912)!==0&&(t.flags&128)===0&&(Pe(t),t.subtreeFlags&6&&(t.flags|=8192)):Pe(t),s=t.updateQueue,s!==null&&qr(t,s.retryQueue),s=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(s=e.memoizedState.cachePool.pool),r=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(r=t.memoizedState.cachePool.pool),r!==s&&(t.flags|=2048),e!==null&&A(Ta),null;case 24:return s=null,e!==null&&(s=e.memoizedState.cache),t.memoizedState.cache!==s&&(t.flags|=2048),Sn(Ze),Pe(t),null;case 25:return null;case 30:return null}throw Error(l(156,t.tag))}function dy(e,t){switch(So(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Sn(Ze),me(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return cn(t),null;case 31:if(t.memoizedState!==null){if(kt(t),t.alternate===null)throw Error(l(340));Ea()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 13:if(kt(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(l(340));Ea()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return A(Qe),null;case 4:return me(),null;case 10:return Sn(t.type),null;case 22:case 23:return kt(t),Ho(),e!==null&&A(Ta),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return Sn(Ze),null;case 25:return null;default:return null}}function Af(e,t){switch(So(t),t.tag){case 3:Sn(Ze),me();break;case 26:case 27:case 5:cn(t);break;case 4:me();break;case 31:t.memoizedState!==null&&kt(t);break;case 13:kt(t);break;case 19:A(Qe);break;case 10:Sn(t.type);break;case 22:case 23:kt(t),Ho(),e!==null&&A(Ta);break;case 24:Sn(Ze)}}function xi(e,t){try{var s=t.updateQueue,r=s!==null?s.lastEffect:null;if(r!==null){var c=r.next;s=c;do{if((s.tag&e)===e){r=void 0;var d=s.create,m=s.inst;r=d(),m.destroy=r}s=s.next}while(s!==c)}}catch(v){Ie(t,t.return,v)}}function ea(e,t,s){try{var r=t.updateQueue,c=r!==null?r.lastEffect:null;if(c!==null){var d=c.next;r=d;do{if((r.tag&e)===e){var m=r.inst,v=m.destroy;if(v!==void 0){m.destroy=void 0,c=t;var T=s,D=v;try{D()}catch(G){Ie(c,T,G)}}}r=r.next}while(r!==d)}}catch(G){Ie(t,t.return,G)}}function Of(e){var t=e.updateQueue;if(t!==null){var s=e.stateNode;try{bh(t,s)}catch(r){Ie(e,e.return,r)}}}function jf(e,t,s){s.props=Ca(e.type,e.memoizedProps),s.state=e.memoizedState;try{s.componentWillUnmount()}catch(r){Ie(e,t,r)}}function _i(e,t){try{var s=e.ref;if(s!==null){switch(e.tag){case 26:case 27:case 5:var r=e.stateNode;break;case 30:r=e.stateNode;break;default:r=e.stateNode}typeof s=="function"?e.refCleanup=s(r):s.current=r}}catch(c){Ie(e,t,c)}}function hn(e,t){var s=e.ref,r=e.refCleanup;if(s!==null)if(typeof r=="function")try{r()}catch(c){Ie(e,t,c)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof s=="function")try{s(null)}catch(c){Ie(e,t,c)}else s.current=null}function Rf(e){var t=e.type,s=e.memoizedProps,r=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":s.autoFocus&&r.focus();break e;case"img":s.src?r.src=s.src:s.srcSet&&(r.srcset=s.srcSet)}}catch(c){Ie(e,e.return,c)}}function yc(e,t,s){try{var r=e.stateNode;Dy(r,e.type,s,t),r[Et]=t}catch(c){Ie(e,e.return,c)}}function Cf(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&la(e.type)||e.tag===4}function vc(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Cf(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&la(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function xc(e,t,s){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s).insertBefore(e,t):(t=s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,t.appendChild(e),s=s._reactRootContainer,s!=null||t.onclick!==null||(t.onclick=xn));else if(r!==4&&(r===27&&la(e.type)&&(s=e.stateNode,t=null),e=e.child,e!==null))for(xc(e,t,s),e=e.sibling;e!==null;)xc(e,t,s),e=e.sibling}function Kr(e,t,s){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?s.insertBefore(e,t):s.appendChild(e);else if(r!==4&&(r===27&&la(e.type)&&(s=e.stateNode),e=e.child,e!==null))for(Kr(e,t,s),e=e.sibling;e!==null;)Kr(e,t,s),e=e.sibling}function If(e){var t=e.stateNode,s=e.memoizedProps;try{for(var r=e.type,c=t.attributes;c.length;)t.removeAttributeNode(c[0]);ft(t,r,s),t[ct]=e,t[Et]=s}catch(d){Ie(e,e.return,d)}}var Rn=!1,nt=!1,_c=!1,Df=typeof WeakSet=="function"?WeakSet:Set,ot=null;function hy(e,t){if(e=e.containerInfo,Pc=pl,e=Vd(e),po(e)){if("selectionStart"in e)var s={start:e.selectionStart,end:e.selectionEnd};else e:{s=(s=e.ownerDocument)&&s.defaultView||window;var r=s.getSelection&&s.getSelection();if(r&&r.rangeCount!==0){s=r.anchorNode;var c=r.anchorOffset,d=r.focusNode;r=r.focusOffset;try{s.nodeType,d.nodeType}catch{s=null;break e}var m=0,v=-1,T=-1,D=0,G=0,F=e,U=null;t:for(;;){for(var M;F!==s||c!==0&&F.nodeType!==3||(v=m+c),F!==d||r!==0&&F.nodeType!==3||(T=m+r),F.nodeType===3&&(m+=F.nodeValue.length),(M=F.firstChild)!==null;)U=F,F=M;for(;;){if(F===e)break t;if(U===s&&++D===c&&(v=m),U===d&&++G===r&&(T=m),(M=F.nextSibling)!==null)break;F=U,U=F.parentNode}F=M}s=v===-1||T===-1?null:{start:v,end:T}}else s=null}s=s||{start:0,end:0}}else s=null;for($c={focusedElem:e,selectionRange:s},pl=!1,ot=t;ot!==null;)if(t=ot,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ot=e;else for(;ot!==null;){switch(t=ot,d=t.alternate,e=t.flags,t.tag){case 0:if((e&4)!==0&&(e=t.updateQueue,e=e!==null?e.events:null,e!==null))for(s=0;s<e.length;s++)c=e[s],c.ref.impl=c.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&d!==null){e=void 0,s=t,c=d.memoizedProps,d=d.memoizedState,r=s.stateNode;try{var se=Ca(s.type,c);e=r.getSnapshotBeforeUpdate(se,d),r.__reactInternalSnapshotBeforeUpdate=e}catch(de){Ie(s,s.return,de)}}break;case 3:if((e&1024)!==0){if(e=t.stateNode.containerInfo,s=e.nodeType,s===9)qc(e);else if(s===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":qc(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(l(163))}if(e=t.sibling,e!==null){e.return=t.return,ot=e;break}ot=t.return}}function Uf(e,t,s){var r=s.flags;switch(s.tag){case 0:case 11:case 15:In(e,s),r&4&&xi(5,s);break;case 1:if(In(e,s),r&4)if(e=s.stateNode,t===null)try{e.componentDidMount()}catch(m){Ie(s,s.return,m)}else{var c=Ca(s.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(c,t,e.__reactInternalSnapshotBeforeUpdate)}catch(m){Ie(s,s.return,m)}}r&64&&Of(s),r&512&&_i(s,s.return);break;case 3:if(In(e,s),r&64&&(e=s.updateQueue,e!==null)){if(t=null,s.child!==null)switch(s.child.tag){case 27:case 5:t=s.child.stateNode;break;case 1:t=s.child.stateNode}try{bh(e,t)}catch(m){Ie(s,s.return,m)}}break;case 27:t===null&&r&4&&If(s);case 26:case 5:In(e,s),t===null&&r&4&&Rf(s),r&512&&_i(s,s.return);break;case 12:In(e,s);break;case 31:In(e,s),r&4&&Lf(e,s);break;case 13:In(e,s),r&4&&Mf(e,s),r&64&&(e=s.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(s=_y.bind(null,s),Gy(e,s))));break;case 22:if(r=s.memoizedState!==null||Rn,!r){t=t!==null&&t.memoizedState!==null||nt,c=Rn;var d=nt;Rn=r,(nt=t)&&!d?Dn(e,s,(s.subtreeFlags&8772)!==0):In(e,s),Rn=c,nt=d}break;case 30:break;default:In(e,s)}}function zf(e){var t=e.alternate;t!==null&&(e.alternate=null,zf(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&Xl(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var $e=null,St=!1;function Cn(e,t,s){for(s=s.child;s!==null;)kf(e,t,s),s=s.sibling}function kf(e,t,s){if(Ct&&typeof Ct.onCommitFiberUnmount=="function")try{Ct.onCommitFiberUnmount(Ys,s)}catch{}switch(s.tag){case 26:nt||hn(s,t),Cn(e,t,s),s.memoizedState?s.memoizedState.count--:s.stateNode&&(s=s.stateNode,s.parentNode.removeChild(s));break;case 27:nt||hn(s,t);var r=$e,c=St;la(s.type)&&($e=s.stateNode,St=!1),Cn(e,t,s),Ri(s.stateNode),$e=r,St=c;break;case 5:nt||hn(s,t);case 6:if(r=$e,c=St,$e=null,Cn(e,t,s),$e=r,St=c,$e!==null)if(St)try{($e.nodeType===9?$e.body:$e.nodeName==="HTML"?$e.ownerDocument.body:$e).removeChild(s.stateNode)}catch(d){Ie(s,t,d)}else try{$e.removeChild(s.stateNode)}catch(d){Ie(s,t,d)}break;case 18:$e!==null&&(St?(e=$e,Op(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,s.stateNode),As(e)):Op($e,s.stateNode));break;case 4:r=$e,c=St,$e=s.stateNode.containerInfo,St=!0,Cn(e,t,s),$e=r,St=c;break;case 0:case 11:case 14:case 15:ea(2,s,t),nt||ea(4,s,t),Cn(e,t,s);break;case 1:nt||(hn(s,t),r=s.stateNode,typeof r.componentWillUnmount=="function"&&jf(s,t,r)),Cn(e,t,s);break;case 21:Cn(e,t,s);break;case 22:nt=(r=nt)||s.memoizedState!==null,Cn(e,t,s),nt=r;break;default:Cn(e,t,s)}}function Lf(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{As(e)}catch(s){Ie(t,t.return,s)}}}function Mf(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{As(e)}catch(s){Ie(t,t.return,s)}}function fy(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new Df),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new Df),t;default:throw Error(l(435,e.tag))}}function Fr(e,t){var s=fy(e);t.forEach(function(r){if(!s.has(r)){s.add(r);var c=wy.bind(null,e,r);r.then(c,c)}})}function Tt(e,t){var s=t.deletions;if(s!==null)for(var r=0;r<s.length;r++){var c=s[r],d=e,m=t,v=m;e:for(;v!==null;){switch(v.tag){case 27:if(la(v.type)){$e=v.stateNode,St=!1;break e}break;case 5:$e=v.stateNode,St=!1;break e;case 3:case 4:$e=v.stateNode.containerInfo,St=!0;break e}v=v.return}if($e===null)throw Error(l(160));kf(d,m,c),$e=null,St=!1,d=c.alternate,d!==null&&(d.return=null),c.return=null}if(t.subtreeFlags&13886)for(t=t.child;t!==null;)Bf(t,e),t=t.sibling}var nn=null;function Bf(e,t){var s=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Tt(t,e),At(e),r&4&&(ea(3,e,e.return),xi(3,e),ea(5,e,e.return));break;case 1:Tt(t,e),At(e),r&512&&(nt||s===null||hn(s,s.return)),r&64&&Rn&&(e=e.updateQueue,e!==null&&(r=e.callbacks,r!==null&&(s=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=s===null?r:s.concat(r))));break;case 26:var c=nn;if(Tt(t,e),At(e),r&512&&(nt||s===null||hn(s,s.return)),r&4){var d=s!==null?s.memoizedState:null;if(r=e.memoizedState,s===null)if(r===null)if(e.stateNode===null){e:{r=e.type,s=e.memoizedProps,c=c.ownerDocument||c;t:switch(r){case"title":d=c.getElementsByTagName("title")[0],(!d||d[Fs]||d[ct]||d.namespaceURI==="http://www.w3.org/2000/svg"||d.hasAttribute("itemprop"))&&(d=c.createElement(r),c.head.insertBefore(d,c.querySelector("head > title"))),ft(d,r,s),d[ct]=e,lt(d),r=d;break e;case"link":var m=Bp("link","href",c).get(r+(s.href||""));if(m){for(var v=0;v<m.length;v++)if(d=m[v],d.getAttribute("href")===(s.href==null||s.href===""?null:s.href)&&d.getAttribute("rel")===(s.rel==null?null:s.rel)&&d.getAttribute("title")===(s.title==null?null:s.title)&&d.getAttribute("crossorigin")===(s.crossOrigin==null?null:s.crossOrigin)){m.splice(v,1);break t}}d=c.createElement(r),ft(d,r,s),c.head.appendChild(d);break;case"meta":if(m=Bp("meta","content",c).get(r+(s.content||""))){for(v=0;v<m.length;v++)if(d=m[v],d.getAttribute("content")===(s.content==null?null:""+s.content)&&d.getAttribute("name")===(s.name==null?null:s.name)&&d.getAttribute("property")===(s.property==null?null:s.property)&&d.getAttribute("http-equiv")===(s.httpEquiv==null?null:s.httpEquiv)&&d.getAttribute("charset")===(s.charSet==null?null:s.charSet)){m.splice(v,1);break t}}d=c.createElement(r),ft(d,r,s),c.head.appendChild(d);break;default:throw Error(l(468,r))}d[ct]=e,lt(d),r=d}e.stateNode=r}else Hp(c,e.type,e.stateNode);else e.stateNode=Mp(c,r,e.memoizedProps);else d!==r?(d===null?s.stateNode!==null&&(s=s.stateNode,s.parentNode.removeChild(s)):d.count--,r===null?Hp(c,e.type,e.stateNode):Mp(c,r,e.memoizedProps)):r===null&&e.stateNode!==null&&yc(e,e.memoizedProps,s.memoizedProps)}break;case 27:Tt(t,e),At(e),r&512&&(nt||s===null||hn(s,s.return)),s!==null&&r&4&&yc(e,e.memoizedProps,s.memoizedProps);break;case 5:if(Tt(t,e),At(e),r&512&&(nt||s===null||hn(s,s.return)),e.flags&32){c=e.stateNode;try{Xa(c,"")}catch(se){Ie(e,e.return,se)}}r&4&&e.stateNode!=null&&(c=e.memoizedProps,yc(e,c,s!==null?s.memoizedProps:c)),r&1024&&(_c=!0);break;case 6:if(Tt(t,e),At(e),r&4){if(e.stateNode===null)throw Error(l(162));r=e.memoizedProps,s=e.stateNode;try{s.nodeValue=r}catch(se){Ie(e,e.return,se)}}break;case 3:if(ul=null,c=nn,nn=ol(t.containerInfo),Tt(t,e),nn=c,At(e),r&4&&s!==null&&s.memoizedState.isDehydrated)try{As(t.containerInfo)}catch(se){Ie(e,e.return,se)}_c&&(_c=!1,Hf(e));break;case 4:r=nn,nn=ol(e.stateNode.containerInfo),Tt(t,e),At(e),nn=r;break;case 12:Tt(t,e),At(e);break;case 31:Tt(t,e),At(e),r&4&&(r=e.updateQueue,r!==null&&(e.updateQueue=null,Fr(e,r)));break;case 13:Tt(t,e),At(e),e.child.flags&8192&&e.memoizedState!==null!=(s!==null&&s.memoizedState!==null)&&(Xr=Rt()),r&4&&(r=e.updateQueue,r!==null&&(e.updateQueue=null,Fr(e,r)));break;case 22:c=e.memoizedState!==null;var T=s!==null&&s.memoizedState!==null,D=Rn,G=nt;if(Rn=D||c,nt=G||T,Tt(t,e),nt=G,Rn=D,At(e),r&8192)e:for(t=e.stateNode,t._visibility=c?t._visibility&-2:t._visibility|1,c&&(s===null||T||Rn||nt||Ia(e)),s=null,t=e;;){if(t.tag===5||t.tag===26){if(s===null){T=s=t;try{if(d=T.stateNode,c)m=d.style,typeof m.setProperty=="function"?m.setProperty("display","none","important"):m.display="none";else{v=T.stateNode;var F=T.memoizedProps.style,U=F!=null&&F.hasOwnProperty("display")?F.display:null;v.style.display=U==null||typeof U=="boolean"?"":(""+U).trim()}}catch(se){Ie(T,T.return,se)}}}else if(t.tag===6){if(s===null){T=t;try{T.stateNode.nodeValue=c?"":T.memoizedProps}catch(se){Ie(T,T.return,se)}}}else if(t.tag===18){if(s===null){T=t;try{var M=T.stateNode;c?jp(M,!0):jp(T.stateNode,!1)}catch(se){Ie(T,T.return,se)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;s===t&&(s=null),t=t.return}s===t&&(s=null),t.sibling.return=t.return,t=t.sibling}r&4&&(r=e.updateQueue,r!==null&&(s=r.retryQueue,s!==null&&(r.retryQueue=null,Fr(e,s))));break;case 19:Tt(t,e),At(e),r&4&&(r=e.updateQueue,r!==null&&(e.updateQueue=null,Fr(e,r)));break;case 30:break;case 21:break;default:Tt(t,e),At(e)}}function At(e){var t=e.flags;if(t&2){try{for(var s,r=e.return;r!==null;){if(Cf(r)){s=r;break}r=r.return}if(s==null)throw Error(l(160));switch(s.tag){case 27:var c=s.stateNode,d=vc(e);Kr(e,d,c);break;case 5:var m=s.stateNode;s.flags&32&&(Xa(m,""),s.flags&=-33);var v=vc(e);Kr(e,v,m);break;case 3:case 4:var T=s.stateNode.containerInfo,D=vc(e);xc(e,D,T);break;default:throw Error(l(161))}}catch(G){Ie(e,e.return,G)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Hf(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;Hf(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function In(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)Uf(e,t.alternate,t),t=t.sibling}function Ia(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:ea(4,t,t.return),Ia(t);break;case 1:hn(t,t.return);var s=t.stateNode;typeof s.componentWillUnmount=="function"&&jf(t,t.return,s),Ia(t);break;case 27:Ri(t.stateNode);case 26:case 5:hn(t,t.return),Ia(t);break;case 22:t.memoizedState===null&&Ia(t);break;case 30:Ia(t);break;default:Ia(t)}e=e.sibling}}function Dn(e,t,s){for(s=s&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var r=t.alternate,c=e,d=t,m=d.flags;switch(d.tag){case 0:case 11:case 15:Dn(c,d,s),xi(4,d);break;case 1:if(Dn(c,d,s),r=d,c=r.stateNode,typeof c.componentDidMount=="function")try{c.componentDidMount()}catch(D){Ie(r,r.return,D)}if(r=d,c=r.updateQueue,c!==null){var v=r.stateNode;try{var T=c.shared.hiddenCallbacks;if(T!==null)for(c.shared.hiddenCallbacks=null,c=0;c<T.length;c++)gh(T[c],v)}catch(D){Ie(r,r.return,D)}}s&&m&64&&Of(d),_i(d,d.return);break;case 27:If(d);case 26:case 5:Dn(c,d,s),s&&r===null&&m&4&&Rf(d),_i(d,d.return);break;case 12:Dn(c,d,s);break;case 31:Dn(c,d,s),s&&m&4&&Lf(c,d);break;case 13:Dn(c,d,s),s&&m&4&&Mf(c,d);break;case 22:d.memoizedState===null&&Dn(c,d,s),_i(d,d.return);break;case 30:break;default:Dn(c,d,s)}t=t.sibling}}function wc(e,t){var s=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(s=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==s&&(e!=null&&e.refCount++,s!=null&&li(s))}function Ec(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&li(e))}function an(e,t,s,r){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)Gf(e,t,s,r),t=t.sibling}function Gf(e,t,s,r){var c=t.flags;switch(t.tag){case 0:case 11:case 15:an(e,t,s,r),c&2048&&xi(9,t);break;case 1:an(e,t,s,r);break;case 3:an(e,t,s,r),c&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&li(e)));break;case 12:if(c&2048){an(e,t,s,r),e=t.stateNode;try{var d=t.memoizedProps,m=d.id,v=d.onPostCommit;typeof v=="function"&&v(m,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(T){Ie(t,t.return,T)}}else an(e,t,s,r);break;case 31:an(e,t,s,r);break;case 13:an(e,t,s,r);break;case 23:break;case 22:d=t.stateNode,m=t.alternate,t.memoizedState!==null?d._visibility&2?an(e,t,s,r):wi(e,t):d._visibility&2?an(e,t,s,r):(d._visibility|=2,gs(e,t,s,r,(t.subtreeFlags&10256)!==0||!1)),c&2048&&wc(m,t);break;case 24:an(e,t,s,r),c&2048&&Ec(t.alternate,t);break;default:an(e,t,s,r)}}function gs(e,t,s,r,c){for(c=c&&((t.subtreeFlags&10256)!==0||!1),t=t.child;t!==null;){var d=e,m=t,v=s,T=r,D=m.flags;switch(m.tag){case 0:case 11:case 15:gs(d,m,v,T,c),xi(8,m);break;case 23:break;case 22:var G=m.stateNode;m.memoizedState!==null?G._visibility&2?gs(d,m,v,T,c):wi(d,m):(G._visibility|=2,gs(d,m,v,T,c)),c&&D&2048&&wc(m.alternate,m);break;case 24:gs(d,m,v,T,c),c&&D&2048&&Ec(m.alternate,m);break;default:gs(d,m,v,T,c)}t=t.sibling}}function wi(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var s=e,r=t,c=r.flags;switch(r.tag){case 22:wi(s,r),c&2048&&wc(r.alternate,r);break;case 24:wi(s,r),c&2048&&Ec(r.alternate,r);break;default:wi(s,r)}t=t.sibling}}var Ei=8192;function bs(e,t,s){if(e.subtreeFlags&Ei)for(e=e.child;e!==null;)Pf(e,t,s),e=e.sibling}function Pf(e,t,s){switch(e.tag){case 26:bs(e,t,s),e.flags&Ei&&e.memoizedState!==null&&Zy(s,nn,e.memoizedState,e.memoizedProps);break;case 5:bs(e,t,s);break;case 3:case 4:var r=nn;nn=ol(e.stateNode.containerInfo),bs(e,t,s),nn=r;break;case 22:e.memoizedState===null&&(r=e.alternate,r!==null&&r.memoizedState!==null?(r=Ei,Ei=16777216,bs(e,t,s),Ei=r):bs(e,t,s));break;default:bs(e,t,s)}}function $f(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function Ni(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var s=0;s<t.length;s++){var r=t[s];ot=r,Yf(r,e)}$f(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)Vf(e),e=e.sibling}function Vf(e){switch(e.tag){case 0:case 11:case 15:Ni(e),e.flags&2048&&ea(9,e,e.return);break;case 3:Ni(e);break;case 12:Ni(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&2&&(e.return===null||e.return.tag!==13)?(t._visibility&=-3,Jr(e)):Ni(e);break;default:Ni(e)}}function Jr(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var s=0;s<t.length;s++){var r=t[s];ot=r,Yf(r,e)}$f(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:ea(8,t,t.return),Jr(t);break;case 22:s=t.stateNode,s._visibility&2&&(s._visibility&=-3,Jr(t));break;default:Jr(t)}e=e.sibling}}function Yf(e,t){for(;ot!==null;){var s=ot;switch(s.tag){case 0:case 11:case 15:ea(8,s,t);break;case 23:case 22:if(s.memoizedState!==null&&s.memoizedState.cachePool!==null){var r=s.memoizedState.cachePool.pool;r!=null&&r.refCount++}break;case 24:li(s.memoizedState.cache)}if(r=s.child,r!==null)r.return=s,ot=r;else e:for(s=e;ot!==null;){r=ot;var c=r.sibling,d=r.return;if(zf(r),r===s){ot=null;break e}if(c!==null){c.return=d,ot=c;break e}ot=d}}}var py={getCacheForType:function(e){var t=dt(Ze),s=t.data.get(e);return s===void 0&&(s=e(),t.data.set(e,s)),s},cacheSignal:function(){return dt(Ze).controller.signal}},my=typeof WeakMap=="function"?WeakMap:Map,je=0,Me=null,_e=null,Ee=0,Ce=0,Lt=null,ta=!1,ys=!1,Nc=!1,Un=0,Je=0,na=0,Da=0,Sc=0,Mt=0,vs=0,Si=null,Ot=null,Tc=!1,Xr=0,qf=0,Qr=1/0,Wr=null,aa=null,it=0,sa=null,xs=null,zn=0,Ac=0,Oc=null,Kf=null,Ti=0,jc=null;function Bt(){return(je&2)!==0&&Ee!==0?Ee&-Ee:z.T!==null?zc():od()}function Ff(){if(Mt===0)if((Ee&536870912)===0||Te){var e=rr;rr<<=1,(rr&3932160)===0&&(rr=262144),Mt=e}else Mt=536870912;return e=zt.current,e!==null&&(e.flags|=32),Mt}function jt(e,t,s){(e===Me&&(Ce===2||Ce===9)||e.cancelPendingCommit!==null)&&(_s(e,0),ia(e,Ee,Mt,!1)),Ks(e,s),((je&2)===0||e!==Me)&&(e===Me&&((je&2)===0&&(Da|=s),Je===4&&ia(e,Ee,Mt,!1)),fn(e))}function Jf(e,t,s){if((je&6)!==0)throw Error(l(327));var r=!s&&(t&127)===0&&(t&e.expiredLanes)===0||qs(e,t),c=r?yy(e,t):Cc(e,t,!0),d=r;do{if(c===0){ys&&!r&&ia(e,t,0,!1);break}else{if(s=e.current.alternate,d&&!gy(s)){c=Cc(e,t,!1),d=!1;continue}if(c===2){if(d=t,e.errorRecoveryDisabledLanes&d)var m=0;else m=e.pendingLanes&-536870913,m=m!==0?m:m&536870912?536870912:0;if(m!==0){t=m;e:{var v=e;c=Si;var T=v.current.memoizedState.isDehydrated;if(T&&(_s(v,m).flags|=256),m=Cc(v,m,!1),m!==2){if(Nc&&!T){v.errorRecoveryDisabledLanes|=d,Da|=d,c=4;break e}d=Ot,Ot=c,d!==null&&(Ot===null?Ot=d:Ot.push.apply(Ot,d))}c=m}if(d=!1,c!==2)continue}}if(c===1){_s(e,0),ia(e,t,0,!0);break}e:{switch(r=e,d=c,d){case 0:case 1:throw Error(l(345));case 4:if((t&4194048)!==t)break;case 6:ia(r,t,Mt,!ta);break e;case 2:Ot=null;break;case 3:case 5:break;default:throw Error(l(329))}if((t&62914560)===t&&(c=Xr+300-Rt(),10<c)){if(ia(r,t,Mt,!ta),or(r,0,!0)!==0)break e;zn=t,r.timeoutHandle=Tp(Xf.bind(null,r,s,Ot,Wr,Tc,t,Mt,Da,vs,ta,d,"Throttled",-0,0),c);break e}Xf(r,s,Ot,Wr,Tc,t,Mt,Da,vs,ta,d,null,-0,0)}}break}while(!0);fn(e)}function Xf(e,t,s,r,c,d,m,v,T,D,G,F,U,M){if(e.timeoutHandle=-1,F=t.subtreeFlags,F&8192||(F&16785408)===16785408){F={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:xn},Pf(t,d,F);var se=(d&62914560)===d?Xr-Rt():(d&4194048)===d?qf-Rt():0;if(se=ev(F,se),se!==null){zn=d,e.cancelPendingCommit=se(sp.bind(null,e,t,d,s,r,c,m,v,T,G,F,null,U,M)),ia(e,d,m,!D);return}}sp(e,t,d,s,r,c,m,v,T)}function gy(e){for(var t=e;;){var s=t.tag;if((s===0||s===11||s===15)&&t.flags&16384&&(s=t.updateQueue,s!==null&&(s=s.stores,s!==null)))for(var r=0;r<s.length;r++){var c=s[r],d=c.getSnapshot;c=c.value;try{if(!Dt(d(),c))return!1}catch{return!1}}if(s=t.child,t.subtreeFlags&16384&&s!==null)s.return=t,t=s;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function ia(e,t,s,r){t&=~Sc,t&=~Da,e.suspendedLanes|=t,e.pingedLanes&=~t,r&&(e.warmLanes|=t),r=e.expirationTimes;for(var c=t;0<c;){var d=31-It(c),m=1<<d;r[d]=-1,c&=~m}s!==0&&id(e,s,t)}function Zr(){return(je&6)===0?(Ai(0),!1):!0}function Rc(){if(_e!==null){if(Ce===0)var e=_e.return;else e=_e,Nn=Na=null,qo(e),ds=null,ci=0,e=_e;for(;e!==null;)Af(e.alternate,e),e=e.return;_e=null}}function _s(e,t){var s=e.timeoutHandle;s!==-1&&(e.timeoutHandle=-1,ky(s)),s=e.cancelPendingCommit,s!==null&&(e.cancelPendingCommit=null,s()),zn=0,Rc(),Me=e,_e=s=wn(e.current,null),Ee=t,Ce=0,Lt=null,ta=!1,ys=qs(e,t),Nc=!1,vs=Mt=Sc=Da=na=Je=0,Ot=Si=null,Tc=!1,(t&8)!==0&&(t|=t&32);var r=e.entangledLanes;if(r!==0)for(e=e.entanglements,r&=t;0<r;){var c=31-It(r),d=1<<c;t|=e[c],r&=~d}return Un=t,xr(),s}function Qf(e,t){be=null,z.H=bi,t===us||t===Or?(t=hh(),Ce=3):t===Uo?(t=hh(),Ce=4):Ce=t===oc?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,Lt=t,_e===null&&(Je=1,Pr(e,qt(t,e.current)))}function Wf(){var e=zt.current;return e===null?!0:(Ee&4194048)===Ee?Xt===null:(Ee&62914560)===Ee||(Ee&536870912)!==0?e===Xt:!1}function Zf(){var e=z.H;return z.H=bi,e===null?bi:e}function ep(){var e=z.A;return z.A=py,e}function el(){Je=4,ta||(Ee&4194048)!==Ee&&zt.current!==null||(ys=!0),(na&134217727)===0&&(Da&134217727)===0||Me===null||ia(Me,Ee,Mt,!1)}function Cc(e,t,s){var r=je;je|=2;var c=Zf(),d=ep();(Me!==e||Ee!==t)&&(Wr=null,_s(e,t)),t=!1;var m=Je;e:do try{if(Ce!==0&&_e!==null){var v=_e,T=Lt;switch(Ce){case 8:Rc(),m=6;break e;case 3:case 2:case 9:case 6:zt.current===null&&(t=!0);var D=Ce;if(Ce=0,Lt=null,ws(e,v,T,D),s&&ys){m=0;break e}break;default:D=Ce,Ce=0,Lt=null,ws(e,v,T,D)}}by(),m=Je;break}catch(G){Qf(e,G)}while(!0);return t&&e.shellSuspendCounter++,Nn=Na=null,je=r,z.H=c,z.A=d,_e===null&&(Me=null,Ee=0,xr()),m}function by(){for(;_e!==null;)tp(_e)}function yy(e,t){var s=je;je|=2;var r=Zf(),c=ep();Me!==e||Ee!==t?(Wr=null,Qr=Rt()+500,_s(e,t)):ys=qs(e,t);e:do try{if(Ce!==0&&_e!==null){t=_e;var d=Lt;t:switch(Ce){case 1:Ce=0,Lt=null,ws(e,t,d,1);break;case 2:case 9:if(uh(d)){Ce=0,Lt=null,np(t);break}t=function(){Ce!==2&&Ce!==9||Me!==e||(Ce=7),fn(e)},d.then(t,t);break e;case 3:Ce=7;break e;case 4:Ce=5;break e;case 7:uh(d)?(Ce=0,Lt=null,np(t)):(Ce=0,Lt=null,ws(e,t,d,7));break;case 5:var m=null;switch(_e.tag){case 26:m=_e.memoizedState;case 5:case 27:var v=_e;if(m?Gp(m):v.stateNode.complete){Ce=0,Lt=null;var T=v.sibling;if(T!==null)_e=T;else{var D=v.return;D!==null?(_e=D,tl(D)):_e=null}break t}}Ce=0,Lt=null,ws(e,t,d,5);break;case 6:Ce=0,Lt=null,ws(e,t,d,6);break;case 8:Rc(),Je=6;break e;default:throw Error(l(462))}}vy();break}catch(G){Qf(e,G)}while(!0);return Nn=Na=null,z.H=r,z.A=c,je=s,_e!==null?0:(Me=null,Ee=0,xr(),Je)}function vy(){for(;_e!==null&&!yn();)tp(_e)}function tp(e){var t=Sf(e.alternate,e,Un);e.memoizedProps=e.pendingProps,t===null?tl(e):_e=t}function np(e){var t=e,s=t.alternate;switch(t.tag){case 15:case 0:t=vf(s,t,t.pendingProps,t.type,void 0,Ee);break;case 11:t=vf(s,t,t.pendingProps,t.type.render,t.ref,Ee);break;case 5:qo(t);default:Af(s,t),t=_e=Zd(t,Un),t=Sf(s,t,Un)}e.memoizedProps=e.pendingProps,t===null?tl(e):_e=t}function ws(e,t,s,r){Nn=Na=null,qo(t),ds=null,ci=0;var c=t.return;try{if(ly(e,c,t,s,Ee)){Je=1,Pr(e,qt(s,e.current)),_e=null;return}}catch(d){if(c!==null)throw _e=c,d;Je=1,Pr(e,qt(s,e.current)),_e=null;return}t.flags&32768?(Te||r===1?e=!0:ys||(Ee&536870912)!==0?e=!1:(ta=e=!0,(r===2||r===9||r===3||r===6)&&(r=zt.current,r!==null&&r.tag===13&&(r.flags|=16384))),ap(t,e)):tl(t)}function tl(e){var t=e;do{if((t.flags&32768)!==0){ap(t,ta);return}e=t.return;var s=uy(t.alternate,t,Un);if(s!==null){_e=s;return}if(t=t.sibling,t!==null){_e=t;return}_e=t=e}while(t!==null);Je===0&&(Je=5)}function ap(e,t){do{var s=dy(e.alternate,e);if(s!==null){s.flags&=32767,_e=s;return}if(s=e.return,s!==null&&(s.flags|=32768,s.subtreeFlags=0,s.deletions=null),!t&&(e=e.sibling,e!==null)){_e=e;return}_e=e=s}while(e!==null);Je=6,_e=null}function sp(e,t,s,r,c,d,m,v,T){e.cancelPendingCommit=null;do nl();while(it!==0);if((je&6)!==0)throw Error(l(327));if(t!==null){if(t===e.current)throw Error(l(177));if(d=t.lanes|t.childLanes,d|=vo,Wg(e,s,d,m,v,T),e===Me&&(_e=Me=null,Ee=0),xs=t,sa=e,zn=s,Ac=d,Oc=c,Kf=r,(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,Ey(sr,function(){return cp(),null})):(e.callbackNode=null,e.callbackPriority=0),r=(t.flags&13878)!==0,(t.subtreeFlags&13878)!==0||r){r=z.T,z.T=null,c=J.p,J.p=2,m=je,je|=4;try{hy(e,t,s)}finally{je=m,J.p=c,z.T=r}}it=1,ip(),rp(),lp()}}function ip(){if(it===1){it=0;var e=sa,t=xs,s=(t.flags&13878)!==0;if((t.subtreeFlags&13878)!==0||s){s=z.T,z.T=null;var r=J.p;J.p=2;var c=je;je|=4;try{Bf(t,e);var d=$c,m=Vd(e.containerInfo),v=d.focusedElem,T=d.selectionRange;if(m!==v&&v&&v.ownerDocument&&$d(v.ownerDocument.documentElement,v)){if(T!==null&&po(v)){var D=T.start,G=T.end;if(G===void 0&&(G=D),"selectionStart"in v)v.selectionStart=D,v.selectionEnd=Math.min(G,v.value.length);else{var F=v.ownerDocument||document,U=F&&F.defaultView||window;if(U.getSelection){var M=U.getSelection(),se=v.textContent.length,de=Math.min(T.start,se),ke=T.end===void 0?de:Math.min(T.end,se);!M.extend&&de>ke&&(m=ke,ke=de,de=m);var R=Pd(v,de),j=Pd(v,ke);if(R&&j&&(M.rangeCount!==1||M.anchorNode!==R.node||M.anchorOffset!==R.offset||M.focusNode!==j.node||M.focusOffset!==j.offset)){var I=F.createRange();I.setStart(R.node,R.offset),M.removeAllRanges(),de>ke?(M.addRange(I),M.extend(j.node,j.offset)):(I.setEnd(j.node,j.offset),M.addRange(I))}}}}for(F=[],M=v;M=M.parentNode;)M.nodeType===1&&F.push({element:M,left:M.scrollLeft,top:M.scrollTop});for(typeof v.focus=="function"&&v.focus(),v=0;v<F.length;v++){var V=F[v];V.element.scrollLeft=V.left,V.element.scrollTop=V.top}}pl=!!Pc,$c=Pc=null}finally{je=c,J.p=r,z.T=s}}e.current=t,it=2}}function rp(){if(it===2){it=0;var e=sa,t=xs,s=(t.flags&8772)!==0;if((t.subtreeFlags&8772)!==0||s){s=z.T,z.T=null;var r=J.p;J.p=2;var c=je;je|=4;try{Uf(e,t.alternate,t)}finally{je=c,J.p=r,z.T=s}}it=3}}function lp(){if(it===4||it===3){it=0,Gn();var e=sa,t=xs,s=zn,r=Kf;(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?it=5:(it=0,xs=sa=null,op(e,e.pendingLanes));var c=e.pendingLanes;if(c===0&&(aa=null),Fl(s),t=t.stateNode,Ct&&typeof Ct.onCommitFiberRoot=="function")try{Ct.onCommitFiberRoot(Ys,t,void 0,(t.current.flags&128)===128)}catch{}if(r!==null){t=z.T,c=J.p,J.p=2,z.T=null;try{for(var d=e.onRecoverableError,m=0;m<r.length;m++){var v=r[m];d(v.value,{componentStack:v.stack})}}finally{z.T=t,J.p=c}}(zn&3)!==0&&nl(),fn(e),c=e.pendingLanes,(s&261930)!==0&&(c&42)!==0?e===jc?Ti++:(Ti=0,jc=e):Ti=0,Ai(0)}}function op(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,li(t)))}function nl(){return ip(),rp(),lp(),cp()}function cp(){if(it!==5)return!1;var e=sa,t=Ac;Ac=0;var s=Fl(zn),r=z.T,c=J.p;try{J.p=32>s?32:s,z.T=null,s=Oc,Oc=null;var d=sa,m=zn;if(it=0,xs=sa=null,zn=0,(je&6)!==0)throw Error(l(331));var v=je;if(je|=4,Vf(d.current),Gf(d,d.current,m,s),je=v,Ai(0,!1),Ct&&typeof Ct.onPostCommitFiberRoot=="function")try{Ct.onPostCommitFiberRoot(Ys,d)}catch{}return!0}finally{J.p=c,z.T=r,op(e,t)}}function up(e,t,s){t=qt(s,t),t=lc(e.stateNode,t,2),e=Qn(e,t,2),e!==null&&(Ks(e,2),fn(e))}function Ie(e,t,s){if(e.tag===3)up(e,e,s);else for(;t!==null;){if(t.tag===3){up(t,e,s);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(aa===null||!aa.has(r))){e=qt(s,e),s=df(2),r=Qn(t,s,2),r!==null&&(hf(s,r,t,e),Ks(r,2),fn(r));break}}t=t.return}}function Ic(e,t,s){var r=e.pingCache;if(r===null){r=e.pingCache=new my;var c=new Set;r.set(t,c)}else c=r.get(t),c===void 0&&(c=new Set,r.set(t,c));c.has(s)||(Nc=!0,c.add(s),e=xy.bind(null,e,t,s),t.then(e,e))}function xy(e,t,s){var r=e.pingCache;r!==null&&r.delete(t),e.pingedLanes|=e.suspendedLanes&s,e.warmLanes&=~s,Me===e&&(Ee&s)===s&&(Je===4||Je===3&&(Ee&62914560)===Ee&&300>Rt()-Xr?(je&2)===0&&_s(e,0):Sc|=s,vs===Ee&&(vs=0)),fn(e)}function dp(e,t){t===0&&(t=sd()),e=_a(e,t),e!==null&&(Ks(e,t),fn(e))}function _y(e){var t=e.memoizedState,s=0;t!==null&&(s=t.retryLane),dp(e,s)}function wy(e,t){var s=0;switch(e.tag){case 31:case 13:var r=e.stateNode,c=e.memoizedState;c!==null&&(s=c.retryLane);break;case 19:r=e.stateNode;break;case 22:r=e.stateNode._retryCache;break;default:throw Error(l(314))}r!==null&&r.delete(t),dp(e,s)}function Ey(e,t){return $a(e,t)}var al=null,Es=null,Dc=!1,sl=!1,Uc=!1,ra=0;function fn(e){e!==Es&&e.next===null&&(Es===null?al=Es=e:Es=Es.next=e),sl=!0,Dc||(Dc=!0,Sy())}function Ai(e,t){if(!Uc&&sl){Uc=!0;do for(var s=!1,r=al;r!==null;){if(e!==0){var c=r.pendingLanes;if(c===0)var d=0;else{var m=r.suspendedLanes,v=r.pingedLanes;d=(1<<31-It(42|e)+1)-1,d&=c&~(m&~v),d=d&201326741?d&201326741|1:d?d|2:0}d!==0&&(s=!0,mp(r,d))}else d=Ee,d=or(r,r===Me?d:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),(d&3)===0||qs(r,d)||(s=!0,mp(r,d));r=r.next}while(s);Uc=!1}}function Ny(){hp()}function hp(){sl=Dc=!1;var e=0;ra!==0&&zy()&&(e=ra);for(var t=Rt(),s=null,r=al;r!==null;){var c=r.next,d=fp(r,t);d===0?(r.next=null,s===null?al=c:s.next=c,c===null&&(Es=s)):(s=r,(e!==0||(d&3)!==0)&&(sl=!0)),r=c}it!==0&&it!==5||Ai(e),ra!==0&&(ra=0)}function fp(e,t){for(var s=e.suspendedLanes,r=e.pingedLanes,c=e.expirationTimes,d=e.pendingLanes&-62914561;0<d;){var m=31-It(d),v=1<<m,T=c[m];T===-1?((v&s)===0||(v&r)!==0)&&(c[m]=Qg(v,t)):T<=t&&(e.expiredLanes|=v),d&=~v}if(t=Me,s=Ee,s=or(e,e===t?s:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),r=e.callbackNode,s===0||e===t&&(Ce===2||Ce===9)||e.cancelPendingCommit!==null)return r!==null&&r!==null&&bn(r),e.callbackNode=null,e.callbackPriority=0;if((s&3)===0||qs(e,s)){if(t=s&-s,t===e.callbackPriority)return t;switch(r!==null&&bn(r),Fl(s)){case 2:case 8:s=nd;break;case 32:s=sr;break;case 268435456:s=ad;break;default:s=sr}return r=pp.bind(null,e),s=$a(s,r),e.callbackPriority=t,e.callbackNode=s,t}return r!==null&&r!==null&&bn(r),e.callbackPriority=2,e.callbackNode=null,2}function pp(e,t){if(it!==0&&it!==5)return e.callbackNode=null,e.callbackPriority=0,null;var s=e.callbackNode;if(nl()&&e.callbackNode!==s)return null;var r=Ee;return r=or(e,e===Me?r:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),r===0?null:(Jf(e,r,t),fp(e,Rt()),e.callbackNode!=null&&e.callbackNode===s?pp.bind(null,e):null)}function mp(e,t){if(nl())return null;Jf(e,t,!0)}function Sy(){Ly(function(){(je&6)!==0?$a(td,Ny):hp()})}function zc(){if(ra===0){var e=os;e===0&&(e=ir,ir<<=1,(ir&261888)===0&&(ir=256)),ra=e}return ra}function gp(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:hr(""+e)}function bp(e,t){var s=t.ownerDocument.createElement("input");return s.name=t.name,s.value=t.value,e.id&&s.setAttribute("form",e.id),t.parentNode.insertBefore(s,t),e=new FormData(e),s.parentNode.removeChild(s),e}function Ty(e,t,s,r,c){if(t==="submit"&&s&&s.stateNode===c){var d=gp((c[Et]||null).action),m=r.submitter;m&&(t=(t=m[Et]||null)?gp(t.formAction):m.getAttribute("formAction"),t!==null&&(d=t,m=null));var v=new gr("action","action",null,r,c);e.push({event:v,listeners:[{instance:null,listener:function(){if(r.defaultPrevented){if(ra!==0){var T=m?bp(c,m):new FormData(c);tc(s,{pending:!0,data:T,method:c.method,action:d},null,T)}}else typeof d=="function"&&(v.preventDefault(),T=m?bp(c,m):new FormData(c),tc(s,{pending:!0,data:T,method:c.method,action:d},d,T))},currentTarget:c}]})}}for(var kc=0;kc<yo.length;kc++){var Lc=yo[kc],Ay=Lc.toLowerCase(),Oy=Lc[0].toUpperCase()+Lc.slice(1);tn(Ay,"on"+Oy)}tn(Kd,"onAnimationEnd"),tn(Fd,"onAnimationIteration"),tn(Jd,"onAnimationStart"),tn("dblclick","onDoubleClick"),tn("focusin","onFocus"),tn("focusout","onBlur"),tn(Vb,"onTransitionRun"),tn(Yb,"onTransitionStart"),tn(qb,"onTransitionCancel"),tn(Xd,"onTransitionEnd"),Fa("onMouseEnter",["mouseout","mouseover"]),Fa("onMouseLeave",["mouseout","mouseover"]),Fa("onPointerEnter",["pointerout","pointerover"]),Fa("onPointerLeave",["pointerout","pointerover"]),ba("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ba("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ba("onBeforeInput",["compositionend","keypress","textInput","paste"]),ba("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ba("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ba("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Oi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),jy=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Oi));function yp(e,t){t=(t&4)!==0;for(var s=0;s<e.length;s++){var r=e[s],c=r.event;r=r.listeners;e:{var d=void 0;if(t)for(var m=r.length-1;0<=m;m--){var v=r[m],T=v.instance,D=v.currentTarget;if(v=v.listener,T!==d&&c.isPropagationStopped())break e;d=v,c.currentTarget=D;try{d(c)}catch(G){vr(G)}c.currentTarget=null,d=T}else for(m=0;m<r.length;m++){if(v=r[m],T=v.instance,D=v.currentTarget,v=v.listener,T!==d&&c.isPropagationStopped())break e;d=v,c.currentTarget=D;try{d(c)}catch(G){vr(G)}c.currentTarget=null,d=T}}}}function we(e,t){var s=t[Jl];s===void 0&&(s=t[Jl]=new Set);var r=e+"__bubble";s.has(r)||(vp(t,e,2,!1),s.add(r))}function Mc(e,t,s){var r=0;t&&(r|=4),vp(s,e,r,t)}var il="_reactListening"+Math.random().toString(36).slice(2);function Bc(e){if(!e[il]){e[il]=!0,dd.forEach(function(s){s!=="selectionchange"&&(jy.has(s)||Mc(s,!1,e),Mc(s,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[il]||(t[il]=!0,Mc("selectionchange",!1,t))}}function vp(e,t,s,r){switch(Fp(t)){case 2:var c=av;break;case 8:c=sv;break;default:c=eu}s=c.bind(null,t,s,e),c=void 0,!so||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(c=!0),r?c!==void 0?e.addEventListener(t,s,{capture:!0,passive:c}):e.addEventListener(t,s,!0):c!==void 0?e.addEventListener(t,s,{passive:c}):e.addEventListener(t,s,!1)}function Hc(e,t,s,r,c){var d=r;if((t&1)===0&&(t&2)===0&&r!==null)e:for(;;){if(r===null)return;var m=r.tag;if(m===3||m===4){var v=r.stateNode.containerInfo;if(v===c)break;if(m===4)for(m=r.return;m!==null;){var T=m.tag;if((T===3||T===4)&&m.stateNode.containerInfo===c)return;m=m.return}for(;v!==null;){if(m=Ya(v),m===null)return;if(T=m.tag,T===5||T===6||T===26||T===27){r=d=m;continue e}v=v.parentNode}}r=r.return}Ed(function(){var D=d,G=no(s),F=[];e:{var U=Qd.get(e);if(U!==void 0){var M=gr,se=e;switch(e){case"keypress":if(pr(s)===0)break e;case"keydown":case"keyup":M=wb;break;case"focusin":se="focus",M=oo;break;case"focusout":se="blur",M=oo;break;case"beforeblur":case"afterblur":M=oo;break;case"click":if(s.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":M=Td;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":M=ub;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":M=Sb;break;case Kd:case Fd:case Jd:M=fb;break;case Xd:M=Ab;break;case"scroll":case"scrollend":M=ob;break;case"wheel":M=jb;break;case"copy":case"cut":case"paste":M=mb;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":M=Od;break;case"toggle":case"beforetoggle":M=Cb}var de=(t&4)!==0,ke=!de&&(e==="scroll"||e==="scrollend"),R=de?U!==null?U+"Capture":null:U;de=[];for(var j=D,I;j!==null;){var V=j;if(I=V.stateNode,V=V.tag,V!==5&&V!==26&&V!==27||I===null||R===null||(V=Xs(j,R),V!=null&&de.push(ji(j,V,I))),ke)break;j=j.return}0<de.length&&(U=new M(U,se,null,s,G),F.push({event:U,listeners:de}))}}if((t&7)===0){e:{if(U=e==="mouseover"||e==="pointerover",M=e==="mouseout"||e==="pointerout",U&&s!==to&&(se=s.relatedTarget||s.fromElement)&&(Ya(se)||se[Va]))break e;if((M||U)&&(U=G.window===G?G:(U=G.ownerDocument)?U.defaultView||U.parentWindow:window,M?(se=s.relatedTarget||s.toElement,M=D,se=se?Ya(se):null,se!==null&&(ke=h(se),de=se.tag,se!==ke||de!==5&&de!==27&&de!==6)&&(se=null)):(M=null,se=D),M!==se)){if(de=Td,V="onMouseLeave",R="onMouseEnter",j="mouse",(e==="pointerout"||e==="pointerover")&&(de=Od,V="onPointerLeave",R="onPointerEnter",j="pointer"),ke=M==null?U:Js(M),I=se==null?U:Js(se),U=new de(V,j+"leave",M,s,G),U.target=ke,U.relatedTarget=I,V=null,Ya(G)===D&&(de=new de(R,j+"enter",se,s,G),de.target=I,de.relatedTarget=ke,V=de),ke=V,M&&se)t:{for(de=Ry,R=M,j=se,I=0,V=R;V;V=de(V))I++;V=0;for(var ue=j;ue;ue=de(ue))V++;for(;0<I-V;)R=de(R),I--;for(;0<V-I;)j=de(j),V--;for(;I--;){if(R===j||j!==null&&R===j.alternate){de=R;break t}R=de(R),j=de(j)}de=null}else de=null;M!==null&&xp(F,U,M,de,!1),se!==null&&ke!==null&&xp(F,ke,se,de,!0)}}e:{if(U=D?Js(D):window,M=U.nodeName&&U.nodeName.toLowerCase(),M==="select"||M==="input"&&U.type==="file")var Ae=kd;else if(Ud(U))if(Ld)Ae=Gb;else{Ae=Bb;var le=Mb}else M=U.nodeName,!M||M.toLowerCase()!=="input"||U.type!=="checkbox"&&U.type!=="radio"?D&&eo(D.elementType)&&(Ae=kd):Ae=Hb;if(Ae&&(Ae=Ae(e,D))){zd(F,Ae,s,G);break e}le&&le(e,U,D),e==="focusout"&&D&&U.type==="number"&&D.memoizedProps.value!=null&&Zl(U,"number",U.value)}switch(le=D?Js(D):window,e){case"focusin":(Ud(le)||le.contentEditable==="true")&&(es=le,mo=D,si=null);break;case"focusout":si=mo=es=null;break;case"mousedown":go=!0;break;case"contextmenu":case"mouseup":case"dragend":go=!1,Yd(F,s,G);break;case"selectionchange":if($b)break;case"keydown":case"keyup":Yd(F,s,G)}var ve;if(uo)e:{switch(e){case"compositionstart":var Ne="onCompositionStart";break e;case"compositionend":Ne="onCompositionEnd";break e;case"compositionupdate":Ne="onCompositionUpdate";break e}Ne=void 0}else Za?Id(e,s)&&(Ne="onCompositionEnd"):e==="keydown"&&s.keyCode===229&&(Ne="onCompositionStart");Ne&&(jd&&s.locale!=="ko"&&(Za||Ne!=="onCompositionStart"?Ne==="onCompositionEnd"&&Za&&(ve=Nd()):(Vn=G,io="value"in Vn?Vn.value:Vn.textContent,Za=!0)),le=rl(D,Ne),0<le.length&&(Ne=new Ad(Ne,e,null,s,G),F.push({event:Ne,listeners:le}),ve?Ne.data=ve:(ve=Dd(s),ve!==null&&(Ne.data=ve)))),(ve=Db?Ub(e,s):zb(e,s))&&(Ne=rl(D,"onBeforeInput"),0<Ne.length&&(le=new Ad("onBeforeInput","beforeinput",null,s,G),F.push({event:le,listeners:Ne}),le.data=ve)),Ty(F,e,D,s,G)}yp(F,t)})}function ji(e,t,s){return{instance:e,listener:t,currentTarget:s}}function rl(e,t){for(var s=t+"Capture",r=[];e!==null;){var c=e,d=c.stateNode;if(c=c.tag,c!==5&&c!==26&&c!==27||d===null||(c=Xs(e,s),c!=null&&r.unshift(ji(e,c,d)),c=Xs(e,t),c!=null&&r.push(ji(e,c,d))),e.tag===3)return r;e=e.return}return[]}function Ry(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function xp(e,t,s,r,c){for(var d=t._reactName,m=[];s!==null&&s!==r;){var v=s,T=v.alternate,D=v.stateNode;if(v=v.tag,T!==null&&T===r)break;v!==5&&v!==26&&v!==27||D===null||(T=D,c?(D=Xs(s,d),D!=null&&m.unshift(ji(s,D,T))):c||(D=Xs(s,d),D!=null&&m.push(ji(s,D,T)))),s=s.return}m.length!==0&&e.push({event:t,listeners:m})}var Cy=/\r\n?/g,Iy=/\u0000|\uFFFD/g;function _p(e){return(typeof e=="string"?e:""+e).replace(Cy,`
`).replace(Iy,"")}function wp(e,t){return t=_p(t),_p(e)===t}function ze(e,t,s,r,c,d){switch(s){case"children":typeof r=="string"?t==="body"||t==="textarea"&&r===""||Xa(e,r):(typeof r=="number"||typeof r=="bigint")&&t!=="body"&&Xa(e,""+r);break;case"className":ur(e,"class",r);break;case"tabIndex":ur(e,"tabindex",r);break;case"dir":case"role":case"viewBox":case"width":case"height":ur(e,s,r);break;case"style":_d(e,r,d);break;case"data":if(t!=="object"){ur(e,"data",r);break}case"src":case"href":if(r===""&&(t!=="a"||s!=="href")){e.removeAttribute(s);break}if(r==null||typeof r=="function"||typeof r=="symbol"||typeof r=="boolean"){e.removeAttribute(s);break}r=hr(""+r),e.setAttribute(s,r);break;case"action":case"formAction":if(typeof r=="function"){e.setAttribute(s,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof d=="function"&&(s==="formAction"?(t!=="input"&&ze(e,t,"name",c.name,c,null),ze(e,t,"formEncType",c.formEncType,c,null),ze(e,t,"formMethod",c.formMethod,c,null),ze(e,t,"formTarget",c.formTarget,c,null)):(ze(e,t,"encType",c.encType,c,null),ze(e,t,"method",c.method,c,null),ze(e,t,"target",c.target,c,null)));if(r==null||typeof r=="symbol"||typeof r=="boolean"){e.removeAttribute(s);break}r=hr(""+r),e.setAttribute(s,r);break;case"onClick":r!=null&&(e.onclick=xn);break;case"onScroll":r!=null&&we("scroll",e);break;case"onScrollEnd":r!=null&&we("scrollend",e);break;case"dangerouslySetInnerHTML":if(r!=null){if(typeof r!="object"||!("__html"in r))throw Error(l(61));if(s=r.__html,s!=null){if(c.children!=null)throw Error(l(60));e.innerHTML=s}}break;case"multiple":e.multiple=r&&typeof r!="function"&&typeof r!="symbol";break;case"muted":e.muted=r&&typeof r!="function"&&typeof r!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(r==null||typeof r=="function"||typeof r=="boolean"||typeof r=="symbol"){e.removeAttribute("xlink:href");break}s=hr(""+r),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",s);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":r!=null&&typeof r!="function"&&typeof r!="symbol"?e.setAttribute(s,""+r):e.removeAttribute(s);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":r&&typeof r!="function"&&typeof r!="symbol"?e.setAttribute(s,""):e.removeAttribute(s);break;case"capture":case"download":r===!0?e.setAttribute(s,""):r!==!1&&r!=null&&typeof r!="function"&&typeof r!="symbol"?e.setAttribute(s,r):e.removeAttribute(s);break;case"cols":case"rows":case"size":case"span":r!=null&&typeof r!="function"&&typeof r!="symbol"&&!isNaN(r)&&1<=r?e.setAttribute(s,r):e.removeAttribute(s);break;case"rowSpan":case"start":r==null||typeof r=="function"||typeof r=="symbol"||isNaN(r)?e.removeAttribute(s):e.setAttribute(s,r);break;case"popover":we("beforetoggle",e),we("toggle",e),cr(e,"popover",r);break;case"xlinkActuate":vn(e,"http://www.w3.org/1999/xlink","xlink:actuate",r);break;case"xlinkArcrole":vn(e,"http://www.w3.org/1999/xlink","xlink:arcrole",r);break;case"xlinkRole":vn(e,"http://www.w3.org/1999/xlink","xlink:role",r);break;case"xlinkShow":vn(e,"http://www.w3.org/1999/xlink","xlink:show",r);break;case"xlinkTitle":vn(e,"http://www.w3.org/1999/xlink","xlink:title",r);break;case"xlinkType":vn(e,"http://www.w3.org/1999/xlink","xlink:type",r);break;case"xmlBase":vn(e,"http://www.w3.org/XML/1998/namespace","xml:base",r);break;case"xmlLang":vn(e,"http://www.w3.org/XML/1998/namespace","xml:lang",r);break;case"xmlSpace":vn(e,"http://www.w3.org/XML/1998/namespace","xml:space",r);break;case"is":cr(e,"is",r);break;case"innerText":case"textContent":break;default:(!(2<s.length)||s[0]!=="o"&&s[0]!=="O"||s[1]!=="n"&&s[1]!=="N")&&(s=rb.get(s)||s,cr(e,s,r))}}function Gc(e,t,s,r,c,d){switch(s){case"style":_d(e,r,d);break;case"dangerouslySetInnerHTML":if(r!=null){if(typeof r!="object"||!("__html"in r))throw Error(l(61));if(s=r.__html,s!=null){if(c.children!=null)throw Error(l(60));e.innerHTML=s}}break;case"children":typeof r=="string"?Xa(e,r):(typeof r=="number"||typeof r=="bigint")&&Xa(e,""+r);break;case"onScroll":r!=null&&we("scroll",e);break;case"onScrollEnd":r!=null&&we("scrollend",e);break;case"onClick":r!=null&&(e.onclick=xn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!hd.hasOwnProperty(s))e:{if(s[0]==="o"&&s[1]==="n"&&(c=s.endsWith("Capture"),t=s.slice(2,c?s.length-7:void 0),d=e[Et]||null,d=d!=null?d[s]:null,typeof d=="function"&&e.removeEventListener(t,d,c),typeof r=="function")){typeof d!="function"&&d!==null&&(s in e?e[s]=null:e.hasAttribute(s)&&e.removeAttribute(s)),e.addEventListener(t,r,c);break e}s in e?e[s]=r:r===!0?e.setAttribute(s,""):cr(e,s,r)}}}function ft(e,t,s){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":we("error",e),we("load",e);var r=!1,c=!1,d;for(d in s)if(s.hasOwnProperty(d)){var m=s[d];if(m!=null)switch(d){case"src":r=!0;break;case"srcSet":c=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(l(137,t));default:ze(e,t,d,m,s,null)}}c&&ze(e,t,"srcSet",s.srcSet,s,null),r&&ze(e,t,"src",s.src,s,null);return;case"input":we("invalid",e);var v=d=m=c=null,T=null,D=null;for(r in s)if(s.hasOwnProperty(r)){var G=s[r];if(G!=null)switch(r){case"name":c=G;break;case"type":m=G;break;case"checked":T=G;break;case"defaultChecked":D=G;break;case"value":d=G;break;case"defaultValue":v=G;break;case"children":case"dangerouslySetInnerHTML":if(G!=null)throw Error(l(137,t));break;default:ze(e,t,r,G,s,null)}}bd(e,d,v,T,D,m,c,!1);return;case"select":we("invalid",e),r=m=d=null;for(c in s)if(s.hasOwnProperty(c)&&(v=s[c],v!=null))switch(c){case"value":d=v;break;case"defaultValue":m=v;break;case"multiple":r=v;default:ze(e,t,c,v,s,null)}t=d,s=m,e.multiple=!!r,t!=null?Ja(e,!!r,t,!1):s!=null&&Ja(e,!!r,s,!0);return;case"textarea":we("invalid",e),d=c=r=null;for(m in s)if(s.hasOwnProperty(m)&&(v=s[m],v!=null))switch(m){case"value":r=v;break;case"defaultValue":c=v;break;case"children":d=v;break;case"dangerouslySetInnerHTML":if(v!=null)throw Error(l(91));break;default:ze(e,t,m,v,s,null)}vd(e,r,c,d);return;case"option":for(T in s)if(s.hasOwnProperty(T)&&(r=s[T],r!=null))switch(T){case"selected":e.selected=r&&typeof r!="function"&&typeof r!="symbol";break;default:ze(e,t,T,r,s,null)}return;case"dialog":we("beforetoggle",e),we("toggle",e),we("cancel",e),we("close",e);break;case"iframe":case"object":we("load",e);break;case"video":case"audio":for(r=0;r<Oi.length;r++)we(Oi[r],e);break;case"image":we("error",e),we("load",e);break;case"details":we("toggle",e);break;case"embed":case"source":case"link":we("error",e),we("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(D in s)if(s.hasOwnProperty(D)&&(r=s[D],r!=null))switch(D){case"children":case"dangerouslySetInnerHTML":throw Error(l(137,t));default:ze(e,t,D,r,s,null)}return;default:if(eo(t)){for(G in s)s.hasOwnProperty(G)&&(r=s[G],r!==void 0&&Gc(e,t,G,r,s,void 0));return}}for(v in s)s.hasOwnProperty(v)&&(r=s[v],r!=null&&ze(e,t,v,r,s,null))}function Dy(e,t,s,r){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var c=null,d=null,m=null,v=null,T=null,D=null,G=null;for(M in s){var F=s[M];if(s.hasOwnProperty(M)&&F!=null)switch(M){case"checked":break;case"value":break;case"defaultValue":T=F;default:r.hasOwnProperty(M)||ze(e,t,M,null,r,F)}}for(var U in r){var M=r[U];if(F=s[U],r.hasOwnProperty(U)&&(M!=null||F!=null))switch(U){case"type":d=M;break;case"name":c=M;break;case"checked":D=M;break;case"defaultChecked":G=M;break;case"value":m=M;break;case"defaultValue":v=M;break;case"children":case"dangerouslySetInnerHTML":if(M!=null)throw Error(l(137,t));break;default:M!==F&&ze(e,t,U,M,r,F)}}Wl(e,m,v,T,D,G,d,c);return;case"select":M=m=v=U=null;for(d in s)if(T=s[d],s.hasOwnProperty(d)&&T!=null)switch(d){case"value":break;case"multiple":M=T;default:r.hasOwnProperty(d)||ze(e,t,d,null,r,T)}for(c in r)if(d=r[c],T=s[c],r.hasOwnProperty(c)&&(d!=null||T!=null))switch(c){case"value":U=d;break;case"defaultValue":v=d;break;case"multiple":m=d;default:d!==T&&ze(e,t,c,d,r,T)}t=v,s=m,r=M,U!=null?Ja(e,!!s,U,!1):!!r!=!!s&&(t!=null?Ja(e,!!s,t,!0):Ja(e,!!s,s?[]:"",!1));return;case"textarea":M=U=null;for(v in s)if(c=s[v],s.hasOwnProperty(v)&&c!=null&&!r.hasOwnProperty(v))switch(v){case"value":break;case"children":break;default:ze(e,t,v,null,r,c)}for(m in r)if(c=r[m],d=s[m],r.hasOwnProperty(m)&&(c!=null||d!=null))switch(m){case"value":U=c;break;case"defaultValue":M=c;break;case"children":break;case"dangerouslySetInnerHTML":if(c!=null)throw Error(l(91));break;default:c!==d&&ze(e,t,m,c,r,d)}yd(e,U,M);return;case"option":for(var se in s)if(U=s[se],s.hasOwnProperty(se)&&U!=null&&!r.hasOwnProperty(se))switch(se){case"selected":e.selected=!1;break;default:ze(e,t,se,null,r,U)}for(T in r)if(U=r[T],M=s[T],r.hasOwnProperty(T)&&U!==M&&(U!=null||M!=null))switch(T){case"selected":e.selected=U&&typeof U!="function"&&typeof U!="symbol";break;default:ze(e,t,T,U,r,M)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var de in s)U=s[de],s.hasOwnProperty(de)&&U!=null&&!r.hasOwnProperty(de)&&ze(e,t,de,null,r,U);for(D in r)if(U=r[D],M=s[D],r.hasOwnProperty(D)&&U!==M&&(U!=null||M!=null))switch(D){case"children":case"dangerouslySetInnerHTML":if(U!=null)throw Error(l(137,t));break;default:ze(e,t,D,U,r,M)}return;default:if(eo(t)){for(var ke in s)U=s[ke],s.hasOwnProperty(ke)&&U!==void 0&&!r.hasOwnProperty(ke)&&Gc(e,t,ke,void 0,r,U);for(G in r)U=r[G],M=s[G],!r.hasOwnProperty(G)||U===M||U===void 0&&M===void 0||Gc(e,t,G,U,r,M);return}}for(var R in s)U=s[R],s.hasOwnProperty(R)&&U!=null&&!r.hasOwnProperty(R)&&ze(e,t,R,null,r,U);for(F in r)U=r[F],M=s[F],!r.hasOwnProperty(F)||U===M||U==null&&M==null||ze(e,t,F,U,r,M)}function Ep(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Uy(){if(typeof performance.getEntriesByType=="function"){for(var e=0,t=0,s=performance.getEntriesByType("resource"),r=0;r<s.length;r++){var c=s[r],d=c.transferSize,m=c.initiatorType,v=c.duration;if(d&&v&&Ep(m)){for(m=0,v=c.responseEnd,r+=1;r<s.length;r++){var T=s[r],D=T.startTime;if(D>v)break;var G=T.transferSize,F=T.initiatorType;G&&Ep(F)&&(T=T.responseEnd,m+=G*(T<v?1:(v-D)/(T-D)))}if(--r,t+=8*(d+m)/(c.duration/1e3),e++,10<e)break}}if(0<e)return t/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var Pc=null,$c=null;function ll(e){return e.nodeType===9?e:e.ownerDocument}function Np(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Sp(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function Vc(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Yc=null;function zy(){var e=window.event;return e&&e.type==="popstate"?e===Yc?!1:(Yc=e,!0):(Yc=null,!1)}var Tp=typeof setTimeout=="function"?setTimeout:void 0,ky=typeof clearTimeout=="function"?clearTimeout:void 0,Ap=typeof Promise=="function"?Promise:void 0,Ly=typeof queueMicrotask=="function"?queueMicrotask:typeof Ap<"u"?function(e){return Ap.resolve(null).then(e).catch(My)}:Tp;function My(e){setTimeout(function(){throw e})}function la(e){return e==="head"}function Op(e,t){var s=t,r=0;do{var c=s.nextSibling;if(e.removeChild(s),c&&c.nodeType===8)if(s=c.data,s==="/$"||s==="/&"){if(r===0){e.removeChild(c),As(t);return}r--}else if(s==="$"||s==="$?"||s==="$~"||s==="$!"||s==="&")r++;else if(s==="html")Ri(e.ownerDocument.documentElement);else if(s==="head"){s=e.ownerDocument.head,Ri(s);for(var d=s.firstChild;d;){var m=d.nextSibling,v=d.nodeName;d[Fs]||v==="SCRIPT"||v==="STYLE"||v==="LINK"&&d.rel.toLowerCase()==="stylesheet"||s.removeChild(d),d=m}}else s==="body"&&Ri(e.ownerDocument.body);s=c}while(s);As(t)}function jp(e,t){var s=e;e=0;do{var r=s.nextSibling;if(s.nodeType===1?t?(s._stashedDisplay=s.style.display,s.style.display="none"):(s.style.display=s._stashedDisplay||"",s.getAttribute("style")===""&&s.removeAttribute("style")):s.nodeType===3&&(t?(s._stashedText=s.nodeValue,s.nodeValue=""):s.nodeValue=s._stashedText||""),r&&r.nodeType===8)if(s=r.data,s==="/$"){if(e===0)break;e--}else s!=="$"&&s!=="$?"&&s!=="$~"&&s!=="$!"||e++;s=r}while(s)}function qc(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var s=t;switch(t=t.nextSibling,s.nodeName){case"HTML":case"HEAD":case"BODY":qc(s),Xl(s);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(s.rel.toLowerCase()==="stylesheet")continue}e.removeChild(s)}}function By(e,t,s,r){for(;e.nodeType===1;){var c=s;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!r&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(r){if(!e[Fs])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(d=e.getAttribute("rel"),d==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(d!==c.rel||e.getAttribute("href")!==(c.href==null||c.href===""?null:c.href)||e.getAttribute("crossorigin")!==(c.crossOrigin==null?null:c.crossOrigin)||e.getAttribute("title")!==(c.title==null?null:c.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(d=e.getAttribute("src"),(d!==(c.src==null?null:c.src)||e.getAttribute("type")!==(c.type==null?null:c.type)||e.getAttribute("crossorigin")!==(c.crossOrigin==null?null:c.crossOrigin))&&d&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var d=c.name==null?null:""+c.name;if(c.type==="hidden"&&e.getAttribute("name")===d)return e}else return e;if(e=Qt(e.nextSibling),e===null)break}return null}function Hy(e,t,s){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!s||(e=Qt(e.nextSibling),e===null))return null;return e}function Rp(e,t){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!t||(e=Qt(e.nextSibling),e===null))return null;return e}function Kc(e){return e.data==="$?"||e.data==="$~"}function Fc(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function Gy(e,t){var s=e.ownerDocument;if(e.data==="$~")e._reactRetry=t;else if(e.data!=="$?"||s.readyState!=="loading")t();else{var r=function(){t(),s.removeEventListener("DOMContentLoaded",r)};s.addEventListener("DOMContentLoaded",r),e._reactRetry=r}}function Qt(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="$~"||t==="&"||t==="F!"||t==="F")break;if(t==="/$"||t==="/&")return null}}return e}var Jc=null;function Cp(e){e=e.nextSibling;for(var t=0;e;){if(e.nodeType===8){var s=e.data;if(s==="/$"||s==="/&"){if(t===0)return Qt(e.nextSibling);t--}else s!=="$"&&s!=="$!"&&s!=="$?"&&s!=="$~"&&s!=="&"||t++}e=e.nextSibling}return null}function Ip(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var s=e.data;if(s==="$"||s==="$!"||s==="$?"||s==="$~"||s==="&"){if(t===0)return e;t--}else s!=="/$"&&s!=="/&"||t++}e=e.previousSibling}return null}function Dp(e,t,s){switch(t=ll(s),e){case"html":if(e=t.documentElement,!e)throw Error(l(452));return e;case"head":if(e=t.head,!e)throw Error(l(453));return e;case"body":if(e=t.body,!e)throw Error(l(454));return e;default:throw Error(l(451))}}function Ri(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Xl(e)}var Wt=new Map,Up=new Set;function ol(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var kn=J.d;J.d={f:Py,r:$y,D:Vy,C:Yy,L:qy,m:Ky,X:Jy,S:Fy,M:Xy};function Py(){var e=kn.f(),t=Zr();return e||t}function $y(e){var t=qa(e);t!==null&&t.tag===5&&t.type==="form"?Xh(t):kn.r(e)}var Ns=typeof document>"u"?null:document;function zp(e,t,s){var r=Ns;if(r&&typeof t=="string"&&t){var c=Vt(t);c='link[rel="'+e+'"][href="'+c+'"]',typeof s=="string"&&(c+='[crossorigin="'+s+'"]'),Up.has(c)||(Up.add(c),e={rel:e,crossOrigin:s,href:t},r.querySelector(c)===null&&(t=r.createElement("link"),ft(t,"link",e),lt(t),r.head.appendChild(t)))}}function Vy(e){kn.D(e),zp("dns-prefetch",e,null)}function Yy(e,t){kn.C(e,t),zp("preconnect",e,t)}function qy(e,t,s){kn.L(e,t,s);var r=Ns;if(r&&e&&t){var c='link[rel="preload"][as="'+Vt(t)+'"]';t==="image"&&s&&s.imageSrcSet?(c+='[imagesrcset="'+Vt(s.imageSrcSet)+'"]',typeof s.imageSizes=="string"&&(c+='[imagesizes="'+Vt(s.imageSizes)+'"]')):c+='[href="'+Vt(e)+'"]';var d=c;switch(t){case"style":d=Ss(e);break;case"script":d=Ts(e)}Wt.has(d)||(e=y({rel:"preload",href:t==="image"&&s&&s.imageSrcSet?void 0:e,as:t},s),Wt.set(d,e),r.querySelector(c)!==null||t==="style"&&r.querySelector(Ci(d))||t==="script"&&r.querySelector(Ii(d))||(t=r.createElement("link"),ft(t,"link",e),lt(t),r.head.appendChild(t)))}}function Ky(e,t){kn.m(e,t);var s=Ns;if(s&&e){var r=t&&typeof t.as=="string"?t.as:"script",c='link[rel="modulepreload"][as="'+Vt(r)+'"][href="'+Vt(e)+'"]',d=c;switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":d=Ts(e)}if(!Wt.has(d)&&(e=y({rel:"modulepreload",href:e},t),Wt.set(d,e),s.querySelector(c)===null)){switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(s.querySelector(Ii(d)))return}r=s.createElement("link"),ft(r,"link",e),lt(r),s.head.appendChild(r)}}}function Fy(e,t,s){kn.S(e,t,s);var r=Ns;if(r&&e){var c=Ka(r).hoistableStyles,d=Ss(e);t=t||"default";var m=c.get(d);if(!m){var v={loading:0,preload:null};if(m=r.querySelector(Ci(d)))v.loading=5;else{e=y({rel:"stylesheet",href:e,"data-precedence":t},s),(s=Wt.get(d))&&Xc(e,s);var T=m=r.createElement("link");lt(T),ft(T,"link",e),T._p=new Promise(function(D,G){T.onload=D,T.onerror=G}),T.addEventListener("load",function(){v.loading|=1}),T.addEventListener("error",function(){v.loading|=2}),v.loading|=4,cl(m,t,r)}m={type:"stylesheet",instance:m,count:1,state:v},c.set(d,m)}}}function Jy(e,t){kn.X(e,t);var s=Ns;if(s&&e){var r=Ka(s).hoistableScripts,c=Ts(e),d=r.get(c);d||(d=s.querySelector(Ii(c)),d||(e=y({src:e,async:!0},t),(t=Wt.get(c))&&Qc(e,t),d=s.createElement("script"),lt(d),ft(d,"link",e),s.head.appendChild(d)),d={type:"script",instance:d,count:1,state:null},r.set(c,d))}}function Xy(e,t){kn.M(e,t);var s=Ns;if(s&&e){var r=Ka(s).hoistableScripts,c=Ts(e),d=r.get(c);d||(d=s.querySelector(Ii(c)),d||(e=y({src:e,async:!0,type:"module"},t),(t=Wt.get(c))&&Qc(e,t),d=s.createElement("script"),lt(d),ft(d,"link",e),s.head.appendChild(d)),d={type:"script",instance:d,count:1,state:null},r.set(c,d))}}function kp(e,t,s,r){var c=(c=B.current)?ol(c):null;if(!c)throw Error(l(446));switch(e){case"meta":case"title":return null;case"style":return typeof s.precedence=="string"&&typeof s.href=="string"?(t=Ss(s.href),s=Ka(c).hoistableStyles,r=s.get(t),r||(r={type:"style",instance:null,count:0,state:null},s.set(t,r)),r):{type:"void",instance:null,count:0,state:null};case"link":if(s.rel==="stylesheet"&&typeof s.href=="string"&&typeof s.precedence=="string"){e=Ss(s.href);var d=Ka(c).hoistableStyles,m=d.get(e);if(m||(c=c.ownerDocument||c,m={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},d.set(e,m),(d=c.querySelector(Ci(e)))&&!d._p&&(m.instance=d,m.state.loading=5),Wt.has(e)||(s={rel:"preload",as:"style",href:s.href,crossOrigin:s.crossOrigin,integrity:s.integrity,media:s.media,hrefLang:s.hrefLang,referrerPolicy:s.referrerPolicy},Wt.set(e,s),d||Qy(c,e,s,m.state))),t&&r===null)throw Error(l(528,""));return m}if(t&&r!==null)throw Error(l(529,""));return null;case"script":return t=s.async,s=s.src,typeof s=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=Ts(s),s=Ka(c).hoistableScripts,r=s.get(t),r||(r={type:"script",instance:null,count:0,state:null},s.set(t,r)),r):{type:"void",instance:null,count:0,state:null};default:throw Error(l(444,e))}}function Ss(e){return'href="'+Vt(e)+'"'}function Ci(e){return'link[rel="stylesheet"]['+e+"]"}function Lp(e){return y({},e,{"data-precedence":e.precedence,precedence:null})}function Qy(e,t,s,r){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?r.loading=1:(t=e.createElement("link"),r.preload=t,t.addEventListener("load",function(){return r.loading|=1}),t.addEventListener("error",function(){return r.loading|=2}),ft(t,"link",s),lt(t),e.head.appendChild(t))}function Ts(e){return'[src="'+Vt(e)+'"]'}function Ii(e){return"script[async]"+e}function Mp(e,t,s){if(t.count++,t.instance===null)switch(t.type){case"style":var r=e.querySelector('style[data-href~="'+Vt(s.href)+'"]');if(r)return t.instance=r,lt(r),r;var c=y({},s,{"data-href":s.href,"data-precedence":s.precedence,href:null,precedence:null});return r=(e.ownerDocument||e).createElement("style"),lt(r),ft(r,"style",c),cl(r,s.precedence,e),t.instance=r;case"stylesheet":c=Ss(s.href);var d=e.querySelector(Ci(c));if(d)return t.state.loading|=4,t.instance=d,lt(d),d;r=Lp(s),(c=Wt.get(c))&&Xc(r,c),d=(e.ownerDocument||e).createElement("link"),lt(d);var m=d;return m._p=new Promise(function(v,T){m.onload=v,m.onerror=T}),ft(d,"link",r),t.state.loading|=4,cl(d,s.precedence,e),t.instance=d;case"script":return d=Ts(s.src),(c=e.querySelector(Ii(d)))?(t.instance=c,lt(c),c):(r=s,(c=Wt.get(d))&&(r=y({},s),Qc(r,c)),e=e.ownerDocument||e,c=e.createElement("script"),lt(c),ft(c,"link",r),e.head.appendChild(c),t.instance=c);case"void":return null;default:throw Error(l(443,t.type))}else t.type==="stylesheet"&&(t.state.loading&4)===0&&(r=t.instance,t.state.loading|=4,cl(r,s.precedence,e));return t.instance}function cl(e,t,s){for(var r=s.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),c=r.length?r[r.length-1]:null,d=c,m=0;m<r.length;m++){var v=r[m];if(v.dataset.precedence===t)d=v;else if(d!==c)break}d?d.parentNode.insertBefore(e,d.nextSibling):(t=s.nodeType===9?s.head:s,t.insertBefore(e,t.firstChild))}function Xc(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function Qc(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var ul=null;function Bp(e,t,s){if(ul===null){var r=new Map,c=ul=new Map;c.set(s,r)}else c=ul,r=c.get(s),r||(r=new Map,c.set(s,r));if(r.has(e))return r;for(r.set(e,null),s=s.getElementsByTagName(e),c=0;c<s.length;c++){var d=s[c];if(!(d[Fs]||d[ct]||e==="link"&&d.getAttribute("rel")==="stylesheet")&&d.namespaceURI!=="http://www.w3.org/2000/svg"){var m=d.getAttribute(t)||"";m=e+m;var v=r.get(m);v?v.push(d):r.set(m,[d])}}return r}function Hp(e,t,s){e=e.ownerDocument||e,e.head.insertBefore(s,t==="title"?e.querySelector("head > title"):null)}function Wy(e,t,s){if(s===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;switch(t.rel){case"stylesheet":return e=t.disabled,typeof t.precedence=="string"&&e==null;default:return!0}case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function Gp(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function Zy(e,t,s,r){if(s.type==="stylesheet"&&(typeof r.media!="string"||matchMedia(r.media).matches!==!1)&&(s.state.loading&4)===0){if(s.instance===null){var c=Ss(r.href),d=t.querySelector(Ci(c));if(d){t=d._p,t!==null&&typeof t=="object"&&typeof t.then=="function"&&(e.count++,e=dl.bind(e),t.then(e,e)),s.state.loading|=4,s.instance=d,lt(d);return}d=t.ownerDocument||t,r=Lp(r),(c=Wt.get(c))&&Xc(r,c),d=d.createElement("link"),lt(d);var m=d;m._p=new Promise(function(v,T){m.onload=v,m.onerror=T}),ft(d,"link",r),s.instance=d}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(s,t),(t=s.state.preload)&&(s.state.loading&3)===0&&(e.count++,s=dl.bind(e),t.addEventListener("load",s),t.addEventListener("error",s))}}var Wc=0;function ev(e,t){return e.stylesheets&&e.count===0&&fl(e,e.stylesheets),0<e.count||0<e.imgCount?function(s){var r=setTimeout(function(){if(e.stylesheets&&fl(e,e.stylesheets),e.unsuspend){var d=e.unsuspend;e.unsuspend=null,d()}},6e4+t);0<e.imgBytes&&Wc===0&&(Wc=62500*Uy());var c=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&fl(e,e.stylesheets),e.unsuspend)){var d=e.unsuspend;e.unsuspend=null,d()}},(e.imgBytes>Wc?50:800)+t);return e.unsuspend=s,function(){e.unsuspend=null,clearTimeout(r),clearTimeout(c)}}:null}function dl(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)fl(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var hl=null;function fl(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,hl=new Map,t.forEach(tv,e),hl=null,dl.call(e))}function tv(e,t){if(!(t.state.loading&4)){var s=hl.get(e);if(s)var r=s.get(null);else{s=new Map,hl.set(e,s);for(var c=e.querySelectorAll("link[data-precedence],style[data-precedence]"),d=0;d<c.length;d++){var m=c[d];(m.nodeName==="LINK"||m.getAttribute("media")!=="not all")&&(s.set(m.dataset.precedence,m),r=m)}r&&s.set(null,r)}c=t.instance,m=c.getAttribute("data-precedence"),d=s.get(m)||r,d===r&&s.set(null,c),s.set(m,c),this.count++,r=dl.bind(this),c.addEventListener("load",r),c.addEventListener("error",r),d?d.parentNode.insertBefore(c,d.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(c,e.firstChild)),t.state.loading|=4}}var Di={$$typeof:H,Provider:null,Consumer:null,_currentValue:Y,_currentValue2:Y,_threadCount:0};function nv(e,t,s,r,c,d,m,v,T){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ql(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ql(0),this.hiddenUpdates=ql(null),this.identifierPrefix=r,this.onUncaughtError=c,this.onCaughtError=d,this.onRecoverableError=m,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=T,this.incompleteTransitions=new Map}function Pp(e,t,s,r,c,d,m,v,T,D,G,F){return e=new nv(e,t,s,m,T,D,G,F,v),t=1,d===!0&&(t|=24),d=Ut(3,null,null,t),e.current=d,d.stateNode=e,t=Co(),t.refCount++,e.pooledCache=t,t.refCount++,d.memoizedState={element:r,isDehydrated:s,cache:t},zo(d),e}function $p(e){return e?(e=as,e):as}function Vp(e,t,s,r,c,d){c=$p(c),r.context===null?r.context=c:r.pendingContext=c,r=Xn(t),r.payload={element:s},d=d===void 0?null:d,d!==null&&(r.callback=d),s=Qn(e,r,t),s!==null&&(jt(s,e,t),di(s,e,t))}function Yp(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var s=e.retryLane;e.retryLane=s!==0&&s<t?s:t}}function Zc(e,t){Yp(e,t),(e=e.alternate)&&Yp(e,t)}function qp(e){if(e.tag===13||e.tag===31){var t=_a(e,67108864);t!==null&&jt(t,e,67108864),Zc(e,67108864)}}function Kp(e){if(e.tag===13||e.tag===31){var t=Bt();t=Kl(t);var s=_a(e,t);s!==null&&jt(s,e,t),Zc(e,t)}}var pl=!0;function av(e,t,s,r){var c=z.T;z.T=null;var d=J.p;try{J.p=2,eu(e,t,s,r)}finally{J.p=d,z.T=c}}function sv(e,t,s,r){var c=z.T;z.T=null;var d=J.p;try{J.p=8,eu(e,t,s,r)}finally{J.p=d,z.T=c}}function eu(e,t,s,r){if(pl){var c=tu(r);if(c===null)Hc(e,t,r,ml,s),Jp(e,r);else if(rv(c,e,t,s,r))r.stopPropagation();else if(Jp(e,r),t&4&&-1<iv.indexOf(e)){for(;c!==null;){var d=qa(c);if(d!==null)switch(d.tag){case 3:if(d=d.stateNode,d.current.memoizedState.isDehydrated){var m=ga(d.pendingLanes);if(m!==0){var v=d;for(v.pendingLanes|=2,v.entangledLanes|=2;m;){var T=1<<31-It(m);v.entanglements[1]|=T,m&=~T}fn(d),(je&6)===0&&(Qr=Rt()+500,Ai(0))}}break;case 31:case 13:v=_a(d,2),v!==null&&jt(v,d,2),Zr(),Zc(d,2)}if(d=tu(r),d===null&&Hc(e,t,r,ml,s),d===c)break;c=d}c!==null&&r.stopPropagation()}else Hc(e,t,r,null,s)}}function tu(e){return e=no(e),nu(e)}var ml=null;function nu(e){if(ml=null,e=Ya(e),e!==null){var t=h(e);if(t===null)e=null;else{var s=t.tag;if(s===13){if(e=f(t),e!==null)return e;e=null}else if(s===31){if(e=g(t),e!==null)return e;e=null}else if(s===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return ml=e,null}function Fp(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Vg()){case td:return 2;case nd:return 8;case sr:case Yg:return 32;case ad:return 268435456;default:return 32}default:return 32}}var au=!1,oa=null,ca=null,ua=null,Ui=new Map,zi=new Map,da=[],iv="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Jp(e,t){switch(e){case"focusin":case"focusout":oa=null;break;case"dragenter":case"dragleave":ca=null;break;case"mouseover":case"mouseout":ua=null;break;case"pointerover":case"pointerout":Ui.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":zi.delete(t.pointerId)}}function ki(e,t,s,r,c,d){return e===null||e.nativeEvent!==d?(e={blockedOn:t,domEventName:s,eventSystemFlags:r,nativeEvent:d,targetContainers:[c]},t!==null&&(t=qa(t),t!==null&&qp(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,c!==null&&t.indexOf(c)===-1&&t.push(c),e)}function rv(e,t,s,r,c){switch(t){case"focusin":return oa=ki(oa,e,t,s,r,c),!0;case"dragenter":return ca=ki(ca,e,t,s,r,c),!0;case"mouseover":return ua=ki(ua,e,t,s,r,c),!0;case"pointerover":var d=c.pointerId;return Ui.set(d,ki(Ui.get(d)||null,e,t,s,r,c)),!0;case"gotpointercapture":return d=c.pointerId,zi.set(d,ki(zi.get(d)||null,e,t,s,r,c)),!0}return!1}function Xp(e){var t=Ya(e.target);if(t!==null){var s=h(t);if(s!==null){if(t=s.tag,t===13){if(t=f(s),t!==null){e.blockedOn=t,cd(e.priority,function(){Kp(s)});return}}else if(t===31){if(t=g(s),t!==null){e.blockedOn=t,cd(e.priority,function(){Kp(s)});return}}else if(t===3&&s.stateNode.current.memoizedState.isDehydrated){e.blockedOn=s.tag===3?s.stateNode.containerInfo:null;return}}}e.blockedOn=null}function gl(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var s=tu(e.nativeEvent);if(s===null){s=e.nativeEvent;var r=new s.constructor(s.type,s);to=r,s.target.dispatchEvent(r),to=null}else return t=qa(s),t!==null&&qp(t),e.blockedOn=s,!1;t.shift()}return!0}function Qp(e,t,s){gl(e)&&s.delete(t)}function lv(){au=!1,oa!==null&&gl(oa)&&(oa=null),ca!==null&&gl(ca)&&(ca=null),ua!==null&&gl(ua)&&(ua=null),Ui.forEach(Qp),zi.forEach(Qp)}function bl(e,t){e.blockedOn===t&&(e.blockedOn=null,au||(au=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,lv)))}var yl=null;function Wp(e){yl!==e&&(yl=e,a.unstable_scheduleCallback(a.unstable_NormalPriority,function(){yl===e&&(yl=null);for(var t=0;t<e.length;t+=3){var s=e[t],r=e[t+1],c=e[t+2];if(typeof r!="function"){if(nu(r||s)===null)continue;break}var d=qa(s);d!==null&&(e.splice(t,3),t-=3,tc(d,{pending:!0,data:c,method:s.method,action:r},r,c))}}))}function As(e){function t(T){return bl(T,e)}oa!==null&&bl(oa,e),ca!==null&&bl(ca,e),ua!==null&&bl(ua,e),Ui.forEach(t),zi.forEach(t);for(var s=0;s<da.length;s++){var r=da[s];r.blockedOn===e&&(r.blockedOn=null)}for(;0<da.length&&(s=da[0],s.blockedOn===null);)Xp(s),s.blockedOn===null&&da.shift();if(s=(e.ownerDocument||e).$$reactFormReplay,s!=null)for(r=0;r<s.length;r+=3){var c=s[r],d=s[r+1],m=c[Et]||null;if(typeof d=="function")m||Wp(s);else if(m){var v=null;if(d&&d.hasAttribute("formAction")){if(c=d,m=d[Et]||null)v=m.formAction;else if(nu(c)!==null)continue}else v=m.action;typeof v=="function"?s[r+1]=v:(s.splice(r,3),r-=3),Wp(s)}}}function Zp(){function e(d){d.canIntercept&&d.info==="react-transition"&&d.intercept({handler:function(){return new Promise(function(m){return c=m})},focusReset:"manual",scroll:"manual"})}function t(){c!==null&&(c(),c=null),r||setTimeout(s,20)}function s(){if(!r&&!navigation.transition){var d=navigation.currentEntry;d&&d.url!=null&&navigation.navigate(d.url,{state:d.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var r=!1,c=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(s,100),function(){r=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),c!==null&&(c(),c=null)}}}function su(e){this._internalRoot=e}vl.prototype.render=su.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(l(409));var s=t.current,r=Bt();Vp(s,r,e,t,null,null)},vl.prototype.unmount=su.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Vp(e.current,2,null,e,null,null),Zr(),t[Va]=null}};function vl(e){this._internalRoot=e}vl.prototype.unstable_scheduleHydration=function(e){if(e){var t=od();e={blockedOn:null,target:e,priority:t};for(var s=0;s<da.length&&t!==0&&t<da[s].priority;s++);da.splice(s,0,e),s===0&&Xp(e)}};var e0=n.version;if(e0!=="19.2.3")throw Error(l(527,e0,"19.2.3"));J.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(l(188)):(e=Object.keys(e).join(","),Error(l(268,e)));return e=b(t),e=e!==null?x(e):null,e=e===null?null:e.stateNode,e};var ov={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:z,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var xl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!xl.isDisabled&&xl.supportsFiber)try{Ys=xl.inject(ov),Ct=xl}catch{}}return Mi.createRoot=function(e,t){if(!u(e))throw Error(l(299));var s=!1,r="",c=lf,d=of,m=cf;return t!=null&&(t.unstable_strictMode===!0&&(s=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onUncaughtError!==void 0&&(c=t.onUncaughtError),t.onCaughtError!==void 0&&(d=t.onCaughtError),t.onRecoverableError!==void 0&&(m=t.onRecoverableError)),t=Pp(e,1,!1,null,null,s,r,null,c,d,m,Zp),e[Va]=t.current,Bc(e),new su(t)},Mi.hydrateRoot=function(e,t,s){if(!u(e))throw Error(l(299));var r=!1,c="",d=lf,m=of,v=cf,T=null;return s!=null&&(s.unstable_strictMode===!0&&(r=!0),s.identifierPrefix!==void 0&&(c=s.identifierPrefix),s.onUncaughtError!==void 0&&(d=s.onUncaughtError),s.onCaughtError!==void 0&&(m=s.onCaughtError),s.onRecoverableError!==void 0&&(v=s.onRecoverableError),s.formState!==void 0&&(T=s.formState)),t=Pp(e,1,!0,t,s??null,r,c,T,d,m,v,Zp),t.context=$p(null),s=t.current,r=Bt(),r=Kl(r),c=Xn(r),c.callback=null,Qn(s,c,r),s=r,t.current.lanes=s,Ks(t,s),fn(t),e[Va]=t.current,Bc(e),new vl(t)},Mi.version="19.2.3",Mi}var u0;function vv(){if(u0)return lu.exports;u0=1;function a(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(a)}catch(n){console.error(n)}}return a(),lu.exports=yv(),lu.exports}var xv=vv();const _v=Xm(xv);function Bl(a,n){var i={};for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&n.indexOf(l)<0&&(i[l]=a[l]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,l=Object.getOwnPropertySymbols(a);u<l.length;u++)n.indexOf(l[u])<0&&Object.prototype.propertyIsEnumerable.call(a,l[u])&&(i[l[u]]=a[l[u]]);return i}function wv(a,n,i,l){function u(h){return h instanceof i?h:new i(function(f){f(h)})}return new(i||(i=Promise))(function(h,f){function g(x){try{b(l.next(x))}catch(y){f(y)}}function p(x){try{b(l.throw(x))}catch(y){f(y)}}function b(x){x.done?h(x.value):u(x.value).then(g,p)}b((l=l.apply(a,n||[])).next())})}const Ev=a=>a?(...n)=>a(...n):(...n)=>fetch(...n);class Yu extends Error{constructor(n,i="FunctionsError",l){super(n),this.name=i,this.context=l}}class Nv extends Yu{constructor(n){super("Failed to send a request to the Edge Function","FunctionsFetchError",n)}}class d0 extends Yu{constructor(n){super("Relay Error invoking the Edge Function","FunctionsRelayError",n)}}class h0 extends Yu{constructor(n){super("Edge Function returned a non-2xx status code","FunctionsHttpError",n)}}var Tu;(function(a){a.Any="any",a.ApNortheast1="ap-northeast-1",a.ApNortheast2="ap-northeast-2",a.ApSouth1="ap-south-1",a.ApSoutheast1="ap-southeast-1",a.ApSoutheast2="ap-southeast-2",a.CaCentral1="ca-central-1",a.EuCentral1="eu-central-1",a.EuWest1="eu-west-1",a.EuWest2="eu-west-2",a.EuWest3="eu-west-3",a.SaEast1="sa-east-1",a.UsEast1="us-east-1",a.UsWest1="us-west-1",a.UsWest2="us-west-2"})(Tu||(Tu={}));class Sv{constructor(n,{headers:i={},customFetch:l,region:u=Tu.Any}={}){this.url=n,this.headers=i,this.region=u,this.fetch=Ev(l)}setAuth(n){this.headers.Authorization=`Bearer ${n}`}invoke(n){return wv(this,arguments,void 0,function*(i,l={}){var u;let h,f;try{const{headers:g,method:p,body:b,signal:x,timeout:y}=l;let E={},{region:_}=l;_||(_=this.region);const w=new URL(`${this.url}/${i}`);_&&_!=="any"&&(E["x-region"]=_,w.searchParams.set("forceFunctionRegion",_));let S;b&&(g&&!Object.prototype.hasOwnProperty.call(g,"Content-Type")||!g)?typeof Blob<"u"&&b instanceof Blob||b instanceof ArrayBuffer?(E["Content-Type"]="application/octet-stream",S=b):typeof b=="string"?(E["Content-Type"]="text/plain",S=b):typeof FormData<"u"&&b instanceof FormData?S=b:(E["Content-Type"]="application/json",S=JSON.stringify(b)):S=b;let N=x;y&&(f=new AbortController,h=setTimeout(()=>f.abort(),y),x?(N=f.signal,x.addEventListener("abort",()=>f.abort())):N=f.signal);const k=yield this.fetch(w.toString(),{method:p||"POST",headers:Object.assign(Object.assign(Object.assign({},E),this.headers),g),body:S,signal:N}).catch(ee=>{throw new Nv(ee)}),K=k.headers.get("x-relay-error");if(K&&K==="true")throw new d0(k);if(!k.ok)throw new h0(k);let H=((u=k.headers.get("Content-Type"))!==null&&u!==void 0?u:"text/plain").split(";")[0].trim(),P;return H==="application/json"?P=yield k.json():H==="application/octet-stream"||H==="application/pdf"?P=yield k.blob():H==="text/event-stream"?P=k:H==="multipart/form-data"?P=yield k.formData():P=yield k.text(),{data:P,error:null,response:k}}catch(g){return{data:null,error:g,response:g instanceof h0||g instanceof d0?g.context:void 0}}finally{h&&clearTimeout(h)}})}}var Tv=class extends Error{constructor(a){super(a.message),this.name="PostgrestError",this.details=a.details,this.hint=a.hint,this.code=a.code}},Av=class{constructor(a){var n,i;this.shouldThrowOnError=!1,this.method=a.method,this.url=a.url,this.headers=new Headers(a.headers),this.schema=a.schema,this.body=a.body,this.shouldThrowOnError=(n=a.shouldThrowOnError)!==null&&n!==void 0?n:!1,this.signal=a.signal,this.isMaybeSingle=(i=a.isMaybeSingle)!==null&&i!==void 0?i:!1,a.fetch?this.fetch=a.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(a,n){return this.headers=new Headers(this.headers),this.headers.set(a,n),this}then(a,n){var i=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const l=this.fetch;let u=l(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async h=>{let f=null,g=null,p=null,b=h.status,x=h.statusText;if(h.ok){var y,E;if(i.method!=="HEAD"){var _;const k=await h.text();k===""||(i.headers.get("Accept")==="text/csv"||i.headers.get("Accept")&&(!((_=i.headers.get("Accept"))===null||_===void 0)&&_.includes("application/vnd.pgrst.plan+text"))?g=k:g=JSON.parse(k))}const S=(y=i.headers.get("Prefer"))===null||y===void 0?void 0:y.match(/count=(exact|planned|estimated)/),N=(E=h.headers.get("content-range"))===null||E===void 0?void 0:E.split("/");S&&N&&N.length>1&&(p=parseInt(N[1])),i.isMaybeSingle&&i.method==="GET"&&Array.isArray(g)&&(g.length>1?(f={code:"PGRST116",details:`Results contain ${g.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},g=null,p=null,b=406,x="Not Acceptable"):g.length===1?g=g[0]:g=null)}else{var w;const S=await h.text();try{f=JSON.parse(S),Array.isArray(f)&&h.status===404&&(g=[],f=null,b=200,x="OK")}catch{h.status===404&&S===""?(b=204,x="No Content"):f={message:S}}if(f&&i.isMaybeSingle&&(!(f==null||(w=f.details)===null||w===void 0)&&w.includes("0 rows"))&&(f=null,b=200,x="OK"),f&&i.shouldThrowOnError)throw new Tv(f)}return{error:f,data:g,count:p,status:b,statusText:x}});return this.shouldThrowOnError||(u=u.catch(h=>{var f;let g="";const p=h==null?void 0:h.cause;if(p){var b,x,y,E;const w=(b=p==null?void 0:p.message)!==null&&b!==void 0?b:"",S=(x=p==null?void 0:p.code)!==null&&x!==void 0?x:"";g=`${(y=h==null?void 0:h.name)!==null&&y!==void 0?y:"FetchError"}: ${h==null?void 0:h.message}`,g+=`

Caused by: ${(E=p==null?void 0:p.name)!==null&&E!==void 0?E:"Error"}: ${w}`,S&&(g+=` (${S})`),p!=null&&p.stack&&(g+=`
${p.stack}`)}else{var _;g=(_=h==null?void 0:h.stack)!==null&&_!==void 0?_:""}return{error:{message:`${(f=h==null?void 0:h.name)!==null&&f!==void 0?f:"FetchError"}: ${h==null?void 0:h.message}`,details:g,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),u.then(a,n)}returns(){return this}overrideTypes(){return this}},Ov=class extends Av{select(a){let n=!1;const i=(a??"*").split("").map(l=>/\s/.test(l)&&!n?"":(l==='"'&&(n=!n),l)).join("");return this.url.searchParams.set("select",i),this.headers.append("Prefer","return=representation"),this}order(a,{ascending:n=!0,nullsFirst:i,foreignTable:l,referencedTable:u=l}={}){const h=u?`${u}.order`:"order",f=this.url.searchParams.get(h);return this.url.searchParams.set(h,`${f?`${f},`:""}${a}.${n?"asc":"desc"}${i===void 0?"":i?".nullsfirst":".nullslast"}`),this}limit(a,{foreignTable:n,referencedTable:i=n}={}){const l=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(l,`${a}`),this}range(a,n,{foreignTable:i,referencedTable:l=i}={}){const u=typeof l>"u"?"offset":`${l}.offset`,h=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(u,`${a}`),this.url.searchParams.set(h,`${n-a+1}`),this}abortSignal(a){return this.signal=a,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:a=!1,verbose:n=!1,settings:i=!1,buffers:l=!1,wal:u=!1,format:h="text"}={}){var f;const g=[a?"analyze":null,n?"verbose":null,i?"settings":null,l?"buffers":null,u?"wal":null].filter(Boolean).join("|"),p=(f=this.headers.get("Accept"))!==null&&f!==void 0?f:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${h}; for="${p}"; options=${g};`),h==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(a){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${a}`),this}};const f0=new RegExp("[,()]");var Us=class extends Ov{eq(a,n){return this.url.searchParams.append(a,`eq.${n}`),this}neq(a,n){return this.url.searchParams.append(a,`neq.${n}`),this}gt(a,n){return this.url.searchParams.append(a,`gt.${n}`),this}gte(a,n){return this.url.searchParams.append(a,`gte.${n}`),this}lt(a,n){return this.url.searchParams.append(a,`lt.${n}`),this}lte(a,n){return this.url.searchParams.append(a,`lte.${n}`),this}like(a,n){return this.url.searchParams.append(a,`like.${n}`),this}likeAllOf(a,n){return this.url.searchParams.append(a,`like(all).{${n.join(",")}}`),this}likeAnyOf(a,n){return this.url.searchParams.append(a,`like(any).{${n.join(",")}}`),this}ilike(a,n){return this.url.searchParams.append(a,`ilike.${n}`),this}ilikeAllOf(a,n){return this.url.searchParams.append(a,`ilike(all).{${n.join(",")}}`),this}ilikeAnyOf(a,n){return this.url.searchParams.append(a,`ilike(any).{${n.join(",")}}`),this}regexMatch(a,n){return this.url.searchParams.append(a,`match.${n}`),this}regexIMatch(a,n){return this.url.searchParams.append(a,`imatch.${n}`),this}is(a,n){return this.url.searchParams.append(a,`is.${n}`),this}isDistinct(a,n){return this.url.searchParams.append(a,`isdistinct.${n}`),this}in(a,n){const i=Array.from(new Set(n)).map(l=>typeof l=="string"&&f0.test(l)?`"${l}"`:`${l}`).join(",");return this.url.searchParams.append(a,`in.(${i})`),this}notIn(a,n){const i=Array.from(new Set(n)).map(l=>typeof l=="string"&&f0.test(l)?`"${l}"`:`${l}`).join(",");return this.url.searchParams.append(a,`not.in.(${i})`),this}contains(a,n){return typeof n=="string"?this.url.searchParams.append(a,`cs.${n}`):Array.isArray(n)?this.url.searchParams.append(a,`cs.{${n.join(",")}}`):this.url.searchParams.append(a,`cs.${JSON.stringify(n)}`),this}containedBy(a,n){return typeof n=="string"?this.url.searchParams.append(a,`cd.${n}`):Array.isArray(n)?this.url.searchParams.append(a,`cd.{${n.join(",")}}`):this.url.searchParams.append(a,`cd.${JSON.stringify(n)}`),this}rangeGt(a,n){return this.url.searchParams.append(a,`sr.${n}`),this}rangeGte(a,n){return this.url.searchParams.append(a,`nxl.${n}`),this}rangeLt(a,n){return this.url.searchParams.append(a,`sl.${n}`),this}rangeLte(a,n){return this.url.searchParams.append(a,`nxr.${n}`),this}rangeAdjacent(a,n){return this.url.searchParams.append(a,`adj.${n}`),this}overlaps(a,n){return typeof n=="string"?this.url.searchParams.append(a,`ov.${n}`):this.url.searchParams.append(a,`ov.{${n.join(",")}}`),this}textSearch(a,n,{config:i,type:l}={}){let u="";l==="plain"?u="pl":l==="phrase"?u="ph":l==="websearch"&&(u="w");const h=i===void 0?"":`(${i})`;return this.url.searchParams.append(a,`${u}fts${h}.${n}`),this}match(a){return Object.entries(a).forEach(([n,i])=>{this.url.searchParams.append(n,`eq.${i}`)}),this}not(a,n,i){return this.url.searchParams.append(a,`not.${n}.${i}`),this}or(a,{foreignTable:n,referencedTable:i=n}={}){const l=i?`${i}.or`:"or";return this.url.searchParams.append(l,`(${a})`),this}filter(a,n,i){return this.url.searchParams.append(a,`${n}.${i}`),this}},jv=class{constructor(a,{headers:n={},schema:i,fetch:l}){this.url=a,this.headers=new Headers(n),this.schema=i,this.fetch=l}select(a,n){const{head:i=!1,count:l}=n??{},u=i?"HEAD":"GET";let h=!1;const f=(a??"*").split("").map(g=>/\s/.test(g)&&!h?"":(g==='"'&&(h=!h),g)).join("");return this.url.searchParams.set("select",f),l&&this.headers.append("Prefer",`count=${l}`),new Us({method:u,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(a,{count:n,defaultToNull:i=!0}={}){var l;const u="POST";if(n&&this.headers.append("Prefer",`count=${n}`),i||this.headers.append("Prefer","missing=default"),Array.isArray(a)){const h=a.reduce((f,g)=>f.concat(Object.keys(g)),[]);if(h.length>0){const f=[...new Set(h)].map(g=>`"${g}"`);this.url.searchParams.set("columns",f.join(","))}}return new Us({method:u,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}upsert(a,{onConflict:n,ignoreDuplicates:i=!1,count:l,defaultToNull:u=!0}={}){var h;const f="POST";if(this.headers.append("Prefer",`resolution=${i?"ignore":"merge"}-duplicates`),n!==void 0&&this.url.searchParams.set("on_conflict",n),l&&this.headers.append("Prefer",`count=${l}`),u||this.headers.append("Prefer","missing=default"),Array.isArray(a)){const g=a.reduce((p,b)=>p.concat(Object.keys(b)),[]);if(g.length>0){const p=[...new Set(g)].map(b=>`"${b}"`);this.url.searchParams.set("columns",p.join(","))}}return new Us({method:f,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(h=this.fetch)!==null&&h!==void 0?h:fetch})}update(a,{count:n}={}){var i;const l="PATCH";return n&&this.headers.append("Prefer",`count=${n}`),new Us({method:l,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}delete({count:a}={}){var n;const i="DELETE";return a&&this.headers.append("Prefer",`count=${a}`),new Us({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}},Rv=class Qm{constructor(n,{headers:i={},schema:l,fetch:u}={}){this.url=n,this.headers=new Headers(i),this.schemaName=l,this.fetch=u}from(n){if(!n||typeof n!="string"||n.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new jv(new URL(`${this.url}/${n}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(n){return new Qm(this.url,{headers:this.headers,schema:n,fetch:this.fetch})}rpc(n,i={},{head:l=!1,get:u=!1,count:h}={}){var f;let g;const p=new URL(`${this.url}/rpc/${n}`);let b;l||u?(g=l?"HEAD":"GET",Object.entries(i).filter(([y,E])=>E!==void 0).map(([y,E])=>[y,Array.isArray(E)?`{${E.join(",")}}`:`${E}`]).forEach(([y,E])=>{p.searchParams.append(y,E)})):(g="POST",b=i);const x=new Headers(this.headers);return h&&x.set("Prefer",`count=${h}`),new Us({method:g,url:p,headers:x,schema:this.schemaName,body:b,fetch:(f=this.fetch)!==null&&f!==void 0?f:fetch})}};class Cv{constructor(){}static detectEnvironment(){var n;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((n=navigator.userAgent)===null||n===void 0)&&n.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const i=process.versions;if(i&&i.node){const l=i.node,u=parseInt(l.replace(/^v/,"").split(".")[0]);return u>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${u} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${u} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const n=this.detectEnvironment();if(n.constructor)return n.constructor;let i=n.error||"WebSocket not supported in this environment.";throw n.workaround&&(i+=`

Suggested solution: ${n.workaround}`),new Error(i)}static createWebSocket(n,i){const l=this.getWebSocketConstructor();return new l(n,i)}static isWebSocketSupported(){try{const n=this.detectEnvironment();return n.type==="native"||n.type==="ws"}catch{return!1}}}const Iv="2.89.0",Dv=`realtime-js/${Iv}`,Wm="1.0.0",Uv="2.0.0",p0=Wm,Au=1e4,zv=1e3,kv=100;var fa;(function(a){a[a.connecting=0]="connecting",a[a.open=1]="open",a[a.closing=2]="closing",a[a.closed=3]="closed"})(fa||(fa={}));var rt;(function(a){a.closed="closed",a.errored="errored",a.joined="joined",a.joining="joining",a.leaving="leaving"})(rt||(rt={}));var ln;(function(a){a.close="phx_close",a.error="phx_error",a.join="phx_join",a.reply="phx_reply",a.leave="phx_leave",a.access_token="access_token"})(ln||(ln={}));var Ou;(function(a){a.websocket="websocket"})(Ou||(Ou={}));var Ma;(function(a){a.Connecting="connecting",a.Open="open",a.Closing="closing",a.Closed="closed"})(Ma||(Ma={}));class Lv{constructor(n){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=n??[]}encode(n,i){if(n.event===this.BROADCAST_EVENT&&!(n.payload instanceof ArrayBuffer)&&typeof n.payload.event=="string")return i(this._binaryEncodeUserBroadcastPush(n));let l=[n.join_ref,n.ref,n.topic,n.event,n.payload];return i(JSON.stringify(l))}_binaryEncodeUserBroadcastPush(n){var i;return this._isArrayBuffer((i=n.payload)===null||i===void 0?void 0:i.payload)?this._encodeBinaryUserBroadcastPush(n):this._encodeJsonUserBroadcastPush(n)}_encodeBinaryUserBroadcastPush(n){var i,l;const u=(l=(i=n.payload)===null||i===void 0?void 0:i.payload)!==null&&l!==void 0?l:new ArrayBuffer(0);return this._encodeUserBroadcastPush(n,this.BINARY_ENCODING,u)}_encodeJsonUserBroadcastPush(n){var i,l;const u=(l=(i=n.payload)===null||i===void 0?void 0:i.payload)!==null&&l!==void 0?l:{},f=new TextEncoder().encode(JSON.stringify(u)).buffer;return this._encodeUserBroadcastPush(n,this.JSON_ENCODING,f)}_encodeUserBroadcastPush(n,i,l){var u,h;const f=n.topic,g=(u=n.ref)!==null&&u!==void 0?u:"",p=(h=n.join_ref)!==null&&h!==void 0?h:"",b=n.payload.event,x=this.allowedMetadataKeys?this._pick(n.payload,this.allowedMetadataKeys):{},y=Object.keys(x).length===0?"":JSON.stringify(x);if(p.length>255)throw new Error(`joinRef length ${p.length} exceeds maximum of 255`);if(g.length>255)throw new Error(`ref length ${g.length} exceeds maximum of 255`);if(f.length>255)throw new Error(`topic length ${f.length} exceeds maximum of 255`);if(b.length>255)throw new Error(`userEvent length ${b.length} exceeds maximum of 255`);if(y.length>255)throw new Error(`metadata length ${y.length} exceeds maximum of 255`);const E=this.USER_BROADCAST_PUSH_META_LENGTH+p.length+g.length+f.length+b.length+y.length,_=new ArrayBuffer(this.HEADER_LENGTH+E);let w=new DataView(_),S=0;w.setUint8(S++,this.KINDS.userBroadcastPush),w.setUint8(S++,p.length),w.setUint8(S++,g.length),w.setUint8(S++,f.length),w.setUint8(S++,b.length),w.setUint8(S++,y.length),w.setUint8(S++,i),Array.from(p,k=>w.setUint8(S++,k.charCodeAt(0))),Array.from(g,k=>w.setUint8(S++,k.charCodeAt(0))),Array.from(f,k=>w.setUint8(S++,k.charCodeAt(0))),Array.from(b,k=>w.setUint8(S++,k.charCodeAt(0))),Array.from(y,k=>w.setUint8(S++,k.charCodeAt(0)));var N=new Uint8Array(_.byteLength+l.byteLength);return N.set(new Uint8Array(_),0),N.set(new Uint8Array(l),_.byteLength),N.buffer}decode(n,i){if(this._isArrayBuffer(n)){let l=this._binaryDecode(n);return i(l)}if(typeof n=="string"){const l=JSON.parse(n),[u,h,f,g,p]=l;return i({join_ref:u,ref:h,topic:f,event:g,payload:p})}return i({})}_binaryDecode(n){const i=new DataView(n),l=i.getUint8(0),u=new TextDecoder;switch(l){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(n,i,u)}}_decodeUserBroadcast(n,i,l){const u=i.getUint8(1),h=i.getUint8(2),f=i.getUint8(3),g=i.getUint8(4);let p=this.HEADER_LENGTH+4;const b=l.decode(n.slice(p,p+u));p=p+u;const x=l.decode(n.slice(p,p+h));p=p+h;const y=l.decode(n.slice(p,p+f));p=p+f;const E=n.slice(p,n.byteLength),_=g===this.JSON_ENCODING?JSON.parse(l.decode(E)):E,w={type:this.BROADCAST_EVENT,event:x,payload:_};return f>0&&(w.meta=JSON.parse(y)),{join_ref:null,ref:null,topic:b,event:this.BROADCAST_EVENT,payload:w}}_isArrayBuffer(n){var i;return n instanceof ArrayBuffer||((i=n==null?void 0:n.constructor)===null||i===void 0?void 0:i.name)==="ArrayBuffer"}_pick(n,i){return!n||typeof n!="object"?{}:Object.fromEntries(Object.entries(n).filter(([l])=>i.includes(l)))}}class Zm{constructor(n,i){this.callback=n,this.timerCalc=i,this.timer=void 0,this.tries=0,this.callback=n,this.timerCalc=i}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var He;(function(a){a.abstime="abstime",a.bool="bool",a.date="date",a.daterange="daterange",a.float4="float4",a.float8="float8",a.int2="int2",a.int4="int4",a.int4range="int4range",a.int8="int8",a.int8range="int8range",a.json="json",a.jsonb="jsonb",a.money="money",a.numeric="numeric",a.oid="oid",a.reltime="reltime",a.text="text",a.time="time",a.timestamp="timestamp",a.timestamptz="timestamptz",a.timetz="timetz",a.tsrange="tsrange",a.tstzrange="tstzrange"})(He||(He={}));const m0=(a,n,i={})=>{var l;const u=(l=i.skipTypes)!==null&&l!==void 0?l:[];return n?Object.keys(n).reduce((h,f)=>(h[f]=Mv(f,a,n,u),h),{}):{}},Mv=(a,n,i,l)=>{const u=n.find(g=>g.name===a),h=u==null?void 0:u.type,f=i[a];return h&&!l.includes(h)?eg(h,f):ju(f)},eg=(a,n)=>{if(a.charAt(0)==="_"){const i=a.slice(1,a.length);return Pv(n,i)}switch(a){case He.bool:return Bv(n);case He.float4:case He.float8:case He.int2:case He.int4:case He.int8:case He.numeric:case He.oid:return Hv(n);case He.json:case He.jsonb:return Gv(n);case He.timestamp:return $v(n);case He.abstime:case He.date:case He.daterange:case He.int4range:case He.int8range:case He.money:case He.reltime:case He.text:case He.time:case He.timestamptz:case He.timetz:case He.tsrange:case He.tstzrange:return ju(n);default:return ju(n)}},ju=a=>a,Bv=a=>{switch(a){case"t":return!0;case"f":return!1;default:return a}},Hv=a=>{if(typeof a=="string"){const n=parseFloat(a);if(!Number.isNaN(n))return n}return a},Gv=a=>{if(typeof a=="string")try{return JSON.parse(a)}catch{return a}return a},Pv=(a,n)=>{if(typeof a!="string")return a;const i=a.length-1,l=a[i];if(a[0]==="{"&&l==="}"){let h;const f=a.slice(1,i);try{h=JSON.parse("["+f+"]")}catch{h=f?f.split(","):[]}return h.map(g=>eg(n,g))}return a},$v=a=>typeof a=="string"?a.replace(" ","T"):a,tg=a=>{const n=new URL(a);return n.protocol=n.protocol.replace(/^ws/i,"http"),n.pathname=n.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),n.pathname===""||n.pathname==="/"?n.pathname="/api/broadcast":n.pathname=n.pathname+"/api/broadcast",n.href};class du{constructor(n,i,l={},u=Au){this.channel=n,this.event=i,this.payload=l,this.timeout=u,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(n){this.timeout=n,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(n){this.payload=Object.assign(Object.assign({},this.payload),n)}receive(n,i){var l;return this._hasReceived(n)&&i((l=this.receivedResp)===null||l===void 0?void 0:l.response),this.recHooks.push({status:n,callback:i}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const n=i=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=i,this._matchReceive(i)};this.channel._on(this.refEvent,{},n),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(n,i){this.refEvent&&this.channel._trigger(this.refEvent,{status:n,response:i})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:n,response:i}){this.recHooks.filter(l=>l.status===n).forEach(l=>l.callback(i))}_hasReceived(n){return this.receivedResp&&this.receivedResp.status===n}}var g0;(function(a){a.SYNC="sync",a.JOIN="join",a.LEAVE="leave"})(g0||(g0={}));class Vi{constructor(n,i){this.channel=n,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const l=(i==null?void 0:i.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(l.state,{},u=>{const{onJoin:h,onLeave:f,onSync:g}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Vi.syncState(this.state,u,h,f),this.pendingDiffs.forEach(p=>{this.state=Vi.syncDiff(this.state,p,h,f)}),this.pendingDiffs=[],g()}),this.channel._on(l.diff,{},u=>{const{onJoin:h,onLeave:f,onSync:g}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(u):(this.state=Vi.syncDiff(this.state,u,h,f),g())}),this.onJoin((u,h,f)=>{this.channel._trigger("presence",{event:"join",key:u,currentPresences:h,newPresences:f})}),this.onLeave((u,h,f)=>{this.channel._trigger("presence",{event:"leave",key:u,currentPresences:h,leftPresences:f})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(n,i,l,u){const h=this.cloneDeep(n),f=this.transformState(i),g={},p={};return this.map(h,(b,x)=>{f[b]||(p[b]=x)}),this.map(f,(b,x)=>{const y=h[b];if(y){const E=x.map(N=>N.presence_ref),_=y.map(N=>N.presence_ref),w=x.filter(N=>_.indexOf(N.presence_ref)<0),S=y.filter(N=>E.indexOf(N.presence_ref)<0);w.length>0&&(g[b]=w),S.length>0&&(p[b]=S)}else g[b]=x}),this.syncDiff(h,{joins:g,leaves:p},l,u)}static syncDiff(n,i,l,u){const{joins:h,leaves:f}={joins:this.transformState(i.joins),leaves:this.transformState(i.leaves)};return l||(l=()=>{}),u||(u=()=>{}),this.map(h,(g,p)=>{var b;const x=(b=n[g])!==null&&b!==void 0?b:[];if(n[g]=this.cloneDeep(p),x.length>0){const y=n[g].map(_=>_.presence_ref),E=x.filter(_=>y.indexOf(_.presence_ref)<0);n[g].unshift(...E)}l(g,x,p)}),this.map(f,(g,p)=>{let b=n[g];if(!b)return;const x=p.map(y=>y.presence_ref);b=b.filter(y=>x.indexOf(y.presence_ref)<0),n[g]=b,u(g,b,p),b.length===0&&delete n[g]}),n}static map(n,i){return Object.getOwnPropertyNames(n).map(l=>i(l,n[l]))}static transformState(n){return n=this.cloneDeep(n),Object.getOwnPropertyNames(n).reduce((i,l)=>{const u=n[l];return"metas"in u?i[l]=u.metas.map(h=>(h.presence_ref=h.phx_ref,delete h.phx_ref,delete h.phx_ref_prev,h)):i[l]=u,i},{})}static cloneDeep(n){return JSON.parse(JSON.stringify(n))}onJoin(n){this.caller.onJoin=n}onLeave(n){this.caller.onLeave=n}onSync(n){this.caller.onSync=n}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var b0;(function(a){a.ALL="*",a.INSERT="INSERT",a.UPDATE="UPDATE",a.DELETE="DELETE"})(b0||(b0={}));var Yi;(function(a){a.BROADCAST="broadcast",a.PRESENCE="presence",a.POSTGRES_CHANGES="postgres_changes",a.SYSTEM="system"})(Yi||(Yi={}));var Ln;(function(a){a.SUBSCRIBED="SUBSCRIBED",a.TIMED_OUT="TIMED_OUT",a.CLOSED="CLOSED",a.CHANNEL_ERROR="CHANNEL_ERROR"})(Ln||(Ln={}));class Ms{constructor(n,i={config:{}},l){var u,h;if(this.topic=n,this.params=i,this.socket=l,this.bindings={},this.state=rt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=n.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},i.config),this.timeout=this.socket.timeout,this.joinPush=new du(this,ln.join,this.params,this.timeout),this.rejoinTimer=new Zm(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=rt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(f=>f.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=rt.closed,this.socket._remove(this)}),this._onError(f=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,f),this.state=rt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=rt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",f=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,f),this.state=rt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(ln.reply,{},(f,g)=>{this._trigger(this._replyEventName(g),f)}),this.presence=new Vi(this),this.broadcastEndpointURL=tg(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((h=(u=this.params.config)===null||u===void 0?void 0:u.broadcast)===null||h===void 0)&&h.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(n,i=this.timeout){var l,u,h;if(this.socket.isConnected()||this.socket.connect(),this.state==rt.closed){const{config:{broadcast:f,presence:g,private:p}}=this.params,b=(u=(l=this.bindings.postgres_changes)===null||l===void 0?void 0:l.map(_=>_.filter))!==null&&u!==void 0?u:[],x=!!this.bindings[Yi.PRESENCE]&&this.bindings[Yi.PRESENCE].length>0||((h=this.params.config.presence)===null||h===void 0?void 0:h.enabled)===!0,y={},E={broadcast:f,presence:Object.assign(Object.assign({},g),{enabled:x}),postgres_changes:b,private:p};this.socket.accessTokenValue&&(y.access_token=this.socket.accessTokenValue),this._onError(_=>n==null?void 0:n(Ln.CHANNEL_ERROR,_)),this._onClose(()=>n==null?void 0:n(Ln.CLOSED)),this.updateJoinPayload(Object.assign({config:E},y)),this.joinedOnce=!0,this._rejoin(i),this.joinPush.receive("ok",async({postgres_changes:_})=>{var w;if(this.socket._isManualToken()||this.socket.setAuth(),_===void 0){n==null||n(Ln.SUBSCRIBED);return}else{const S=this.bindings.postgres_changes,N=(w=S==null?void 0:S.length)!==null&&w!==void 0?w:0,k=[];for(let K=0;K<N;K++){const H=S[K],{filter:{event:P,schema:ee,table:te,filter:W}}=H,ye=_&&_[K];if(ye&&ye.event===P&&Ms.isFilterValueEqual(ye.schema,ee)&&Ms.isFilterValueEqual(ye.table,te)&&Ms.isFilterValueEqual(ye.filter,W))k.push(Object.assign(Object.assign({},H),{id:ye.id}));else{this.unsubscribe(),this.state=rt.errored,n==null||n(Ln.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=k,n&&n(Ln.SUBSCRIBED);return}}).receive("error",_=>{this.state=rt.errored,n==null||n(Ln.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(_).join(", ")||"error")))}).receive("timeout",()=>{n==null||n(Ln.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(n,i={}){return await this.send({type:"presence",event:"track",payload:n},i.timeout||this.timeout)}async untrack(n={}){return await this.send({type:"presence",event:"untrack"},n)}on(n,i,l){return this.state===rt.joined&&n===Yi.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(n,i,l)}async httpSend(n,i,l={}){var u;if(i==null)return Promise.reject("Payload is required for httpSend()");const h={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(h.Authorization=`Bearer ${this.socket.accessTokenValue}`);const f={method:"POST",headers:h,body:JSON.stringify({messages:[{topic:this.subTopic,event:n,payload:i,private:this.private}]})},g=await this._fetchWithTimeout(this.broadcastEndpointURL,f,(u=l.timeout)!==null&&u!==void 0?u:this.timeout);if(g.status===202)return{success:!0};let p=g.statusText;try{const b=await g.json();p=b.error||b.message||p}catch{}return Promise.reject(new Error(p))}async send(n,i={}){var l,u;if(!this._canPush()&&n.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:h,payload:f}=n,g={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(g.Authorization=`Bearer ${this.socket.accessTokenValue}`);const p={method:"POST",headers:g,body:JSON.stringify({messages:[{topic:this.subTopic,event:h,payload:f,private:this.private}]})};try{const b=await this._fetchWithTimeout(this.broadcastEndpointURL,p,(l=i.timeout)!==null&&l!==void 0?l:this.timeout);return await((u=b.body)===null||u===void 0?void 0:u.cancel()),b.ok?"ok":"error"}catch(b){return b.name==="AbortError"?"timed out":"error"}}else return new Promise(h=>{var f,g,p;const b=this._push(n.type,n,i.timeout||this.timeout);n.type==="broadcast"&&!(!((p=(g=(f=this.params)===null||f===void 0?void 0:f.config)===null||g===void 0?void 0:g.broadcast)===null||p===void 0)&&p.ack)&&h("ok"),b.receive("ok",()=>h("ok")),b.receive("error",()=>h("error")),b.receive("timeout",()=>h("timed out"))})}updateJoinPayload(n){this.joinPush.updatePayload(n)}unsubscribe(n=this.timeout){this.state=rt.leaving;const i=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(ln.close,"leave",this._joinRef())};this.joinPush.destroy();let l=null;return new Promise(u=>{l=new du(this,ln.leave,{},n),l.receive("ok",()=>{i(),u("ok")}).receive("timeout",()=>{i(),u("timed out")}).receive("error",()=>{u("error")}),l.send(),this._canPush()||l.trigger("ok",{})}).finally(()=>{l==null||l.destroy()})}teardown(){this.pushBuffer.forEach(n=>n.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=rt.closed,this.bindings={}}async _fetchWithTimeout(n,i,l){const u=new AbortController,h=setTimeout(()=>u.abort(),l),f=await this.socket.fetch(n,Object.assign(Object.assign({},i),{signal:u.signal}));return clearTimeout(h),f}_push(n,i,l=this.timeout){if(!this.joinedOnce)throw`tried to push '${n}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let u=new du(this,n,i,l);return this._canPush()?u.send():this._addToPushBuffer(u),u}_addToPushBuffer(n){if(n.startTimeout(),this.pushBuffer.push(n),this.pushBuffer.length>kv){const i=this.pushBuffer.shift();i&&(i.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${i.event}`,i.payload))}}_onMessage(n,i,l){return i}_isMember(n){return this.topic===n}_joinRef(){return this.joinPush.ref}_trigger(n,i,l){var u,h;const f=n.toLocaleLowerCase(),{close:g,error:p,leave:b,join:x}=ln;if(l&&[g,p,b,x].indexOf(f)>=0&&l!==this._joinRef())return;let E=this._onMessage(f,i,l);if(i&&!E)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(f)?(u=this.bindings.postgres_changes)===null||u===void 0||u.filter(_=>{var w,S,N;return((w=_.filter)===null||w===void 0?void 0:w.event)==="*"||((N=(S=_.filter)===null||S===void 0?void 0:S.event)===null||N===void 0?void 0:N.toLocaleLowerCase())===f}).map(_=>_.callback(E,l)):(h=this.bindings[f])===null||h===void 0||h.filter(_=>{var w,S,N,k,K,H;if(["broadcast","presence","postgres_changes"].includes(f))if("id"in _){const P=_.id,ee=(w=_.filter)===null||w===void 0?void 0:w.event;return P&&((S=i.ids)===null||S===void 0?void 0:S.includes(P))&&(ee==="*"||(ee==null?void 0:ee.toLocaleLowerCase())===((N=i.data)===null||N===void 0?void 0:N.type.toLocaleLowerCase()))}else{const P=(K=(k=_==null?void 0:_.filter)===null||k===void 0?void 0:k.event)===null||K===void 0?void 0:K.toLocaleLowerCase();return P==="*"||P===((H=i==null?void 0:i.event)===null||H===void 0?void 0:H.toLocaleLowerCase())}else return _.type.toLocaleLowerCase()===f}).map(_=>{if(typeof E=="object"&&"ids"in E){const w=E.data,{schema:S,table:N,commit_timestamp:k,type:K,errors:H}=w;E=Object.assign(Object.assign({},{schema:S,table:N,commit_timestamp:k,eventType:K,new:{},old:{},errors:H}),this._getPayloadRecords(w))}_.callback(E,l)})}_isClosed(){return this.state===rt.closed}_isJoined(){return this.state===rt.joined}_isJoining(){return this.state===rt.joining}_isLeaving(){return this.state===rt.leaving}_replyEventName(n){return`chan_reply_${n}`}_on(n,i,l){const u=n.toLocaleLowerCase(),h={type:u,filter:i,callback:l};return this.bindings[u]?this.bindings[u].push(h):this.bindings[u]=[h],this}_off(n,i){const l=n.toLocaleLowerCase();return this.bindings[l]&&(this.bindings[l]=this.bindings[l].filter(u=>{var h;return!(((h=u.type)===null||h===void 0?void 0:h.toLocaleLowerCase())===l&&Ms.isEqual(u.filter,i))})),this}static isEqual(n,i){if(Object.keys(n).length!==Object.keys(i).length)return!1;for(const l in n)if(n[l]!==i[l])return!1;return!0}static isFilterValueEqual(n,i){return(n??void 0)===(i??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(n){this._on(ln.close,{},n)}_onError(n){this._on(ln.error,{},i=>n(i))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(n=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=rt.joining,this.joinPush.resend(n))}_getPayloadRecords(n){const i={new:{},old:{}};return(n.type==="INSERT"||n.type==="UPDATE")&&(i.new=m0(n.columns,n.record)),(n.type==="UPDATE"||n.type==="DELETE")&&(i.old=m0(n.columns,n.old_record)),i}}const hu=()=>{},_l={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Vv=[1e3,2e3,5e3,1e4],Yv=1e4,qv=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Kv{constructor(n,i){var l;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Au,this.transport=null,this.heartbeatIntervalMs=_l.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=hu,this.ref=0,this.reconnectTimer=null,this.vsn=p0,this.logger=hu,this.conn=null,this.sendBuffer=[],this.serializer=new Lv,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=u=>u?(...h)=>u(...h):(...h)=>fetch(...h),!(!((l=i==null?void 0:i.params)===null||l===void 0)&&l.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=i.params.apikey,this.endPoint=`${n}/${Ou.websocket}`,this.httpEndpoint=tg(n),this._initializeOptions(i),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(i==null?void 0:i.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Cv.createWebSocket(this.endpointURL())}catch(n){this._setConnectionState("disconnected");const i=n.message;throw i.includes("Node.js")?new Error(`${i}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${i}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(n,i){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const l=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(l),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(n?this.conn.close(n,i??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(n){const i=await n.unsubscribe();return this.channels.length===0&&this.disconnect(),i}async removeAllChannels(){const n=await Promise.all(this.channels.map(i=>i.unsubscribe()));return this.channels=[],this.disconnect(),n}log(n,i,l){this.logger(n,i,l)}connectionState(){switch(this.conn&&this.conn.readyState){case fa.connecting:return Ma.Connecting;case fa.open:return Ma.Open;case fa.closing:return Ma.Closing;default:return Ma.Closed}}isConnected(){return this.connectionState()===Ma.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(n,i={config:{}}){const l=`realtime:${n}`,u=this.getChannels().find(h=>h.topic===l);if(u)return u;{const h=new Ms(`realtime:${n}`,i,this);return this.channels.push(h),h}}push(n){const{topic:i,event:l,payload:u,ref:h}=n,f=()=>{this.encode(n,g=>{var p;(p=this.conn)===null||p===void 0||p.send(g)})};this.log("push",`${i} ${l} (${h})`,u),this.isConnected()?f():this.sendBuffer.push(f)}async setAuth(n=null){this._authPromise=this._performAuth(n);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var n;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(i){this.log("error","error in heartbeat callback",i)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(i){this.log("error","error in heartbeat callback",i)}this._wasManualDisconnect=!1,(n=this.conn)===null||n===void 0||n.close(zv,"heartbeat timeout"),setTimeout(()=>{var i;this.isConnected()||(i=this.reconnectTimer)===null||i===void 0||i.scheduleTimeout()},_l.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(i){this.log("error","error in heartbeat callback",i)}this._setAuthSafely("heartbeat")}onHeartbeat(n){this.heartbeatCallback=n}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(n=>n()),this.sendBuffer=[])}_makeRef(){let n=this.ref+1;return n===this.ref?this.ref=0:this.ref=n,this.ref.toString()}_leaveOpenTopic(n){let i=this.channels.find(l=>l.topic===n&&(l._isJoined()||l._isJoining()));i&&(this.log("transport",`leaving duplicate topic "${n}"`),i.unsubscribe())}_remove(n){this.channels=this.channels.filter(i=>i.topic!==n.topic)}_onConnMessage(n){this.decode(n.data,i=>{if(i.topic==="phoenix"&&i.event==="phx_reply")try{this.heartbeatCallback(i.payload.status==="ok"?"ok":"error")}catch(b){this.log("error","error in heartbeat callback",b)}i.ref&&i.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:l,event:u,payload:h,ref:f}=i,g=f?`(${f})`:"",p=h.status||"";this.log("receive",`${p} ${l} ${u} ${g}`.trim(),h),this.channels.filter(b=>b._isMember(l)).forEach(b=>b._trigger(u,h,f)),this._triggerStateCallbacks("message",i)})}_clearTimer(n){var i;n==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):n==="reconnect"&&((i=this.reconnectTimer)===null||i===void 0||i.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=n=>this._onConnError(n),this.conn.onmessage=n=>this._onConnMessage(n),this.conn.onclose=n=>this._onConnClose(n),this.conn.readyState===fa.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===fa.open||this.conn.readyState===fa.connecting)try{this.conn.close()}catch(n){this.log("error","Error closing connection",n)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(n=>n.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(i=>{this.log("error","error waiting for auth on connect",i),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const n=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(n),this.workerRef.onerror=i=>{this.log("worker","worker error",i.message),this._terminateWorker()},this.workerRef.onmessage=i=>{i.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(n){var i;this._setConnectionState("disconnected"),this.log("transport","close",n),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(i=this.reconnectTimer)===null||i===void 0||i.scheduleTimeout(),this._triggerStateCallbacks("close",n)}_onConnError(n){this._setConnectionState("disconnected"),this.log("transport",`${n}`),this._triggerChanError(),this._triggerStateCallbacks("error",n)}_triggerChanError(){this.channels.forEach(n=>n._trigger(ln.error))}_appendParams(n,i){if(Object.keys(i).length===0)return n;const l=n.match(/\?/)?"&":"?",u=new URLSearchParams(i);return`${n}${l}${u}`}_workerObjectUrl(n){let i;if(n)i=n;else{const l=new Blob([qv],{type:"application/javascript"});i=URL.createObjectURL(l)}return i}_setConnectionState(n,i=!1){this._connectionState=n,n==="connecting"?this._wasManualDisconnect=!1:n==="disconnecting"&&(this._wasManualDisconnect=i)}async _performAuth(n=null){let i,l=!1;if(n)i=n,l=!0;else if(this.accessToken)try{i=await this.accessToken()}catch(u){this.log("error","Error fetching access token from callback",u),i=this.accessTokenValue}else i=this.accessTokenValue;l?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=i&&(this.accessTokenValue=i,this.channels.forEach(u=>{const h={access_token:i,version:Dv};i&&u.updateJoinPayload(h),u.joinedOnce&&u._isJoined()&&u._push(ln.access_token,{access_token:i})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(n="general"){this._isManualToken()||this.setAuth().catch(i=>{this.log("error",`Error setting auth in ${n}`,i)})}_triggerStateCallbacks(n,i){try{this.stateChangeCallbacks[n].forEach(l=>{try{l(i)}catch(u){this.log("error",`error in ${n} callback`,u)}})}catch(l){this.log("error",`error triggering ${n} callbacks`,l)}}_setupReconnectionTimer(){this.reconnectTimer=new Zm(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},_l.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(n){var i,l,u,h,f,g,p,b,x,y,E,_;switch(this.transport=(i=n==null?void 0:n.transport)!==null&&i!==void 0?i:null,this.timeout=(l=n==null?void 0:n.timeout)!==null&&l!==void 0?l:Au,this.heartbeatIntervalMs=(u=n==null?void 0:n.heartbeatIntervalMs)!==null&&u!==void 0?u:_l.HEARTBEAT_INTERVAL,this.worker=(h=n==null?void 0:n.worker)!==null&&h!==void 0?h:!1,this.accessToken=(f=n==null?void 0:n.accessToken)!==null&&f!==void 0?f:null,this.heartbeatCallback=(g=n==null?void 0:n.heartbeatCallback)!==null&&g!==void 0?g:hu,this.vsn=(p=n==null?void 0:n.vsn)!==null&&p!==void 0?p:p0,n!=null&&n.params&&(this.params=n.params),n!=null&&n.logger&&(this.logger=n.logger),(n!=null&&n.logLevel||n!=null&&n.log_level)&&(this.logLevel=n.logLevel||n.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(b=n==null?void 0:n.reconnectAfterMs)!==null&&b!==void 0?b:(w=>Vv[w-1]||Yv),this.vsn){case Wm:this.encode=(x=n==null?void 0:n.encode)!==null&&x!==void 0?x:((w,S)=>S(JSON.stringify(w))),this.decode=(y=n==null?void 0:n.decode)!==null&&y!==void 0?y:((w,S)=>S(JSON.parse(w)));break;case Uv:this.encode=(E=n==null?void 0:n.encode)!==null&&E!==void 0?E:this.serializer.encode.bind(this.serializer),this.decode=(_=n==null?void 0:n.decode)!==null&&_!==void 0?_:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=n==null?void 0:n.workerUrl}}}var Fi=class extends Error{constructor(a,n){var i;super(a),this.name="IcebergError",this.status=n.status,this.icebergType=n.icebergType,this.icebergCode=n.icebergCode,this.details=n.details,this.isCommitStateUnknown=n.icebergType==="CommitStateUnknownException"||[500,502,504].includes(n.status)&&((i=n.icebergType)==null?void 0:i.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function Fv(a,n,i){const l=new URL(n,a);if(i)for(const[u,h]of Object.entries(i))h!==void 0&&l.searchParams.set(u,h);return l.toString()}async function Jv(a){return!a||a.type==="none"?{}:a.type==="bearer"?{Authorization:`Bearer ${a.token}`}:a.type==="header"?{[a.name]:a.value}:a.type==="custom"?await a.getHeaders():{}}function Xv(a){const n=a.fetchImpl??globalThis.fetch;return{async request({method:i,path:l,query:u,body:h,headers:f}){const g=Fv(a.baseUrl,l,u),p=await Jv(a.auth),b=await n(g,{method:i,headers:{...h?{"Content-Type":"application/json"}:{},...p,...f},body:h?JSON.stringify(h):void 0}),x=await b.text(),y=(b.headers.get("content-type")||"").includes("application/json"),E=y&&x?JSON.parse(x):x;if(!b.ok){const _=y?E:void 0,w=_==null?void 0:_.error;throw new Fi((w==null?void 0:w.message)??`Request failed with status ${b.status}`,{status:b.status,icebergType:w==null?void 0:w.type,icebergCode:w==null?void 0:w.code,details:_})}return{status:b.status,headers:b.headers,data:E}}}}function wl(a){return a.join("")}var Qv=class{constructor(a,n=""){this.client=a,this.prefix=n}async listNamespaces(a){const n=a?{parent:wl(a.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:n})).data.namespaces.map(l=>({namespace:l}))}async createNamespace(a,n){const i={namespace:a.namespace,properties:n==null?void 0:n.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:i})).data}async dropNamespace(a){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${wl(a.namespace)}`})}async loadNamespaceMetadata(a){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${wl(a.namespace)}`})).data.properties}}async namespaceExists(a){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${wl(a.namespace)}`}),!0}catch(n){if(n instanceof Fi&&n.status===404)return!1;throw n}}async createNamespaceIfNotExists(a,n){try{return await this.createNamespace(a,n)}catch(i){if(i instanceof Fi&&i.status===409)return;throw i}}};function Os(a){return a.join("")}var Wv=class{constructor(a,n="",i){this.client=a,this.prefix=n,this.accessDelegation=i}async listTables(a){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Os(a.namespace)}/tables`})).data.identifiers}async createTable(a,n){const i={};return this.accessDelegation&&(i["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Os(a.namespace)}/tables`,body:n,headers:i})).data.metadata}async updateTable(a,n){const i=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Os(a.namespace)}/tables/${a.name}`,body:n});return{"metadata-location":i.data["metadata-location"],metadata:i.data.metadata}}async dropTable(a,n){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Os(a.namespace)}/tables/${a.name}`,query:{purgeRequested:String((n==null?void 0:n.purge)??!1)}})}async loadTable(a){const n={};return this.accessDelegation&&(n["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Os(a.namespace)}/tables/${a.name}`,headers:n})).data.metadata}async tableExists(a){const n={};this.accessDelegation&&(n["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Os(a.namespace)}/tables/${a.name}`,headers:n}),!0}catch(i){if(i instanceof Fi&&i.status===404)return!1;throw i}}async createTableIfNotExists(a,n){try{return await this.createTable(a,n)}catch(i){if(i instanceof Fi&&i.status===409)return await this.loadTable({namespace:a.namespace,name:n.name});throw i}}},Zv=class{constructor(a){var l;let n="v1";a.catalogName&&(n+=`/${a.catalogName}`);const i=a.baseUrl.endsWith("/")?a.baseUrl:`${a.baseUrl}/`;this.client=Xv({baseUrl:i,auth:a.auth,fetchImpl:a.fetch}),this.accessDelegation=(l=a.accessDelegation)==null?void 0:l.join(","),this.namespaceOps=new Qv(this.client,n),this.tableOps=new Wv(this.client,n,this.accessDelegation)}async listNamespaces(a){return this.namespaceOps.listNamespaces(a)}async createNamespace(a,n){return this.namespaceOps.createNamespace(a,n)}async dropNamespace(a){await this.namespaceOps.dropNamespace(a)}async loadNamespaceMetadata(a){return this.namespaceOps.loadNamespaceMetadata(a)}async listTables(a){return this.tableOps.listTables(a)}async createTable(a,n){return this.tableOps.createTable(a,n)}async updateTable(a,n){return this.tableOps.updateTable(a,n)}async dropTable(a,n){await this.tableOps.dropTable(a,n)}async loadTable(a){return this.tableOps.loadTable(a)}async namespaceExists(a){return this.namespaceOps.namespaceExists(a)}async tableExists(a){return this.tableOps.tableExists(a)}async createNamespaceIfNotExists(a,n){return this.namespaceOps.createNamespaceIfNotExists(a,n)}async createTableIfNotExists(a,n){return this.tableOps.createTableIfNotExists(a,n)}},Hl=class extends Error{constructor(a){super(a),this.__isStorageError=!0,this.name="StorageError"}};function Ye(a){return typeof a=="object"&&a!==null&&"__isStorageError"in a}var ex=class extends Hl{constructor(a,n,i){super(a),this.name="StorageApiError",this.status=n,this.statusCode=i}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Ru=class extends Hl{constructor(a,n){super(a),this.name="StorageUnknownError",this.originalError=n}};const qu=a=>a?(...n)=>a(...n):(...n)=>fetch(...n),tx=()=>Response,Cu=a=>{if(Array.isArray(a))return a.map(i=>Cu(i));if(typeof a=="function"||a!==Object(a))return a;const n={};return Object.entries(a).forEach(([i,l])=>{const u=i.replace(/([-_][a-z])/gi,h=>h.toUpperCase().replace(/[-_]/g,""));n[u]=Cu(l)}),n},nx=a=>{if(typeof a!="object"||a===null)return!1;const n=Object.getPrototypeOf(a);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in a)&&!(Symbol.iterator in a)},ax=a=>!a||typeof a!="string"||a.length===0||a.length>100||a.trim()!==a||a.includes("/")||a.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(a);function Ji(a){"@babel/helpers - typeof";return Ji=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Ji(a)}function sx(a,n){if(Ji(a)!="object"||!a)return a;var i=a[Symbol.toPrimitive];if(i!==void 0){var l=i.call(a,n);if(Ji(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(a)}function ix(a){var n=sx(a,"string");return Ji(n)=="symbol"?n:n+""}function rx(a,n,i){return(n=ix(n))in a?Object.defineProperty(a,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):a[n]=i,a}function y0(a,n){var i=Object.keys(a);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(a);n&&(l=l.filter(function(u){return Object.getOwnPropertyDescriptor(a,u).enumerable})),i.push.apply(i,l)}return i}function fe(a){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?y0(Object(i),!0).forEach(function(l){rx(a,l,i[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(i)):y0(Object(i)).forEach(function(l){Object.defineProperty(a,l,Object.getOwnPropertyDescriptor(i,l))})}return a}const fu=a=>{var n;return a.msg||a.message||a.error_description||(typeof a.error=="string"?a.error:(n=a.error)===null||n===void 0?void 0:n.message)||JSON.stringify(a)},lx=async(a,n,i)=>{a instanceof await tx()&&!(i!=null&&i.noResolveJson)?a.json().then(l=>{const u=a.status||500,h=(l==null?void 0:l.statusCode)||u+"";n(new ex(fu(l),u,h))}).catch(l=>{n(new Ru(fu(l),l))}):n(new Ru(fu(a),a))},ox=(a,n,i,l)=>{const u={method:a,headers:(n==null?void 0:n.headers)||{}};return a==="GET"||!l?u:(nx(l)?(u.headers=fe({"Content-Type":"application/json"},n==null?void 0:n.headers),u.body=JSON.stringify(l)):u.body=l,n!=null&&n.duplex&&(u.duplex=n.duplex),fe(fe({},u),i))};async function nr(a,n,i,l,u,h){return new Promise((f,g)=>{a(i,ox(n,l,u,h)).then(p=>{if(!p.ok)throw p;return l!=null&&l.noResolveJson?p:p.json()}).then(p=>f(p)).catch(p=>lx(p,g,l))})}async function Xi(a,n,i,l){return nr(a,"GET",n,i,l)}async function rn(a,n,i,l,u){return nr(a,"POST",n,l,u,i)}async function Iu(a,n,i,l,u){return nr(a,"PUT",n,l,u,i)}async function cx(a,n,i,l){return nr(a,"HEAD",n,fe(fe({},i),{},{noResolveJson:!0}),l)}async function Ku(a,n,i,l,u){return nr(a,"DELETE",n,l,u,i)}var ux=class{constructor(a,n){this.downloadFn=a,this.shouldThrowOnError=n}then(a,n){return this.execute().then(a,n)}async execute(){var a=this;try{return{data:(await a.downloadFn()).body,error:null}}catch(n){if(a.shouldThrowOnError)throw n;if(Ye(n))return{data:null,error:n};throw n}}};let ng;ng=Symbol.toStringTag;var dx=class{constructor(a,n){this.downloadFn=a,this.shouldThrowOnError=n,this[ng]="BlobDownloadBuilder",this.promise=null}asStream(){return new ux(this.downloadFn,this.shouldThrowOnError)}then(a,n){return this.getPromise().then(a,n)}catch(a){return this.getPromise().catch(a)}finally(a){return this.getPromise().finally(a)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var a=this;try{return{data:await(await a.downloadFn()).blob(),error:null}}catch(n){if(a.shouldThrowOnError)throw n;if(Ye(n))return{data:null,error:n};throw n}}};const hx={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},v0={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var fx=class{constructor(a,n={},i,l){this.shouldThrowOnError=!1,this.url=a,this.headers=n,this.bucketId=i,this.fetch=qu(l)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(a,n,i,l){var u=this;try{let h;const f=fe(fe({},v0),l);let g=fe(fe({},u.headers),a==="POST"&&{"x-upsert":String(f.upsert)});const p=f.metadata;typeof Blob<"u"&&i instanceof Blob?(h=new FormData,h.append("cacheControl",f.cacheControl),p&&h.append("metadata",u.encodeMetadata(p)),h.append("",i)):typeof FormData<"u"&&i instanceof FormData?(h=i,h.has("cacheControl")||h.append("cacheControl",f.cacheControl),p&&!h.has("metadata")&&h.append("metadata",u.encodeMetadata(p))):(h=i,g["cache-control"]=`max-age=${f.cacheControl}`,g["content-type"]=f.contentType,p&&(g["x-metadata"]=u.toBase64(u.encodeMetadata(p))),(typeof ReadableStream<"u"&&h instanceof ReadableStream||h&&typeof h=="object"&&"pipe"in h&&typeof h.pipe=="function")&&!f.duplex&&(f.duplex="half")),l!=null&&l.headers&&(g=fe(fe({},g),l.headers));const b=u._removeEmptyFolders(n),x=u._getFinalPath(b),y=await(a=="PUT"?Iu:rn)(u.fetch,`${u.url}/object/${x}`,h,fe({headers:g},f!=null&&f.duplex?{duplex:f.duplex}:{}));return{data:{path:b,id:y.Id,fullPath:y.Key},error:null}}catch(h){if(u.shouldThrowOnError)throw h;if(Ye(h))return{data:null,error:h};throw h}}async upload(a,n,i){return this.uploadOrUpdate("POST",a,n,i)}async uploadToSignedUrl(a,n,i,l){var u=this;const h=u._removeEmptyFolders(a),f=u._getFinalPath(h),g=new URL(u.url+`/object/upload/sign/${f}`);g.searchParams.set("token",n);try{let p;const b=fe({upsert:v0.upsert},l),x=fe(fe({},u.headers),{"x-upsert":String(b.upsert)});return typeof Blob<"u"&&i instanceof Blob?(p=new FormData,p.append("cacheControl",b.cacheControl),p.append("",i)):typeof FormData<"u"&&i instanceof FormData?(p=i,p.append("cacheControl",b.cacheControl)):(p=i,x["cache-control"]=`max-age=${b.cacheControl}`,x["content-type"]=b.contentType),{data:{path:h,fullPath:(await Iu(u.fetch,g.toString(),p,{headers:x})).Key},error:null}}catch(p){if(u.shouldThrowOnError)throw p;if(Ye(p))return{data:null,error:p};throw p}}async createSignedUploadUrl(a,n){var i=this;try{let l=i._getFinalPath(a);const u=fe({},i.headers);n!=null&&n.upsert&&(u["x-upsert"]="true");const h=await rn(i.fetch,`${i.url}/object/upload/sign/${l}`,{},{headers:u}),f=new URL(i.url+h.url),g=f.searchParams.get("token");if(!g)throw new Hl("No token returned by API");return{data:{signedUrl:f.toString(),path:a,token:g},error:null}}catch(l){if(i.shouldThrowOnError)throw l;if(Ye(l))return{data:null,error:l};throw l}}async update(a,n,i){return this.uploadOrUpdate("PUT",a,n,i)}async move(a,n,i){var l=this;try{return{data:await rn(l.fetch,`${l.url}/object/move`,{bucketId:l.bucketId,sourceKey:a,destinationKey:n,destinationBucket:i==null?void 0:i.destinationBucket},{headers:l.headers}),error:null}}catch(u){if(l.shouldThrowOnError)throw u;if(Ye(u))return{data:null,error:u};throw u}}async copy(a,n,i){var l=this;try{return{data:{path:(await rn(l.fetch,`${l.url}/object/copy`,{bucketId:l.bucketId,sourceKey:a,destinationKey:n,destinationBucket:i==null?void 0:i.destinationBucket},{headers:l.headers})).Key},error:null}}catch(u){if(l.shouldThrowOnError)throw u;if(Ye(u))return{data:null,error:u};throw u}}async createSignedUrl(a,n,i){var l=this;try{let u=l._getFinalPath(a),h=await rn(l.fetch,`${l.url}/object/sign/${u}`,fe({expiresIn:n},i!=null&&i.transform?{transform:i.transform}:{}),{headers:l.headers});const f=i!=null&&i.download?`&download=${i.download===!0?"":i.download}`:"";return h={signedUrl:encodeURI(`${l.url}${h.signedURL}${f}`)},{data:h,error:null}}catch(u){if(l.shouldThrowOnError)throw u;if(Ye(u))return{data:null,error:u};throw u}}async createSignedUrls(a,n,i){var l=this;try{const u=await rn(l.fetch,`${l.url}/object/sign/${l.bucketId}`,{expiresIn:n,paths:a},{headers:l.headers}),h=i!=null&&i.download?`&download=${i.download===!0?"":i.download}`:"";return{data:u.map(f=>fe(fe({},f),{},{signedUrl:f.signedURL?encodeURI(`${l.url}${f.signedURL}${h}`):null})),error:null}}catch(u){if(l.shouldThrowOnError)throw u;if(Ye(u))return{data:null,error:u};throw u}}download(a,n){const i=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",l=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),u=l?`?${l}`:"",h=this._getFinalPath(a),f=()=>Xi(this.fetch,`${this.url}/${i}/${h}${u}`,{headers:this.headers,noResolveJson:!0});return new dx(f,this.shouldThrowOnError)}async info(a){var n=this;const i=n._getFinalPath(a);try{return{data:Cu(await Xi(n.fetch,`${n.url}/object/info/${i}`,{headers:n.headers})),error:null}}catch(l){if(n.shouldThrowOnError)throw l;if(Ye(l))return{data:null,error:l};throw l}}async exists(a){var n=this;const i=n._getFinalPath(a);try{return await cx(n.fetch,`${n.url}/object/${i}`,{headers:n.headers}),{data:!0,error:null}}catch(l){if(n.shouldThrowOnError)throw l;if(Ye(l)&&l instanceof Ru){const u=l.originalError;if([400,404].includes(u==null?void 0:u.status))return{data:!1,error:l}}throw l}}getPublicUrl(a,n){const i=this._getFinalPath(a),l=[],u=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";u!==""&&l.push(u);const h=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",f=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});f!==""&&l.push(f);let g=l.join("&");return g!==""&&(g=`?${g}`),{data:{publicUrl:encodeURI(`${this.url}/${h}/public/${i}${g}`)}}}async remove(a){var n=this;try{return{data:await Ku(n.fetch,`${n.url}/object/${n.bucketId}`,{prefixes:a},{headers:n.headers}),error:null}}catch(i){if(n.shouldThrowOnError)throw i;if(Ye(i))return{data:null,error:i};throw i}}async list(a,n,i){var l=this;try{const u=fe(fe(fe({},hx),n),{},{prefix:a||""});return{data:await rn(l.fetch,`${l.url}/object/list/${l.bucketId}`,u,{headers:l.headers},i),error:null}}catch(u){if(l.shouldThrowOnError)throw u;if(Ye(u))return{data:null,error:u};throw u}}async listV2(a,n){var i=this;try{const l=fe({},a);return{data:await rn(i.fetch,`${i.url}/object/list-v2/${i.bucketId}`,l,{headers:i.headers},n),error:null}}catch(l){if(i.shouldThrowOnError)throw l;if(Ye(l))return{data:null,error:l};throw l}}encodeMetadata(a){return JSON.stringify(a)}toBase64(a){return typeof Buffer<"u"?Buffer.from(a).toString("base64"):btoa(a)}_getFinalPath(a){return`${this.bucketId}/${a.replace(/^\/+/,"")}`}_removeEmptyFolders(a){return a.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(a){const n=[];return a.width&&n.push(`width=${a.width}`),a.height&&n.push(`height=${a.height}`),a.resize&&n.push(`resize=${a.resize}`),a.format&&n.push(`format=${a.format}`),a.quality&&n.push(`quality=${a.quality}`),n.join("&")}};const ag="2.89.0",sg={"X-Client-Info":`storage-js/${ag}`};var px=class{constructor(a,n={},i,l){this.shouldThrowOnError=!1;const u=new URL(a);l!=null&&l.useNewHostname&&/supabase\.(co|in|red)$/.test(u.hostname)&&!u.hostname.includes("storage.supabase.")&&(u.hostname=u.hostname.replace("supabase.","storage.supabase.")),this.url=u.href.replace(/\/$/,""),this.headers=fe(fe({},sg),n),this.fetch=qu(i)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(a){var n=this;try{const i=n.listBucketOptionsToQueryString(a);return{data:await Xi(n.fetch,`${n.url}/bucket${i}`,{headers:n.headers}),error:null}}catch(i){if(n.shouldThrowOnError)throw i;if(Ye(i))return{data:null,error:i};throw i}}async getBucket(a){var n=this;try{return{data:await Xi(n.fetch,`${n.url}/bucket/${a}`,{headers:n.headers}),error:null}}catch(i){if(n.shouldThrowOnError)throw i;if(Ye(i))return{data:null,error:i};throw i}}async createBucket(a,n={public:!1}){var i=this;try{return{data:await rn(i.fetch,`${i.url}/bucket`,{id:a,name:a,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:i.headers}),error:null}}catch(l){if(i.shouldThrowOnError)throw l;if(Ye(l))return{data:null,error:l};throw l}}async updateBucket(a,n){var i=this;try{return{data:await Iu(i.fetch,`${i.url}/bucket/${a}`,{id:a,name:a,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:i.headers}),error:null}}catch(l){if(i.shouldThrowOnError)throw l;if(Ye(l))return{data:null,error:l};throw l}}async emptyBucket(a){var n=this;try{return{data:await rn(n.fetch,`${n.url}/bucket/${a}/empty`,{},{headers:n.headers}),error:null}}catch(i){if(n.shouldThrowOnError)throw i;if(Ye(i))return{data:null,error:i};throw i}}async deleteBucket(a){var n=this;try{return{data:await Ku(n.fetch,`${n.url}/bucket/${a}`,{},{headers:n.headers}),error:null}}catch(i){if(n.shouldThrowOnError)throw i;if(Ye(i))return{data:null,error:i};throw i}}listBucketOptionsToQueryString(a){const n={};return a&&("limit"in a&&(n.limit=String(a.limit)),"offset"in a&&(n.offset=String(a.offset)),a.search&&(n.search=a.search),a.sortColumn&&(n.sortColumn=a.sortColumn),a.sortOrder&&(n.sortOrder=a.sortOrder)),Object.keys(n).length>0?"?"+new URLSearchParams(n).toString():""}},mx=class{constructor(a,n={},i){this.shouldThrowOnError=!1,this.url=a.replace(/\/$/,""),this.headers=fe(fe({},sg),n),this.fetch=qu(i)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(a){var n=this;try{return{data:await rn(n.fetch,`${n.url}/bucket`,{name:a},{headers:n.headers}),error:null}}catch(i){if(n.shouldThrowOnError)throw i;if(Ye(i))return{data:null,error:i};throw i}}async listBuckets(a){var n=this;try{const i=new URLSearchParams;(a==null?void 0:a.limit)!==void 0&&i.set("limit",a.limit.toString()),(a==null?void 0:a.offset)!==void 0&&i.set("offset",a.offset.toString()),a!=null&&a.sortColumn&&i.set("sortColumn",a.sortColumn),a!=null&&a.sortOrder&&i.set("sortOrder",a.sortOrder),a!=null&&a.search&&i.set("search",a.search);const l=i.toString(),u=l?`${n.url}/bucket?${l}`:`${n.url}/bucket`;return{data:await Xi(n.fetch,u,{headers:n.headers}),error:null}}catch(i){if(n.shouldThrowOnError)throw i;if(Ye(i))return{data:null,error:i};throw i}}async deleteBucket(a){var n=this;try{return{data:await Ku(n.fetch,`${n.url}/bucket/${a}`,{},{headers:n.headers}),error:null}}catch(i){if(n.shouldThrowOnError)throw i;if(Ye(i))return{data:null,error:i};throw i}}from(a){var n=this;if(!ax(a))throw new Hl("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const i=new Zv({baseUrl:this.url,catalogName:a,auth:{type:"custom",getHeaders:async()=>n.headers},fetch:this.fetch}),l=this.shouldThrowOnError;return new Proxy(i,{get(u,h){const f=u[h];return typeof f!="function"?f:async(...g)=>{try{return{data:await f.apply(u,g),error:null}}catch(p){if(l)throw p;return{data:null,error:p}}}}})}};const Fu={"X-Client-Info":`storage-js/${ag}`,"Content-Type":"application/json"};var ig=class extends Error{constructor(a){super(a),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function Gt(a){return typeof a=="object"&&a!==null&&"__isStorageVectorsError"in a}var pu=class extends ig{constructor(a,n,i){super(a),this.name="StorageVectorsApiError",this.status=n,this.statusCode=i}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},gx=class extends ig{constructor(a,n){super(a),this.name="StorageVectorsUnknownError",this.originalError=n}};const Ju=a=>a?(...n)=>a(...n):(...n)=>fetch(...n),bx=a=>{if(typeof a!="object"||a===null)return!1;const n=Object.getPrototypeOf(a);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in a)&&!(Symbol.iterator in a)},x0=a=>a.msg||a.message||a.error_description||a.error||JSON.stringify(a),yx=async(a,n,i)=>{if(a&&typeof a=="object"&&"status"in a&&"ok"in a&&typeof a.status=="number"&&!(i!=null&&i.noResolveJson)){const l=a.status||500,u=a;if(typeof u.json=="function")u.json().then(h=>{const f=(h==null?void 0:h.statusCode)||(h==null?void 0:h.code)||l+"";n(new pu(x0(h),l,f))}).catch(()=>{const h=l+"";n(new pu(u.statusText||`HTTP ${l} error`,l,h))});else{const h=l+"";n(new pu(u.statusText||`HTTP ${l} error`,l,h))}}else n(new gx(x0(a),a))},vx=(a,n,i,l)=>{const u={method:a,headers:(n==null?void 0:n.headers)||{}};return l?(bx(l)?(u.headers=fe({"Content-Type":"application/json"},n==null?void 0:n.headers),u.body=JSON.stringify(l)):u.body=l,fe(fe({},u),i)):u};async function xx(a,n,i,l,u,h){return new Promise((f,g)=>{a(i,vx(n,l,u,h)).then(p=>{if(!p.ok)throw p;if(l!=null&&l.noResolveJson)return p;const b=p.headers.get("content-type");return!b||!b.includes("application/json")?{}:p.json()}).then(p=>f(p)).catch(p=>yx(p,g,l))})}async function Pt(a,n,i,l,u){return xx(a,"POST",n,l,u,i)}var _x=class{constructor(a,n={},i){this.shouldThrowOnError=!1,this.url=a.replace(/\/$/,""),this.headers=fe(fe({},Fu),n),this.fetch=Ju(i)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(a){var n=this;try{return{data:await Pt(n.fetch,`${n.url}/CreateIndex`,a,{headers:n.headers})||{},error:null}}catch(i){if(n.shouldThrowOnError)throw i;if(Gt(i))return{data:null,error:i};throw i}}async getIndex(a,n){var i=this;try{return{data:await Pt(i.fetch,`${i.url}/GetIndex`,{vectorBucketName:a,indexName:n},{headers:i.headers}),error:null}}catch(l){if(i.shouldThrowOnError)throw l;if(Gt(l))return{data:null,error:l};throw l}}async listIndexes(a){var n=this;try{return{data:await Pt(n.fetch,`${n.url}/ListIndexes`,a,{headers:n.headers}),error:null}}catch(i){if(n.shouldThrowOnError)throw i;if(Gt(i))return{data:null,error:i};throw i}}async deleteIndex(a,n){var i=this;try{return{data:await Pt(i.fetch,`${i.url}/DeleteIndex`,{vectorBucketName:a,indexName:n},{headers:i.headers})||{},error:null}}catch(l){if(i.shouldThrowOnError)throw l;if(Gt(l))return{data:null,error:l};throw l}}},wx=class{constructor(a,n={},i){this.shouldThrowOnError=!1,this.url=a.replace(/\/$/,""),this.headers=fe(fe({},Fu),n),this.fetch=Ju(i)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(a){var n=this;try{if(a.vectors.length<1||a.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await Pt(n.fetch,`${n.url}/PutVectors`,a,{headers:n.headers})||{},error:null}}catch(i){if(n.shouldThrowOnError)throw i;if(Gt(i))return{data:null,error:i};throw i}}async getVectors(a){var n=this;try{return{data:await Pt(n.fetch,`${n.url}/GetVectors`,a,{headers:n.headers}),error:null}}catch(i){if(n.shouldThrowOnError)throw i;if(Gt(i))return{data:null,error:i};throw i}}async listVectors(a){var n=this;try{if(a.segmentCount!==void 0){if(a.segmentCount<1||a.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(a.segmentIndex!==void 0&&(a.segmentIndex<0||a.segmentIndex>=a.segmentCount))throw new Error(`segmentIndex must be between 0 and ${a.segmentCount-1}`)}return{data:await Pt(n.fetch,`${n.url}/ListVectors`,a,{headers:n.headers}),error:null}}catch(i){if(n.shouldThrowOnError)throw i;if(Gt(i))return{data:null,error:i};throw i}}async queryVectors(a){var n=this;try{return{data:await Pt(n.fetch,`${n.url}/QueryVectors`,a,{headers:n.headers}),error:null}}catch(i){if(n.shouldThrowOnError)throw i;if(Gt(i))return{data:null,error:i};throw i}}async deleteVectors(a){var n=this;try{if(a.keys.length<1||a.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await Pt(n.fetch,`${n.url}/DeleteVectors`,a,{headers:n.headers})||{},error:null}}catch(i){if(n.shouldThrowOnError)throw i;if(Gt(i))return{data:null,error:i};throw i}}},Ex=class{constructor(a,n={},i){this.shouldThrowOnError=!1,this.url=a.replace(/\/$/,""),this.headers=fe(fe({},Fu),n),this.fetch=Ju(i)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(a){var n=this;try{return{data:await Pt(n.fetch,`${n.url}/CreateVectorBucket`,{vectorBucketName:a},{headers:n.headers})||{},error:null}}catch(i){if(n.shouldThrowOnError)throw i;if(Gt(i))return{data:null,error:i};throw i}}async getBucket(a){var n=this;try{return{data:await Pt(n.fetch,`${n.url}/GetVectorBucket`,{vectorBucketName:a},{headers:n.headers}),error:null}}catch(i){if(n.shouldThrowOnError)throw i;if(Gt(i))return{data:null,error:i};throw i}}async listBuckets(a={}){var n=this;try{return{data:await Pt(n.fetch,`${n.url}/ListVectorBuckets`,a,{headers:n.headers}),error:null}}catch(i){if(n.shouldThrowOnError)throw i;if(Gt(i))return{data:null,error:i};throw i}}async deleteBucket(a){var n=this;try{return{data:await Pt(n.fetch,`${n.url}/DeleteVectorBucket`,{vectorBucketName:a},{headers:n.headers})||{},error:null}}catch(i){if(n.shouldThrowOnError)throw i;if(Gt(i))return{data:null,error:i};throw i}}},Nx=class extends Ex{constructor(a,n={}){super(a,n.headers||{},n.fetch)}from(a){return new Sx(this.url,this.headers,a,this.fetch)}async createBucket(a){var n=()=>super.createBucket,i=this;return n().call(i,a)}async getBucket(a){var n=()=>super.getBucket,i=this;return n().call(i,a)}async listBuckets(a={}){var n=()=>super.listBuckets,i=this;return n().call(i,a)}async deleteBucket(a){var n=()=>super.deleteBucket,i=this;return n().call(i,a)}},Sx=class extends _x{constructor(a,n,i,l){super(a,n,l),this.vectorBucketName=i}async createIndex(a){var n=()=>super.createIndex,i=this;return n().call(i,fe(fe({},a),{},{vectorBucketName:i.vectorBucketName}))}async listIndexes(a={}){var n=()=>super.listIndexes,i=this;return n().call(i,fe(fe({},a),{},{vectorBucketName:i.vectorBucketName}))}async getIndex(a){var n=()=>super.getIndex,i=this;return n().call(i,i.vectorBucketName,a)}async deleteIndex(a){var n=()=>super.deleteIndex,i=this;return n().call(i,i.vectorBucketName,a)}index(a){return new Tx(this.url,this.headers,this.vectorBucketName,a,this.fetch)}},Tx=class extends wx{constructor(a,n,i,l,u){super(a,n,u),this.vectorBucketName=i,this.indexName=l}async putVectors(a){var n=()=>super.putVectors,i=this;return n().call(i,fe(fe({},a),{},{vectorBucketName:i.vectorBucketName,indexName:i.indexName}))}async getVectors(a){var n=()=>super.getVectors,i=this;return n().call(i,fe(fe({},a),{},{vectorBucketName:i.vectorBucketName,indexName:i.indexName}))}async listVectors(a={}){var n=()=>super.listVectors,i=this;return n().call(i,fe(fe({},a),{},{vectorBucketName:i.vectorBucketName,indexName:i.indexName}))}async queryVectors(a){var n=()=>super.queryVectors,i=this;return n().call(i,fe(fe({},a),{},{vectorBucketName:i.vectorBucketName,indexName:i.indexName}))}async deleteVectors(a){var n=()=>super.deleteVectors,i=this;return n().call(i,fe(fe({},a),{},{vectorBucketName:i.vectorBucketName,indexName:i.indexName}))}},Ax=class extends px{constructor(a,n={},i,l){super(a,n,i,l)}from(a){return new fx(this.url,this.headers,a,this.fetch)}get vectors(){return new Nx(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new mx(this.url+"/iceberg",this.headers,this.fetch)}};const rg="2.89.0",zs=30*1e3,Du=3,mu=Du*zs,Ox="http://localhost:9999",jx="supabase.auth.token",Rx={"X-Client-Info":`gotrue-js/${rg}`},Uu="X-Supabase-Api-Version",lg={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Cx=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Ix=600*1e3;class Qi extends Error{constructor(n,i,l){super(n),this.__isAuthError=!0,this.name="AuthError",this.status=i,this.code=l}}function ce(a){return typeof a=="object"&&a!==null&&"__isAuthError"in a}class Dx extends Qi{constructor(n,i,l){super(n,i,l),this.name="AuthApiError",this.status=i,this.code=l}}function Ux(a){return ce(a)&&a.name==="AuthApiError"}class Ba extends Qi{constructor(n,i){super(n),this.name="AuthUnknownError",this.originalError=i}}class Bn extends Qi{constructor(n,i,l,u){super(n,l,u),this.name=i,this.status=l}}class Ht extends Bn{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function zx(a){return ce(a)&&a.name==="AuthSessionMissingError"}class js extends Bn{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class El extends Bn{constructor(n){super(n,"AuthInvalidCredentialsError",400,void 0)}}class Nl extends Bn{constructor(n,i=null){super(n,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=i}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function kx(a){return ce(a)&&a.name==="AuthImplicitGrantRedirectError"}class _0 extends Bn{constructor(n,i=null){super(n,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=i}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Lx extends Bn{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class zu extends Bn{constructor(n,i){super(n,"AuthRetryableFetchError",i,void 0)}}function gu(a){return ce(a)&&a.name==="AuthRetryableFetchError"}class w0 extends Bn{constructor(n,i,l){super(n,"AuthWeakPasswordError",i,"weak_password"),this.reasons=l}}class ku extends Bn{constructor(n){super(n,"AuthInvalidJwtError",400,"invalid_jwt")}}const Cl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),E0=` 	
\r=`.split(""),Mx=(()=>{const a=new Array(128);for(let n=0;n<a.length;n+=1)a[n]=-1;for(let n=0;n<E0.length;n+=1)a[E0[n].charCodeAt(0)]=-2;for(let n=0;n<Cl.length;n+=1)a[Cl[n].charCodeAt(0)]=n;return a})();function N0(a,n,i){if(a!==null)for(n.queue=n.queue<<8|a,n.queuedBits+=8;n.queuedBits>=6;){const l=n.queue>>n.queuedBits-6&63;i(Cl[l]),n.queuedBits-=6}else if(n.queuedBits>0)for(n.queue=n.queue<<6-n.queuedBits,n.queuedBits=6;n.queuedBits>=6;){const l=n.queue>>n.queuedBits-6&63;i(Cl[l]),n.queuedBits-=6}}function og(a,n,i){const l=Mx[a];if(l>-1)for(n.queue=n.queue<<6|l,n.queuedBits+=6;n.queuedBits>=8;)i(n.queue>>n.queuedBits-8&255),n.queuedBits-=8;else{if(l===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(a)}"`)}}function S0(a){const n=[],i=f=>{n.push(String.fromCodePoint(f))},l={utf8seq:0,codepoint:0},u={queue:0,queuedBits:0},h=f=>{Gx(f,l,i)};for(let f=0;f<a.length;f+=1)og(a.charCodeAt(f),u,h);return n.join("")}function Bx(a,n){if(a<=127){n(a);return}else if(a<=2047){n(192|a>>6),n(128|a&63);return}else if(a<=65535){n(224|a>>12),n(128|a>>6&63),n(128|a&63);return}else if(a<=1114111){n(240|a>>18),n(128|a>>12&63),n(128|a>>6&63),n(128|a&63);return}throw new Error(`Unrecognized Unicode codepoint: ${a.toString(16)}`)}function Hx(a,n){for(let i=0;i<a.length;i+=1){let l=a.charCodeAt(i);if(l>55295&&l<=56319){const u=(l-55296)*1024&65535;l=(a.charCodeAt(i+1)-56320&65535|u)+65536,i+=1}Bx(l,n)}}function Gx(a,n,i){if(n.utf8seq===0){if(a<=127){i(a);return}for(let l=1;l<6;l+=1)if((a>>7-l&1)===0){n.utf8seq=l;break}if(n.utf8seq===2)n.codepoint=a&31;else if(n.utf8seq===3)n.codepoint=a&15;else if(n.utf8seq===4)n.codepoint=a&7;else throw new Error("Invalid UTF-8 sequence");n.utf8seq-=1}else if(n.utf8seq>0){if(a<=127)throw new Error("Invalid UTF-8 sequence");n.codepoint=n.codepoint<<6|a&63,n.utf8seq-=1,n.utf8seq===0&&i(n.codepoint)}}function Gs(a){const n=[],i={queue:0,queuedBits:0},l=u=>{n.push(u)};for(let u=0;u<a.length;u+=1)og(a.charCodeAt(u),i,l);return new Uint8Array(n)}function Px(a){const n=[];return Hx(a,i=>n.push(i)),new Uint8Array(n)}function Ha(a){const n=[],i={queue:0,queuedBits:0},l=u=>{n.push(u)};return a.forEach(u=>N0(u,i,l)),N0(null,i,l),n.join("")}function $x(a){return Math.round(Date.now()/1e3)+a}function Vx(){return Symbol("auth-callback")}const mt=()=>typeof window<"u"&&typeof document<"u",Ua={tested:!1,writable:!1},cg=()=>{if(!mt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ua.tested)return Ua.writable;const a=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(a,a),globalThis.localStorage.removeItem(a),Ua.tested=!0,Ua.writable=!0}catch{Ua.tested=!0,Ua.writable=!1}return Ua.writable};function Yx(a){const n={},i=new URL(a);if(i.hash&&i.hash[0]==="#")try{new URLSearchParams(i.hash.substring(1)).forEach((u,h)=>{n[h]=u})}catch{}return i.searchParams.forEach((l,u)=>{n[u]=l}),n}const ug=a=>a?(...n)=>a(...n):(...n)=>fetch(...n),qx=a=>typeof a=="object"&&a!==null&&"status"in a&&"ok"in a&&"json"in a&&typeof a.json=="function",ks=async(a,n,i)=>{await a.setItem(n,JSON.stringify(i))},za=async(a,n)=>{const i=await a.getItem(n);if(!i)return null;try{return JSON.parse(i)}catch{return i}},pt=async(a,n)=>{await a.removeItem(n)};class Gl{constructor(){this.promise=new Gl.promiseConstructor((n,i)=>{this.resolve=n,this.reject=i})}}Gl.promiseConstructor=Promise;function bu(a){const n=a.split(".");if(n.length!==3)throw new ku("Invalid JWT structure");for(let l=0;l<n.length;l++)if(!Cx.test(n[l]))throw new ku("JWT not in base64url format");return{header:JSON.parse(S0(n[0])),payload:JSON.parse(S0(n[1])),signature:Gs(n[2]),raw:{header:n[0],payload:n[1]}}}async function Kx(a){return await new Promise(n=>{setTimeout(()=>n(null),a)})}function Fx(a,n){return new Promise((l,u)=>{(async()=>{for(let h=0;h<1/0;h++)try{const f=await a(h);if(!n(h,null,f)){l(f);return}}catch(f){if(!n(h,f)){u(f);return}}})()})}function Jx(a){return("0"+a.toString(16)).substr(-2)}function Xx(){const n=new Uint32Array(56);if(typeof crypto>"u"){const i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",l=i.length;let u="";for(let h=0;h<56;h++)u+=i.charAt(Math.floor(Math.random()*l));return u}return crypto.getRandomValues(n),Array.from(n,Jx).join("")}async function Qx(a){const i=new TextEncoder().encode(a),l=await crypto.subtle.digest("SHA-256",i),u=new Uint8Array(l);return Array.from(u).map(h=>String.fromCharCode(h)).join("")}async function Wx(a){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),a;const i=await Qx(a);return btoa(i).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Rs(a,n,i=!1){const l=Xx();let u=l;i&&(u+="/PASSWORD_RECOVERY"),await ks(a,`${n}-code-verifier`,u);const h=await Wx(l);return[h,l===h?"plain":"s256"]}const Zx=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function e_(a){const n=a.headers.get(Uu);if(!n||!n.match(Zx))return null;try{return new Date(`${n}T00:00:00.0Z`)}catch{return null}}function t_(a){if(!a)throw new Error("Missing exp claim");const n=Math.floor(Date.now()/1e3);if(a<=n)throw new Error("JWT has expired")}function n_(a){switch(a){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const a_=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Cs(a){if(!a_.test(a))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function yu(){const a={};return new Proxy(a,{get:(n,i)=>{if(i==="__isUserNotAvailableProxy")return!0;if(typeof i=="symbol"){const l=i.toString();if(l==="Symbol(Symbol.toPrimitive)"||l==="Symbol(Symbol.toStringTag)"||l==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${i}" property of the session object is not supported. Please use getUser() instead.`)},set:(n,i)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${i}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(n,i)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${i}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function s_(a,n){return new Proxy(a,{get:(i,l,u)=>{if(l==="__isInsecureUserWarningProxy")return!0;if(typeof l=="symbol"){const h=l.toString();if(h==="Symbol(Symbol.toPrimitive)"||h==="Symbol(Symbol.toStringTag)"||h==="Symbol(util.inspect.custom)"||h==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(i,l,u)}return!n.value&&typeof l=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),n.value=!0),Reflect.get(i,l,u)}})}function T0(a){return JSON.parse(JSON.stringify(a))}const ka=a=>a.msg||a.message||a.error_description||a.error||JSON.stringify(a),i_=[502,503,504];async function A0(a){var n;if(!qx(a))throw new zu(ka(a),0);if(i_.includes(a.status))throw new zu(ka(a),a.status);let i;try{i=await a.json()}catch(h){throw new Ba(ka(h),h)}let l;const u=e_(a);if(u&&u.getTime()>=lg["2024-01-01"].timestamp&&typeof i=="object"&&i&&typeof i.code=="string"?l=i.code:typeof i=="object"&&i&&typeof i.error_code=="string"&&(l=i.error_code),l){if(l==="weak_password")throw new w0(ka(i),a.status,((n=i.weak_password)===null||n===void 0?void 0:n.reasons)||[]);if(l==="session_not_found")throw new Ht}else if(typeof i=="object"&&i&&typeof i.weak_password=="object"&&i.weak_password&&Array.isArray(i.weak_password.reasons)&&i.weak_password.reasons.length&&i.weak_password.reasons.reduce((h,f)=>h&&typeof f=="string",!0))throw new w0(ka(i),a.status,i.weak_password.reasons);throw new Dx(ka(i),a.status||500,l)}const r_=(a,n,i,l)=>{const u={method:a,headers:(n==null?void 0:n.headers)||{}};return a==="GET"?u:(u.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},n==null?void 0:n.headers),u.body=JSON.stringify(l),Object.assign(Object.assign({},u),i))};async function he(a,n,i,l){var u;const h=Object.assign({},l==null?void 0:l.headers);h[Uu]||(h[Uu]=lg["2024-01-01"].name),l!=null&&l.jwt&&(h.Authorization=`Bearer ${l.jwt}`);const f=(u=l==null?void 0:l.query)!==null&&u!==void 0?u:{};l!=null&&l.redirectTo&&(f.redirect_to=l.redirectTo);const g=Object.keys(f).length?"?"+new URLSearchParams(f).toString():"",p=await l_(a,n,i+g,{headers:h,noResolveJson:l==null?void 0:l.noResolveJson},{},l==null?void 0:l.body);return l!=null&&l.xform?l==null?void 0:l.xform(p):{data:Object.assign({},p),error:null}}async function l_(a,n,i,l,u,h){const f=r_(n,l,u,h);let g;try{g=await a(i,Object.assign({},f))}catch(p){throw console.error(p),new zu(ka(p),0)}if(g.ok||await A0(g),l!=null&&l.noResolveJson)return g;try{return await g.json()}catch(p){await A0(p)}}function sn(a){var n;let i=null;u_(a)&&(i=Object.assign({},a),a.expires_at||(i.expires_at=$x(a.expires_in)));const l=(n=a.user)!==null&&n!==void 0?n:a;return{data:{session:i,user:l},error:null}}function O0(a){const n=sn(a);return!n.error&&a.weak_password&&typeof a.weak_password=="object"&&Array.isArray(a.weak_password.reasons)&&a.weak_password.reasons.length&&a.weak_password.message&&typeof a.weak_password.message=="string"&&a.weak_password.reasons.reduce((i,l)=>i&&typeof l=="string",!0)&&(n.data.weak_password=a.weak_password),n}function pa(a){var n;return{data:{user:(n=a.user)!==null&&n!==void 0?n:a},error:null}}function o_(a){return{data:a,error:null}}function c_(a){const{action_link:n,email_otp:i,hashed_token:l,redirect_to:u,verification_type:h}=a,f=Bl(a,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),g={action_link:n,email_otp:i,hashed_token:l,redirect_to:u,verification_type:h},p=Object.assign({},f);return{data:{properties:g,user:p},error:null}}function j0(a){return a}function u_(a){return a.access_token&&a.refresh_token&&a.expires_in}const vu=["global","local","others"];class d_{constructor({url:n="",headers:i={},fetch:l}){this.url=n,this.headers=i,this.fetch=ug(l),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(n,i=vu[0]){if(vu.indexOf(i)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${vu.join(", ")}`);try{return await he(this.fetch,"POST",`${this.url}/logout?scope=${i}`,{headers:this.headers,jwt:n,noResolveJson:!0}),{data:null,error:null}}catch(l){if(ce(l))return{data:null,error:l};throw l}}async inviteUserByEmail(n,i={}){try{return await he(this.fetch,"POST",`${this.url}/invite`,{body:{email:n,data:i.data},headers:this.headers,redirectTo:i.redirectTo,xform:pa})}catch(l){if(ce(l))return{data:{user:null},error:l};throw l}}async generateLink(n){try{const{options:i}=n,l=Bl(n,["options"]),u=Object.assign(Object.assign({},l),i);return"newEmail"in l&&(u.new_email=l==null?void 0:l.newEmail,delete u.newEmail),await he(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:u,headers:this.headers,xform:c_,redirectTo:i==null?void 0:i.redirectTo})}catch(i){if(ce(i))return{data:{properties:null,user:null},error:i};throw i}}async createUser(n){try{return await he(this.fetch,"POST",`${this.url}/admin/users`,{body:n,headers:this.headers,xform:pa})}catch(i){if(ce(i))return{data:{user:null},error:i};throw i}}async listUsers(n){var i,l,u,h,f,g,p;try{const b={nextPage:null,lastPage:0,total:0},x=await he(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(l=(i=n==null?void 0:n.page)===null||i===void 0?void 0:i.toString())!==null&&l!==void 0?l:"",per_page:(h=(u=n==null?void 0:n.perPage)===null||u===void 0?void 0:u.toString())!==null&&h!==void 0?h:""},xform:j0});if(x.error)throw x.error;const y=await x.json(),E=(f=x.headers.get("x-total-count"))!==null&&f!==void 0?f:0,_=(p=(g=x.headers.get("link"))===null||g===void 0?void 0:g.split(","))!==null&&p!==void 0?p:[];return _.length>0&&(_.forEach(w=>{const S=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),N=JSON.parse(w.split(";")[1].split("=")[1]);b[`${N}Page`]=S}),b.total=parseInt(E)),{data:Object.assign(Object.assign({},y),b),error:null}}catch(b){if(ce(b))return{data:{users:[]},error:b};throw b}}async getUserById(n){Cs(n);try{return await he(this.fetch,"GET",`${this.url}/admin/users/${n}`,{headers:this.headers,xform:pa})}catch(i){if(ce(i))return{data:{user:null},error:i};throw i}}async updateUserById(n,i){Cs(n);try{return await he(this.fetch,"PUT",`${this.url}/admin/users/${n}`,{body:i,headers:this.headers,xform:pa})}catch(l){if(ce(l))return{data:{user:null},error:l};throw l}}async deleteUser(n,i=!1){Cs(n);try{return await he(this.fetch,"DELETE",`${this.url}/admin/users/${n}`,{headers:this.headers,body:{should_soft_delete:i},xform:pa})}catch(l){if(ce(l))return{data:{user:null},error:l};throw l}}async _listFactors(n){Cs(n.userId);try{const{data:i,error:l}=await he(this.fetch,"GET",`${this.url}/admin/users/${n.userId}/factors`,{headers:this.headers,xform:u=>({data:{factors:u},error:null})});return{data:i,error:l}}catch(i){if(ce(i))return{data:null,error:i};throw i}}async _deleteFactor(n){Cs(n.userId),Cs(n.id);try{return{data:await he(this.fetch,"DELETE",`${this.url}/admin/users/${n.userId}/factors/${n.id}`,{headers:this.headers}),error:null}}catch(i){if(ce(i))return{data:null,error:i};throw i}}async _listOAuthClients(n){var i,l,u,h,f,g,p;try{const b={nextPage:null,lastPage:0,total:0},x=await he(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(l=(i=n==null?void 0:n.page)===null||i===void 0?void 0:i.toString())!==null&&l!==void 0?l:"",per_page:(h=(u=n==null?void 0:n.perPage)===null||u===void 0?void 0:u.toString())!==null&&h!==void 0?h:""},xform:j0});if(x.error)throw x.error;const y=await x.json(),E=(f=x.headers.get("x-total-count"))!==null&&f!==void 0?f:0,_=(p=(g=x.headers.get("link"))===null||g===void 0?void 0:g.split(","))!==null&&p!==void 0?p:[];return _.length>0&&(_.forEach(w=>{const S=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),N=JSON.parse(w.split(";")[1].split("=")[1]);b[`${N}Page`]=S}),b.total=parseInt(E)),{data:Object.assign(Object.assign({},y),b),error:null}}catch(b){if(ce(b))return{data:{clients:[]},error:b};throw b}}async _createOAuthClient(n){try{return await he(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:n,headers:this.headers,xform:i=>({data:i,error:null})})}catch(i){if(ce(i))return{data:null,error:i};throw i}}async _getOAuthClient(n){try{return await he(this.fetch,"GET",`${this.url}/admin/oauth/clients/${n}`,{headers:this.headers,xform:i=>({data:i,error:null})})}catch(i){if(ce(i))return{data:null,error:i};throw i}}async _updateOAuthClient(n,i){try{return await he(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${n}`,{body:i,headers:this.headers,xform:l=>({data:l,error:null})})}catch(l){if(ce(l))return{data:null,error:l};throw l}}async _deleteOAuthClient(n){try{return await he(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${n}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(i){if(ce(i))return{data:null,error:i};throw i}}async _regenerateOAuthClientSecret(n){try{return await he(this.fetch,"POST",`${this.url}/admin/oauth/clients/${n}/regenerate_secret`,{headers:this.headers,xform:i=>({data:i,error:null})})}catch(i){if(ce(i))return{data:null,error:i};throw i}}}function R0(a={}){return{getItem:n=>a[n]||null,setItem:(n,i)=>{a[n]=i},removeItem:n=>{delete a[n]}}}const Is={debug:!!(globalThis&&cg()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class dg extends Error{constructor(n){super(n),this.isAcquireTimeout=!0}}class h_ extends dg{}async function f_(a,n,i){Is.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",a,n);const l=new globalThis.AbortController;return n>0&&setTimeout(()=>{l.abort(),Is.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",a)},n),await Promise.resolve().then(()=>globalThis.navigator.locks.request(a,n===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:l.signal},async u=>{if(u){Is.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",a,u.name);try{return await i()}finally{Is.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",a,u.name)}}else{if(n===0)throw Is.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",a),new h_(`Acquiring an exclusive Navigator LockManager lock "${a}" immediately failed`);if(Is.debug)try{const h=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(h,null,"  "))}catch(h){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",h)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await i()}}))}function p_(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function hg(a){if(!/^0x[a-fA-F0-9]{40}$/.test(a))throw new Error(`@supabase/auth-js: Address "${a}" is invalid.`);return a.toLowerCase()}function m_(a){return parseInt(a,16)}function g_(a){const n=new TextEncoder().encode(a);return"0x"+Array.from(n,l=>l.toString(16).padStart(2,"0")).join("")}function b_(a){var n;const{chainId:i,domain:l,expirationTime:u,issuedAt:h=new Date,nonce:f,notBefore:g,requestId:p,resources:b,scheme:x,uri:y,version:E}=a;{if(!Number.isInteger(i))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${i}`);if(!l)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(f&&f.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${f}`);if(!y)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(E!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${E}`);if(!((n=a.statement)===null||n===void 0)&&n.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${a.statement}`)}const _=hg(a.address),w=x?`${x}://${l}`:l,S=a.statement?`${a.statement}
`:"",N=`${w} wants you to sign in with your Ethereum account:
${_}

${S}`;let k=`URI: ${y}
Version: ${E}
Chain ID: ${i}${f?`
Nonce: ${f}`:""}
Issued At: ${h.toISOString()}`;if(u&&(k+=`
Expiration Time: ${u.toISOString()}`),g&&(k+=`
Not Before: ${g.toISOString()}`),p&&(k+=`
Request ID: ${p}`),b){let K=`
Resources:`;for(const H of b){if(!H||typeof H!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${H}`);K+=`
- ${H}`}k+=K}return`${N}
${k}`}class at extends Error{constructor({message:n,code:i,cause:l,name:u}){var h;super(n,{cause:l}),this.__isWebAuthnError=!0,this.name=(h=u??(l instanceof Error?l.name:void 0))!==null&&h!==void 0?h:"Unknown Error",this.code=i}}class Il extends at{constructor(n,i){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:i,message:n}),this.name="WebAuthnUnknownError",this.originalError=i}}function y_({error:a,options:n}){var i,l,u;const{publicKey:h}=n;if(!h)throw Error("options was missing required publicKey property");if(a.name==="AbortError"){if(n.signal instanceof AbortSignal)return new at({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:a})}else if(a.name==="ConstraintError"){if(((i=h.authenticatorSelection)===null||i===void 0?void 0:i.requireResidentKey)===!0)return new at({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:a});if(n.mediation==="conditional"&&((l=h.authenticatorSelection)===null||l===void 0?void 0:l.userVerification)==="required")return new at({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:a});if(((u=h.authenticatorSelection)===null||u===void 0?void 0:u.userVerification)==="required")return new at({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:a})}else{if(a.name==="InvalidStateError")return new at({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:a});if(a.name==="NotAllowedError")return new at({message:a.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:a});if(a.name==="NotSupportedError")return h.pubKeyCredParams.filter(g=>g.type==="public-key").length===0?new at({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:a}):new at({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:a});if(a.name==="SecurityError"){const f=window.location.hostname;if(fg(f)){if(h.rp.id!==f)return new at({message:`The RP ID "${h.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:a})}else return new at({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:a})}else if(a.name==="TypeError"){if(h.user.id.byteLength<1||h.user.id.byteLength>64)return new at({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:a})}else if(a.name==="UnknownError")return new at({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:a})}return new at({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:a})}function v_({error:a,options:n}){const{publicKey:i}=n;if(!i)throw Error("options was missing required publicKey property");if(a.name==="AbortError"){if(n.signal instanceof AbortSignal)return new at({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:a})}else{if(a.name==="NotAllowedError")return new at({message:a.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:a});if(a.name==="SecurityError"){const l=window.location.hostname;if(fg(l)){if(i.rpId!==l)return new at({message:`The RP ID "${i.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:a})}else return new at({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:a})}else if(a.name==="UnknownError")return new at({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:a})}return new at({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:a})}class x_{createNewAbortSignal(){if(this.controller){const i=new Error("Cancelling existing WebAuthn API call for new one");i.name="AbortError",this.controller.abort(i)}const n=new AbortController;return this.controller=n,n.signal}cancelCeremony(){if(this.controller){const n=new Error("Manually cancelling existing WebAuthn API call");n.name="AbortError",this.controller.abort(n),this.controller=void 0}}}const __=new x_;function w_(a){if(!a)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(a);const{challenge:n,user:i,excludeCredentials:l}=a,u=Bl(a,["challenge","user","excludeCredentials"]),h=Gs(n).buffer,f=Object.assign(Object.assign({},i),{id:Gs(i.id).buffer}),g=Object.assign(Object.assign({},u),{challenge:h,user:f});if(l&&l.length>0){g.excludeCredentials=new Array(l.length);for(let p=0;p<l.length;p++){const b=l[p];g.excludeCredentials[p]=Object.assign(Object.assign({},b),{id:Gs(b.id).buffer,type:b.type||"public-key",transports:b.transports})}}return g}function E_(a){if(!a)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(a);const{challenge:n,allowCredentials:i}=a,l=Bl(a,["challenge","allowCredentials"]),u=Gs(n).buffer,h=Object.assign(Object.assign({},l),{challenge:u});if(i&&i.length>0){h.allowCredentials=new Array(i.length);for(let f=0;f<i.length;f++){const g=i[f];h.allowCredentials[f]=Object.assign(Object.assign({},g),{id:Gs(g.id).buffer,type:g.type||"public-key",transports:g.transports})}}return h}function N_(a){var n;if("toJSON"in a&&typeof a.toJSON=="function")return a.toJSON();const i=a;return{id:a.id,rawId:a.id,response:{attestationObject:Ha(new Uint8Array(a.response.attestationObject)),clientDataJSON:Ha(new Uint8Array(a.response.clientDataJSON))},type:"public-key",clientExtensionResults:a.getClientExtensionResults(),authenticatorAttachment:(n=i.authenticatorAttachment)!==null&&n!==void 0?n:void 0}}function S_(a){var n;if("toJSON"in a&&typeof a.toJSON=="function")return a.toJSON();const i=a,l=a.getClientExtensionResults(),u=a.response;return{id:a.id,rawId:a.id,response:{authenticatorData:Ha(new Uint8Array(u.authenticatorData)),clientDataJSON:Ha(new Uint8Array(u.clientDataJSON)),signature:Ha(new Uint8Array(u.signature)),userHandle:u.userHandle?Ha(new Uint8Array(u.userHandle)):void 0},type:"public-key",clientExtensionResults:l,authenticatorAttachment:(n=i.authenticatorAttachment)!==null&&n!==void 0?n:void 0}}function fg(a){return a==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(a)}function C0(){var a,n;return!!(mt()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((a=navigator==null?void 0:navigator.credentials)===null||a===void 0?void 0:a.create)=="function"&&typeof((n=navigator==null?void 0:navigator.credentials)===null||n===void 0?void 0:n.get)=="function")}async function T_(a){try{const n=await navigator.credentials.create(a);return n?n instanceof PublicKeyCredential?{data:n,error:null}:{data:null,error:new Il("Browser returned unexpected credential type",n)}:{data:null,error:new Il("Empty credential response",n)}}catch(n){return{data:null,error:y_({error:n,options:a})}}}async function A_(a){try{const n=await navigator.credentials.get(a);return n?n instanceof PublicKeyCredential?{data:n,error:null}:{data:null,error:new Il("Browser returned unexpected credential type",n)}:{data:null,error:new Il("Empty credential response",n)}}catch(n){return{data:null,error:v_({error:n,options:a})}}}const O_={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},j_={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Dl(...a){const n=u=>u!==null&&typeof u=="object"&&!Array.isArray(u),i=u=>u instanceof ArrayBuffer||ArrayBuffer.isView(u),l={};for(const u of a)if(u)for(const h in u){const f=u[h];if(f!==void 0)if(Array.isArray(f))l[h]=f;else if(i(f))l[h]=f;else if(n(f)){const g=l[h];n(g)?l[h]=Dl(g,f):l[h]=Dl(f)}else l[h]=f}return l}function R_(a,n){return Dl(O_,a,n||{})}function C_(a,n){return Dl(j_,a,n||{})}class I_{constructor(n){this.client=n,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(n){return this.client.mfa.enroll(Object.assign(Object.assign({},n),{factorType:"webauthn"}))}async _challenge({factorId:n,webauthn:i,friendlyName:l,signal:u},h){try{const{data:f,error:g}=await this.client.mfa.challenge({factorId:n,webauthn:i});if(!f)return{data:null,error:g};const p=u??__.createNewAbortSignal();if(f.webauthn.type==="create"){const{user:b}=f.webauthn.credential_options.publicKey;b.name||(b.name=`${b.id}:${l}`),b.displayName||(b.displayName=b.name)}switch(f.webauthn.type){case"create":{const b=R_(f.webauthn.credential_options.publicKey,h==null?void 0:h.create),{data:x,error:y}=await T_({publicKey:b,signal:p});return x?{data:{factorId:n,challengeId:f.id,webauthn:{type:f.webauthn.type,credential_response:x}},error:null}:{data:null,error:y}}case"request":{const b=C_(f.webauthn.credential_options.publicKey,h==null?void 0:h.request),{data:x,error:y}=await A_(Object.assign(Object.assign({},f.webauthn.credential_options),{publicKey:b,signal:p}));return x?{data:{factorId:n,challengeId:f.id,webauthn:{type:f.webauthn.type,credential_response:x}},error:null}:{data:null,error:y}}}}catch(f){return ce(f)?{data:null,error:f}:{data:null,error:new Ba("Unexpected error in challenge",f)}}}async _verify({challengeId:n,factorId:i,webauthn:l}){return this.client.mfa.verify({factorId:i,challengeId:n,webauthn:l})}async _authenticate({factorId:n,webauthn:{rpId:i=typeof window<"u"?window.location.hostname:void 0,rpOrigins:l=typeof window<"u"?[window.location.origin]:void 0,signal:u}={}},h){if(!i)return{data:null,error:new Qi("rpId is required for WebAuthn authentication")};try{if(!C0())return{data:null,error:new Ba("Browser does not support WebAuthn",null)};const{data:f,error:g}=await this.challenge({factorId:n,webauthn:{rpId:i,rpOrigins:l},signal:u},{request:h});if(!f)return{data:null,error:g};const{webauthn:p}=f;return this._verify({factorId:n,challengeId:f.challengeId,webauthn:{type:p.type,rpId:i,rpOrigins:l,credential_response:p.credential_response}})}catch(f){return ce(f)?{data:null,error:f}:{data:null,error:new Ba("Unexpected error in authenticate",f)}}}async _register({friendlyName:n,webauthn:{rpId:i=typeof window<"u"?window.location.hostname:void 0,rpOrigins:l=typeof window<"u"?[window.location.origin]:void 0,signal:u}={}},h){if(!i)return{data:null,error:new Qi("rpId is required for WebAuthn registration")};try{if(!C0())return{data:null,error:new Ba("Browser does not support WebAuthn",null)};const{data:f,error:g}=await this._enroll({friendlyName:n});if(!f)return await this.client.mfa.listFactors().then(x=>{var y;return(y=x.data)===null||y===void 0?void 0:y.all.find(E=>E.factor_type==="webauthn"&&E.friendly_name===n&&E.status!=="unverified")}).then(x=>x?this.client.mfa.unenroll({factorId:x==null?void 0:x.id}):void 0),{data:null,error:g};const{data:p,error:b}=await this._challenge({factorId:f.id,friendlyName:f.friendly_name,webauthn:{rpId:i,rpOrigins:l},signal:u},{create:h});return p?this._verify({factorId:f.id,challengeId:p.challengeId,webauthn:{rpId:i,rpOrigins:l,type:p.webauthn.type,credential_response:p.webauthn.credential_response}}):{data:null,error:b}}catch(f){return ce(f)?{data:null,error:f}:{data:null,error:new Ba("Unexpected error in register",f)}}}}p_();const D_={url:Ox,storageKey:jx,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Rx,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function I0(a,n,i){return await i()}const Ds={};class Wi{get jwks(){var n,i;return(i=(n=Ds[this.storageKey])===null||n===void 0?void 0:n.jwks)!==null&&i!==void 0?i:{keys:[]}}set jwks(n){Ds[this.storageKey]=Object.assign(Object.assign({},Ds[this.storageKey]),{jwks:n})}get jwks_cached_at(){var n,i;return(i=(n=Ds[this.storageKey])===null||n===void 0?void 0:n.cachedAt)!==null&&i!==void 0?i:Number.MIN_SAFE_INTEGER}set jwks_cached_at(n){Ds[this.storageKey]=Object.assign(Object.assign({},Ds[this.storageKey]),{cachedAt:n})}constructor(n){var i,l,u;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const h=Object.assign(Object.assign({},D_),n);if(this.storageKey=h.storageKey,this.instanceID=(i=Wi.nextInstanceID[this.storageKey])!==null&&i!==void 0?i:0,Wi.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!h.debug,typeof h.debug=="function"&&(this.logger=h.debug),this.instanceID>0&&mt()){const f=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(f),this.logDebugMessages&&console.trace(f)}if(this.persistSession=h.persistSession,this.autoRefreshToken=h.autoRefreshToken,this.admin=new d_({url:h.url,headers:h.headers,fetch:h.fetch}),this.url=h.url,this.headers=h.headers,this.fetch=ug(h.fetch),this.lock=h.lock||I0,this.detectSessionInUrl=h.detectSessionInUrl,this.flowType=h.flowType,this.hasCustomAuthorizationHeader=h.hasCustomAuthorizationHeader,this.throwOnError=h.throwOnError,h.lock?this.lock=h.lock:this.persistSession&&mt()&&(!((l=globalThis==null?void 0:globalThis.navigator)===null||l===void 0)&&l.locks)?this.lock=f_:this.lock=I0,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new I_(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(h.storage?this.storage=h.storage:cg()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=R0(this.memoryStorage)),h.userStorage&&(this.userStorage=h.userStorage)):(this.memoryStorage={},this.storage=R0(this.memoryStorage)),mt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(f){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",f)}(u=this.broadcastChannel)===null||u===void 0||u.addEventListener("message",async f=>{this._debug("received broadcast notification from other tab or client",f),await this._notifyAllSubscribers(f.data.event,f.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(n){if(this.throwOnError&&n&&n.error)throw n.error;return n}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${rg}) ${new Date().toISOString()}`}_debug(...n){return this.logDebugMessages&&this.logger(this._logPrefix(),...n),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var n;try{let i={},l="none";if(mt()&&(i=Yx(window.location.href),this._isImplicitGrantCallback(i)?l="implicit":await this._isPKCECallback(i)&&(l="pkce")),mt()&&this.detectSessionInUrl&&l!=="none"){const{data:u,error:h}=await this._getSessionFromURL(i,l);if(h){if(this._debug("#_initialize()","error detecting session from URL",h),kx(h)){const p=(n=h.details)===null||n===void 0?void 0:n.code;if(p==="identity_already_exists"||p==="identity_not_found"||p==="single_identity_not_deletable")return{error:h}}return await this._removeSession(),{error:h}}const{session:f,redirectType:g}=u;return this._debug("#_initialize()","detected session in URL",f,"redirect type",g),await this._saveSession(f),setTimeout(async()=>{g==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",f):await this._notifyAllSubscribers("SIGNED_IN",f)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(i){return ce(i)?this._returnResult({error:i}):this._returnResult({error:new Ba("Unexpected error during initialization",i)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(n){var i,l,u;try{const h=await he(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(l=(i=n==null?void 0:n.options)===null||i===void 0?void 0:i.data)!==null&&l!==void 0?l:{},gotrue_meta_security:{captcha_token:(u=n==null?void 0:n.options)===null||u===void 0?void 0:u.captchaToken}},xform:sn}),{data:f,error:g}=h;if(g||!f)return this._returnResult({data:{user:null,session:null},error:g});const p=f.session,b=f.user;return f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",p)),this._returnResult({data:{user:b,session:p},error:null})}catch(h){if(ce(h))return this._returnResult({data:{user:null,session:null},error:h});throw h}}async signUp(n){var i,l,u;try{let h;if("email"in n){const{email:x,password:y,options:E}=n;let _=null,w=null;this.flowType==="pkce"&&([_,w]=await Rs(this.storage,this.storageKey)),h=await he(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:E==null?void 0:E.emailRedirectTo,body:{email:x,password:y,data:(i=E==null?void 0:E.data)!==null&&i!==void 0?i:{},gotrue_meta_security:{captcha_token:E==null?void 0:E.captchaToken},code_challenge:_,code_challenge_method:w},xform:sn})}else if("phone"in n){const{phone:x,password:y,options:E}=n;h=await he(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:x,password:y,data:(l=E==null?void 0:E.data)!==null&&l!==void 0?l:{},channel:(u=E==null?void 0:E.channel)!==null&&u!==void 0?u:"sms",gotrue_meta_security:{captcha_token:E==null?void 0:E.captchaToken}},xform:sn})}else throw new El("You must provide either an email or phone number and a password");const{data:f,error:g}=h;if(g||!f)return await pt(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:g});const p=f.session,b=f.user;return f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",p)),this._returnResult({data:{user:b,session:p},error:null})}catch(h){if(await pt(this.storage,`${this.storageKey}-code-verifier`),ce(h))return this._returnResult({data:{user:null,session:null},error:h});throw h}}async signInWithPassword(n){try{let i;if("email"in n){const{email:h,password:f,options:g}=n;i=await he(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:h,password:f,gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken}},xform:O0})}else if("phone"in n){const{phone:h,password:f,options:g}=n;i=await he(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:h,password:f,gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken}},xform:O0})}else throw new El("You must provide either an email or phone number and a password");const{data:l,error:u}=i;if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!l||!l.session||!l.user){const h=new js;return this._returnResult({data:{user:null,session:null},error:h})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:Object.assign({user:l.user,session:l.session},l.weak_password?{weakPassword:l.weak_password}:null),error:u})}catch(i){if(ce(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithOAuth(n){var i,l,u,h;return await this._handleProviderSignIn(n.provider,{redirectTo:(i=n.options)===null||i===void 0?void 0:i.redirectTo,scopes:(l=n.options)===null||l===void 0?void 0:l.scopes,queryParams:(u=n.options)===null||u===void 0?void 0:u.queryParams,skipBrowserRedirect:(h=n.options)===null||h===void 0?void 0:h.skipBrowserRedirect})}async exchangeCodeForSession(n){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(n))}async signInWithWeb3(n){const{chain:i}=n;switch(i){case"ethereum":return await this.signInWithEthereum(n);case"solana":return await this.signInWithSolana(n);default:throw new Error(`@supabase/auth-js: Unsupported chain "${i}"`)}}async signInWithEthereum(n){var i,l,u,h,f,g,p,b,x,y,E;let _,w;if("message"in n)_=n.message,w=n.signature;else{const{chain:S,wallet:N,statement:k,options:K}=n;let H;if(mt())if(typeof N=="object")H=N;else{const pe=window;if("ethereum"in pe&&typeof pe.ethereum=="object"&&"request"in pe.ethereum&&typeof pe.ethereum.request=="function")H=pe.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof N!="object"||!(K!=null&&K.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");H=N}const P=new URL((i=K==null?void 0:K.url)!==null&&i!==void 0?i:window.location.href),ee=await H.request({method:"eth_requestAccounts"}).then(pe=>pe).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!ee||ee.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const te=hg(ee[0]);let W=(l=K==null?void 0:K.signInWithEthereum)===null||l===void 0?void 0:l.chainId;if(!W){const pe=await H.request({method:"eth_chainId"});W=m_(pe)}const ye={domain:P.host,address:te,statement:k,uri:P.href,version:"1",chainId:W,nonce:(u=K==null?void 0:K.signInWithEthereum)===null||u===void 0?void 0:u.nonce,issuedAt:(f=(h=K==null?void 0:K.signInWithEthereum)===null||h===void 0?void 0:h.issuedAt)!==null&&f!==void 0?f:new Date,expirationTime:(g=K==null?void 0:K.signInWithEthereum)===null||g===void 0?void 0:g.expirationTime,notBefore:(p=K==null?void 0:K.signInWithEthereum)===null||p===void 0?void 0:p.notBefore,requestId:(b=K==null?void 0:K.signInWithEthereum)===null||b===void 0?void 0:b.requestId,resources:(x=K==null?void 0:K.signInWithEthereum)===null||x===void 0?void 0:x.resources};_=b_(ye),w=await H.request({method:"personal_sign",params:[g_(_),te]})}try{const{data:S,error:N}=await he(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:_,signature:w},!((y=n.options)===null||y===void 0)&&y.captchaToken?{gotrue_meta_security:{captcha_token:(E=n.options)===null||E===void 0?void 0:E.captchaToken}}:null),xform:sn});if(N)throw N;if(!S||!S.session||!S.user){const k=new js;return this._returnResult({data:{user:null,session:null},error:k})}return S.session&&(await this._saveSession(S.session),await this._notifyAllSubscribers("SIGNED_IN",S.session)),this._returnResult({data:Object.assign({},S),error:N})}catch(S){if(ce(S))return this._returnResult({data:{user:null,session:null},error:S});throw S}}async signInWithSolana(n){var i,l,u,h,f,g,p,b,x,y,E,_;let w,S;if("message"in n)w=n.message,S=n.signature;else{const{chain:N,wallet:k,statement:K,options:H}=n;let P;if(mt())if(typeof k=="object")P=k;else{const te=window;if("solana"in te&&typeof te.solana=="object"&&("signIn"in te.solana&&typeof te.solana.signIn=="function"||"signMessage"in te.solana&&typeof te.solana.signMessage=="function"))P=te.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof k!="object"||!(H!=null&&H.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");P=k}const ee=new URL((i=H==null?void 0:H.url)!==null&&i!==void 0?i:window.location.href);if("signIn"in P&&P.signIn){const te=await P.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},H==null?void 0:H.signInWithSolana),{version:"1",domain:ee.host,uri:ee.href}),K?{statement:K}:null));let W;if(Array.isArray(te)&&te[0]&&typeof te[0]=="object")W=te[0];else if(te&&typeof te=="object"&&"signedMessage"in te&&"signature"in te)W=te;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in W&&"signature"in W&&(typeof W.signedMessage=="string"||W.signedMessage instanceof Uint8Array)&&W.signature instanceof Uint8Array)w=typeof W.signedMessage=="string"?W.signedMessage:new TextDecoder().decode(W.signedMessage),S=W.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in P)||typeof P.signMessage!="function"||!("publicKey"in P)||typeof P!="object"||!P.publicKey||!("toBase58"in P.publicKey)||typeof P.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");w=[`${ee.host} wants you to sign in with your Solana account:`,P.publicKey.toBase58(),...K?["",K,""]:[""],"Version: 1",`URI: ${ee.href}`,`Issued At: ${(u=(l=H==null?void 0:H.signInWithSolana)===null||l===void 0?void 0:l.issuedAt)!==null&&u!==void 0?u:new Date().toISOString()}`,...!((h=H==null?void 0:H.signInWithSolana)===null||h===void 0)&&h.notBefore?[`Not Before: ${H.signInWithSolana.notBefore}`]:[],...!((f=H==null?void 0:H.signInWithSolana)===null||f===void 0)&&f.expirationTime?[`Expiration Time: ${H.signInWithSolana.expirationTime}`]:[],...!((g=H==null?void 0:H.signInWithSolana)===null||g===void 0)&&g.chainId?[`Chain ID: ${H.signInWithSolana.chainId}`]:[],...!((p=H==null?void 0:H.signInWithSolana)===null||p===void 0)&&p.nonce?[`Nonce: ${H.signInWithSolana.nonce}`]:[],...!((b=H==null?void 0:H.signInWithSolana)===null||b===void 0)&&b.requestId?[`Request ID: ${H.signInWithSolana.requestId}`]:[],...!((y=(x=H==null?void 0:H.signInWithSolana)===null||x===void 0?void 0:x.resources)===null||y===void 0)&&y.length?["Resources",...H.signInWithSolana.resources.map(W=>`- ${W}`)]:[]].join(`
`);const te=await P.signMessage(new TextEncoder().encode(w),"utf8");if(!te||!(te instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");S=te}}try{const{data:N,error:k}=await he(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:w,signature:Ha(S)},!((E=n.options)===null||E===void 0)&&E.captchaToken?{gotrue_meta_security:{captcha_token:(_=n.options)===null||_===void 0?void 0:_.captchaToken}}:null),xform:sn});if(k)throw k;if(!N||!N.session||!N.user){const K=new js;return this._returnResult({data:{user:null,session:null},error:K})}return N.session&&(await this._saveSession(N.session),await this._notifyAllSubscribers("SIGNED_IN",N.session)),this._returnResult({data:Object.assign({},N),error:k})}catch(N){if(ce(N))return this._returnResult({data:{user:null,session:null},error:N});throw N}}async _exchangeCodeForSession(n){const i=await za(this.storage,`${this.storageKey}-code-verifier`),[l,u]=(i??"").split("/");try{if(!l&&this.flowType==="pkce")throw new Lx;const{data:h,error:f}=await he(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:n,code_verifier:l},xform:sn});if(await pt(this.storage,`${this.storageKey}-code-verifier`),f)throw f;if(!h||!h.session||!h.user){const g=new js;return this._returnResult({data:{user:null,session:null,redirectType:null},error:g})}return h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",h.session)),this._returnResult({data:Object.assign(Object.assign({},h),{redirectType:u??null}),error:f})}catch(h){if(await pt(this.storage,`${this.storageKey}-code-verifier`),ce(h))return this._returnResult({data:{user:null,session:null,redirectType:null},error:h});throw h}}async signInWithIdToken(n){try{const{options:i,provider:l,token:u,access_token:h,nonce:f}=n,g=await he(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:l,id_token:u,access_token:h,nonce:f,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},xform:sn}),{data:p,error:b}=g;if(b)return this._returnResult({data:{user:null,session:null},error:b});if(!p||!p.session||!p.user){const x=new js;return this._returnResult({data:{user:null,session:null},error:x})}return p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("SIGNED_IN",p.session)),this._returnResult({data:p,error:b})}catch(i){if(ce(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithOtp(n){var i,l,u,h,f;try{if("email"in n){const{email:g,options:p}=n;let b=null,x=null;this.flowType==="pkce"&&([b,x]=await Rs(this.storage,this.storageKey));const{error:y}=await he(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:g,data:(i=p==null?void 0:p.data)!==null&&i!==void 0?i:{},create_user:(l=p==null?void 0:p.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken},code_challenge:b,code_challenge_method:x},redirectTo:p==null?void 0:p.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:y})}if("phone"in n){const{phone:g,options:p}=n,{data:b,error:x}=await he(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:g,data:(u=p==null?void 0:p.data)!==null&&u!==void 0?u:{},create_user:(h=p==null?void 0:p.shouldCreateUser)!==null&&h!==void 0?h:!0,gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken},channel:(f=p==null?void 0:p.channel)!==null&&f!==void 0?f:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:b==null?void 0:b.message_id},error:x})}throw new El("You must provide either an email or phone number.")}catch(g){if(await pt(this.storage,`${this.storageKey}-code-verifier`),ce(g))return this._returnResult({data:{user:null,session:null},error:g});throw g}}async verifyOtp(n){var i,l;try{let u,h;"options"in n&&(u=(i=n.options)===null||i===void 0?void 0:i.redirectTo,h=(l=n.options)===null||l===void 0?void 0:l.captchaToken);const{data:f,error:g}=await he(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},n),{gotrue_meta_security:{captcha_token:h}}),redirectTo:u,xform:sn});if(g)throw g;if(!f)throw new Error("An error occurred on token verification.");const p=f.session,b=f.user;return p!=null&&p.access_token&&(await this._saveSession(p),await this._notifyAllSubscribers(n.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",p)),this._returnResult({data:{user:b,session:p},error:null})}catch(u){if(ce(u))return this._returnResult({data:{user:null,session:null},error:u});throw u}}async signInWithSSO(n){var i,l,u,h,f;try{let g=null,p=null;this.flowType==="pkce"&&([g,p]=await Rs(this.storage,this.storageKey));const b=await he(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in n?{provider_id:n.providerId}:null),"domain"in n?{domain:n.domain}:null),{redirect_to:(l=(i=n.options)===null||i===void 0?void 0:i.redirectTo)!==null&&l!==void 0?l:void 0}),!((u=n==null?void 0:n.options)===null||u===void 0)&&u.captchaToken?{gotrue_meta_security:{captcha_token:n.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:g,code_challenge_method:p}),headers:this.headers,xform:o_});return!((h=b.data)===null||h===void 0)&&h.url&&mt()&&!(!((f=n.options)===null||f===void 0)&&f.skipBrowserRedirect)&&window.location.assign(b.data.url),this._returnResult(b)}catch(g){if(await pt(this.storage,`${this.storageKey}-code-verifier`),ce(g))return this._returnResult({data:null,error:g});throw g}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async n=>{const{data:{session:i},error:l}=n;if(l)throw l;if(!i)throw new Ht;const{error:u}=await he(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:i.access_token});return this._returnResult({data:{user:null,session:null},error:u})})}catch(n){if(ce(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async resend(n){try{const i=`${this.url}/resend`;if("email"in n){const{email:l,type:u,options:h}=n,{error:f}=await he(this.fetch,"POST",i,{headers:this.headers,body:{email:l,type:u,gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},redirectTo:h==null?void 0:h.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:f})}else if("phone"in n){const{phone:l,type:u,options:h}=n,{data:f,error:g}=await he(this.fetch,"POST",i,{headers:this.headers,body:{phone:l,type:u,gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:f==null?void 0:f.message_id},error:g})}throw new El("You must provide either an email or phone number and a type")}catch(i){if(ce(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async i=>i))}async _acquireLock(n,i){this._debug("#_acquireLock","begin",n);try{if(this.lockAcquired){const l=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),u=(async()=>(await l,await i()))();return this.pendingInLock.push((async()=>{try{await u}catch{}})()),u}return await this.lock(`lock:${this.storageKey}`,n,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const l=i();for(this.pendingInLock.push((async()=>{try{await l}catch{}})()),await l;this.pendingInLock.length;){const u=[...this.pendingInLock];await Promise.all(u),this.pendingInLock.splice(0,u.length)}return await l}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(n){this._debug("#_useSession","begin");try{const i=await this.__loadSession();return await n(i)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let n=null;const i=await za(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",i),i!==null&&(this._isValidSession(i)?n=i:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!n)return{data:{session:null},error:null};const l=n.expires_at?n.expires_at*1e3-Date.now()<mu:!1;if(this._debug("#__loadSession()",`session has${l?"":" not"} expired`,"expires_at",n.expires_at),!l){if(this.userStorage){const f=await za(this.userStorage,this.storageKey+"-user");f!=null&&f.user?n.user=f.user:n.user=yu()}if(this.storage.isServer&&n.user&&!n.user.__isUserNotAvailableProxy){const f={value:this.suppressGetSessionWarning};n.user=s_(n.user,f),f.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:n},error:null}}const{data:u,error:h}=await this._callRefreshToken(n.refresh_token);return h?this._returnResult({data:{session:null},error:h}):this._returnResult({data:{session:u},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(n){if(n)return await this._getUser(n);await this.initializePromise;const i=await this._acquireLock(-1,async()=>await this._getUser());return i.data.user&&(this.suppressGetSessionWarning=!0),i}async _getUser(n){try{return n?await he(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:n,xform:pa}):await this._useSession(async i=>{var l,u,h;const{data:f,error:g}=i;if(g)throw g;return!(!((l=f.session)===null||l===void 0)&&l.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ht}:await he(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(h=(u=f.session)===null||u===void 0?void 0:u.access_token)!==null&&h!==void 0?h:void 0,xform:pa})})}catch(i){if(ce(i))return zx(i)&&(await this._removeSession(),await pt(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:i});throw i}}async updateUser(n,i={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(n,i))}async _updateUser(n,i={}){try{return await this._useSession(async l=>{const{data:u,error:h}=l;if(h)throw h;if(!u.session)throw new Ht;const f=u.session;let g=null,p=null;this.flowType==="pkce"&&n.email!=null&&([g,p]=await Rs(this.storage,this.storageKey));const{data:b,error:x}=await he(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:i==null?void 0:i.emailRedirectTo,body:Object.assign(Object.assign({},n),{code_challenge:g,code_challenge_method:p}),jwt:f.access_token,xform:pa});if(x)throw x;return f.user=b.user,await this._saveSession(f),await this._notifyAllSubscribers("USER_UPDATED",f),this._returnResult({data:{user:f.user},error:null})})}catch(l){if(await pt(this.storage,`${this.storageKey}-code-verifier`),ce(l))return this._returnResult({data:{user:null},error:l});throw l}}async setSession(n){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(n))}async _setSession(n){try{if(!n.access_token||!n.refresh_token)throw new Ht;const i=Date.now()/1e3;let l=i,u=!0,h=null;const{payload:f}=bu(n.access_token);if(f.exp&&(l=f.exp,u=l<=i),u){const{data:g,error:p}=await this._callRefreshToken(n.refresh_token);if(p)return this._returnResult({data:{user:null,session:null},error:p});if(!g)return{data:{user:null,session:null},error:null};h=g}else{const{data:g,error:p}=await this._getUser(n.access_token);if(p)throw p;h={access_token:n.access_token,refresh_token:n.refresh_token,user:g.user,token_type:"bearer",expires_in:l-i,expires_at:l},await this._saveSession(h),await this._notifyAllSubscribers("SIGNED_IN",h)}return this._returnResult({data:{user:h.user,session:h},error:null})}catch(i){if(ce(i))return this._returnResult({data:{session:null,user:null},error:i});throw i}}async refreshSession(n){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(n))}async _refreshSession(n){try{return await this._useSession(async i=>{var l;if(!n){const{data:f,error:g}=i;if(g)throw g;n=(l=f.session)!==null&&l!==void 0?l:void 0}if(!(n!=null&&n.refresh_token))throw new Ht;const{data:u,error:h}=await this._callRefreshToken(n.refresh_token);return h?this._returnResult({data:{user:null,session:null},error:h}):u?this._returnResult({data:{user:u.user,session:u},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(i){if(ce(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async _getSessionFromURL(n,i){try{if(!mt())throw new Nl("No browser detected.");if(n.error||n.error_description||n.error_code)throw new Nl(n.error_description||"Error in URL with unspecified error_description",{error:n.error||"unspecified_error",code:n.error_code||"unspecified_code"});switch(i){case"implicit":if(this.flowType==="pkce")throw new _0("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Nl("Not a valid implicit grant flow url.");break;default:}if(i==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!n.code)throw new _0("No code detected.");const{data:K,error:H}=await this._exchangeCodeForSession(n.code);if(H)throw H;const P=new URL(window.location.href);return P.searchParams.delete("code"),window.history.replaceState(window.history.state,"",P.toString()),{data:{session:K.session,redirectType:null},error:null}}const{provider_token:l,provider_refresh_token:u,access_token:h,refresh_token:f,expires_in:g,expires_at:p,token_type:b}=n;if(!h||!g||!f||!b)throw new Nl("No session defined in URL");const x=Math.round(Date.now()/1e3),y=parseInt(g);let E=x+y;p&&(E=parseInt(p));const _=E-x;_*1e3<=zs&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${_}s, should have been closer to ${y}s`);const w=E-y;x-w>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",w,E,x):x-w<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",w,E,x);const{data:S,error:N}=await this._getUser(h);if(N)throw N;const k={provider_token:l,provider_refresh_token:u,access_token:h,expires_in:y,expires_at:E,refresh_token:f,token_type:b,user:S.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:k,redirectType:n.type},error:null})}catch(l){if(ce(l))return this._returnResult({data:{session:null,redirectType:null},error:l});throw l}}_isImplicitGrantCallback(n){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),n):!!(n.access_token||n.error_description)}async _isPKCECallback(n){const i=await za(this.storage,`${this.storageKey}-code-verifier`);return!!(n.code&&i)}async signOut(n={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(n))}async _signOut({scope:n}={scope:"global"}){return await this._useSession(async i=>{var l;const{data:u,error:h}=i;if(h)return this._returnResult({error:h});const f=(l=u.session)===null||l===void 0?void 0:l.access_token;if(f){const{error:g}=await this.admin.signOut(f,n);if(g&&!(Ux(g)&&(g.status===404||g.status===401||g.status===403)))return this._returnResult({error:g})}return n!=="others"&&(await this._removeSession(),await pt(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(n){const i=Vx(),l={id:i,callback:n,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",i),this.stateChangeEmitters.delete(i)}};return this._debug("#onAuthStateChange()","registered callback with id",i),this.stateChangeEmitters.set(i,l),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(i)})))(),{data:{subscription:l}}}async _emitInitialSession(n){return await this._useSession(async i=>{var l,u;try{const{data:{session:h},error:f}=i;if(f)throw f;await((l=this.stateChangeEmitters.get(n))===null||l===void 0?void 0:l.callback("INITIAL_SESSION",h)),this._debug("INITIAL_SESSION","callback id",n,"session",h)}catch(h){await((u=this.stateChangeEmitters.get(n))===null||u===void 0?void 0:u.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",n,"error",h),console.error(h)}})}async resetPasswordForEmail(n,i={}){let l=null,u=null;this.flowType==="pkce"&&([l,u]=await Rs(this.storage,this.storageKey,!0));try{return await he(this.fetch,"POST",`${this.url}/recover`,{body:{email:n,code_challenge:l,code_challenge_method:u,gotrue_meta_security:{captcha_token:i.captchaToken}},headers:this.headers,redirectTo:i.redirectTo})}catch(h){if(await pt(this.storage,`${this.storageKey}-code-verifier`),ce(h))return this._returnResult({data:null,error:h});throw h}}async getUserIdentities(){var n;try{const{data:i,error:l}=await this.getUser();if(l)throw l;return this._returnResult({data:{identities:(n=i.user.identities)!==null&&n!==void 0?n:[]},error:null})}catch(i){if(ce(i))return this._returnResult({data:null,error:i});throw i}}async linkIdentity(n){return"token"in n?this.linkIdentityIdToken(n):this.linkIdentityOAuth(n)}async linkIdentityOAuth(n){var i;try{const{data:l,error:u}=await this._useSession(async h=>{var f,g,p,b,x;const{data:y,error:E}=h;if(E)throw E;const _=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,n.provider,{redirectTo:(f=n.options)===null||f===void 0?void 0:f.redirectTo,scopes:(g=n.options)===null||g===void 0?void 0:g.scopes,queryParams:(p=n.options)===null||p===void 0?void 0:p.queryParams,skipBrowserRedirect:!0});return await he(this.fetch,"GET",_,{headers:this.headers,jwt:(x=(b=y.session)===null||b===void 0?void 0:b.access_token)!==null&&x!==void 0?x:void 0})});if(u)throw u;return mt()&&!(!((i=n.options)===null||i===void 0)&&i.skipBrowserRedirect)&&window.location.assign(l==null?void 0:l.url),this._returnResult({data:{provider:n.provider,url:l==null?void 0:l.url},error:null})}catch(l){if(ce(l))return this._returnResult({data:{provider:n.provider,url:null},error:l});throw l}}async linkIdentityIdToken(n){return await this._useSession(async i=>{var l;try{const{error:u,data:{session:h}}=i;if(u)throw u;const{options:f,provider:g,token:p,access_token:b,nonce:x}=n,y=await he(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(l=h==null?void 0:h.access_token)!==null&&l!==void 0?l:void 0,body:{provider:g,id_token:p,access_token:b,nonce:x,link_identity:!0,gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:sn}),{data:E,error:_}=y;return _?this._returnResult({data:{user:null,session:null},error:_}):!E||!E.session||!E.user?this._returnResult({data:{user:null,session:null},error:new js}):(E.session&&(await this._saveSession(E.session),await this._notifyAllSubscribers("USER_UPDATED",E.session)),this._returnResult({data:E,error:_}))}catch(u){if(await pt(this.storage,`${this.storageKey}-code-verifier`),ce(u))return this._returnResult({data:{user:null,session:null},error:u});throw u}})}async unlinkIdentity(n){try{return await this._useSession(async i=>{var l,u;const{data:h,error:f}=i;if(f)throw f;return await he(this.fetch,"DELETE",`${this.url}/user/identities/${n.identity_id}`,{headers:this.headers,jwt:(u=(l=h.session)===null||l===void 0?void 0:l.access_token)!==null&&u!==void 0?u:void 0})})}catch(i){if(ce(i))return this._returnResult({data:null,error:i});throw i}}async _refreshAccessToken(n){const i=`#_refreshAccessToken(${n.substring(0,5)}...)`;this._debug(i,"begin");try{const l=Date.now();return await Fx(async u=>(u>0&&await Kx(200*Math.pow(2,u-1)),this._debug(i,"refreshing attempt",u),await he(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:n},headers:this.headers,xform:sn})),(u,h)=>{const f=200*Math.pow(2,u);return h&&gu(h)&&Date.now()+f-l<zs})}catch(l){if(this._debug(i,"error",l),ce(l))return this._returnResult({data:{session:null,user:null},error:l});throw l}finally{this._debug(i,"end")}}_isValidSession(n){return typeof n=="object"&&n!==null&&"access_token"in n&&"refresh_token"in n&&"expires_at"in n}async _handleProviderSignIn(n,i){const l=await this._getUrlForProvider(`${this.url}/authorize`,n,{redirectTo:i.redirectTo,scopes:i.scopes,queryParams:i.queryParams});return this._debug("#_handleProviderSignIn()","provider",n,"options",i,"url",l),mt()&&!i.skipBrowserRedirect&&window.location.assign(l),{data:{provider:n,url:l},error:null}}async _recoverAndRefresh(){var n,i;const l="#_recoverAndRefresh()";this._debug(l,"begin");try{const u=await za(this.storage,this.storageKey);if(u&&this.userStorage){let f=await za(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!f&&(f={user:u.user},await ks(this.userStorage,this.storageKey+"-user",f)),u.user=(n=f==null?void 0:f.user)!==null&&n!==void 0?n:yu()}else if(u&&!u.user&&!u.user){const f=await za(this.storage,this.storageKey+"-user");f&&(f!=null&&f.user)?(u.user=f.user,await pt(this.storage,this.storageKey+"-user"),await ks(this.storage,this.storageKey,u)):u.user=yu()}if(this._debug(l,"session from storage",u),!this._isValidSession(u)){this._debug(l,"session is not valid"),u!==null&&await this._removeSession();return}const h=((i=u.expires_at)!==null&&i!==void 0?i:1/0)*1e3-Date.now()<mu;if(this._debug(l,`session has${h?"":" not"} expired with margin of ${mu}s`),h){if(this.autoRefreshToken&&u.refresh_token){const{error:f}=await this._callRefreshToken(u.refresh_token);f&&(console.error(f),gu(f)||(this._debug(l,"refresh failed with a non-retryable error, removing the session",f),await this._removeSession()))}}else if(u.user&&u.user.__isUserNotAvailableProxy===!0)try{const{data:f,error:g}=await this._getUser(u.access_token);!g&&(f!=null&&f.user)?(u.user=f.user,await this._saveSession(u),await this._notifyAllSubscribers("SIGNED_IN",u)):this._debug(l,"could not get user data, skipping SIGNED_IN notification")}catch(f){console.error("Error getting user data:",f),this._debug(l,"error getting user data, skipping SIGNED_IN notification",f)}else await this._notifyAllSubscribers("SIGNED_IN",u)}catch(u){this._debug(l,"error",u),console.error(u);return}finally{this._debug(l,"end")}}async _callRefreshToken(n){var i,l;if(!n)throw new Ht;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const u=`#_callRefreshToken(${n.substring(0,5)}...)`;this._debug(u,"begin");try{this.refreshingDeferred=new Gl;const{data:h,error:f}=await this._refreshAccessToken(n);if(f)throw f;if(!h.session)throw new Ht;await this._saveSession(h.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",h.session);const g={data:h.session,error:null};return this.refreshingDeferred.resolve(g),g}catch(h){if(this._debug(u,"error",h),ce(h)){const f={data:null,error:h};return gu(h)||await this._removeSession(),(i=this.refreshingDeferred)===null||i===void 0||i.resolve(f),f}throw(l=this.refreshingDeferred)===null||l===void 0||l.reject(h),h}finally{this.refreshingDeferred=null,this._debug(u,"end")}}async _notifyAllSubscribers(n,i,l=!0){const u=`#_notifyAllSubscribers(${n})`;this._debug(u,"begin",i,`broadcast = ${l}`);try{this.broadcastChannel&&l&&this.broadcastChannel.postMessage({event:n,session:i});const h=[],f=Array.from(this.stateChangeEmitters.values()).map(async g=>{try{await g.callback(n,i)}catch(p){h.push(p)}});if(await Promise.all(f),h.length>0){for(let g=0;g<h.length;g+=1)console.error(h[g]);throw h[0]}}finally{this._debug(u,"end")}}async _saveSession(n){this._debug("#_saveSession()",n),this.suppressGetSessionWarning=!0,await pt(this.storage,`${this.storageKey}-code-verifier`);const i=Object.assign({},n),l=i.user&&i.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!l&&i.user&&await ks(this.userStorage,this.storageKey+"-user",{user:i.user});const u=Object.assign({},i);delete u.user;const h=T0(u);await ks(this.storage,this.storageKey,h)}else{const u=T0(i);await ks(this.storage,this.storageKey,u)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await pt(this.storage,this.storageKey),await pt(this.storage,this.storageKey+"-code-verifier"),await pt(this.storage,this.storageKey+"-user"),this.userStorage&&await pt(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const n=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{n&&mt()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",n)}catch(i){console.error("removing visibilitychange callback failed",i)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const n=setInterval(()=>this._autoRefreshTokenTick(),zs);this.autoRefreshTicker=n,n&&typeof n=="object"&&typeof n.unref=="function"?n.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(n),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const n=this.autoRefreshTicker;this.autoRefreshTicker=null,n&&clearInterval(n)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const n=Date.now();try{return await this._useSession(async i=>{const{data:{session:l}}=i;if(!l||!l.refresh_token||!l.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const u=Math.floor((l.expires_at*1e3-n)/zs);this._debug("#_autoRefreshTokenTick()",`access token expires in ${u} ticks, a tick lasts ${zs}ms, refresh threshold is ${Du} ticks`),u<=Du&&await this._callRefreshToken(l.refresh_token)})}catch(i){console.error("Auto refresh tick failed with error. This is likely a transient error.",i)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(n){if(n.isAcquireTimeout||n instanceof dg)this._debug("auto refresh token tick lock not available");else throw n}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!mt()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(n){console.error("_handleVisibilityChange",n)}}async _onVisibilityChanged(n){const i=`#_onVisibilityChanged(${n})`;this._debug(i,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),n||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(i,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(n,i,l){const u=[`provider=${encodeURIComponent(i)}`];if(l!=null&&l.redirectTo&&u.push(`redirect_to=${encodeURIComponent(l.redirectTo)}`),l!=null&&l.scopes&&u.push(`scopes=${encodeURIComponent(l.scopes)}`),this.flowType==="pkce"){const[h,f]=await Rs(this.storage,this.storageKey),g=new URLSearchParams({code_challenge:`${encodeURIComponent(h)}`,code_challenge_method:`${encodeURIComponent(f)}`});u.push(g.toString())}if(l!=null&&l.queryParams){const h=new URLSearchParams(l.queryParams);u.push(h.toString())}return l!=null&&l.skipBrowserRedirect&&u.push(`skip_http_redirect=${l.skipBrowserRedirect}`),`${n}?${u.join("&")}`}async _unenroll(n){try{return await this._useSession(async i=>{var l;const{data:u,error:h}=i;return h?this._returnResult({data:null,error:h}):await he(this.fetch,"DELETE",`${this.url}/factors/${n.factorId}`,{headers:this.headers,jwt:(l=u==null?void 0:u.session)===null||l===void 0?void 0:l.access_token})})}catch(i){if(ce(i))return this._returnResult({data:null,error:i});throw i}}async _enroll(n){try{return await this._useSession(async i=>{var l,u;const{data:h,error:f}=i;if(f)return this._returnResult({data:null,error:f});const g=Object.assign({friendly_name:n.friendlyName,factor_type:n.factorType},n.factorType==="phone"?{phone:n.phone}:n.factorType==="totp"?{issuer:n.issuer}:{}),{data:p,error:b}=await he(this.fetch,"POST",`${this.url}/factors`,{body:g,headers:this.headers,jwt:(l=h==null?void 0:h.session)===null||l===void 0?void 0:l.access_token});return b?this._returnResult({data:null,error:b}):(n.factorType==="totp"&&p.type==="totp"&&(!((u=p==null?void 0:p.totp)===null||u===void 0)&&u.qr_code)&&(p.totp.qr_code=`data:image/svg+xml;utf-8,${p.totp.qr_code}`),this._returnResult({data:p,error:null}))})}catch(i){if(ce(i))return this._returnResult({data:null,error:i});throw i}}async _verify(n){return this._acquireLock(-1,async()=>{try{return await this._useSession(async i=>{var l;const{data:u,error:h}=i;if(h)return this._returnResult({data:null,error:h});const f=Object.assign({challenge_id:n.challengeId},"webauthn"in n?{webauthn:Object.assign(Object.assign({},n.webauthn),{credential_response:n.webauthn.type==="create"?N_(n.webauthn.credential_response):S_(n.webauthn.credential_response)})}:{code:n.code}),{data:g,error:p}=await he(this.fetch,"POST",`${this.url}/factors/${n.factorId}/verify`,{body:f,headers:this.headers,jwt:(l=u==null?void 0:u.session)===null||l===void 0?void 0:l.access_token});return p?this._returnResult({data:null,error:p}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+g.expires_in},g)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",g),this._returnResult({data:g,error:p}))})}catch(i){if(ce(i))return this._returnResult({data:null,error:i});throw i}})}async _challenge(n){return this._acquireLock(-1,async()=>{try{return await this._useSession(async i=>{var l;const{data:u,error:h}=i;if(h)return this._returnResult({data:null,error:h});const f=await he(this.fetch,"POST",`${this.url}/factors/${n.factorId}/challenge`,{body:n,headers:this.headers,jwt:(l=u==null?void 0:u.session)===null||l===void 0?void 0:l.access_token});if(f.error)return f;const{data:g}=f;if(g.type!=="webauthn")return{data:g,error:null};switch(g.webauthn.type){case"create":return{data:Object.assign(Object.assign({},g),{webauthn:Object.assign(Object.assign({},g.webauthn),{credential_options:Object.assign(Object.assign({},g.webauthn.credential_options),{publicKey:w_(g.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},g),{webauthn:Object.assign(Object.assign({},g.webauthn),{credential_options:Object.assign(Object.assign({},g.webauthn.credential_options),{publicKey:E_(g.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(i){if(ce(i))return this._returnResult({data:null,error:i});throw i}})}async _challengeAndVerify(n){const{data:i,error:l}=await this._challenge({factorId:n.factorId});return l?this._returnResult({data:null,error:l}):await this._verify({factorId:n.factorId,challengeId:i.id,code:n.code})}async _listFactors(){var n;const{data:{user:i},error:l}=await this.getUser();if(l)return{data:null,error:l};const u={all:[],phone:[],totp:[],webauthn:[]};for(const h of(n=i==null?void 0:i.factors)!==null&&n!==void 0?n:[])u.all.push(h),h.status==="verified"&&u[h.factor_type].push(h);return{data:u,error:null}}async _getAuthenticatorAssuranceLevel(){var n,i;const{data:{session:l},error:u}=await this.getSession();if(u)return this._returnResult({data:null,error:u});if(!l)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:h}=bu(l.access_token);let f=null;h.aal&&(f=h.aal);let g=f;((i=(n=l.user.factors)===null||n===void 0?void 0:n.filter(x=>x.status==="verified"))!==null&&i!==void 0?i:[]).length>0&&(g="aal2");const b=h.amr||[];return{data:{currentLevel:f,nextLevel:g,currentAuthenticationMethods:b},error:null}}async _getAuthorizationDetails(n){try{return await this._useSession(async i=>{const{data:{session:l},error:u}=i;return u?this._returnResult({data:null,error:u}):l?await he(this.fetch,"GET",`${this.url}/oauth/authorizations/${n}`,{headers:this.headers,jwt:l.access_token,xform:h=>({data:h,error:null})}):this._returnResult({data:null,error:new Ht})})}catch(i){if(ce(i))return this._returnResult({data:null,error:i});throw i}}async _approveAuthorization(n,i){try{return await this._useSession(async l=>{const{data:{session:u},error:h}=l;if(h)return this._returnResult({data:null,error:h});if(!u)return this._returnResult({data:null,error:new Ht});const f=await he(this.fetch,"POST",`${this.url}/oauth/authorizations/${n}/consent`,{headers:this.headers,jwt:u.access_token,body:{action:"approve"},xform:g=>({data:g,error:null})});return f.data&&f.data.redirect_url&&mt()&&!(i!=null&&i.skipBrowserRedirect)&&window.location.assign(f.data.redirect_url),f})}catch(l){if(ce(l))return this._returnResult({data:null,error:l});throw l}}async _denyAuthorization(n,i){try{return await this._useSession(async l=>{const{data:{session:u},error:h}=l;if(h)return this._returnResult({data:null,error:h});if(!u)return this._returnResult({data:null,error:new Ht});const f=await he(this.fetch,"POST",`${this.url}/oauth/authorizations/${n}/consent`,{headers:this.headers,jwt:u.access_token,body:{action:"deny"},xform:g=>({data:g,error:null})});return f.data&&f.data.redirect_url&&mt()&&!(i!=null&&i.skipBrowserRedirect)&&window.location.assign(f.data.redirect_url),f})}catch(l){if(ce(l))return this._returnResult({data:null,error:l});throw l}}async _listOAuthGrants(){try{return await this._useSession(async n=>{const{data:{session:i},error:l}=n;return l?this._returnResult({data:null,error:l}):i?await he(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:i.access_token,xform:u=>({data:u,error:null})}):this._returnResult({data:null,error:new Ht})})}catch(n){if(ce(n))return this._returnResult({data:null,error:n});throw n}}async _revokeOAuthGrant(n){try{return await this._useSession(async i=>{const{data:{session:l},error:u}=i;return u?this._returnResult({data:null,error:u}):l?(await he(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:l.access_token,query:{client_id:n.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Ht})})}catch(i){if(ce(i))return this._returnResult({data:null,error:i});throw i}}async fetchJwk(n,i={keys:[]}){let l=i.keys.find(g=>g.kid===n);if(l)return l;const u=Date.now();if(l=this.jwks.keys.find(g=>g.kid===n),l&&this.jwks_cached_at+Ix>u)return l;const{data:h,error:f}=await he(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(f)throw f;return!h.keys||h.keys.length===0||(this.jwks=h,this.jwks_cached_at=u,l=h.keys.find(g=>g.kid===n),!l)?null:l}async getClaims(n,i={}){try{let l=n;if(!l){const{data:_,error:w}=await this.getSession();if(w||!_.session)return this._returnResult({data:null,error:w});l=_.session.access_token}const{header:u,payload:h,signature:f,raw:{header:g,payload:p}}=bu(l);i!=null&&i.allowExpired||t_(h.exp);const b=!u.alg||u.alg.startsWith("HS")||!u.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(u.kid,i!=null&&i.keys?{keys:i.keys}:i==null?void 0:i.jwks);if(!b){const{error:_}=await this.getUser(l);if(_)throw _;return{data:{claims:h,header:u,signature:f},error:null}}const x=n_(u.alg),y=await crypto.subtle.importKey("jwk",b,x,!0,["verify"]);if(!await crypto.subtle.verify(x,y,f,Px(`${g}.${p}`)))throw new ku("Invalid JWT signature");return{data:{claims:h,header:u,signature:f},error:null}}catch(l){if(ce(l))return this._returnResult({data:null,error:l});throw l}}}Wi.nextInstanceID={};const U_=Wi,z_="2.89.0";let Hi="";typeof Deno<"u"?Hi="deno":typeof document<"u"?Hi="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Hi="react-native":Hi="node";const k_={"X-Client-Info":`supabase-js-${Hi}/${z_}`},L_={headers:k_},M_={schema:"public"},B_={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},H_={};function Zi(a){"@babel/helpers - typeof";return Zi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Zi(a)}function G_(a,n){if(Zi(a)!="object"||!a)return a;var i=a[Symbol.toPrimitive];if(i!==void 0){var l=i.call(a,n);if(Zi(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(a)}function P_(a){var n=G_(a,"string");return Zi(n)=="symbol"?n:n+""}function $_(a,n,i){return(n=P_(n))in a?Object.defineProperty(a,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):a[n]=i,a}function D0(a,n){var i=Object.keys(a);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(a);n&&(l=l.filter(function(u){return Object.getOwnPropertyDescriptor(a,u).enumerable})),i.push.apply(i,l)}return i}function Xe(a){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?D0(Object(i),!0).forEach(function(l){$_(a,l,i[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(i)):D0(Object(i)).forEach(function(l){Object.defineProperty(a,l,Object.getOwnPropertyDescriptor(i,l))})}return a}const V_=a=>a?(...n)=>a(...n):(...n)=>fetch(...n),Y_=()=>Headers,q_=(a,n,i)=>{const l=V_(i),u=Y_();return async(h,f)=>{var g;const p=(g=await n())!==null&&g!==void 0?g:a;let b=new u(f==null?void 0:f.headers);return b.has("apikey")||b.set("apikey",a),b.has("Authorization")||b.set("Authorization",`Bearer ${p}`),l(h,Xe(Xe({},f),{},{headers:b}))}};function K_(a){return a.endsWith("/")?a:a+"/"}function F_(a,n){var i,l;const{db:u,auth:h,realtime:f,global:g}=a,{db:p,auth:b,realtime:x,global:y}=n,E={db:Xe(Xe({},p),u),auth:Xe(Xe({},b),h),realtime:Xe(Xe({},x),f),storage:{},global:Xe(Xe(Xe({},y),g),{},{headers:Xe(Xe({},(i=y==null?void 0:y.headers)!==null&&i!==void 0?i:{}),(l=g==null?void 0:g.headers)!==null&&l!==void 0?l:{})}),accessToken:async()=>""};return a.accessToken?E.accessToken=a.accessToken:delete E.accessToken,E}function J_(a){const n=a==null?void 0:a.trim();if(!n)throw new Error("supabaseUrl is required.");if(!n.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(K_(n))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var X_=class extends U_{constructor(a){super(a)}},Q_=class{constructor(a,n,i){var l,u;this.supabaseUrl=a,this.supabaseKey=n;const h=J_(a);if(!n)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",h),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",h),this.storageUrl=new URL("storage/v1",h),this.functionsUrl=new URL("functions/v1",h);const f=`sb-${h.hostname.split(".")[0]}-auth-token`,g={db:M_,realtime:H_,auth:Xe(Xe({},B_),{},{storageKey:f}),global:L_},p=F_(i??{},g);if(this.storageKey=(l=p.auth.storageKey)!==null&&l!==void 0?l:"",this.headers=(u=p.global.headers)!==null&&u!==void 0?u:{},p.accessToken)this.accessToken=p.accessToken,this.auth=new Proxy({},{get:(x,y)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(y)} is not possible`)}});else{var b;this.auth=this._initSupabaseAuthClient((b=p.auth)!==null&&b!==void 0?b:{},this.headers,p.global.fetch)}this.fetch=q_(n,this._getAccessToken.bind(this),p.global.fetch),this.realtime=this._initRealtimeClient(Xe({headers:this.headers,accessToken:this._getAccessToken.bind(this)},p.realtime)),this.accessToken&&this.accessToken().then(x=>this.realtime.setAuth(x)).catch(x=>console.warn("Failed to set initial Realtime auth token:",x)),this.rest=new Rv(new URL("rest/v1",h).href,{headers:this.headers,schema:p.db.schema,fetch:this.fetch}),this.storage=new Ax(this.storageUrl.href,this.headers,this.fetch,i==null?void 0:i.storage),p.accessToken||this._listenForAuthEvents()}get functions(){return new Sv(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(a){return this.rest.from(a)}schema(a){return this.rest.schema(a)}rpc(a,n={},i={head:!1,get:!1,count:void 0}){return this.rest.rpc(a,n,i)}channel(a,n={config:{}}){return this.realtime.channel(a,n)}getChannels(){return this.realtime.getChannels()}removeChannel(a){return this.realtime.removeChannel(a)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var a=this,n,i;if(a.accessToken)return await a.accessToken();const{data:l}=await a.auth.getSession();return(n=(i=l.session)===null||i===void 0?void 0:i.access_token)!==null&&n!==void 0?n:a.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:a,persistSession:n,detectSessionInUrl:i,storage:l,userStorage:u,storageKey:h,flowType:f,lock:g,debug:p,throwOnError:b},x,y){const E={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new X_({url:this.authUrl.href,headers:Xe(Xe({},E),x),storageKey:h,autoRefreshToken:a,persistSession:n,detectSessionInUrl:i,storage:l,userStorage:u,flowType:f,lock:g,debug:p,throwOnError:b,fetch:y,hasCustomAuthorizationHeader:Object.keys(this.headers).some(_=>_.toLowerCase()==="authorization")})}_initRealtimeClient(a){return new Kv(this.realtimeUrl.href,Xe(Xe({},a),{},{params:Xe(Xe({},{apikey:this.supabaseKey}),a==null?void 0:a.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((a,n)=>{this._handleTokenChanged(a,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(a,n,i){(a==="TOKEN_REFRESHED"||a==="SIGNED_IN")&&this.changedAccessToken!==i?(this.changedAccessToken=i,this.realtime.setAuth(i)):a==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const W_=(a,n,i)=>new Q_(a,n,i);function Z_(){if(typeof window<"u"||typeof process>"u")return!1;const a=process.version;if(a==null)return!1;const n=a.match(/^v(\d+)\./);return n?parseInt(n[1],10)<=18:!1}Z_()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const pg="https://zqdwuxtgxbkuhvthyyao.supabase.co",mg="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpxZHd1eHRneGJrdWh2dGh5eWFvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjY5NTEwNTAsImV4cCI6MjA4MjUyNzA1MH0.4TkkCHQmxMtCL5z6zdj59v-VIFsRzNFFNIWaVDptxwo";(pg.includes("your-project-id")||mg.includes("your-anon-key"))&&console.warn(" CNH BO: Bn cha nhp Supabase URL v Key trong file 'config.ts'. Chc nng ng nhp s khng hot ng.");const Re=W_(pg,mg),Mn=({className:a})=>o.jsxs("svg",{className:a,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"3"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),ma=({className:a})=>o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",className:a,children:[o.jsx("path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"}),o.jsx("path",{d:"m15 5 4 4"})]}),gg=({className:a})=>o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",className:a,children:[o.jsx("path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),o.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),Pl=({className:a})=>o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",className:a,children:[o.jsx("rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2"}),o.jsx("line",{x1:"3",x2:"21",y1:"9",y2:"9"}),o.jsx("line",{x1:"9",x2:"9",y1:"21",y2:"9"})]}),Ul=({className:a})=>o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",className:a,children:[o.jsx("rect",{width:"7",height:"7",x:"3",y:"3",rx:"1"}),o.jsx("rect",{width:"7",height:"7",x:"14",y:"3",rx:"1"}),o.jsx("rect",{width:"7",height:"7",x:"14",y:"14",rx:"1"}),o.jsx("rect",{width:"7",height:"7",x:"3",y:"14",rx:"1"})]}),Gi=({className:a})=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",className:a,children:o.jsx("path",{d:"M4 20h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.93a2 2 0 0 1-1.66-.9l-.82-1.2A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13c0 1.1.9 2 2 2Z"})}),zl=({className:a})=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",className:a,children:o.jsx("path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"})}),Lu=({className:a})=>o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",className:a,children:[o.jsx("circle",{cx:"12",cy:"12",r:"10"}),o.jsx("path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20"}),o.jsx("path",{d:"M2 12h20"})]}),mn=({className:a})=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",className:a,children:o.jsx("path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L12 3Z"})}),Zt=({className:a})=>o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",className:a,children:[o.jsx("path",{d:"M3 6h18"}),o.jsx("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}),o.jsx("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"})]}),on=({className:a})=>o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",className:a,children:[o.jsx("path",{d:"M5 12h14"}),o.jsx("path",{d:"M12 5v14"})]}),Ga=({className:a})=>o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",className:a,children:[o.jsx("path",{d:"M5 12h14"}),o.jsx("path",{d:"m12 5 7 7-7 7"})]}),Pi=({className:a})=>o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",className:a,children:[o.jsx("rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2"}),o.jsx("path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"})]}),Ps=({className:a})=>o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",className:a,children:[o.jsx("path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"}),o.jsx("path",{d:"M3 3v5h5"}),o.jsx("path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16"}),o.jsx("path",{d:"M16 16h5v5"})]}),bg=({className:a})=>o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",className:a,children:[o.jsx("path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"}),o.jsx("polyline",{points:"14 2 14 8 20 8"}),o.jsx("line",{x1:"8",x2:"8",y1:"13",y2:"13"}),o.jsx("line",{x1:"16",x2:"16",y1:"13",y2:"13"}),o.jsx("line",{x1:"8",x2:"8",y1:"17",y2:"17"}),o.jsx("line",{x1:"16",x2:"16",y1:"17",y2:"17"}),o.jsx("line",{x1:"8",x2:"8",y1:"9",y2:"9"})]}),er=({className:a})=>o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",className:a,children:[o.jsx("circle",{cx:"11",cy:"11",r:"8"}),o.jsx("path",{d:"m21 21-4.3-4.3"})]}),ew=({className:a})=>o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",className:a,children:[o.jsx("path",{d:"M15 3h6v6"}),o.jsx("path",{d:"M9 21H3v-6"}),o.jsx("path",{d:"M21 3l-7 7"}),o.jsx("path",{d:"M3 21l7-7"})]}),tw=({className:a})=>o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",className:a,children:[o.jsx("path",{d:"M8 3v3a2 2 0 0 1-2 2H3"}),o.jsx("path",{d:"M21 8h-3a2 2 0 0 1-2-2V3"}),o.jsx("path",{d:"M3 16h3a2 2 0 0 1 2 2v3"}),o.jsx("path",{d:"M16 21v-3a2 2 0 0 1 2-2h3"})]}),nw=({className:a})=>o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",className:a,children:[o.jsx("circle",{cx:"13.5",cy:"6.5",r:".5"}),o.jsx("circle",{cx:"17.5",cy:"10.5",r:".5"}),o.jsx("circle",{cx:"8.5",cy:"7.5",r:".5"}),o.jsx("circle",{cx:"6.5",cy:"12.5",r:".5"}),o.jsx("path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z"})]}),st=({className:a})=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",className:a,children:o.jsx("polyline",{points:"20 6 9 17 4 12"})}),yg=({className:a})=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",className:a,children:o.jsx("path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"})}),aw=({className:a})=>o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",className:a,children:[o.jsx("rect",{width:"20",height:"16",x:"2",y:"4",rx:"2"}),o.jsx("path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"})]}),tr=({className:a})=>o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",className:a,children:[o.jsx("path",{d:"M2 15c6.667-6 13.333 0 20-6"}),o.jsx("path",{d:"M9 22c1.798-1.998 2.518-3.995 2.807-5.993"}),o.jsx("path",{d:"M15 2c-1.798 1.998-2.518 3.995-2.807 5.993"}),o.jsx("path",{d:"M17 6l-2.5-2.5"}),o.jsx("path",{d:"M14 8l-1-1"}),o.jsx("path",{d:"M7 18l2.5 2.5"}),o.jsx("path",{d:"M3.5 14.5l.5.5"}),o.jsx("path",{d:"M20 9l.5.5"}),o.jsx("path",{d:"M6.5 12.5l1 1"}),o.jsx("path",{d:"M16.5 10.5l1 1"}),o.jsx("path",{d:"M10 16l1.5 1.5"})]}),sw=({className:a})=>o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",className:a,children:[o.jsx("path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"}),o.jsx("path",{d:"M3 3v5h5"}),o.jsx("path",{d:"M12 7v5l4 2"})]}),U0=({className:a})=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",className:a,children:o.jsx("path",{d:"m6 9 6 6 6-6"})}),z0=({className:a})=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",className:a,children:o.jsx("path",{d:"m18 15-6-6-6 6"})}),iw=({className:a})=>o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",className:a,children:[o.jsx("line",{x1:"12",x2:"12",y1:"20",y2:"10"}),o.jsx("line",{x1:"18",x2:"18",y1:"20",y2:"4"}),o.jsx("line",{x1:"6",x2:"6",y1:"20",y2:"16"})]}),rw=async a=>{if(!a)return null;try{const n=await fetch("https://openrouter.ai/api/v1/auth/key",{method:"GET",headers:{Authorization:`Bearer ${a}`}});return n.ok?(await n.json()).data:null}catch(n){return console.error("Failed to fetch OpenRouter credits:",n),null}},Hn=async(a,n,i,l,u=!1)=>{var h,f,g,p,b,x,y;if(!l)throw new Error("OpenRouter API Key is missing. Please add it in Settings.");console.log("[OpenRouter] Preparing Request..."),console.log(`[OpenRouter] Model: ${a}`),console.log(`[OpenRouter] System Prompt Length: ${n.length}`),console.log(`[OpenRouter] User Prompt Length: ${i.length}`);try{const E=a.toLowerCase().includes("gemini"),_={model:a,messages:[{role:"system",content:n},{role:"user",content:i}],temperature:.4,max_tokens:32e3};u&&!E&&(_.response_format={type:"json_object"}),console.log(`[OpenRouter] Full Request Payload Size: ~${JSON.stringify(_).length} chars`);const w=await fetch("https://openrouter.ai/api/v1/chat/completions",{method:"POST",headers:{Authorization:`Bearer ${l}`,"Content-Type":"application/json","HTTP-Referer":"https://log-ai.app","X-Title":"LOG AI Script Engine"},body:JSON.stringify(_)}),N=(await w.text()).trim();console.log(`[OpenRouter] Response Status: ${w.status}`);const k=N.length>2e3?N.substring(0,2e3)+"...":N;console.log("[OpenRouter] Raw Response:",k);let K;try{if(!N)throw new Error("Empty response body from OpenRouter.");K=JSON.parse(N)}catch{throw console.error("[OpenRouter] FATAL: API returned invalid JSON envelope."),new Error(`OpenRouter API response was not valid JSON. Status: ${w.status}. Preview: ${k}`)}if(!w.ok){const P=((h=K.error)==null?void 0:h.message)||((f=K.error)==null?void 0:f.code)||JSON.stringify(K);throw new Error(`OpenRouter Error (${w.status}): ${P}`)}let H=((b=(p=(g=K.choices)==null?void 0:g[0])==null?void 0:p.message)==null?void 0:b.content)||"";if(!H&&((y=(x=K.choices)==null?void 0:x[0])==null?void 0:y.finish_reason)==="stop"&&console.warn("[OpenRouter] Content is empty but finish_reason is stop. Model might have failed to generate text."),console.log(`[OpenRouter] Extracted Content Length: ${H.length}`),u){H=H.replace(/^```json\s*/i,"").replace(/^```\s*/,"").replace(/```\s*$/,"");const P=H.indexOf("{"),ee=H.lastIndexOf("}");if(P!==-1&&ee!==-1&&ee>=P){const te=H.substring(P,ee+1);te.length<H.length&&(console.log(`[OpenRouter] Trimmed content from ${H.length} to ${te.length} chars (found JSON bounds).`),H=te)}else console.warn("[OpenRouter] JSON Mode is ON but no curly braces found in content!")}if(!H.trim())throw new Error("AI returned empty content string.");return H}catch(E){throw console.error("OpenRouter Service Error:",E),new Error(E.message||"Failed to generate content via OpenRouter")}},Sl=({icon:a,label:n,active:i,onClick:l})=>o.jsxs("button",{onClick:l,className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium transition-all ${i?"bg-white text-black shadow-lg shadow-white/10":"text-zinc-400 hover:text-white hover:bg-white/5"}`,children:[a,n]}),lw=({currentRoute:a,onNavigate:n,onLogout:i,userEmail:l,openRouterKey:u})=>{const[h,f]=ie.useState(null),[g,p]=ie.useState(!1),b=a==="/home/pricing",x=5,y=h?(h.usage||0)*x:0,E=h&&h.limit!=null?h.limit*x:null,_=h&&h.limit?Math.min(h.usage/h.limit*100,100):0;return ie.useEffect(()=>{u&&rw(u).then(f)},[u]),o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:()=>p(!g),className:"md:hidden fixed top-4 left-4 z-50 p-3 bg-zinc-900 border border-white/10 rounded-lg hover:bg-zinc-800 transition-colors","aria-label":"Toggle menu",children:o.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g?o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"}):o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),g&&o.jsx("div",{className:"md:hidden fixed inset-0 bg-black/70 z-40 backdrop-blur-sm",onClick:()=>p(!1)}),o.jsxs("aside",{className:`
        fixed left-0 top-0 bottom-0 w-64 bg-zinc-950 border-r border-white/5 flex flex-col z-50
        transition-transform duration-300 ease-in-out
        ${g?"translate-x-0":"-translate-x-full md:translate-x-0"}
      `,children:[o.jsx("div",{className:"p-6 border-b border-white/5",children:o.jsxs("div",{className:"flex items-center gap-3 cursor-pointer",onClick:()=>{n("/home/dashboard"),p(!1)},children:[o.jsx("div",{className:"w-8 h-8 rounded-lg bg-white flex items-center justify-center",children:o.jsx(ma,{className:"w-4 h-4 text-black"})}),o.jsx("span",{className:"text-xl font-black text-white tracking-tighter",children:"LOG"})]})}),!b&&o.jsxs(o.Fragment,{children:[o.jsxs("nav",{className:"flex-1 p-4 space-y-2",children:[o.jsx("p",{className:"px-3 text-[10px] font-bold text-zinc-600 uppercase tracking-widest mb-2 mt-2",children:"Menu"}),o.jsx(Sl,{icon:o.jsx(Ul,{className:"w-4 h-4"}),label:"Dashboard",active:a==="/home/dashboard",onClick:()=>{n("/home/dashboard"),p(!1)}}),o.jsx(Sl,{icon:o.jsx(ma,{className:"w-4 h-4"}),label:"Creating",active:a==="/home/creating",onClick:()=>{n("/home/creating"),p(!1)}}),o.jsx(Sl,{icon:o.jsx(tr,{className:"w-4 h-4"}),label:"DNA Lab",active:a==="/home/dna",onClick:()=>{n("/home/dna"),p(!1)}}),o.jsx(Sl,{icon:o.jsx(bg,{className:"w-4 h-4"}),label:"Notes",active:a==="/home/notes",onClick:()=>{n("/home/notes"),p(!1)}}),o.jsxs("div",{className:"pt-6 pb-2",children:[o.jsx("p",{className:"px-3 text-[10px] font-bold text-zinc-600 uppercase tracking-widest mb-2",children:"System"}),o.jsxs("button",{onClick:i,className:"w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium text-zinc-400 hover:text-red-400 hover:bg-red-500/10 transition-all",children:[o.jsx(Ga,{className:"w-4 h-4 rotate-180"}),"Log Out"]})]})]}),o.jsxs("div",{className:"px-4 pb-4 space-y-4",children:[o.jsxs("a",{href:"https://www.facebook.com/logdd.pitre",target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-3 px-3 py-2.5 bg-blue-600/10 hover:bg-blue-600/20 border border-blue-500/20 hover:border-blue-500/40 rounded-lg text-sm font-bold text-blue-400 hover:text-blue-300 transition-all group",children:[o.jsx(yg,{className:"w-4 h-4 group-hover:scale-110 transition-transform"}),o.jsx("span",{children:"Support / Contact"})]}),h&&o.jsxs("div",{className:"bg-zinc-900/50 rounded-xl p-3 border border-white/5",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("span",{className:"text-[10px] font-bold text-zinc-500 uppercase tracking-widest",children:"AI Usage"}),o.jsxs("span",{className:"text-xs font-mono font-bold text-white",children:["$",y.toFixed(3)]})]}),h.limit&&o.jsx("div",{className:"w-full h-1 bg-black rounded-full overflow-hidden mb-1",children:o.jsx("div",{className:"h-full bg-gradient-to-r from-blue-600 to-purple-600",style:{width:`${_}%`}})}),h.limit&&o.jsxs("div",{className:"text-right text-[9px] text-zinc-600",children:["Limit: $",E]})]}),l&&o.jsx("div",{className:"px-3 text-[10px] text-zinc-500 font-mono truncate opacity-60 hover:opacity-100 transition-opacity",children:l})]})]})]})]})},k0=({simple:a})=>o.jsx("footer",{className:"fixed bottom-0 left-0 right-0 bg-black/80 backdrop-blur-sm border-t border-white/5 py-3 text-center z-40",children:o.jsx("p",{className:"text-zinc-600 text-[10px]",children:" 2025 LOG AI Inc. All rights reserved."})}),ow=({onNavigate:a})=>o.jsxs("nav",{className:"fixed top-0 left-0 right-0 z-50 flex items-center justify-between px-6 py-4 md:px-12 backdrop-blur-md bg-black/70 border-b border-white/5 transition-all",children:[o.jsxs("div",{className:"flex items-center gap-3 cursor-pointer group",onClick:()=>a("/home"),children:[o.jsx("div",{className:"w-9 h-9 rounded-xl bg-white flex items-center justify-center shadow-[0_0_20px_rgba(255,255,255,0.2)] group-hover:scale-105 transition-transform",children:o.jsx(ma,{className:"w-5 h-5 text-black"})}),o.jsx("span",{className:"text-xl font-black text-white tracking-tighter",children:"LOG"})]}),o.jsxs("div",{className:"hidden md:flex items-center gap-6 text-sm",children:[o.jsx("button",{onClick:()=>window.scrollTo({top:0,behavior:"smooth"}),className:"text-zinc-400 hover:text-white transition-colors font-medium",children:"Sign In"}),o.jsx("a",{href:"#how-it-works",className:"text-zinc-400 hover:text-white transition-colors",children:"How It Works"}),o.jsx("a",{href:"#features",className:"text-zinc-400 hover:text-white transition-colors",children:"Features"}),o.jsx("a",{href:"#pricing",className:"text-zinc-400 hover:text-white transition-colors",children:"Pricing"}),o.jsx("a",{href:"#faq",className:"text-zinc-400 hover:text-white transition-colors",children:"FAQ"})]})]}),cw=({onNavigate:a,onAuth:n,authLoading:i})=>{const[l,u]=ie.useState(""),[h,f]=ie.useState(""),[g,p]=ie.useState(!1),b=x=>{x.preventDefault(),l&&h&&n(l,h,g)};return o.jsxs("div",{className:"relative text-center px-4 overflow-hidden",children:[o.jsxs("div",{className:"relative min-h-[90vh] flex flex-col justify-center",children:[o.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[600px] h-[300px] bg-purple-600/20 blur-[120px] rounded-full pointer-events-none"}),o.jsxs("div",{className:"relative z-10 space-y-8 max-w-4xl mx-auto",children:[o.jsx("div",{className:"inline-block px-4 py-2 bg-purple-500/10 border border-purple-500/20 rounded-full text-purple-400 text-sm font-medium mb-4",children:" AI-Powered Script Optimization"}),o.jsxs("h1",{className:"text-6xl md:text-8xl font-black text-white tracking-tighter leading-[1] animate-in fade-in slide-in-from-bottom-6 duration-700 delay-100",children:["The Logic of ",o.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-pink-600",children:"Virality"})]}),o.jsxs("p",{className:"text-lg md:text-2xl text-zinc-400 max-w-2xl mx-auto leading-relaxed font-light animate-in fade-in slide-in-from-bottom-8 duration-700 delay-200",children:["Stop guessing. Start engineering. LOG analyzes successful content DNA to rewrite your scripts for ",o.jsx("span",{className:"text-white font-semibold",children:"maximum retention"}),"."]}),o.jsxs("div",{className:"flex justify-center gap-8 md:gap-12 py-6 animate-in fade-in slide-in-from-bottom-10 duration-700 delay-300",children:[o.jsxs("div",{children:[o.jsx("div",{className:"text-3xl font-bold text-white",children:"10x"}),o.jsx("div",{className:"text-sm text-zinc-500",children:"Faster Writing"})]}),o.jsxs("div",{children:[o.jsx("div",{className:"text-3xl font-bold text-white",children:"85%"}),o.jsx("div",{className:"text-sm text-zinc-500",children:"Avg. Retention"})]}),o.jsxs("div",{children:[o.jsx("div",{className:"text-3xl font-bold text-white",children:"1M+"}),o.jsx("div",{className:"text-sm text-zinc-500",children:"Scripts Analyzed"})]})]}),o.jsxs("div",{className:"max-w-sm mx-auto bg-zinc-900/50 border border-white/10 rounded-2xl p-6 backdrop-blur-md shadow-2xl animate-in fade-in slide-in-from-bottom-10 duration-700 delay-400",children:[o.jsxs("form",{onSubmit:b,className:"space-y-4",children:[o.jsx("div",{children:o.jsx("input",{type:"email",placeholder:"Email address",className:"w-full bg-black/50 border border-zinc-700 rounded-lg px-4 py-3 text-white focus:outline-none focus:border-purple-500 transition-colors",value:l,onChange:x=>u(x.target.value),required:!0})}),o.jsx("div",{children:o.jsx("input",{type:"password",placeholder:"Password",className:"w-full bg-black/50 border border-zinc-700 rounded-lg px-4 py-3 text-white focus:outline-none focus:border-purple-500 transition-colors",value:h,onChange:x=>f(x.target.value),required:!0})}),o.jsx("button",{type:"submit",disabled:i,className:"w-full bg-gradient-to-r from-purple-600 to-pink-600 text-white font-bold py-3 rounded-lg hover:from-purple-700 hover:to-pink-700 transition-all flex items-center justify-center gap-2 shadow-lg shadow-purple-500/50",children:i?o.jsx(Mn,{className:"w-5 h-5 animate-spin"}):o.jsxs(o.Fragment,{children:[g?"Create Account":"Sign In",o.jsx(Ga,{className:"w-4 h-4"})]})})]}),o.jsxs("div",{className:"mt-4 text-xs text-zinc-500",children:[g?"Already have an account? ":"Don't have an account? ",o.jsx("button",{onClick:()=>p(!g),className:"text-purple-400 font-bold hover:underline",children:g?"Sign In":"Sign Up"})]})]})]})]}),o.jsxs("div",{id:"how-it-works",className:"py-24 max-w-6xl mx-auto",children:[o.jsxs("div",{className:"text-center mb-16",children:[o.jsx("h2",{className:"text-4xl md:text-5xl font-black text-white mb-4",children:"How It Works"}),o.jsx("p",{className:"text-zinc-400 text-lg",children:"Transform your content in 3 simple steps"})]}),o.jsxs("div",{className:"grid md:grid-cols-3 gap-8",children:[o.jsxs("div",{className:"bg-zinc-900/50 border border-white/10 rounded-2xl p-8 hover:border-purple-500/50 transition-all group",children:[o.jsx("div",{className:"w-16 h-16 bg-purple-500/10 rounded-2xl flex items-center justify-center mb-6 group-hover:scale-110 transition-transform",children:o.jsx(tr,{className:"w-8 h-8 text-purple-400"})}),o.jsx("div",{className:"text-purple-400 font-bold mb-2",children:"Step 1"}),o.jsx("h3",{className:"text-xl font-bold text-white mb-3",children:"Extract DNA"}),o.jsx("p",{className:"text-zinc-400",children:"Paste viral and flop video URLs. Our AI analyzes pacing, hooks, retention tactics, and audience psychology."})]}),o.jsxs("div",{className:"bg-zinc-900/50 border border-white/10 rounded-2xl p-8 hover:border-purple-500/50 transition-all group",children:[o.jsx("div",{className:"w-16 h-16 bg-purple-500/10 rounded-2xl flex items-center justify-center mb-6 group-hover:scale-110 transition-transform",children:o.jsx(Pl,{className:"w-8 h-8 text-purple-400"})}),o.jsx("div",{className:"text-purple-400 font-bold mb-2",children:"Step 2"}),o.jsx("h3",{className:"text-xl font-bold text-white mb-3",children:"Generate Blueprint"}),o.jsx("p",{className:"text-zinc-400",children:"AI creates a section-by-section blueprint optimized for retention, CTR, and algorithm performance."})]}),o.jsxs("div",{className:"bg-zinc-900/50 border border-white/10 rounded-2xl p-8 hover:border-purple-500/50 transition-all group",children:[o.jsx("div",{className:"w-16 h-16 bg-purple-500/10 rounded-2xl flex items-center justify-center mb-6 group-hover:scale-110 transition-transform",children:o.jsx(mn,{className:"w-8 h-8 text-purple-400"})}),o.jsx("div",{className:"text-purple-400 font-bold mb-2",children:"Step 3"}),o.jsx("h3",{className:"text-xl font-bold text-white mb-3",children:"Write & Optimize"}),o.jsx("p",{className:"text-zinc-400",children:"Get a complete script with B-roll suggestions, emotion tags, and predictive viral scoring."})]})]})]}),o.jsxs("div",{className:"py-24 max-w-6xl mx-auto",children:[o.jsxs("div",{className:"text-center mb-16",children:[o.jsx("h2",{className:"text-4xl md:text-5xl font-black text-white mb-4",children:"Before vs After"}),o.jsx("p",{className:"text-zinc-400 text-lg",children:"See the difference LOG makes"})]}),o.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[o.jsxs("div",{className:"bg-red-500/5 border border-red-500/20 rounded-2xl p-8",children:[o.jsxs("div",{className:"text-red-400 font-bold mb-4 flex items-center gap-2",children:[o.jsx("span",{className:"text-2xl",children:""})," Before LOG"]}),o.jsxs("div",{className:"space-y-3 text-left",children:[o.jsx("p",{className:"text-zinc-400",children:" Generic hooks that don't grab attention"}),o.jsx("p",{className:"text-zinc-400",children:" Random pacing with no retention strategy"}),o.jsx("p",{className:"text-zinc-400",children:" No data-driven optimization"}),o.jsx("p",{className:"text-zinc-400",children:" Guessing what works"}),o.jsx("p",{className:"text-zinc-400",children:" Low AVD (30-40%)"})]})]}),o.jsxs("div",{className:"bg-green-500/5 border border-green-500/20 rounded-2xl p-8",children:[o.jsxs("div",{className:"text-green-400 font-bold mb-4 flex items-center gap-2",children:[o.jsx("span",{className:"text-2xl",children:""})," After LOG"]}),o.jsxs("div",{className:"space-y-3 text-left",children:[o.jsxs("p",{className:"text-zinc-300",children:[" ",o.jsx("span",{className:"text-green-400 font-semibold",children:"Viral-proven hooks"})," from DNA analysis"]}),o.jsxs("p",{className:"text-zinc-300",children:[" ",o.jsx("span",{className:"text-green-400 font-semibold",children:"Pattern interrupts"})," every 15-20s"]}),o.jsxs("p",{className:"text-zinc-300",children:[" ",o.jsx("span",{className:"text-green-400 font-semibold",children:"Algorithm-optimized"})," structure"]}),o.jsxs("p",{className:"text-zinc-300",children:[" ",o.jsx("span",{className:"text-green-400 font-semibold",children:"Predictive scoring"})," (CTR, AVD, Viral %)"]}),o.jsx("p",{className:"text-zinc-300",children:" High AVD (70-85%)"})]})]})]})]}),o.jsxs("div",{id:"features",className:"py-24 max-w-6xl mx-auto",children:[o.jsxs("div",{className:"text-center mb-16",children:[o.jsx("h2",{className:"text-4xl md:text-5xl font-black text-white mb-4",children:"Powerful Features"}),o.jsx("p",{className:"text-zinc-400 text-lg",children:"Everything you need to create viral content"})]}),o.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:[{icon:"",title:"DNA Extraction",desc:"Reverse-engineer viral patterns"},{icon:"",title:"Multi-Modal Analysis",desc:"Audio, visual, editing, metadata"},{icon:"",title:"Algorithm Optimizer",desc:"CTR, AVD, engagement signals"},{icon:"",title:"Predictive Scoring",desc:"Viral probability prediction"},{icon:"",title:"B-Roll Suggestions",desc:"Visual direction for editors"},{icon:"",title:"Performance Tracking",desc:"Analytics dashboard"}].map((x,y)=>o.jsxs("div",{className:"bg-zinc-900/50 border border-white/10 rounded-xl p-6 hover:border-purple-500/50 transition-all",children:[o.jsx("div",{className:"text-4xl mb-3",children:x.icon}),o.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:x.title}),o.jsx("p",{className:"text-zinc-400 text-sm",children:x.desc})]},y))})]}),o.jsxs("div",{id:"pricing",className:"py-24 max-w-6xl mx-auto",children:[o.jsxs("div",{className:"text-center mb-16",children:[o.jsx("h2",{className:"text-4xl md:text-5xl font-black text-white mb-4",children:"Simple Pricing"}),o.jsx("p",{className:"text-zinc-400 text-lg",children:"Choose the plan that fits your needs"})]}),o.jsxs("div",{className:"grid md:grid-cols-3 gap-8",children:[o.jsxs("div",{className:"bg-zinc-900/50 border border-white/10 rounded-2xl p-8",children:[o.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Free"}),o.jsxs("div",{className:"text-4xl font-black text-white mb-6",children:["$0",o.jsx("span",{className:"text-lg text-zinc-500",children:"/mo"})]}),o.jsxs("ul",{className:"space-y-3 mb-8",children:[o.jsxs("li",{className:"flex items-start gap-2 text-zinc-400",children:[o.jsx(st,{className:"w-5 h-5 text-green-400 mt-0.5"})," 5 projects/month"]}),o.jsxs("li",{className:"flex items-start gap-2 text-zinc-400",children:[o.jsx(st,{className:"w-5 h-5 text-green-400 mt-0.5"})," 3 DNA extractions"]}),o.jsxs("li",{className:"flex items-start gap-2 text-zinc-400",children:[o.jsx(st,{className:"w-5 h-5 text-green-400 mt-0.5"})," Basic scoring"]})]}),o.jsx("button",{className:"w-full py-3 border border-white/20 rounded-lg hover:bg-white/5 transition-colors text-white font-semibold",children:"Get Started"})]}),o.jsxs("div",{className:"bg-gradient-to-b from-purple-500/10 to-pink-500/10 border-2 border-purple-500/50 rounded-2xl p-8 relative",children:[o.jsx("div",{className:"absolute -top-4 left-1/2 -translate-x-1/2 bg-gradient-to-r from-purple-600 to-pink-600 text-white text-sm font-bold px-4 py-1 rounded-full",children:"POPULAR"}),o.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Pro"}),o.jsxs("div",{className:"text-4xl font-black text-white mb-6",children:["$29",o.jsx("span",{className:"text-lg text-zinc-500",children:"/mo"})]}),o.jsxs("ul",{className:"space-y-3 mb-8",children:[o.jsxs("li",{className:"flex items-start gap-2 text-zinc-300",children:[o.jsx(st,{className:"w-5 h-5 text-purple-400 mt-0.5"})," Unlimited projects"]}),o.jsxs("li",{className:"flex items-start gap-2 text-zinc-300",children:[o.jsx(st,{className:"w-5 h-5 text-purple-400 mt-0.5"})," Unlimited DNA extractions"]}),o.jsxs("li",{className:"flex items-start gap-2 text-zinc-300",children:[o.jsx(st,{className:"w-5 h-5 text-purple-400 mt-0.5"})," Advanced scoring + predictions"]}),o.jsxs("li",{className:"flex items-start gap-2 text-zinc-300",children:[o.jsx(st,{className:"w-5 h-5 text-purple-400 mt-0.5"})," Export to PDF/DOCX"]}),o.jsxs("li",{className:"flex items-start gap-2 text-zinc-300",children:[o.jsx(st,{className:"w-5 h-5 text-purple-400 mt-0.5"})," Priority support"]})]}),o.jsx("button",{className:"w-full py-3 bg-gradient-to-r from-purple-600 to-pink-600 rounded-lg hover:from-purple-700 hover:to-pink-700 transition-all text-white font-bold shadow-lg shadow-purple-500/50",children:"Start Free Trial"})]}),o.jsxs("div",{className:"bg-zinc-900/50 border border-white/10 rounded-2xl p-8",children:[o.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Enterprise"}),o.jsx("div",{className:"text-4xl font-black text-white mb-6",children:"Custom"}),o.jsxs("ul",{className:"space-y-3 mb-8",children:[o.jsxs("li",{className:"flex items-start gap-2 text-zinc-400",children:[o.jsx(st,{className:"w-5 h-5 text-green-400 mt-0.5"})," Everything in Pro"]}),o.jsxs("li",{className:"flex items-start gap-2 text-zinc-400",children:[o.jsx(st,{className:"w-5 h-5 text-green-400 mt-0.5"})," Team collaboration"]}),o.jsxs("li",{className:"flex items-start gap-2 text-zinc-400",children:[o.jsx(st,{className:"w-5 h-5 text-green-400 mt-0.5"})," Custom AI models"]}),o.jsxs("li",{className:"flex items-start gap-2 text-zinc-400",children:[o.jsx(st,{className:"w-5 h-5 text-green-400 mt-0.5"})," API access"]})]}),o.jsx("button",{className:"w-full py-3 border border-white/20 rounded-lg hover:bg-white/5 transition-colors text-white font-semibold",children:"Contact Sales"})]})]})]}),o.jsxs("div",{id:"faq",className:"py-24 max-w-3xl mx-auto mb-20",children:[o.jsxs("div",{className:"text-center mb-16",children:[o.jsx("h2",{className:"text-4xl md:text-5xl font-black text-white mb-4",children:"FAQ"}),o.jsx("p",{className:"text-zinc-400 text-lg",children:"Common questions answered"})]}),o.jsx("div",{className:"space-y-4",children:[{q:"How does DNA extraction work?",a:"LOG analyzes viral and flop videos to identify patterns in pacing, hooks, retention tactics, and audience psychology. It creates a reusable template (DNA) that captures these precise rules."},{q:"What platforms does LOG support?",a:"Currently YouTube. TikTok and Instagram Reels support coming soon."},{q:"Can I export my scripts?",a:"Yes! Pro users can export to PDF, DOCX, and JSON formats."},{q:"How accurate is the viral probability prediction?",a:"Our AI analyzes CTR triggers, AVD patterns, and engagement signals to predict viral probability. Accuracy improves as you create more DNAs from your niche."}].map((x,y)=>o.jsxs("details",{className:"bg-zinc-900/50 border border-white/10 rounded-xl p-6 group",children:[o.jsxs("summary",{className:"font-bold text-white cursor-pointer list-none flex justify-between items-center",children:[x.q,o.jsx("span",{className:"text-purple-400 group-open:rotate-180 transition-transform",children:""})]}),o.jsx("p",{className:"text-zinc-400 mt-4 leading-relaxed",children:x.a})]},y))})]})]})},uw=({projects:a,dnas:n})=>{const i=a.length,l=n.length,u=a.filter(p=>p.data.result!==null).length,h=i>0?Math.round(u/i*100):0,f=a.filter(p=>p.data.lastScore),g=f.length>0?Math.round(f.reduce((p,b)=>{var x;return p+(((x=b.data.lastScore)==null?void 0:x.total_score)||0)},0)/f.length):0;return o.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 mb-6",children:[o.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl p-4 hover:border-zinc-600 transition-all",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("div",{className:"w-8 h-8 bg-blue-500/10 rounded-lg flex items-center justify-center",children:o.jsx(iw,{className:"w-4 h-4 text-blue-400"})}),o.jsx("span",{className:"text-2xl font-bold text-white",children:i})]}),o.jsx("p",{className:"text-xs text-zinc-500 font-medium",children:"Total Projects"})]}),o.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl p-4 hover:border-zinc-600 transition-all",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("div",{className:"w-8 h-8 bg-purple-500/10 rounded-lg flex items-center justify-center",children:o.jsx(tr,{className:"w-4 h-4 text-purple-400"})}),o.jsx("span",{className:"text-2xl font-bold text-white",children:l})]}),o.jsx("p",{className:"text-xs text-zinc-500 font-medium",children:"DNA Templates"})]}),o.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl p-4 hover:border-zinc-600 transition-all",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("div",{className:"w-8 h-8 bg-green-500/10 rounded-lg flex items-center justify-center",children:o.jsx(st,{className:"w-4 h-4 text-green-400"})}),o.jsxs("span",{className:"text-2xl font-bold text-white",children:[h,"%"]})]}),o.jsx("p",{className:"text-xs text-zinc-500 font-medium",children:"Success Rate"})]}),o.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl p-4 hover:border-zinc-600 transition-all",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("div",{className:"w-8 h-8 bg-orange-500/10 rounded-lg flex items-center justify-center",children:o.jsx(mn,{className:"w-4 h-4 text-orange-400"})}),o.jsxs("span",{className:"text-2xl font-bold text-white",children:[g,"/100"]})]}),o.jsx("p",{className:"text-xs text-zinc-500 font-medium",children:"Avg. Score"})]})]})},Xu=({isOpen:a,title:n,message:i,confirmText:l="OK",cancelText:u="Cancel",onConfirm:h,onCancel:f,danger:g=!1})=>a?o.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center animate-in fade-in duration-200",children:[o.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:f}),o.jsxs("div",{className:"relative bg-zinc-900 border border-zinc-700 rounded-2xl p-6 max-w-md w-full mx-4 shadow-2xl animate-in zoom-in-95 duration-200",children:[o.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:n}),o.jsx("p",{className:"text-sm text-zinc-400 mb-6",children:i}),o.jsxs("div",{className:"flex gap-3 justify-end",children:[o.jsx("button",{onClick:f,className:"px-4 py-2 bg-zinc-800 hover:bg-zinc-700 text-white rounded-lg text-sm font-medium transition-colors",children:u}),o.jsx("button",{onClick:h,className:`px-4 py-2 rounded-lg text-sm font-bold transition-colors ${g?"bg-red-500 hover:bg-red-600 text-white":"bg-white hover:bg-zinc-200 text-black"}`,children:l})]})]})]}):null,dw=({folders:a,currentFolderId:n,onSelect:i,onClose:l})=>{const u=ie.useRef(null);return ie.useEffect(()=>{const h=f=>{u.current&&!u.current.contains(f.target)&&l()};return document.addEventListener("mousedown",h),()=>document.removeEventListener("mousedown",h)},[l]),o.jsxs("div",{ref:u,className:"absolute right-0 top-full mt-2 w-48 bg-zinc-900 border border-white/10 rounded-xl shadow-2xl z-[100] py-2 animate-in fade-in zoom-in-95 duration-200",children:[o.jsx("p",{className:"px-4 py-2 text-[10px] font-bold text-zinc-500 uppercase tracking-widest border-b border-white/5 mb-1",children:"Move To"}),o.jsxs("button",{onClick:h=>{h.stopPropagation(),i(void 0)},className:`w-full text-left px-4 py-2 text-xs hover:bg-white/5 flex items-center gap-2 ${n?"text-zinc-400":"text-blue-400 font-bold"}`,children:[o.jsx(gg,{className:"w-3 h-3"})," Root Library"]}),a.map(h=>o.jsxs("button",{onClick:f=>{f.stopPropagation(),i(h.id)},className:`w-full text-left px-4 py-2 text-xs hover:bg-white/5 flex items-center gap-2 ${n===h.id?"text-blue-400 font-bold":"text-zinc-400"}`,children:[o.jsx(Gi,{className:"w-3 h-3"})," ",h.name]},h.id))]})},hw=({projects:a,folders:n,dnas:i,onOpenProject:l,onNewProject:u,onDeleteProject:h,onDeleteFolder:f,onRenameProject:g,onCreateFolder:p,onMoveProject:b})=>{const[x,y]=ie.useState(null),[E,_]=ie.useState(""),[w,S]=ie.useState(null),[N,k]=ie.useState(!1),[K,H]=ie.useState(""),[P,ee]=ie.useState(""),[te,W]=ie.useState(null),[ye,pe]=ie.useState({isOpen:!1,itemId:"",itemName:"",type:"project"}),Be=n.find(Y=>Y.id===w),Ve=n.filter(Y=>Y.name.toLowerCase().includes(P.toLowerCase())),De=a.filter(Y=>{const ae=Y.name.toLowerCase().includes(P.toLowerCase()),xe=w?Y.folderId===w:!Y.folderId;return ae&&xe}),Ke=a.filter(Y=>Y.name.toLowerCase().includes(P.toLowerCase())),Le=P?Ke:De,oe=P?Ve:w?[]:n,z=(Y,ae)=>{Y.stopPropagation(),y(ae.id),_(ae.name)},J=Y=>{E.trim()&&g(Y,E),y(null)};return o.jsxs("div",{className:"animate-in fade-in duration-500",children:[!w&&!P&&o.jsx(uw,{projects:a,dnas:i}),o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-3xl font-bold text-white tracking-tight",children:w?Be==null?void 0:Be.name:"Dashboard"}),o.jsx("p",{className:"text-zinc-500 mt-2",children:w?`Managing projects in ${Be==null?void 0:Be.name}`:"Manage your viral engineering projects."})]}),o.jsxs("div",{className:"flex gap-3",children:[!w&&o.jsxs("button",{onClick:()=>k(!N),className:"bg-zinc-800 text-white px-4 py-3 rounded-full font-bold hover:bg-zinc-700 transition-colors flex items-center gap-2",children:[o.jsx(Gi,{className:"w-4 h-4"})," New Folder"]}),o.jsxs("button",{onClick:()=>u(w||void 0),className:"bg-white text-black px-6 py-3 rounded-full font-bold hover:bg-zinc-200 transition-colors flex items-center gap-2 shadow-lg shadow-white/10",children:[o.jsx(on,{className:"w-4 h-4"})," ",w?"New in Folder":"New Project"]})]})]}),o.jsxs("div",{className:"relative mb-8",children:[o.jsx(er,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-zinc-500"}),o.jsx("input",{type:"text",placeholder:"Search projects and folders...",className:"w-full bg-zinc-900/50 border border-white/5 rounded-xl py-4 pl-12 pr-4 text-white focus:outline-none focus:ring-1 focus:ring-white/20 transition-all placeholder-zinc-600",value:P,onChange:Y=>ee(Y.target.value)})]}),N&&o.jsxs("div",{className:"mb-8 p-4 bg-zinc-900 border border-zinc-700 rounded-xl flex gap-3 animate-in slide-in-from-top-2",children:[o.jsx("input",{className:"flex-1 bg-black border border-zinc-700 rounded-lg px-4 py-2 text-white",placeholder:"Folder Name",value:K,onChange:Y=>H(Y.target.value)}),o.jsx("button",{onClick:()=>{K&&(p(K),H(""),k(!1))},className:"bg-white text-black px-4 py-2 rounded-lg font-bold",children:"Create"})]}),w&&!P&&o.jsxs("div",{className:"flex items-center gap-2 mb-6 text-sm text-zinc-400",children:[o.jsxs("button",{onClick:()=>S(null),className:"hover:text-white flex items-center gap-1",children:[o.jsx(gg,{className:"w-3 h-3"})," Dashboard"]}),o.jsx("span",{children:"/"}),o.jsxs("span",{className:"text-white font-bold flex items-center gap-2",children:[o.jsx(Gi,{className:"w-3 h-3"})," ",Be==null?void 0:Be.name]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3",children:[!w&&oe.map(Y=>o.jsxs("div",{onClick:()=>{S(Y.id),ee("")},className:"group bg-zinc-900/30 border border-white/5 rounded-lg p-3 hover:bg-zinc-900/60 hover:border-white/20 transition-all cursor-pointer relative overflow-hidden flex flex-col justify-center min-h-[100px]",children:[o.jsxs("div",{className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity flex gap-1 z-10",onClick:ae=>ae.stopPropagation(),children:[o.jsx("button",{onClick:()=>{y(Y.id),_(Y.name)},className:"p-1 hover:bg-white/10 rounded text-zinc-500 hover:text-white",title:"Rename",children:o.jsx(zl,{className:"w-3 h-3"})}),o.jsx("button",{onClick:()=>pe({isOpen:!0,itemId:Y.id,itemName:Y.name,type:"folder"}),className:"p-1 hover:bg-white/10 rounded text-zinc-500 hover:text-red-400",title:"Delete",children:o.jsx(Zt,{className:"w-3 h-3"})})]}),o.jsx("div",{className:"w-8 h-8 bg-blue-500/10 rounded-md flex items-center justify-center mb-2 group-hover:bg-blue-500/20 transition-colors",children:o.jsx(Gi,{className:"w-4 h-4 text-blue-400"})}),x===Y.id?o.jsx("input",{autoFocus:!0,value:E,onChange:ae=>_(ae.target.value),onBlur:()=>{g(Y.id,E),y(null)},onKeyDown:ae=>ae.key==="Enter"&&(g(Y.id,E),y(null)),onClick:ae=>ae.stopPropagation(),className:"bg-black/50 border border-zinc-600 rounded px-1.5 py-1 text-white font-bold w-full mb-0.5 text-xs"}):o.jsx("h3",{className:"text-sm font-bold text-white mb-0.5 group-hover:text-blue-300 transition-colors",children:Y.name}),o.jsxs("p",{className:"text-[9px] text-zinc-500",children:[a.filter(ae=>ae.folderId===Y.id).length," projects"]})]},Y.id)),Le.map(Y=>o.jsxs("div",{onClick:()=>l(Y.id),className:"group bg-zinc-900/50 border border-white/5 rounded-lg p-3 hover:bg-zinc-900 hover:border-white/10 transition-all cursor-pointer relative overflow-hidden",children:[o.jsxs("div",{className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity flex gap-1 z-10",children:[o.jsx("button",{onClick:ae=>z(ae,Y),className:"p-1 hover:bg-white/10 rounded text-zinc-500 hover:text-white",title:"Rename",children:o.jsx(zl,{className:"w-3 h-3"})}),o.jsxs("div",{className:"relative",children:[o.jsx("button",{onClick:ae=>{ae.stopPropagation(),W(te===Y.id?null:Y.id)},className:`p-1 hover:bg-white/10 rounded transition-colors ${Y.folderId?"text-blue-400":"text-zinc-500 hover:text-blue-400"}`,title:"Move to folder",children:o.jsx(Gi,{className:"w-3 h-3"})}),te===Y.id&&o.jsx(dw,{folders:n,currentFolderId:Y.folderId,onSelect:ae=>{b(Y.id,ae),W(null)},onClose:()=>W(null)})]}),o.jsx("button",{onClick:ae=>{ae.stopPropagation(),pe({isOpen:!0,itemId:Y.id,itemName:Y.name,type:"project"})},className:"p-1 hover:bg-white/10 rounded text-zinc-500 hover:text-red-400",title:"Delete",children:o.jsx(Zt,{className:"w-3 h-3"})})]}),o.jsxs("div",{className:"flex flex-col h-full justify-between",children:[o.jsxs("div",{children:[o.jsx("div",{className:"mb-2",children:o.jsx("span",{className:`text-[8px] font-bold uppercase tracking-wider px-1.5 py-0.5 rounded border ${Y.data.result?"bg-green-500/10 text-green-400 border-green-500/20":Y.data.blueprint?"bg-blue-500/10 text-blue-400 border-blue-500/20":"bg-zinc-800 text-zinc-500 border-zinc-700"}`,children:Y.data.result?"Completed":Y.data.blueprint?"In Progress":"Draft"})}),x===Y.id?o.jsx("input",{autoFocus:!0,value:E,onChange:ae=>_(ae.target.value),onBlur:()=>J(Y.id),onKeyDown:ae=>ae.key==="Enter"&&J(Y.id),onClick:ae=>ae.stopPropagation(),className:"bg-black border border-zinc-600 rounded px-1.5 py-1 text-white font-bold w-full mb-1.5 text-xs"}):o.jsx("h3",{className:"text-sm font-bold text-white mb-1.5 line-clamp-1",children:Y.name||"Untitled Project"}),o.jsx("p",{className:"text-[10px] text-zinc-500 line-clamp-2",children:Y.data.userDraft.description||Y.data.userDraft.title||"No description provided."})]}),o.jsxs("div",{className:"mt-3 pt-3 border-t border-white/5 flex items-center justify-between",children:[o.jsx("span",{className:"text-[9px] text-zinc-600",children:new Date(Y.updatedAt).toLocaleDateString()}),o.jsx("span",{className:"text-[10px] text-zinc-700 uppercase",children:Y.data.language})]})]})]},Y.id))]}),o.jsx(Xu,{isOpen:ye.isOpen,title:"Delete Project?",message:`Are you sure you want to delete "${ye.projectName}"? This action cannot be undone.`,confirmText:"Delete",cancelText:"Cancel",danger:!0,onConfirm:()=>{ye.type==="folder"?f(ye.itemId):h({stopPropagation:()=>{}},ye.itemId),pe({isOpen:!1,itemId:"",itemName:"",type:"project"})},onCancel:()=>pe({isOpen:!1,itemId:"",itemName:"",type:"project"})})]})},gn="google/gemini-3-pro-preview",Mu=[{id:"google/gemini-3-pro-preview",name:"Gemini 3 Pro",provider:"Google"},{id:"google/gemini-3-flash-preview",name:"Gemini 3 Flash",provider:"Google"},{id:"openai/gpt-5.2",name:"GPT-5.2",provider:"OpenAI"},{id:"x-ai/grok-4.1-fast",name:"Grok 4.1 Fast",provider:"xAI"},{id:"anthropic/claude-sonnet-4.5",name:"Claude Sonnet 4.5",provider:"Anthropic"}],xu={title:"e.g., How I built a SaaS in 2 days",description:"e.g., A quick breakdown of the tech stack...",script:"e.g., Intro: Start with a hook about time management..."},Pa=a=>`
CRITICAL OUTPUT RULE: The final content MUST be written in ${a}. Translate any structural logic into natural-sounding ${a}.`,vg=`
ROLE: Lead Content Scientist & Viral Pattern Analyst
OBJECTIVE: Reverse-engineer the "Genetic Code" (DNA) of high-performing content through DEEP QUALITATIVE analysis.

*** CRITICAL LAW: NO EVIDENCE, NO INSIGHT ***
- YOU ARE FORBIDDEN from using vague adjectives like "engaging", "fast-paced", "emotional" without PROOF.
- EVERY insight must follow the structure: [Trait] + [Specific Evidence from transcript/timestamp].
- Example (BAD): "The hook is curious."
- Example (GOOD): "The hook uses the 'Paradox' technique, proven by the contradictory statement 'Eat fat to lose fat' at 0:02."

YOUR METHODOLOGY:

1. STRUCTURE-CENTRIC ANALYSIS (Standard Patterns - The 70%):
   - Identify the "Skeleton" used by the majority of successful scripts.
   - Pacing: Quantify cut frequency (e.g. "Every 2-4s").
   - Tone: Describe the dominant emotional baseline.

2. ANOMALY DETECTION (Viral X-Factors - The 30%):
   - Identify "Outliers": What did the TOP 1% of videos do that broke the rules?
   - Look for: Silence where others talk, slow edits where others are fast, unique vocabulary.
   - These are your "X-Factors".

3. HOOK "ANGLE" DECONSTRUCTION:
   - Do NOT just length-check. CLASSIFY the angle:
     * Negative (Fear/Warning)
     * Curiosity (Mystery/Gap)
     * Benefit (result)
     * Paradox (Contradiction)
   - PROVIDE EVIDENCE: Quote the exact line that creates this angle.

4. LINGUISTIC FINGERPRINTING (The "Voice"):
   - Extract the "Persona": Who is speaking? (e.g. The Rebel, The Wise Teacher).
   - Analyze "Voice Signature": 
     * Slang density (High/Low?)
     * Question vs Statement ratio (Qualitative feel, not math)
     * Sentence structure (Choppy? Flowing?)

5. SENTIMENT CLUSTERING:
   - High Dopamine Triggers: "Goosebumps", "Best part"  KEEP & AMPLIFY
   - Confusion Points: "I don't get it"  FIX & CLARIFY
   - Objections: "I disagree"  ADDRESS or AVOID

6. AUDIENCE PSYCHOLOGY (Deep Analysis):
   - Analyze BOTH script content AND audience comments
   - Map viewer journey: Awareness  Interest  Desire  Action
7. SYNTHESIS: Create a reusable, quantified DNA template with specific timing rules.

8. **STRUCTURE-CENTRIC ANALYSIS (CRITICAL UPGRADE)**:
   For EACH section identified, extract:
       
       a) BASICS:
          - section_name: Clear name(Hook, Build - up, Climax, Payoff...)
          - word_count_range: Estimated words(e.g., "40-60")(DERIVED FROM INPUT LENGTH)
       
       b) ** TIMING & RHYTHM(MANDATORY) **:
          - pacing: ** SPECIFIC EDITING INSTRUCTIONS **. (e.g. "Fast cuts every 2s", "Slow zoom", "Pause for effect").NEVER LEAVE EMPTY.
          - tone: Emotional quality(e.g. "Urgent", "Sincere", "Sarcastic").

   c) ** CONTENT & NARRATIVE(CRITICAL) **:
          - content_focus: ** DETAILED DESCRIPTION **.Do not just say "Intro".Say "Introduce the problem of X and promise specific solution Y."
          - ** LOOP CONNECTIVITY **: If this section answers a question from the Hook, explicitly write: "CLOSE LOOP: Answer the question about [Topic]."
          - audience_value: What specific value does the viewer get ? (MANDATORY).

         d) ** ENGAGEMENT **:
          - viral_triggers: Specific elements that caused spikes(visuals, sounds).
          - audience_interaction: CTA * only if present in input *.
          - micro_hook: The FIRST sentence of this section that grabs attention. (e.g. "But here's the twist", "Why does this matter?").
          - open_loop: Questions raised here.
          - close_loop: ANSWERS to previous loops. (CRITICAL: Track where loops close).
`,fw=`
    ROLE: You are an expert Content DNA Synthesizer & Methodology Architect.
   OBJECTIVE: Merge multiple successful video scripts into a SINGLE, MASTER DNA TEMPLATE.

    ** CRITICAL INSTRUCTIONS FOR ACCURACY **:
1. ** WORD COUNT **: Calculate average word count from inputs.
    2. ** PACING(MANDATORY) **: You MUST extract specific pacing(speed, cuts) for EVERY section.If inputs are fast, the DNA must say "Fast".Do not leave empty.
    3. ** AUDIENCE_VALUE(ABSOLUTELY MANDATORY) **: EVERY section MUST have audience_value defined.What specific benefit / emotion does the viewer get ? (e.g. "Learn 3 tax loopholes" not just "value").
4. ** NARRATIVE THREADING(Open / Close Loops) **: 
       - ** Hook Section **: Identify the BIG PROMISE or MYSTERY(Open Loop).
       - ** Payoff Section **: The content_focus MUST explicitly say: "Fulfill the promise made in the Hook about [Topic]."
   - Do not write vague goals.Connect the dots.

    ** REFINEMENT METHODOLOGY **:
1. ** Structure Synthesis **: Create a "Master Skeleton" that fits the best performers.
    2. ** Detail Enrichment **:
       - ** Content Focus **: Make it descriptive enough(1 - 2 sentences) so a writer knows EXACTLY what to cover and what loop to close.
       - ** Audience Value **: Mandatory definition of value.
       - ** CTA **: Optional.

    ** OUTPUT **:
    Return ONLY the updated JSON \`ScriptDNA\` object.
`,pw=(a,n)=>`
INPUT DATA STREAMS:

=== DATASET A: VIRAL HITS (POSITIVE SIGNALS) ===
${a}

=== DATASET B: FLOPS (NEGATIVE SIGNALS) ===
${n}

TASK:
Extract a robust Script DNA Template with DEEP STRUCTURE ANALYSIS.

SPECIFIC INSTRUCTIONS FOR JSON FIELDS:
1. "pacing": Provide technical editing rules. Mention seconds, cut frequency, and energy shifts.
2. "structure_skeleton": 
   - Analyze the script IN DETAIL. Extract 6-10 distinct sections minimum.
   - For EACH section, provide: section_name, word_count_range, tone, pacing, content_focus, audience_value.
   - OPTIONAL FIELDS (include if present):
     * "audience_interaction": Analyze via [METHOD + TEXT]. Example: "Soft-sell via Storytelling: 'I used to struggle too...'" instead of just "Subscribe".
     * "viral_triggers": Specific audio/visual elements that spike retention (e.g. "Silence", "Fast Zoom").
     * "micro_hook": The FIRST sentence of this section that grabs attention. (e.g. "But here's the twist", "Why does this matter?").
     * "open_loop": Questions raised here.
     * "close_loop": ANSWERS to previous loops. (CRITICAL: Track where loops close).
   - MATH CHECK: Sum of all section word counts MUST fall within the Target Word Count Range.
   - EXPANSION RULE: If the sum is too low, do NOT just increase numbers. You MUST add depth to the 'content_focus'.
     * Add "Deep Dive: [Specific Concept]"
     * Add "Case Study: [Example]"
     * Add "Advanced Nuance: [Counter-intuitive point]"
   - Justify the length with substance, not fluff.
   - "must_include": ONLY if a specific element is CRITICAL (e.g. "Screen recording"). Ignore if generic.
3. "core_patterns": List the KEY foundational patterns found in the majority. (Do not limit number, list all that matter).
4. "viral_x_factors": List ALL distinct anomalies/breakthroughs found in top performers. (No limit).
5. "hook_angle": Return an OBJECT { type: "Negative"|"Curiosity"|..., description: "Uncover the psychological trick with EVIDENCE from transcript" }.
6. "linguistic_fingerprint": Return an OBJECT { role_persona: "...", tone_description: "...", keywords: [...] }.
7. "target_word_count_range": Calculate the MIN-MAX word count from the viral scripts.
8. "niche": Analyze the content and strictly categorize the Industry/Niche (e.g. "Crypto Trading", "Weight Loss", "SaaS Marketing").
`,mw=(a,n,i)=>`
BASE DNA PROFILE (CURRENT VERSION):
${a}

NEW TRAINING DATA STREAM:
=== NEW VIRALS ===
${n}
=== NEW FLOPS ===
${i}

TASK:
Refine and Evolve the Base DNA Profile.
- PUSH FOR SPECIFICITY: If the base DNA says "Engaging intro", change it to "Intro must ask a question in the first 5 seconds".
- UPDATE "pacing" with specific timing data observed in new virals.
- VERIFY "core_patterns" still hold true (70% rule).
- DISCOVER new "viral_x_factors" from the new hits.
`,gw=`
ROLE: Master Script Architect, Psychologist & Algorithm Optimizer
OBJECTIVE: Design a high - retention, algorithm - friendly video blueprint.

CORE UPGRADE - AUDIENCE SIMULATOR(4 Personas):
Before generating the final blueprint, run an internal simulation with FOUR critical personas:

1. THE NEWBIE(Low attention span, casual viewer):
"Is this boring? Do I get it immediately? Will I click away in 5 seconds?"

2. THE EXPERT(High scrutiny, domain knowledge):
"Is this accurate? Is it too shallow? Does this add real value?"

3. THE HATER(Cynical, skeptical):
"This is clickbait. I disagree with point X. This is misleading."

4. THE ALGORITHM(YouTube / TikTok AI):
"Does this maximize CTR and AVD? Will users watch till the end? Does it trigger engagement?"

OPTIMIZATION ACTIONS:
- Use the "Hater's" objections to strengthen arguments(Anti - thesis) and avoid red flags
   - Use the "Newbie's" confusion to simplify Hook and add pattern interrupts
      - Use the "Expert's" demand to ensure value density and credibility
         - Use the "Algorithm's" requirements to optimize for first 30 seconds, retention, and engagement

ALGORITHM OPTIMIZATION RULES:
- Hook MUST capture attention in first 3 - 8 seconds(critical retention window)
   - Add pattern interrupts every 15 - 20 seconds(visual / audio changes)
      - Ensure payoff matches the promise(avoid clickbait penalty)
         - Build to a climax that justifies the watch time
            - End with clear CTA that triggers engagement(comment, like, share)

INTELLIGENT PATTERN MATCHING (70/30 RULE):
1. CORE PATTERNS (The 70%):
   - ALWAYS apply the "Safety Rails" from the DNA's Core Patterns.
   - Maintain the foundational structure and pacing.

2. X-FACTOR SELECTION (The 30%):
   - CONTEXT-MATCHING: Scan the DNA's "viral_x_factors" list.
   - SELECT ONLY 1-2 factors that strictly align with the current IDEA Context and Vibe.
   - CRITICAL: Do NOT use all X-Factors. Providing a "Sad Story" idea? Do NOT use a "High Energy Prank" X-Factor.
   - SIMULATION CHECK: If the "Hater" persona rejects the X-Factor as "Too Cringe" or "Try-hard", DISCARD it.
   - Integrate the selected X-Factors into specific blueprint sections as "Breakthrough Moments".

DNA STRUCTURE INTEGRATION:

When generating blueprint, for EACH section from DNA.structure_skeleton:
1. INHERIT section_name as blueprint section name
2. STRICT MATH EQUITY: The SUM of all section word counts MUST strictly equal the User's Target Word Count.
   - MATH CHECK: Intro + Body Sections + Outro = Target Total.
   - If DNA is short (e.g. sums to 2000) but Target is 3400, you MUST distribute the extra 1400 words into the "Content Plan" sections. Do NOT just stretch the hook.
   - ERROR PREVENTION: Do not output a blueprint that falls short of the target.
3. APPLY tone and pacing from DNA section
4. FOLLOW content_focus as section objective
5. INCLUDE must_include elements
6. RESPECT avoid_patterns
7. PLAN transitions using transition_in/out

If DNA has open_loop:
- NOTE where loops open
   - ENSURE loops are closed before end

Blueprint should be a CONCRETE version of DNA structure, not generic.

RED FLAGS DETECTION:
- Identify potential clickbait elements that could trigger algorithm penalties
   - Flag misleading claims that could hurt credibility
      - Detect pacing issues that could cause early drop - offs
         - Warn about content that violates platform guidelines

Generate the blueprint ONLY after optimizing for all 4 personas and passing red flags check.
`,bw=(a,n,i)=>`
CONTEXT & SOURCE MATERIAL:
${a}

CONSTRAINTS & DNA RULES:
${n}

TASK:
Create a detailed, section - by - section blueprint for a video of approximately ${i} words.

   STEP 1: SIMULATION
      - Simualte the Newbie, Expert, and Hater watching this content.
- Note their reactions.

   STEP 2: BLUEPRINT CONSTRUCTION
      - Based on the simulation, outline the sections.
      - For EACH section, you must define:
        * "Micro-Hook": Strategy to keep them watching (Question, Paradox, Strong Statement). VARIETY IS KEY.
        * "Tone Shift": The specific emotional sub-tone of this section (e.g. "Skeptical -> Convinced").
        * "Content Plan": The core value delivery.
      `,xg=`
ROLE: Ghostwriter for Top - Tier Creator
OBJECTIVE: Write ONLY the spoken words - pure script content with NO labels, NO titles, NO directions.

CRITICAL OUTPUT RULES:
- Output ONLY what the speaker says - nothing else
- NO section titles(e.g., "Introduction:", "Hook:", "Section 1:")
   - NO stage directions(e.g., "[pause]", "[emphasis]")
      - NO metadata or labels of any kind
         - NO visual suggestions in the output(save those for separate notes)
   - Just pure, natural spoken script

STYLE GUIDE:
- Write for the EAR, not the eye
   - Use short, punchy sentences that sound natural when spoken
      - Be conversational, not academic
         - Sound like a human, not a robot
            - Use contractions(I'm, you're, don't) for natural flow
               - Vary sentence length for rhythm
   - LINGUISTIC FINGERPRINT: Use the specific keywords defined in the DNA naturally. Do not force them, but ensure the "flavor" matches.
   - MICRO-HOOK EXECUTION: Start the section with the defined Catch/Hook (Question, Paradox, etc.). Never start boring.

VOLUME BY DEPTH (FORCED EXPANSION Protocol):
- CRITICAL: You MUST land INSIDE the specific word count range provided for this section.
- "Short" is NOT "Punchy" if it misses the target. Short is LAZY.
- OVERFLOW ALERT: Do NOT exceed the maximum word count. If you write too much, CUT fluff.
- If you are running short, EXPAND DEEPLY (Examples, nuanced explanations).
- VIOLATION: Missing the range (either too short or too long) is a FAILURE.

INTERNAL GUIDANCE (Don't output these):
                  - Think about emotion: excitement, urgency, curiosity, authority, empathy
               - Consider pacing: fast sections vs.breathing room
               - Plan visual metaphors(but don't write them in the script)
                  - Optimize for how it sounds when read aloud

EXAMPLE OF CORRECT OUTPUT:
"What if I told you everything you know about productivity is wrong? Yeah, I said it. Because while you're out there trying to wake up at 5 AM and drink green smoothies, the most successful people I know are doing the complete opposite. And today, I'm gonna show you exactly what they do instead."

EXAMPLE OF WRONG OUTPUT(Don't do this):
"[HOOK - EXCITEMENT]
Introduction: What if I told you...
[VISUAL: Clock ticking backwards]
[TEXT: Everything you know is WRONG]"

Remember: The output should be ready to hand directly to a voice actor or read aloud yourself.Nothing else.
`,yw=(a,n,i,l,u)=>`
CURRENT SECTION TO WRITE:
${a}

${u?`
DNA SECTION REQUIREMENTS:
- Tone: ${u.tone||"Use global"}
- Pacing: ${u.pacing||"Use global"}
- Word Count Target: ${u.word_count_range||"Follow blueprint"}
- Content Focus: ${u.content_focus||"Follow blueprint"}
- Must Include: ${Array.isArray(u.must_include)?u.must_include.join(", "):u.must_include||"N/A"}
- Avoid: ${Array.isArray(u.avoid_patterns)?u.avoid_patterns.join(", "):u.avoid_patterns||"N/A"}
${u.micro_hook?`- MICRO-HOOK STRATEGY: ${u.micro_hook}`:""}
${u.open_loop?`- Open Loop: ${u.open_loop}`:""}
${u.transition_out?`- Transition Out: ${u.transition_out}`:""}
`:""}

GLOBAL STYLE DNA(Apply this Voice):
${n}

CONTEXT(Previous Section's End - Connect to this):
"${i}..."


   TASK:
   Write the full spoken script for this section FROM SCRATCH using the Blueprint instructions above.
- DO NOT reuse phrases or sentences from previous sections or reference notes.
- Ensure a smooth transition from the previous section's ending.
   - Hit the specific "Micro-Hook" and content goals defined in the section details.
- Strictly follow the Word Count target.
- Write original content that follows the DNA style but with fresh phrasing.
`,vw=(a,n,i,l,u)=>`
TASK: Rewrite and Improve the following script section.

INPUT DATA:
1. ORIGINAL DRAFT (Base material): 
"${n}"

2. USER INSTRUCTION (What to fix): 
"${a}"

3. BLUEPRINT CONSTRAINTS (Must follow):
${u}

4. NARRATIVE CONTEXT (Connectivity is Critical):
- PREVIOUS SECTION ENDED WITH: "...${i.slice(-400)}"
- NEXT SECTION STARTS WITH: "${l.slice(0,400)}..."

CRITICAL RULES (VIOLATION = INSTANT FAILURE):
1. SEAMLESS TRANSITIONS: You MUST start by connecting smoothly from the Previous Section, and end by setting up the Next Section. Do not create a disjointed island of text.
2. PURE SCRIPT ONLY - ZERO TOLERANCE:
   - NO preamble text ("Here is...", "I've rewritten...", "Below is...", "This version...")
   - NO markdown formatting (no **bold**, no *italics*, no ### headers, no ---)
   - NO meta-commentary about the script
   - NO labels or section titles
   - The FIRST word of your output must be the FIRST word of the actual script
   - The LAST word of your output must be the LAST word of the actual script
3. WORD COUNT: Adhere strictly to the Blueprint's word count target.
4. STYLE: Maintain the extracted Linguistic Fingerprint.

REMEMBER: You are a ghostwriter. The output goes directly to the speaker. If you add ANY text that isn't meant to be spoken aloud, you have FAILED.

OUTPUT (Start with the script immediately, no intro):
`,xw=`
ROLE: Merciless Script Critic, Algorithm Auditor & Performance Predictor
OBJECTIVE: Deep analysis of script quality across multiple dimensions with actionable feedback.

CRITICAL ANALYSIS FRAMEWORK:

1. AUDIENCE VALUE ANALYSIS(Per Section):
- What specific value does the viewer receive in this section ?
   - Emotional impact: Does it trigger curiosity, excitement, relief, or satisfaction ?
      - Content delivery: Is the information clear, actionable, or entertaining ?
         - Retention hook: What keeps them watching to the next section ?

            2. LANGUAGE STYLE & TONE ANALYSIS:
   a) Natural Speech Patterns:
- Does it sound natural when read aloud or does it feel like written text ?
   - Are sentences conversational(short, punchy) or academic(long, complex) ?
      - Check for awkward phrasing that would trip up a speaker
   
   b) Audience Appropriateness:
- Vocabulary level: Too simple, too complex, or just right for target audience ?
   - Jargon usage: Technical terms explained or assumed knowledge ?
      - Cultural references: Relatable to the target demographic ?
         - Tone match: Does the voice match the audience's expectations (casual, professional, etc.)?
   
   c) Readability & Flow:
- Sentence variety: Mix of short punchy lines and longer explanations ?
   - Rhythm : Does it have a natural cadence or feel monotonous ?
      - Word choice: Familiar, accessible language vs.overly formal / academic ?

         3. STRUCTURE & PACING ANALYSIS:
   a) Hook Effectiveness(First 5 - 10 seconds):
- Does it immediately grab attention with a question, statement, or visual ?
   - Is there a clear promise of value ?
      - Does it create curiosity gap or FOMO ?
         - Rate hook strength: WEAK / AVERAGE / STRONG / VIRAL - WORTHY
   
   b) Content Flow & Logic:
- Is the narrative progression logical and easy to follow ?
   - Do ideas build on each other naturally ?
      - Are there any confusing jumps or missing connections ?
         - Does each section justify its existence ?

            c) Transitions:
- Are section transitions smooth and natural ?
   - Do they use connective phrases or feel abrupt / choppy ?
      - Do transitions maintain momentum or kill it ?

         d) Pacing Balance:
- Fast sections: High energy, quick cuts, rapid information
   - Slow sections: Breathing room, emphasis, emotional beats
      - Is there variety to avoid monotony ?
         - Pattern interrupts: Are there enough changes to maintain attention ?

            4. CTA(CALL - TO - ACTION) ANALYSIS:
- Location: Where are CTAs placed ? (Beginning, middle, end, multiple ?)
   - Clarity : Is it crystal clear what action to take ?
      - Motivation : Does it give a compelling reason WHY to act ?
         - Tone : Natural and conversational vs.pushy and salesy ?
            - Friction : Is it easy to do or does it require too much effort ?
               - Examples of GOOD CTA: "Drop a comment if you've experienced this"(low friction, engaging)
                  - Examples of BAD CTA: "Make sure to subscribe, like, and hit the bell"(robotic, overused)

5. PREDICTIVE METRICS:
- Estimated CTR: 1 - 10 % (based on hook + title alignment)
- Estimated AVD: 30 - 80 % (based on pacing + value delivery)
- Viral Probability: LOW / MEDIUM / HIGH / VERY HIGH
   - Expected Engagement Rate: Likes, comments, shares ratio

6. RED FLAGS IDENTIFICATION:
- Clickbait elements that don't deliver
   - Boring / generic opening
      - Confusing structure or logic gaps
         - Unnatural language or robotic tone
            - Weak or missing CTA
               - Pacing issues(too slow or too fast throughout)

OUTPUT STRUCTURE:
1. Overall Score(0 - 100) with brief justification
2. Audience Value Breakdown(per section if applicable)
   3. Language & Tone Assessment
4. Structure & Pacing Evaluation
5. CTA Effectiveness Rating
6. Predictive Metrics(CTR, AVD, Viral Probability)
7. Red Flags List(if any)
   8. Top 3 Improvement Priorities(specific, actionable)

SCORING PHILOSOPHY:
- Be HARSH but FAIR
   - 90 - 100: Viral potential, minimal improvements needed
      - 70 - 89: Strong script, minor tweaks required
         - 50 - 69: Average, needs significant improvements
            - Below 50: Major issues, requires rewrite
               `,_w=(a,n)=>`
SCRIPT TO ANALYZE:
"${a}"

EVALUATION CRITERIA / DNA:
${n}

TASK:
Analyze the script and provide a score(0 - 100) for each criterion or DNA element.
`,Qu={name:"Pattern Name",niche:"Industry/Category (e.g. Health, Finance, Gaming)",analysis:{pacing:"Description",tone:"Description",structure_skeleton:[{section_name:"Hook",timing:"0-8s",word_count_range:"40-60",tone:"Urgent",pacing:"Fast cuts every 2s",content_focus:"Grab attention with shocking statement",must_include:["Sound effect"],audience_value:"Instant curiosity and emotional hook",audience_reaction:"Shock",viral_triggers:"Loud noise",micro_hook:"Mini-hook statement",open_loop:"Big question",transition_out:"Cut to black"}],hook_angle:{type:"Curiosity",description:"Psychological deconstruction of the hook with evidence."},retention_tactics:["Tactic 1","Tactic 2"],audience_psychology:"Description",audience_sentiment:{high_dopamine_triggers:["Trigger 1"],confusion_points:["Point 1"],objections:["Objection 1"]},contrastive_insight:"Insight",linguistic_fingerprint:{role_persona:"The Rebel / The Mentor",tone_description:"Deep analysis of tone with specific examples",keywords:["Keyword 1","Phrase 2"],sentence_structure:"Description of sentence length and rhythm"},core_patterns:["Pattern 1 - The 70% Safe Zone"],viral_x_factors:["Anomaly 1 - The 30% Breakthrough Element"],content_gaps:["Gap 1"],viral_triggers:["Trigger 1"],flop_reasons:["Reason 1"],target_platform:"YouTube Shorts",target_length:"60s",target_word_count_range:"3000-3400",overall_vibe:"Description"},raw_transcript_summary:"Summary"},_u=2,ww=a=>{if(a.length===0)return"1000-2000";const n=a.map(g=>g.script.trim().split(/\s+/).filter(x=>x.length>0).length),i=Math.min(...n),l=Math.max(...n),u=Math.round(n.reduce((g,p)=>g+p,0)/n.length);console.log(`Word counts per script: ${n.join(", ")}, Average: ${u}`);const h=Math.floor(i/50)*50,f=Math.ceil(l/50)*50;return`${h}-${f}`},Ew=a=>{if(a.length===0)return 1500;const n=a.map(i=>i.script.trim().split(/\s+/).filter(l=>l.length>0).length);return Math.round(n.reduce((i,l)=>i+l,0)/n.length)},Nw=async(a,n,i,l)=>{if(a.length===0)throw new Error("No DNA to synthesize");if(a.length===1)return a[0].analysis.target_word_count_range=`${n}`,a[0];console.log(`Synthesizing ${a.length} DNAs with AI... Target: ${n} words`);const u=a.map((x,y)=>`=== DNA #${y+1} ===
${JSON.stringify(x.analysis,null,2)}`).join(`

`),h=`You have ${a.length} raw DNA analyses from different viral scripts in the same niche.

${u}

YOUR TASK:
Synthesize ALL these DNAs into ONE refined, unified DNA.

CRITICAL RULES:
1. **TARGET WORD COUNT = ${n} words** - This is FIXED. Your structure must sum to exactly this.
2. **STRUCTURE**: Create a balanced structure (5-8 sections). Don't just concatenate - SYNTHESIZE the essence.
3. **REFINEMENT**: For each section, combine insights from ALL DNAs into one refined description.
4. **NO BLOAT**: Be concise. Remove redundancy. Keep only what's essential and impactful.
5. Each section's word_count_range should sum to approximately ${n} total.

OUTPUT: Return PURE JSON matching the DNA template. Include the refined, synthesized analysis.`,f=`${vg}
  
CRITICAL: You are SYNTHESIZING multiple DNAs into ONE refined DNA.
  - Do NOT just merge arrays. SYNTHESIZE and REFINE.
  - Target word count is FIXED at ${n} words.
  - Output valid JSON only.
  
TEMPLATE:
${JSON.stringify(Qu,null,2)}`,g=await Hn(gn,f,h+Pa(i)+`

OUTPUT PURE JSON ONLY.`,l,!0),p=a.flatMap(x=>x.source_urls||[]),b=Wu(g,[]);return b.source_urls=[...new Set(p)],b.analysis.target_word_count_range=`${n}`,b.id=`dna-synthesized-${Date.now()}`,b},L0=async(a,n,i,l,u)=>{const h=kl(a,"VIRAL"),f=kl(n,"FLOP");let g=u&&u.trim()?`INPUT DATA STREAMS:
=== DATASET A: VIRAL HITS ===
${h}
=== DATASET B: FLOPS ===
${f}
USER CUSTOM INSTRUCTIONS:
${u}
TASK: Perform analysis and output strictly in JSON.`:pw(h,f);g+=Pa(i),g+=`

REMINDER: OUTPUT PURE JSON ONLY. NO MARKDOWN. START WITH '{'.`;const p=`${vg}
  
CRITICAL OUTPUT RULE: You MUST return valid JSON matching the template below. 
  - Do NOT output schema definitions. 
  - Output the FILLED data object.
  
TEMPLATE:
${JSON.stringify(Qu,null,2)}`,b=await Hn(gn,p,g,l,!0);return Wu(b,a)},Sw=async(a,n,i,l,u,h,f)=>{const g=ww(a);if(console.log("--- DEBUG DNA INPUT ---"),console.log(`Virals Count: ${a.length}, Word Count Range: ${g}`),console.log(`Flops Count: ${n.length}`),a.length<=_u){const w=await L0(a,n,i,l,u);return w.analysis.target_word_count_range=g,w}const p=[];for(let w=0;w<a.length;w+=_u)p.push(a.slice(w,w+_u));console.log(`Processing ${p.length} batches with staggered delay...`),f&&f(0,p.length);const b=()=>new Promise(w=>setTimeout(w,2e3+Math.random()*1e3)),x=p.map(async(w,S)=>(S>0&&(console.log(`Waiting before batch ${S+1}...`),await b()),console.log(`Starting batch ${S+1}/${p.length}...`),f&&f(S+1,p.length),L0(w,S===0?n:[],i,l,u))),y=await Promise.all(x);f&&f(p.length,p.length),console.log("All batches completed. Synthesizing DNA results with AI...");const E=Ew(a);return await Nw(y,E,i,l)},Tw=async(a,n,i,l,u,h,f)=>{const g=kl(n,"NEW VIRAL"),p=kl(i,"NEW FLOP"),b=JSON.stringify(a.analysis,null,2);console.log("--- DEBUG DNA REFINE INPUT ---"),console.log(`New Virals Length: ${g.length}`);let x=h&&h.trim()?`BASE DNA: ${b}
NEW VIRALS: ${g}
NEW FLOPS: ${p}
USER INSTRUCTIONS: ${h}`:mw(b,g,p);x+=Pa(l),x+=`

REMINDER: OUTPUT PURE JSON ONLY. NO MARKDOWN. START WITH '{'.`;const y=`${fw}
  
CRITICAL OUTPUT RULE: You MUST return valid JSON matching the template below.
  - Do NOT output schema definitions. 
  - Output the FILLED data object.
  
TEMPLATE:
${JSON.stringify(Qu,null,2)}`,E=await Hn(gn,y,x,u,!0),_=Wu(E,n),w=[...a.source_urls||[],...n.map(S=>S.url||"").filter(Boolean)];return{...a,id:a.id||`dna-evolved-${Date.now()}`,name:_.name||a.name,source_urls:[...new Set(w)]}},kl=(a,n)=>a.map((i,l)=>`[${n} #${l+1}]
Title: ${i.title}
Transcript: ${i.script}
Feedback: ${i.comments||"N/A"}`).join(`

`),Wu=(a,n)=>{let i=a.trim();i.startsWith("```")&&(i=i.replace(/^```(json)?/,"").replace(/```$/,"").trim());let l;try{l=JSON.parse(i||"{}"),l.dna&&(l=l.dna)}catch{throw console.error("DNA Parse Error",i),new Error("Failed to parse AI response. Check console for raw output.")}return{id:`dna-${Date.now()}`,source_urls:n.map(u=>u.url||"").filter(Boolean),...l}},pn=a=>a?a.replace(/[\x00-\x08\x0B-\x1F\x7F]/g,""):"",Aw=a=>{if(!a)return"{}";let n=a.trim();n=n.replace(/^```json\s*/i,"").replace(/^```\s*/,"").replace(/```\s*$/,"");const i=n.indexOf("{"),l=n.lastIndexOf("}");return i!==-1&&l>i&&(n=n.substring(i,l+1)),n=n.replace(/,\s*([}\]])/g,"$1"),n},M0=a=>a&&(a.properties&&!a.sections&&!a.analysis&&(console.warn("Unwrapping hallucinated schema structure (Level 1)..."),a.properties.analysis)?a.properties.analysis.properties?(console.warn("Deep unwrap required. Aborting unwrap, data likely invalid schema definition."),a):a.properties:a.blueprint&&a.blueprint.sections?a.blueprint:a),Ow=async(a,n,i,l,u,h,f,g,p,b)=>{let x="Optimize for retention.";p&&(x=`STYLE & STRUCTURE GUIDE (FROM DNA: ${p.name}):
`,x+=`- Tone: ${p.analysis.tone}
`,x+=`- Structure: ${JSON.stringify(p.analysis.structure_skeleton)}
`,x+=`- Viral Triggers to use: ${JSON.stringify(p.analysis.viral_triggers)}
`,p.user_notes&&(x+=`
USER MANDATORY NOTES / CONSTRAINTS: "${pn(p.user_notes)}"
`)),b&&b.criteria.length>0&&(x+=`

CRITICAL QUALITY STANDARDS (You MUST follow these rules):`,b.criteria.forEach((H,P)=>{x+=`
${P+1}. ${H.name}: ${H.description}`}),x+=`
Ensure the generated blueprint explicitly addresses these standards.`);const y=pn(i.script||i.description||"");let E="";if(a==="idea"?E=`PRIMARY USER PROMPT / IDEA: Title: "${pn(i.title)}"
<idea_concept>
${y}
</idea_concept>
TASK: Generate blueprint from this idea.`:E=`SOURCE MATERIAL (DRAFT TO REWRITE):
<source_material>
${y}
</source_material>

TASK: Restructure this material completely.`,l&&l.length>0){const H=l.map((P,ee)=>`[VIRAL REF #${ee+1}]
Title: ${pn(P.title)}
<content>
${pn(P.script||P.description)}
</content>
Feedback: ${pn(P.comments||"N/A")}`).join(`

`);E+=`

=== VIRAL REFERENCES (EMULATE THESE PATTERNS) ===
${H}`}else E+=`

=== VIRAL REFERENCES ===
(None provided. Rely on General Viral Logic.)`;if(u&&u.length>0){const H=u.map((P,ee)=>`[FLOP REF #${ee+1}]
Title: ${pn(P.title)}
<content>
${pn(P.script||P.description)}
</content>
Feedback: ${pn(P.comments||"N/A")}`).join(`

`);E+=`

=== FLOP REFERENCES (AVOID THESE PATTERNS) ===
${H}`}else E+=`

=== FLOP REFERENCES ===
(None provided. Rely on General Flop Avoidance Logic.)`;console.log("--- DEBUG BLUEPRINT INPUT ---"),console.log(`Mode: ${a}`),console.log(`Draft Length: ${y.length}`),g&&g.trim()&&(x+=`

USER OVERRIDE: ${pn(g)}`);const _=bw(E,x,h)+Pa(n),S=`${gw}
  
CRITICAL OUTPUT RULE: Return ONLY a valid JSON object. 
  - Follow the structure below exactly.
  - Do NOT output schema definitions (like "type": "object"). 
  - Just fill the data.
  
  REQUIRED JSON STRUCTURE:
  ${JSON.stringify({analysis:{core_formula:"The concise formula name",narrative_phases:[{phase:"Setup",purpose:"Hook",duration_weight:"10%"}],pacing_map:{climax_points:["Midpoint","End"],speed_strategy:"Fast start, slow middle",pattern:"Linear"},hook_hierarchy:{main_hook:"The big promise",micro_hooks:["Visual","Audio"],psychological_anchor:"Curiosity"},emotional_arc:{triggers:["Fear","Relief"],energy_flow:"Rising",payoff_moment:"The reveal"},linguistic_fingerprint:{pov:"First person",dominant_tones:["Authoritative"],vocabulary_style:"Simple"}},audience_simulation:{newbie_perspective:"Reaction...",expert_perspective:"Reaction...",hater_critique:"Reaction...",final_verdict:"Go / No Go"},pitfalls:["Avoid X","Don't do Y"],critique:"Overall assessment...",sections:[{title:"Section Title",type:"Hook / Body / CTA",purpose:"Goal of section",hook_tactic:"Technique used",emotional_goal:"Feeling",pacing_instruction:"Fast/Slow",content_plan:"Detailed outline...",word_count_target:150}]},null,2)}`,N=_+`

REMINDER: OUTPUT PURE JSON ONLY. START WITH '{'. NO MARKDOWN. NO REASONING TEXT.`,k=await Hn(gn,S,N,f,!0);let K;try{K=JSON.parse(k),K=M0(K)}catch{console.warn("Initial JSON parse failed, attempting repair...");try{const P=Aw(k);K=JSON.parse(P),K=M0(K)}catch{throw console.error("Blueprint JSON Parse Error. Raw:",k),new Error("Failed to parse blueprint JSON. Check console for raw AI output.")}}if(!K.sections||!Array.isArray(K.sections))throw console.error("Invalid Blueprint Structure:",K),new Error("AI returned JSON, but it is missing the 'sections' array. The generation failed to follow the template.");return K.sections=(K.sections||[]).map((H,P)=>{const ee={...H,id:`bp-${Date.now()}-${P}`};if(p&&p.analysis.structure_skeleton){const te=p.analysis.structure_skeleton;if(Array.isArray(te)&&te.length>P){const W=te[P];typeof W!="string"&&(ee.dna_section_detail=W)}}return ee}),K};var jw={};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var B0;(function(a){a.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",a.OUTCOME_OK="OUTCOME_OK",a.OUTCOME_FAILED="OUTCOME_FAILED",a.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(B0||(B0={}));var H0;(function(a){a.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",a.PYTHON="PYTHON"})(H0||(H0={}));var G0;(function(a){a.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",a.SILENT="SILENT",a.WHEN_IDLE="WHEN_IDLE",a.INTERRUPT="INTERRUPT"})(G0||(G0={}));var Bs;(function(a){a.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",a.STRING="STRING",a.NUMBER="NUMBER",a.INTEGER="INTEGER",a.BOOLEAN="BOOLEAN",a.ARRAY="ARRAY",a.OBJECT="OBJECT",a.NULL="NULL"})(Bs||(Bs={}));var P0;(function(a){a.MODE_UNSPECIFIED="MODE_UNSPECIFIED",a.MODE_DYNAMIC="MODE_DYNAMIC"})(P0||(P0={}));var $0;(function(a){a.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",a.SIMPLE_SEARCH="SIMPLE_SEARCH",a.ELASTIC_SEARCH="ELASTIC_SEARCH"})($0||($0={}));var V0;(function(a){a.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",a.NO_AUTH="NO_AUTH",a.API_KEY_AUTH="API_KEY_AUTH",a.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",a.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",a.OAUTH="OAUTH",a.OIDC_AUTH="OIDC_AUTH"})(V0||(V0={}));var Y0;(function(a){a.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",a.HTTP_IN_QUERY="HTTP_IN_QUERY",a.HTTP_IN_HEADER="HTTP_IN_HEADER",a.HTTP_IN_PATH="HTTP_IN_PATH",a.HTTP_IN_BODY="HTTP_IN_BODY",a.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(Y0||(Y0={}));var q0;(function(a){a.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",a.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",a.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",a.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",a.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",a.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",a.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(q0||(q0={}));var K0;(function(a){a.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",a.LOW="LOW",a.MEDIUM="MEDIUM",a.HIGH="HIGH",a.MINIMAL="MINIMAL"})(K0||(K0={}));var F0;(function(a){a.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",a.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",a.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",a.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",a.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",a.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",a.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",a.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",a.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",a.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",a.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(F0||(F0={}));var J0;(function(a){a.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",a.SEVERITY="SEVERITY",a.PROBABILITY="PROBABILITY"})(J0||(J0={}));var X0;(function(a){a.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",a.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",a.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",a.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",a.BLOCK_NONE="BLOCK_NONE",a.OFF="OFF"})(X0||(X0={}));var Q0;(function(a){a.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",a.STOP="STOP",a.MAX_TOKENS="MAX_TOKENS",a.SAFETY="SAFETY",a.RECITATION="RECITATION",a.LANGUAGE="LANGUAGE",a.OTHER="OTHER",a.BLOCKLIST="BLOCKLIST",a.PROHIBITED_CONTENT="PROHIBITED_CONTENT",a.SPII="SPII",a.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",a.IMAGE_SAFETY="IMAGE_SAFETY",a.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",a.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",a.NO_IMAGE="NO_IMAGE",a.IMAGE_RECITATION="IMAGE_RECITATION",a.IMAGE_OTHER="IMAGE_OTHER"})(Q0||(Q0={}));var W0;(function(a){a.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",a.NEGLIGIBLE="NEGLIGIBLE",a.LOW="LOW",a.MEDIUM="MEDIUM",a.HIGH="HIGH"})(W0||(W0={}));var Z0;(function(a){a.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",a.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",a.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",a.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",a.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(Z0||(Z0={}));var em;(function(a){a.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",a.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",a.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",a.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",a.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(em||(em={}));var tm;(function(a){a.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",a.SAFETY="SAFETY",a.OTHER="OTHER",a.BLOCKLIST="BLOCKLIST",a.PROHIBITED_CONTENT="PROHIBITED_CONTENT",a.IMAGE_SAFETY="IMAGE_SAFETY",a.MODEL_ARMOR="MODEL_ARMOR",a.JAILBREAK="JAILBREAK"})(tm||(tm={}));var nm;(function(a){a.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",a.ON_DEMAND="ON_DEMAND",a.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(nm||(nm={}));var am;(function(a){a.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",a.TEXT="TEXT",a.IMAGE="IMAGE",a.AUDIO="AUDIO"})(am||(am={}));var sm;(function(a){a.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",a.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",a.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",a.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(sm||(sm={}));var im;(function(a){a.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",a.TUNING_MODE_FULL="TUNING_MODE_FULL",a.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(im||(im={}));var rm;(function(a){a.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",a.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",a.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",a.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",a.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",a.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",a.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(rm||(rm={}));var lm;(function(a){a.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",a.JOB_STATE_QUEUED="JOB_STATE_QUEUED",a.JOB_STATE_PENDING="JOB_STATE_PENDING",a.JOB_STATE_RUNNING="JOB_STATE_RUNNING",a.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",a.JOB_STATE_FAILED="JOB_STATE_FAILED",a.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",a.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",a.JOB_STATE_PAUSED="JOB_STATE_PAUSED",a.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",a.JOB_STATE_UPDATING="JOB_STATE_UPDATING",a.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(lm||(lm={}));var om;(function(a){a.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",a.TUNING_TASK_I2V="TUNING_TASK_I2V",a.TUNING_TASK_T2V="TUNING_TASK_T2V",a.TUNING_TASK_R2V="TUNING_TASK_R2V"})(om||(om={}));var cm;(function(a){a.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",a.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",a.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",a.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",a.MEDIA_RESOLUTION_ULTRA_HIGH="MEDIA_RESOLUTION_ULTRA_HIGH"})(cm||(cm={}));var um;(function(a){a.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",a.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",a.BALANCED="BALANCED",a.PRIORITIZE_COST="PRIORITIZE_COST"})(um||(um={}));var dm;(function(a){a.UNSPECIFIED="UNSPECIFIED",a.BLOCKING="BLOCKING",a.NON_BLOCKING="NON_BLOCKING"})(dm||(dm={}));var hm;(function(a){a.MODE_UNSPECIFIED="MODE_UNSPECIFIED",a.MODE_DYNAMIC="MODE_DYNAMIC"})(hm||(hm={}));var fm;(function(a){a.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",a.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(fm||(fm={}));var pm;(function(a){a.MODE_UNSPECIFIED="MODE_UNSPECIFIED",a.AUTO="AUTO",a.ANY="ANY",a.NONE="NONE",a.VALIDATED="VALIDATED"})(pm||(pm={}));var mm;(function(a){a.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",a.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",a.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",a.BLOCK_NONE="BLOCK_NONE"})(mm||(mm={}));var gm;(function(a){a.DONT_ALLOW="DONT_ALLOW",a.ALLOW_ADULT="ALLOW_ADULT",a.ALLOW_ALL="ALLOW_ALL"})(gm||(gm={}));var bm;(function(a){a.auto="auto",a.en="en",a.ja="ja",a.ko="ko",a.hi="hi",a.zh="zh",a.pt="pt",a.es="es"})(bm||(bm={}));var ym;(function(a){a.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",a.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",a.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",a.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",a.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(ym||(ym={}));var vm;(function(a){a.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",a.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",a.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",a.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(vm||(vm={}));var xm;(function(a){a.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",a.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",a.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",a.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(xm||(xm={}));var _m;(function(a){a.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",a.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",a.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",a.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",a.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",a.EDIT_MODE_STYLE="EDIT_MODE_STYLE",a.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",a.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(_m||(_m={}));var wm;(function(a){a.FOREGROUND="FOREGROUND",a.BACKGROUND="BACKGROUND",a.PROMPT="PROMPT",a.SEMANTIC="SEMANTIC",a.INTERACTIVE="INTERACTIVE"})(wm||(wm={}));var Em;(function(a){a.ASSET="ASSET",a.STYLE="STYLE"})(Em||(Em={}));var Nm;(function(a){a.INSERT="INSERT",a.REMOVE="REMOVE",a.REMOVE_STATIC="REMOVE_STATIC",a.OUTPAINT="OUTPAINT"})(Nm||(Nm={}));var Sm;(function(a){a.OPTIMIZED="OPTIMIZED",a.LOSSLESS="LOSSLESS"})(Sm||(Sm={}));var Tm;(function(a){a.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",a.PREFERENCE_TUNING="PREFERENCE_TUNING"})(Tm||(Tm={}));var Am;(function(a){a.STATE_UNSPECIFIED="STATE_UNSPECIFIED",a.STATE_PENDING="STATE_PENDING",a.STATE_ACTIVE="STATE_ACTIVE",a.STATE_FAILED="STATE_FAILED"})(Am||(Am={}));var Om;(function(a){a.STATE_UNSPECIFIED="STATE_UNSPECIFIED",a.PROCESSING="PROCESSING",a.ACTIVE="ACTIVE",a.FAILED="FAILED"})(Om||(Om={}));var jm;(function(a){a.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",a.UPLOADED="UPLOADED",a.GENERATED="GENERATED"})(jm||(jm={}));var Rm;(function(a){a.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",a.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",a.RESPONSE_REJECTED="RESPONSE_REJECTED",a.NEED_MORE_INPUT="NEED_MORE_INPUT"})(Rm||(Rm={}));var Cm;(function(a){a.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",a.TEXT="TEXT",a.IMAGE="IMAGE",a.VIDEO="VIDEO",a.AUDIO="AUDIO",a.DOCUMENT="DOCUMENT"})(Cm||(Cm={}));var Im;(function(a){a.VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",a.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",a.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS"})(Im||(Im={}));var Dm;(function(a){a.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",a.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",a.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(Dm||(Dm={}));var Um;(function(a){a.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",a.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",a.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(Um||(Um={}));var zm;(function(a){a.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",a.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",a.NO_INTERRUPTION="NO_INTERRUPTION"})(zm||(zm={}));var km;(function(a){a.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",a.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",a.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(km||(km={}));var Lm;(function(a){a.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",a.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",a.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",a.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",a.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",a.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",a.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",a.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",a.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",a.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",a.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",a.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",a.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(Lm||(Lm={}));var Mm;(function(a){a.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",a.QUALITY="QUALITY",a.DIVERSITY="DIVERSITY",a.VOCALIZATION="VOCALIZATION"})(Mm||(Mm={}));var Bm;(function(a){a.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",a.PLAY="PLAY",a.PAUSE="PAUSE",a.STOP="STOP",a.RESET_CONTEXT="RESET_CONTEXT"})(Bm||(Bm={}));/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Hm;(function(a){a.PAGED_ITEM_BATCH_JOBS="batchJobs",a.PAGED_ITEM_MODELS="models",a.PAGED_ITEM_TUNING_JOBS="tuningJobs",a.PAGED_ITEM_FILES="files",a.PAGED_ITEM_CACHED_CONTENTS="cachedContents",a.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",a.PAGED_ITEM_DOCUMENTS="documents"})(Hm||(Hm={}));function Ll(a,n){var i={};for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&n.indexOf(l)<0&&(i[l]=a[l]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,l=Object.getOwnPropertySymbols(a);u<l.length;u++)n.indexOf(l[u])<0&&Object.prototype.propertyIsEnumerable.call(a,l[u])&&(i[l[u]]=a[l[u]]);return i}function Gm(a){var n=typeof Symbol=="function"&&Symbol.iterator,i=n&&a[n],l=0;if(i)return i.call(a);if(a&&typeof a.length=="number")return{next:function(){return a&&l>=a.length&&(a=void 0),{value:a&&a[l++],done:!a}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}function qe(a){return this instanceof qe?(this.v=a,this):new qe(a)}function qi(a,n,i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var l=i.apply(a,n||[]),u,h=[];return u=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),g("next"),g("throw"),g("return",f),u[Symbol.asyncIterator]=function(){return this},u;function f(_){return function(w){return Promise.resolve(w).then(_,y)}}function g(_,w){l[_]&&(u[_]=function(S){return new Promise(function(N,k){h.push([_,S,N,k])>1||p(_,S)})},w&&(u[_]=w(u[_])))}function p(_,w){try{b(l[_](w))}catch(S){E(h[0][3],S)}}function b(_){_.value instanceof qe?Promise.resolve(_.value.v).then(x,y):E(h[0][2],_)}function x(_){p("next",_)}function y(_){p("throw",_)}function E(_,w){_(w),h.shift(),h.length&&p(h[0][0],h[0][1])}}function $s(a){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=a[Symbol.asyncIterator],i;return n?n.call(a):(a=typeof Gm=="function"?Gm(a):a[Symbol.iterator](),i={},l("next"),l("throw"),l("return"),i[Symbol.asyncIterator]=function(){return this},i);function l(h){i[h]=a[h]&&function(f){return new Promise(function(g,p){f=a[h](f),u(g,p,f.done,f.value)})}}function u(h,f,g,p){Promise.resolve(p).then(function(b){h({value:b,done:g})},f)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let _g=function(){const{crypto:a}=globalThis;if(a!=null&&a.randomUUID)return _g=a.randomUUID.bind(a),a.randomUUID();const n=new Uint8Array(1),i=a?()=>a.getRandomValues(n)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,l=>(+l^i()&15>>+l/4).toString(16))};const Rw=()=>_g();/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Bu(a){return typeof a=="object"&&a!==null&&("name"in a&&a.name==="AbortError"||"message"in a&&String(a.message).includes("FetchRequestCanceledException"))}const Hu=a=>{if(a instanceof Error)return a;if(typeof a=="object"&&a!==null){try{if(Object.prototype.toString.call(a)==="[object Error]"){const n=new Error(a.message,a.cause?{cause:a.cause}:{});return a.stack&&(n.stack=a.stack),a.cause&&!n.cause&&(n.cause=a.cause),a.name&&(n.name=a.name),n}}catch{}try{return new Error(JSON.stringify(a))}catch{}}return new Error(a)};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class en extends Error{}class wt extends en{constructor(n,i,l,u){super(`${wt.makeMessage(n,i,l)}`),this.status=n,this.headers=u,this.error=i}static makeMessage(n,i,l){const u=i!=null&&i.message?typeof i.message=="string"?i.message:JSON.stringify(i.message):i?JSON.stringify(i):l;return n&&u?`${n} ${u}`:n?`${n} status code (no body)`:u||"(no status code or body)"}static generate(n,i,l,u){if(!n||!u)return new $l({message:l,cause:Hu(i)});const h=i;return n===400?new Eg(n,h,l,u):n===401?new Ng(n,h,l,u):n===403?new Sg(n,h,l,u):n===404?new Tg(n,h,l,u):n===409?new Ag(n,h,l,u):n===422?new Og(n,h,l,u):n===429?new jg(n,h,l,u):n>=500?new Rg(n,h,l,u):new wt(n,h,l,u)}}class Gu extends wt{constructor({message:n}={}){super(void 0,void 0,n||"Request was aborted.",void 0)}}class $l extends wt{constructor({message:n,cause:i}){super(void 0,void 0,n||"Connection error.",void 0),i&&(this.cause=i)}}class wg extends $l{constructor({message:n}={}){super({message:n??"Request timed out."})}}class Eg extends wt{}class Ng extends wt{}class Sg extends wt{}class Tg extends wt{}class Ag extends wt{}class Og extends wt{}class jg extends wt{}class Rg extends wt{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Cw=/^[a-z][a-z0-9+.-]*:/i,Iw=a=>Cw.test(a);let Pu=a=>(Pu=Array.isArray,Pu(a));const Dw=Pu;let Uw=Dw;const Pm=Uw;function zw(a){if(!a)return!0;for(const n in a)return!1;return!0}function kw(a,n){return Object.prototype.hasOwnProperty.call(a,n)}const Lw=(a,n)=>{if(typeof n!="number"||!Number.isInteger(n))throw new en(`${a} must be an integer`);if(n<0)throw new en(`${a} must be a positive integer`);return n},Mw=a=>{try{return JSON.parse(a)}catch{return}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Bw=a=>new Promise(n=>setTimeout(n,a));/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Ls="0.0.1";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Hw(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const Gw=()=>{var a,n,i,l,u;const h=Hw();if(h==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ls,"X-Stainless-OS":Vm(Deno.build.os),"X-Stainless-Arch":$m(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:(n=(a=Deno.version)===null||a===void 0?void 0:a.deno)!==null&&n!==void 0?n:"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ls,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(h==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ls,"X-Stainless-OS":Vm((i=globalThis.process.platform)!==null&&i!==void 0?i:"unknown"),"X-Stainless-Arch":$m((l=globalThis.process.arch)!==null&&l!==void 0?l:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":(u=globalThis.process.version)!==null&&u!==void 0?u:"unknown"};const f=Pw();return f?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ls,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${f.browser}`,"X-Stainless-Runtime-Version":f.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ls,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function Pw(){if(typeof navigator>"u"||!navigator)return null;const a=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:n,pattern:i}of a){const l=i.exec(navigator.userAgent);if(l){const u=l[1]||0,h=l[2]||0,f=l[3]||0;return{browser:n,version:`${u}.${h}.${f}`}}}return null}const $m=a=>a==="x32"?"x32":a==="x86_64"||a==="x64"?"x64":a==="arm"?"arm":a==="aarch64"||a==="arm64"?"arm64":a?`other:${a}`:"unknown",Vm=a=>(a=a.toLowerCase(),a.includes("ios")?"iOS":a==="android"?"Android":a==="darwin"?"MacOS":a==="win32"?"Windows":a==="freebsd"?"FreeBSD":a==="openbsd"?"OpenBSD":a==="linux"?"Linux":a?`Other:${a}`:"Unknown");let Tl;const $w=()=>Tl??(Tl=Gw());/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Vw(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function Cg(...a){const n=globalThis.ReadableStream;if(typeof n>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new n(...a)}function Yw(a){let n=Symbol.asyncIterator in a?a[Symbol.asyncIterator]():a[Symbol.iterator]();return Cg({start(){},async pull(i){const{done:l,value:u}=await n.next();l?i.close():i.enqueue(u)},async cancel(){var i;await((i=n.return)===null||i===void 0?void 0:i.call(n))}})}function Ig(a){if(a[Symbol.asyncIterator])return a;const n=a.getReader();return{async next(){try{const i=await n.read();return i!=null&&i.done&&n.releaseLock(),i}catch(i){throw n.releaseLock(),i}},async return(){const i=n.cancel();return n.releaseLock(),await i,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function qw(a){var n,i;if(a===null||typeof a!="object")return;if(a[Symbol.asyncIterator]){await((i=(n=a[Symbol.asyncIterator]()).return)===null||i===void 0?void 0:i.call(n));return}const l=a.getReader(),u=l.cancel();l.releaseLock(),await u}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Kw=({headers:a,body:n})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(n)});/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Dg=()=>{var a;if(typeof File>"u"){const{process:n}=globalThis,i=typeof((a=n==null?void 0:n.versions)===null||a===void 0?void 0:a.node)=="string"&&parseInt(n.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(i?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function wu(a,n,i){return Dg(),new File(a,n??"unknown_file",i)}function Fw(a){return(typeof a=="object"&&a!==null&&("name"in a&&a.name&&String(a.name)||"url"in a&&a.url&&String(a.url)||"filename"in a&&a.filename&&String(a.filename)||"path"in a&&a.path&&String(a.path))||"").split(/[\\/]/).pop()||void 0}const Jw=a=>a!=null&&typeof a=="object"&&typeof a[Symbol.asyncIterator]=="function";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Ug=a=>a!=null&&typeof a=="object"&&typeof a.size=="number"&&typeof a.type=="string"&&typeof a.text=="function"&&typeof a.slice=="function"&&typeof a.arrayBuffer=="function",Xw=a=>a!=null&&typeof a=="object"&&typeof a.name=="string"&&typeof a.lastModified=="number"&&Ug(a),Qw=a=>a!=null&&typeof a=="object"&&typeof a.url=="string"&&typeof a.blob=="function";async function Ww(a,n,i){if(Dg(),a=await a,Xw(a))return a instanceof File?a:wu([await a.arrayBuffer()],a.name);if(Qw(a)){const u=await a.blob();return n||(n=new URL(a.url).pathname.split(/[\\/]/).pop()),wu(await $u(u),n,i)}const l=await $u(a);if(n||(n=Fw(a)),!(i!=null&&i.type)){const u=l.find(h=>typeof h=="object"&&"type"in h&&h.type);typeof u=="string"&&(i=Object.assign(Object.assign({},i),{type:u}))}return wu(l,n,i)}async function $u(a){var n,i,l,u,h;let f=[];if(typeof a=="string"||ArrayBuffer.isView(a)||a instanceof ArrayBuffer)f.push(a);else if(Ug(a))f.push(a instanceof Blob?a:await a.arrayBuffer());else if(Jw(a))try{for(var g=!0,p=$s(a),b;b=await p.next(),n=b.done,!n;g=!0){u=b.value,g=!1;const x=u;f.push(...await $u(x))}}catch(x){i={error:x}}finally{try{!g&&!n&&(l=p.return)&&await l.call(p)}finally{if(i)throw i.error}}else{const x=(h=a==null?void 0:a.constructor)===null||h===void 0?void 0:h.name;throw new Error(`Unexpected data type: ${typeof a}${x?`; constructor: ${x}`:""}${Zw(a)}`)}return f}function Zw(a){return typeof a!="object"||a===null?"":`; props: [${Object.getOwnPropertyNames(a).map(i=>`"${i}"`).join(", ")}]`}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class zg{constructor(n){this._client=n}}zg._key=[];/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function kg(a){return a.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const Ym=Object.freeze(Object.create(null)),eE=(a=kg)=>(function(i,...l){if(i.length===1)return i[0];let u=!1;const h=[],f=i.reduce((x,y,E)=>{var _,w,S;/[?#]/.test(y)&&(u=!0);const N=l[E];let k=(u?encodeURIComponent:a)(""+N);return E!==l.length&&(N==null||typeof N=="object"&&N.toString===((S=Object.getPrototypeOf((w=Object.getPrototypeOf((_=N.hasOwnProperty)!==null&&_!==void 0?_:Ym))!==null&&w!==void 0?w:Ym))===null||S===void 0?void 0:S.toString))&&(k=N+"",h.push({start:x.length+y.length,length:k.length,error:`Value of type ${Object.prototype.toString.call(N).slice(8,-1)} is not a valid path parameter`})),x+y+(E===l.length?"":k)},""),g=f.split(/[?#]/,1)[0],p=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let b;for(;(b=p.exec(g))!==null;)h.push({start:b.index,length:b[0].length,error:`Value "${b[0]}" can't be safely passed as a path parameter`});if(h.sort((x,y)=>x.start-y.start),h.length>0){let x=0;const y=h.reduce((E,_)=>{const w=" ".repeat(_.start-x),S="^".repeat(_.length);return x=_.start+_.length,E+w+S},"");throw new en(`Path parameters result in path with invalid segments:
${h.map(E=>E.error).join(`
`)}
${f}
${y}`)}return f}),Al=eE(kg);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Lg extends zg{create(n,i){var l;const{api_version:u=this._client.apiVersion}=n,h=Ll(n,["api_version"]);if("model"in h&&"agent_config"in h)throw new en("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in h&&"generation_config"in h)throw new en("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(Al`/${u}/interactions`,Object.assign(Object.assign({body:h},i),{stream:(l=n.stream)!==null&&l!==void 0?l:!1}))}delete(n,i={},l){const{api_version:u=this._client.apiVersion}=i??{};return this._client.delete(Al`/${u}/interactions/${n}`,l)}cancel(n,i={},l){const{api_version:u=this._client.apiVersion}=i??{};return this._client.post(Al`/${u}/interactions/${n}/cancel`,l)}get(n,i={},l){var u;const h=i??{},{api_version:f=this._client.apiVersion}=h,g=Ll(h,["api_version"]);return this._client.get(Al`/${f}/interactions/${n}`,Object.assign(Object.assign({query:g},l),{stream:(u=i==null?void 0:i.stream)!==null&&u!==void 0?u:!1}))}}Lg._key=Object.freeze(["interactions"]);class Mg extends Lg{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function tE(a){let n=0;for(const u of a)n+=u.length;const i=new Uint8Array(n);let l=0;for(const u of a)i.set(u,l),l+=u.length;return i}let Ol;function Zu(a){let n;return(Ol??(n=new globalThis.TextEncoder,Ol=n.encode.bind(n)))(a)}let jl;function qm(a){let n;return(jl??(n=new globalThis.TextDecoder,jl=n.decode.bind(n)))(a)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Vl{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(n){if(n==null)return[];const i=n instanceof ArrayBuffer?new Uint8Array(n):typeof n=="string"?Zu(n):n;this.buffer=tE([this.buffer,i]);const l=[];let u;for(;(u=nE(this.buffer,this.carriageReturnIndex))!=null;){if(u.carriage&&this.carriageReturnIndex==null){this.carriageReturnIndex=u.index;continue}if(this.carriageReturnIndex!=null&&(u.index!==this.carriageReturnIndex+1||u.carriage)){l.push(qm(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}const h=this.carriageReturnIndex!==null?u.preceding-1:u.preceding,f=qm(this.buffer.subarray(0,h));l.push(f),this.buffer=this.buffer.subarray(u.index),this.carriageReturnIndex=null}return l}flush(){return this.buffer.length?this.decode(`
`):[]}}Vl.NEWLINE_CHARS=new Set([`
`,"\r"]);Vl.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function nE(a,n){for(let u=n??0;u<a.length;u++){if(a[u]===10)return{preceding:u,index:u+1,carriage:!1};if(a[u]===13)return{preceding:u,index:u+1,carriage:!0}}return null}function aE(a){for(let l=0;l<a.length-1;l++){if(a[l]===10&&a[l+1]===10||a[l]===13&&a[l+1]===13)return l+2;if(a[l]===13&&a[l+1]===10&&l+3<a.length&&a[l+2]===13&&a[l+3]===10)return l+4}return-1}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Ml={off:0,error:200,warn:300,info:400,debug:500},Km=(a,n,i)=>{if(a){if(kw(Ml,a))return a;_t(i).warn(`${n} was set to ${JSON.stringify(a)}, expected one of ${JSON.stringify(Object.keys(Ml))}`)}};function $i(){}function Rl(a,n,i){return!n||Ml[a]>Ml[i]?$i:n[a].bind(n)}const sE={error:$i,warn:$i,info:$i,debug:$i};let Fm=new WeakMap;function _t(a){var n;const i=a.logger,l=(n=a.logLevel)!==null&&n!==void 0?n:"off";if(!i)return sE;const u=Fm.get(i);if(u&&u[0]===l)return u[1];const h={error:Rl("error",i,l),warn:Rl("warn",i,l),info:Rl("info",i,l),debug:Rl("debug",i,l)};return Fm.set(i,[l,h]),h}const La=a=>(a.options&&(a.options=Object.assign({},a.options),delete a.options.headers),a.headers&&(a.headers=Object.fromEntries((a.headers instanceof Headers?[...a.headers]:Object.entries(a.headers)).map(([n,i])=>[n,n.toLowerCase()==="x-goog-api-key"||n.toLowerCase()==="authorization"||n.toLowerCase()==="cookie"||n.toLowerCase()==="set-cookie"?"***":i]))),"retryOfRequestLogID"in a&&(a.retryOfRequestLogID&&(a.retryOf=a.retryOfRequestLogID),delete a.retryOfRequestLogID),a);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Hs{constructor(n,i,l){this.iterator=n,this.controller=i,this.client=l}static fromSSEResponse(n,i,l){let u=!1;const h=l?_t(l):console;function f(){return qi(this,arguments,function*(){var p,b,x,y;if(u)throw new en("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");u=!0;let E=!1;try{try{for(var _=!0,w=$s(iE(n,i)),S;S=yield qe(w.next()),p=S.done,!p;_=!0){y=S.value,_=!1;const N=y;if(!E)if(N.data.startsWith("[DONE]")){E=!0;continue}else try{yield yield qe(JSON.parse(N.data))}catch(k){throw h.error("Could not parse message into JSON:",N.data),h.error("From chunk:",N.raw),k}}}catch(N){b={error:N}}finally{try{!_&&!p&&(x=w.return)&&(yield qe(x.call(w)))}finally{if(b)throw b.error}}E=!0}catch(N){if(Bu(N))return yield qe(void 0);throw N}finally{E||i.abort()}})}return new Hs(f,i,l)}static fromReadableStream(n,i,l){let u=!1;function h(){return qi(this,arguments,function*(){var p,b,x,y;const E=new Vl,_=Ig(n);try{for(var w=!0,S=$s(_),N;N=yield qe(S.next()),p=N.done,!p;w=!0){y=N.value,w=!1;const k=y;for(const K of E.decode(k))yield yield qe(K)}}catch(k){b={error:k}}finally{try{!w&&!p&&(x=S.return)&&(yield qe(x.call(S)))}finally{if(b)throw b.error}}for(const k of E.flush())yield yield qe(k)})}function f(){return qi(this,arguments,function*(){var p,b,x,y;if(u)throw new en("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");u=!0;let E=!1;try{try{for(var _=!0,w=$s(h()),S;S=yield qe(w.next()),p=S.done,!p;_=!0){y=S.value,_=!1;const N=y;E||N&&(yield yield qe(JSON.parse(N)))}}catch(N){b={error:N}}finally{try{!_&&!p&&(x=w.return)&&(yield qe(x.call(w)))}finally{if(b)throw b.error}}E=!0}catch(N){if(Bu(N))return yield qe(void 0);throw N}finally{E||i.abort()}})}return new Hs(f,i,l)}[Symbol.asyncIterator](){return this.iterator()}tee(){const n=[],i=[],l=this.iterator(),u=h=>({next:()=>{if(h.length===0){const f=l.next();n.push(f),i.push(f)}return h.shift()}});return[new Hs(()=>u(n),this.controller,this.client),new Hs(()=>u(i),this.controller,this.client)]}toReadableStream(){const n=this;let i;return Cg({async start(){i=n[Symbol.asyncIterator]()},async pull(l){try{const{value:u,done:h}=await i.next();if(h)return l.close();const f=Zu(JSON.stringify(u)+`
`);l.enqueue(f)}catch(u){l.error(u)}},async cancel(){var l;await((l=i.return)===null||l===void 0?void 0:l.call(i))}})}}function iE(a,n){return qi(this,arguments,function*(){var l,u,h,f;if(!a.body)throw n.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new en("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new en("Attempted to iterate over a response with no body");const g=new lE,p=new Vl,b=Ig(a.body);try{for(var x=!0,y=$s(rE(b)),E;E=yield qe(y.next()),l=E.done,!l;x=!0){f=E.value,x=!1;const _=f;for(const w of p.decode(_)){const S=g.decode(w);S&&(yield yield qe(S))}}}catch(_){u={error:_}}finally{try{!x&&!l&&(h=y.return)&&(yield qe(h.call(y)))}finally{if(u)throw u.error}}for(const _ of p.flush()){const w=g.decode(_);w&&(yield yield qe(w))}})}function rE(a){return qi(this,arguments,function*(){var i,l,u,h;let f=new Uint8Array;try{for(var g=!0,p=$s(a),b;b=yield qe(p.next()),i=b.done,!i;g=!0){h=b.value,g=!1;const x=h;if(x==null)continue;const y=x instanceof ArrayBuffer?new Uint8Array(x):typeof x=="string"?Zu(x):x;let E=new Uint8Array(f.length+y.length);E.set(f),E.set(y,f.length),f=E;let _;for(;(_=aE(f))!==-1;)yield yield qe(f.slice(0,_)),f=f.slice(_)}}catch(x){l={error:x}}finally{try{!g&&!i&&(u=p.return)&&(yield qe(u.call(p)))}finally{if(l)throw l.error}}f.length>0&&(yield yield qe(f))})}class lE{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(n){if(n.endsWith("\r")&&(n=n.substring(0,n.length-1)),!n){if(!this.event&&!this.data.length)return null;const h={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],h}if(this.chunks.push(n),n.startsWith(":"))return null;let[i,l,u]=oE(n,":");return u.startsWith(" ")&&(u=u.substring(1)),i==="event"?this.event=u:i==="data"&&this.data.push(u),null}}function oE(a,n){const i=a.indexOf(n);return i!==-1?[a.substring(0,i),n,a.substring(i+n.length)]:[a,"",""]}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function cE(a,n){const{response:i,requestLogID:l,retryOfRequestLogID:u,startTime:h}=n,f=await(async()=>{var g;if(n.options.stream)return _t(a).debug("response",i.status,i.url,i.headers,i.body),n.options.__streamClass?n.options.__streamClass.fromSSEResponse(i,n.controller,a):Hs.fromSSEResponse(i,n.controller,a);if(i.status===204)return null;if(n.options.__binaryResponse)return i;const p=i.headers.get("content-type"),b=(g=p==null?void 0:p.split(";")[0])===null||g===void 0?void 0:g.trim();return(b==null?void 0:b.includes("application/json"))||(b==null?void 0:b.endsWith("+json"))?await i.json():await i.text()})();return _t(a).debug(`[${l}] response parsed`,La({retryOfRequestLogID:u,url:i.url,status:i.status,body:f,durationMs:Date.now()-h})),f}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ed extends Promise{constructor(n,i,l=cE){super(u=>{u(null)}),this.responsePromise=i,this.parseResponse=l,this.client=n}_thenUnwrap(n){return new ed(this.client,this.responsePromise,async(i,l)=>n(await this.parseResponse(i,l),l))}asResponse(){return this.responsePromise.then(n=>n.response)}async withResponse(){const[n,i]=await Promise.all([this.parse(),this.asResponse()]);return{data:n,response:i}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(n=>this.parseResponse(this.client,n))),this.parsedPromise}then(n,i){return this.parse().then(n,i)}catch(n){return this.parse().catch(n)}finally(n){return this.parse().finally(n)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Bg=Symbol("brand.privateNullableHeaders");function*uE(a){if(!a)return;if(Bg in a){const{values:l,nulls:u}=a;yield*l.entries();for(const h of u)yield[h,null];return}let n=!1,i;a instanceof Headers?i=a.entries():Pm(a)?i=a:(n=!0,i=Object.entries(a??{}));for(let l of i){const u=l[0];if(typeof u!="string")throw new TypeError("expected header name to be a string");const h=Pm(l[1])?l[1]:[l[1]];let f=!1;for(const g of h)g!==void 0&&(n&&!f&&(f=!0,yield[u,null]),yield[u,g])}}const Bi=a=>{const n=new Headers,i=new Set;for(const l of a){const u=new Set;for(const[h,f]of uE(l)){const g=h.toLowerCase();u.has(g)||(n.delete(h),u.add(g)),f===null?(n.delete(h),i.add(g)):(n.append(h,f),i.delete(g))}}return{[Bg]:!0,values:n,nulls:i}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Eu=a=>{var n,i,l,u,h,f;if(typeof globalThis.process<"u")return(l=(i=(n=jw)===null||n===void 0?void 0:n[a])===null||i===void 0?void 0:i.trim())!==null&&l!==void 0?l:void 0;if(typeof globalThis.Deno<"u")return(f=(h=(u=globalThis.Deno.env)===null||u===void 0?void 0:u.get)===null||h===void 0?void 0:h.call(u,a))===null||f===void 0?void 0:f.trim()};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Hg;class Yl{constructor(n){var i,l,u,h,f,g,p,{baseURL:b=Eu("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:x=(i=Eu("GEMINI_API_KEY"))!==null&&i!==void 0?i:null,apiVersion:y="v1beta"}=n,E=Ll(n,["baseURL","apiKey","apiVersion"]);const _=Object.assign(Object.assign({apiKey:x,apiVersion:y},E),{baseURL:b||"https://generativelanguage.googleapis.com"});this.baseURL=_.baseURL,this.timeout=(l=_.timeout)!==null&&l!==void 0?l:Yl.DEFAULT_TIMEOUT,this.logger=(u=_.logger)!==null&&u!==void 0?u:console;const w="warn";this.logLevel=w,this.logLevel=(f=(h=Km(_.logLevel,"ClientOptions.logLevel",this))!==null&&h!==void 0?h:Km(Eu("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))!==null&&f!==void 0?f:w,this.fetchOptions=_.fetchOptions,this.maxRetries=(g=_.maxRetries)!==null&&g!==void 0?g:2,this.fetch=(p=_.fetch)!==null&&p!==void 0?p:Vw(),this.encoder=Kw,this._options=_,this.apiKey=x,this.apiVersion=y,this.clientAdapter=_.clientAdapter}withOptions(n){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),n))}baseURLOverridden(){return this.baseURL!=="https://generativelanguage.googleapis.com"}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:n,nulls:i}){if(!(n.has("authorization")||n.has("x-goog-api-key"))&&!(this.apiKey&&n.get("x-goog-api-key"))&&!i.has("x-goog-api-key"))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(n){const i=Bi([n.headers]);if(!(i.values.has("authorization")||i.values.has("x-goog-api-key"))){if(this.apiKey)return Bi([{"x-goog-api-key":this.apiKey}]);if(this.clientAdapter.isVertexAI())return Bi([await this.clientAdapter.getAuthHeaders()])}}stringifyQuery(n){return Object.entries(n).filter(([i,l])=>typeof l<"u").map(([i,l])=>{if(typeof l=="string"||typeof l=="number"||typeof l=="boolean")return`${encodeURIComponent(i)}=${encodeURIComponent(l)}`;if(l===null)return`${encodeURIComponent(i)}=`;throw new en(`Cannot stringify type ${typeof l}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${Ls}`}defaultIdempotencyKey(){return`stainless-node-retry-${Rw()}`}makeStatusError(n,i,l,u){return wt.generate(n,i,l,u)}buildURL(n,i,l){const u=!this.baseURLOverridden()&&l||this.baseURL,h=Iw(n)?new URL(n):new URL(u+(u.endsWith("/")&&n.startsWith("/")?n.slice(1):n)),f=this.defaultQuery();return zw(f)||(i=Object.assign(Object.assign({},f),i)),typeof i=="object"&&i&&!Array.isArray(i)&&(h.search=this.stringifyQuery(i)),h.toString()}async prepareOptions(n){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!n.path.startsWith(`/${this.apiVersion}/projects/`)){const i=n.path.slice(this.apiVersion.length+1);n.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${i}`}}async prepareRequest(n,{url:i,options:l}){}get(n,i){return this.methodRequest("get",n,i)}post(n,i){return this.methodRequest("post",n,i)}patch(n,i){return this.methodRequest("patch",n,i)}put(n,i){return this.methodRequest("put",n,i)}delete(n,i){return this.methodRequest("delete",n,i)}methodRequest(n,i,l){return this.request(Promise.resolve(l).then(u=>Object.assign({method:n,path:i},u)))}request(n,i=null){return new ed(this,this.makeRequest(n,i,void 0))}async makeRequest(n,i,l){var u,h,f;const g=await n,p=(u=g.maxRetries)!==null&&u!==void 0?u:this.maxRetries;i==null&&(i=p),await this.prepareOptions(g);const{req:b,url:x,timeout:y}=await this.buildRequest(g,{retryCount:p-i});await this.prepareRequest(b,{url:x,options:g});const E="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),_=l===void 0?"":`, retryOf: ${l}`,w=Date.now();if(_t(this).debug(`[${E}] sending request`,La({retryOfRequestLogID:l,method:g.method,url:x,options:g,headers:b.headers})),!((h=g.signal)===null||h===void 0)&&h.aborted)throw new Gu;const S=new AbortController,N=await this.fetchWithTimeout(x,b,y,S).catch(Hu),k=Date.now();if(N instanceof globalThis.Error){const H=`retrying, ${i} attempts remaining`;if(!((f=g.signal)===null||f===void 0)&&f.aborted)throw new Gu;const P=Bu(N)||/timed? ?out/i.test(String(N)+("cause"in N?String(N.cause):""));if(i)return _t(this).info(`[${E}] connection ${P?"timed out":"failed"} - ${H}`),_t(this).debug(`[${E}] connection ${P?"timed out":"failed"} (${H})`,La({retryOfRequestLogID:l,url:x,durationMs:k-w,message:N.message})),this.retryRequest(g,i,l??E);throw _t(this).info(`[${E}] connection ${P?"timed out":"failed"} - error; no more retries left`),_t(this).debug(`[${E}] connection ${P?"timed out":"failed"} (error; no more retries left)`,La({retryOfRequestLogID:l,url:x,durationMs:k-w,message:N.message})),P?new wg:new $l({cause:N})}const K=`[${E}${_}] ${b.method} ${x} ${N.ok?"succeeded":"failed"} with status ${N.status} in ${k-w}ms`;if(!N.ok){const H=await this.shouldRetry(N);if(i&&H){const pe=`retrying, ${i} attempts remaining`;return await qw(N.body),_t(this).info(`${K} - ${pe}`),_t(this).debug(`[${E}] response error (${pe})`,La({retryOfRequestLogID:l,url:N.url,status:N.status,headers:N.headers,durationMs:k-w})),this.retryRequest(g,i,l??E,N.headers)}const P=H?"error; no more retries left":"error; not retryable";_t(this).info(`${K} - ${P}`);const ee=await N.text().catch(pe=>Hu(pe).message),te=Mw(ee),W=te?void 0:ee;throw _t(this).debug(`[${E}] response error (${P})`,La({retryOfRequestLogID:l,url:N.url,status:N.status,headers:N.headers,message:W,durationMs:Date.now()-w})),this.makeStatusError(N.status,te,W,N.headers)}return _t(this).info(K),_t(this).debug(`[${E}] response start`,La({retryOfRequestLogID:l,url:N.url,status:N.status,headers:N.headers,durationMs:k-w})),{response:N,options:g,controller:S,requestLogID:E,retryOfRequestLogID:l,startTime:w}}async fetchWithTimeout(n,i,l,u){const h=i||{},{signal:f,method:g}=h,p=Ll(h,["signal","method"]);f&&f.addEventListener("abort",()=>u.abort());const b=setTimeout(()=>u.abort(),l),x=globalThis.ReadableStream&&p.body instanceof globalThis.ReadableStream||typeof p.body=="object"&&p.body!==null&&Symbol.asyncIterator in p.body,y=Object.assign(Object.assign(Object.assign({signal:u.signal},x?{duplex:"half"}:{}),{method:"GET"}),p);g&&(y.method=g.toUpperCase());try{return await this.fetch.call(void 0,n,y)}finally{clearTimeout(b)}}async shouldRetry(n){const i=n.headers.get("x-should-retry");return i==="true"?!0:i==="false"?!1:n.status===408||n.status===409||n.status===429||n.status>=500}async retryRequest(n,i,l,u){var h;let f;const g=u==null?void 0:u.get("retry-after-ms");if(g){const b=parseFloat(g);Number.isNaN(b)||(f=b)}const p=u==null?void 0:u.get("retry-after");if(p&&!f){const b=parseFloat(p);Number.isNaN(b)?f=Date.parse(p)-Date.now():f=b*1e3}if(!(f&&0<=f&&f<60*1e3)){const b=(h=n.maxRetries)!==null&&h!==void 0?h:this.maxRetries;f=this.calculateDefaultRetryTimeoutMillis(i,b)}return await Bw(f),this.makeRequest(n,i-1,l)}calculateDefaultRetryTimeoutMillis(n,i){const h=i-n,f=Math.min(.5*Math.pow(2,h),8),g=1-Math.random()*.25;return f*g*1e3}async buildRequest(n,{retryCount:i=0}={}){var l,u,h;const f=Object.assign({},n),{method:g,path:p,query:b,defaultBaseURL:x}=f,y=this.buildURL(p,b,x);"timeout"in f&&Lw("timeout",f.timeout),f.timeout=(l=f.timeout)!==null&&l!==void 0?l:this.timeout;const{bodyHeaders:E,body:_}=this.buildBody({options:f}),w=await this.buildHeaders({options:n,method:g,bodyHeaders:E,retryCount:i});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:g,headers:w},f.signal&&{signal:f.signal}),globalThis.ReadableStream&&_ instanceof globalThis.ReadableStream&&{duplex:"half"}),_&&{body:_}),(u=this.fetchOptions)!==null&&u!==void 0?u:{}),(h=f.fetchOptions)!==null&&h!==void 0?h:{}),url:y,timeout:f.timeout}}async buildHeaders({options:n,method:i,bodyHeaders:l,retryCount:u}){let h={};this.idempotencyHeader&&i!=="get"&&(n.idempotencyKey||(n.idempotencyKey=this.defaultIdempotencyKey()),h[this.idempotencyHeader]=n.idempotencyKey);const f=await this.authHeaders(n);let g=Bi([h,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(u)},n.timeout?{"X-Stainless-Timeout":String(Math.trunc(n.timeout/1e3))}:{}),$w()),this._options.defaultHeaders,l,n.headers,f]);return this.validateHeaders(g),g.values}buildBody({options:{body:n,headers:i}}){if(!n)return{bodyHeaders:void 0,body:void 0};const l=Bi([i]);return ArrayBuffer.isView(n)||n instanceof ArrayBuffer||n instanceof DataView||typeof n=="string"&&l.values.has("content-type")||globalThis.Blob&&n instanceof globalThis.Blob||n instanceof FormData||n instanceof URLSearchParams||globalThis.ReadableStream&&n instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:n}:typeof n=="object"&&(Symbol.asyncIterator in n||Symbol.iterator in n&&"next"in n&&typeof n.next=="function")?{bodyHeaders:void 0,body:Yw(n)}:this.encoder({body:n,headers:l})}}Yl.DEFAULT_TIMEOUT=6e4;class gt extends Yl{constructor(){super(...arguments),this.interactions=new Mg(this)}}Hg=gt;gt.GeminiNextGenAPIClient=Hg;gt.GeminiNextGenAPIClientError=en;gt.APIError=wt;gt.APIConnectionError=$l;gt.APIConnectionTimeoutError=wg;gt.APIUserAbortError=Gu;gt.NotFoundError=Tg;gt.ConflictError=Ag;gt.RateLimitError=jg;gt.BadRequestError=Eg;gt.AuthenticationError=Ng;gt.InternalServerError=Rg;gt.PermissionDeniedError=Sg;gt.UnprocessableEntityError=Og;gt.toFile=Ww;gt.Interactions=Mg;const Gg=async(a,n,i,l,u,h,f)=>{const g=f||gn,p=`Section: ${a.title}
Goal: ${a.purpose}
Plan: ${a.content_plan}`,b=a.custom_script_prompt?`OVERRIDE: "${a.custom_script_prompt}"`:"",x=h||"Start of video",y=xg,E=`DNA CONTEXT: Tone: ${n.analysis.linguistic_fingerprint.dominant_tones.join(", ")}`,_=`${Pa(l)}
${yw(p+(b?`
${b}`:""),E,x,"",a.dna_section_detail)}`;return await Hn(g,y,_,u)},dE=async(a,n,i,l,u,h)=>{const f=h||gn,g={type:Bs.OBJECT,properties:{title:{type:Bs.STRING},description:{type:Bs.STRING},tags:{type:Bs.STRING}},required:["title","description","tags"]},p=await Hn(f,`Return valid JSON matching schema: ${JSON.stringify(g)}`,`Generate metadata. Analysis: ${JSON.stringify(a.analysis)} ${Pa(i)}`,l,!0),b=JSON.parse(p||"{}");let x=[...a.sections];for(let y=0;y<x.length;y++){const E=x[y],_=y>0?x[y-1].generated_content:"",w=`${u||""} 
 PREVIOUS END: "...${(_==null?void 0:_.slice(-1500))||""}"`,S=await Gg(E,a,n,i,l,w,f);x[y]={...E,generated_content:S}}return{blueprint:a,rewritten:{title:b.title||"Optimized Title",description:b.description||"Viral Description",tags:b.tags||"trending",explanation_of_changes:"Optimized based on DNA.",script_sections:x.map(y=>({id:y.id,title:y.title,type:y.type,content:y.generated_content||""}))}}},hE=async(a,n,i,l,u,h)=>{const f=h||gn,g=xg,p=vw(n,a.content,i,"",`Language: ${l}. Follow the original section's word count.`);return await Hn(f,g,p,u)},Nu=async(a,n,i,l,u,h)=>{let f="",g="";if(n==="dna"){if(!u)throw new Error("No DNA provided.");if(f=`COMPARE AGAINST DNA:
Tone: ${u.analysis.tone}
Pacing: ${u.analysis.pacing}`,u.analysis.structure_skeleton&&u.analysis.structure_skeleton.length>0){const _=u.analysis.structure_skeleton;if(typeof _[0]!="string"){const w=_.map((S,N)=>`Section ${N+1} (${S.section_name}): Tone='${S.tone||"N/A"}', Pacing='${S.pacing||"N/A"}', Focus='${S.content_focus||"N/A"}'`).join(`
`);f+=`

STRUCTURE REQUIREMENTS:
${w}`}else f+=`

STRUCTURE SKELETON: ${_.join(", ")}`}g=`DNA: ${u.name}`}else{if(!h)throw new Error("No criteria provided.");f=`EVALUATE AGAINST:
${h.criteria.map((_,w)=>`${w+1}. ${_.name}: ${_.description}`).join(`
`)}`,g=`Rule: ${h.name}`}const p=_w(a,f)+Pa(i),x=`${xw}

CRITICAL: You MUST respond with ONLY valid JSON matching this exact structure:
${JSON.stringify({total_score:"number (0-100)",breakdown:[{criteria:"string (name of criterion)",score:"number (0-100)",reasoning:"string (why this score)",improvement_tip:"string (actionable advice)"}],overall_feedback:"string (overall verdict)"},null,2)}

DO NOT include any text before or after the JSON.
DO NOT return the schema itself - return ACTUAL DATA with real scores and feedback.
All score values must be numbers between 0-100.`,y=await Hn(gn,x,p,l,!0);console.log("[SCORING API] Raw response text:",y.substring(0,500));const E=JSON.parse(y||"{}");if(console.log("[SCORING API] Parsed result:",E),console.log("[SCORING API] total_score type:",typeof E.total_score,"value:",E.total_score),typeof E.total_score!="number")throw console.error("[SCORING API] ERROR: total_score is not a number!",E),new Error("AI returned invalid score format - total_score must be a number");return{...E,timestamp:Date.now(),source_info:g}},fE=a=>{try{const n=/(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/\s]{11})/,i=a.match(n);return i?i[1]:null}catch{return null}},Pg=async(a,n)=>{var l;if(!n)throw console.error("YouTube API Key is missing"),new Error("YouTube API Key cha c cu hnh. Vui lng nhp key vo Settings.");const i=fE(a);if(!i)throw new Error("URL YouTube khng hp l.");try{const u="https://www.googleapis.com/youtube/v3/commentThreads?"+new URLSearchParams({part:"snippet",videoId:i,key:n,maxResults:"100",order:"relevance",textFormat:"plainText"}),h=await fetch(u),f=await h.json();if(!h.ok){const p=((l=f.error)==null?void 0:l.message)||"Li YouTube API khng xc nh";if(p.includes("disabled"))return"Video ny  tt tnh nng bnh lun.";if(p.includes("API key not valid"))return"API Key khng hp l. Vui lng kim tra li trong Settings.";throw new Error(p)}return!f.items||f.items.length===0?"Khng tm thy bnh lun no.":f.items.map(p=>{const b=p.snippet.topLevelComment.snippet;return`[${b.authorDisplayName}] (${b.likeCount} likes): ${b.textDisplay}`}).join(`
---
`)}catch(u){throw console.error("YouTube Fetch Error:",u),new Error(u.message||"Khng th ly bnh lun.")}},Ki=({data:a,onChange:n,onRemove:i,onFetchComments:l,label:u,isRemovable:h,className:f,compact:g,fieldLabels:p,placeholders:b,showComments:x=!1,showUrl:y=!1,showDescription:E=!0,scriptNumber:_})=>{const w=P=>P.trim()?P.trim().split(/\s+/).length:0,[S,N]=ie.useState("script"),[k,K]=ie.useState(!1),H=async()=>{if(!(!a.url||!l)){K(!0);try{await l(a.id,a.url),N("comments")}finally{K(!1)}}};return o.jsxs("div",{className:`bg-zinc-900 border border-zinc-800 rounded-xl p-6 transition-all duration-300 hover:border-zinc-600 hover:shadow-lg group relative ${f}`,children:[_!==void 0&&o.jsxs("div",{className:"absolute -top-3 -left-3 bg-blue-600 text-white text-xs font-bold px-3 py-1.5 rounded-full shadow-lg border-2 border-zinc-900 z-20",children:["#",_]}),u&&o.jsx("div",{className:"flex justify-between items-center mb-4",children:o.jsx("h3",{className:"text-xs font-bold text-zinc-400 uppercase tracking-wider group-hover:text-zinc-300 transition-colors",children:u})}),h&&i&&o.jsx("button",{onClick:()=>i(a.id),className:`absolute top-4 right-4 p-2 rounded-md text-zinc-500 hover:text-red-400 hover:bg-red-500/10 transition-all z-10 ${u?"":"opacity-0 group-hover:opacity-100"}`,title:"Remove",children:o.jsx(Zt,{className:"w-4 h-4"})}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"text-[10px] font-bold text-zinc-500 uppercase mb-1.5 flex items-center gap-2",children:[o.jsx(zl,{className:"w-3 h-3"})," ",(p==null?void 0:p.title)||"Title"]}),o.jsx("input",{type:"text",className:"w-full bg-black/20 border-b border-zinc-700 px-3 py-2 text-zinc-100 placeholder-zinc-600 focus:outline-none focus:border-blue-500 focus:bg-black/40 transition-all font-semibold text-sm rounded-t-md",placeholder:(b==null?void 0:b.title)||xu.title,value:a.title,onChange:P=>n(a.id,"title",P.target.value)})]}),y&&o.jsxs("div",{children:[o.jsxs("label",{className:"text-[10px] font-bold text-zinc-500 uppercase mb-1.5 flex items-center gap-2",children:[o.jsx(Lu,{className:"w-3 h-3"})," YouTube URL"]}),o.jsxs("div",{className:"relative",children:[o.jsx("input",{type:"text",className:"w-full bg-black/20 border-b border-zinc-700 pl-10 pr-20 py-2 text-blue-400 placeholder-zinc-700 focus:outline-none focus:border-blue-500 focus:bg-black/40 transition-all text-xs font-mono rounded-t-md h-[34px]",placeholder:(b==null?void 0:b.url)||"https://youtube.com/watch?v=...",value:a.url||"",onChange:P=>n(a.id,"url",P.target.value)}),o.jsx(Lu,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-zinc-500"}),l&&o.jsx("button",{onClick:H,disabled:k||!a.url,className:"absolute right-2 top-1/2 -translate-y-1/2 px-3 py-1 bg-blue-500/10 hover:bg-blue-500/20 border border-blue-500/30 rounded text-blue-400 text-[10px] font-bold transition-colors disabled:opacity-50 flex items-center justify-center gap-1.5",title:"Fetch Top Comments",children:k?o.jsx(Mn,{className:"w-3 h-3 animate-spin"}):""})]})]})]}),x&&o.jsxs("div",{className:"flex border-b border-zinc-800 mb-2",children:[o.jsx("button",{onClick:()=>N("script"),className:`px-4 py-2 text-xs font-bold uppercase border-b-2 transition-all ${S==="script"?"border-white text-white":"border-transparent text-zinc-500 hover:text-zinc-300"}`,children:"Script / Transcript"}),o.jsxs("button",{onClick:()=>N("comments"),className:`px-4 py-2 text-xs font-bold uppercase border-b-2 transition-all ${S==="comments"?"border-yellow-500 text-yellow-500":"border-transparent text-zinc-500 hover:text-zinc-300"}`,children:["Comments / Feedback ",a.comments?"":""]})]}),(!x||S==="script")&&o.jsxs("div",{children:[!x&&o.jsxs("label",{className:"text-[10px] font-bold text-zinc-500 uppercase mb-1.5 flex items-center gap-2",children:[o.jsx(bg,{className:"w-3 h-3"})," ",(p==null?void 0:p.script)||"Script Content"]}),o.jsxs("div",{className:"relative",children:[o.jsx("textarea",{className:`w-full bg-black/20 border border-zinc-800 rounded-lg px-3 py-3 text-zinc-200 placeholder-zinc-600 focus:outline-none focus:bg-black/40 focus:border-zinc-600 transition-all text-xs font-normal leading-relaxed resize-y pb-6 ${g?"min-h-[80px]":"min-h-[150px]"}`,placeholder:(b==null?void 0:b.script)||xu.script,value:a.script,onChange:P=>n(a.id,"script",P.target.value)}),o.jsxs("div",{className:"absolute bottom-2 right-3 text-[10px] text-zinc-500 font-mono pointer-events-none select-none",children:[w(a.script)," words"]})]})]}),x&&S==="comments"&&o.jsx("div",{children:o.jsxs("div",{className:"relative",children:[o.jsx("textarea",{className:"w-full bg-yellow-500/5 border border-yellow-500/10 rounded-lg px-3 py-3 text-yellow-100/80 placeholder-yellow-500/30 focus:outline-none focus:bg-black/40 focus:border-yellow-500/30 transition-all text-xs font-normal leading-relaxed resize-y pb-6 min-h-[150px]",placeholder:(b==null?void 0:b.comments)||"Paste top comments here OR click 'Fetch' above to auto-load audience sentiment...",value:a.comments||"",onChange:P=>n(a.id,"comments",P.target.value)}),o.jsx("div",{className:"absolute top-2 right-2 px-2 py-1 bg-yellow-500/20 rounded text-[9px] text-yellow-500 font-bold uppercase",children:"Audience Voice"})]})}),E&&o.jsxs("div",{children:[o.jsxs("label",{className:"text-[10px] font-bold text-zinc-500 uppercase mb-1.5 flex items-center gap-2",children:[o.jsx(Pl,{className:"w-3 h-3"})," ",(p==null?void 0:p.description)||"Description / Notes"]}),o.jsx("div",{className:"relative",children:o.jsx("textarea",{className:"w-full bg-black/20 border border-zinc-800 rounded-lg px-3 py-3 text-zinc-300 placeholder-zinc-600 focus:outline-none focus:bg-black/40 focus:border-zinc-600 transition-all min-h-[60px] text-xs leading-relaxed resize-none pb-6",placeholder:(b==null?void 0:b.description)||xu.description,value:a.description,onChange:P=>n(a.id,"description",P.target.value)})})]})]})]})},pE=({blueprint:a,customBlueprintPrompt:n,onUpdateBlueprintPrompt:i,onProceed:l,onWriteSection:u,onUpdateSection:h,isWriting:f})=>{const[g,p]=ie.useState(null),b=async N=>{p(N),await u(N),p(null)},x=N=>N.trim()?N.trim().split(/\s+/).length:0,y=(a.sections||[]).reduce((N,k)=>N+(k.word_count_target||0),0),E=(a.sections||[]).reduce((N,k)=>N+x(k.generated_content||""),0),_=a.analysis,w=(_==null?void 0:_.hook_hierarchy)||{main_hook:"N/A",micro_hooks:[]},S=(_==null?void 0:_.pacing_map)||{speed_strategy:"N/A"};return _!=null&&_.linguistic_fingerprint,o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-10 animate-in slide-in-from-right-4 duration-500",children:[o.jsxs("div",{className:"lg:col-span-4 space-y-6",children:[o.jsxs("div",{className:"bg-zinc-900/60 border border-white/10 rounded-3xl p-6 shadow-2xl",children:[o.jsxs("div",{className:"flex justify-between items-center mb-4",children:[o.jsx("h3",{className:"text-[10px] font-bold text-yellow-400 uppercase tracking-widest flex items-center gap-2",children:"Blueprint Specs"}),o.jsxs("div",{className:"text-right",children:[o.jsx("span",{className:"block text-[10px] text-zinc-500 uppercase font-bold",children:"Word Count"}),o.jsxs("span",{className:`text-sm font-mono font-bold ${E>0?"text-white":"text-zinc-500"}`,children:[E," ",o.jsx("span",{className:"text-zinc-600",children:"/"})," ",y]})]})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-[9px] text-zinc-500 uppercase font-bold block mb-1",children:"Main Hook"}),o.jsx("p",{className:"text-sm text-white font-medium",children:w.main_hook||"N/A"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-[9px] text-zinc-500 uppercase font-bold block mb-2",children:"Micro-Hooks"}),o.jsx("div",{className:"space-y-1.5",children:(w.micro_hooks||[]).map((N,k)=>o.jsxs("div",{className:"text-xs text-zinc-400 flex gap-2",children:[o.jsx("span",{className:"text-yellow-500",children:""})," ",N]},k))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-[9px] text-zinc-500 uppercase font-bold block mb-1",children:"Pacing Strategy"}),o.jsx("p",{className:"text-xs text-zinc-300 leading-relaxed",children:S.speed_strategy||"N/A"})]})]})]}),o.jsxs("div",{className:"glass-card p-6 rounded-3xl border border-purple-500/20",children:[o.jsxs("label",{className:"text-[10px] font-bold text-purple-400 uppercase tracking-widest mb-3 block flex items-center gap-2",children:[o.jsx(ma,{className:"w-3 h-3"})," Global Assembly Rules"]}),o.jsx("textarea",{className:"w-full bg-black/40 border border-white/5 rounded-xl px-4 py-3 text-xs text-zinc-300 placeholder-zinc-700 focus:outline-none focus:border-purple-500/50 min-h-[120px] resize-none",placeholder:"e.g. 'Use a lot of rhetorical questions', 'Keep the tone more aggressive'...",value:n,onChange:N=>i(N.target.value)})]}),o.jsxs("button",{onClick:l,className:"w-full py-4 rounded-xl bg-white text-black font-black text-sm hover:bg-zinc-200 transition-all shadow-[0_0_20px_rgba(255,255,255,0.1)] flex items-center justify-center gap-2",children:[f?o.jsx(Mn,{className:"w-4 h-4 animate-spin"}):o.jsx(mn,{className:"w-4 h-4"}),"ASSEMBLE FULL SCRIPT"]})]}),o.jsx("div",{className:"lg:col-span-8 space-y-6 pb-24",children:(a.sections||[]).map((N,k)=>o.jsxs("div",{className:"relative pl-14 group",children:[o.jsx("div",{className:"absolute left-[23px] top-6 bottom-0 w-[1px] bg-zinc-800 last:hidden"}),o.jsx("div",{className:`absolute left-0 top-6 w-12 h-12 rounded-full border-4 border-black flex items-center justify-center text-sm font-bold z-10 transition-all ${N.generated_content?"bg-white text-black":"bg-zinc-800 text-zinc-500"}`,children:k+1}),o.jsxs("div",{className:"bg-zinc-900/60 border border-white/10 rounded-3xl overflow-hidden shadow-xl",children:[o.jsxs("div",{className:"bg-white/5 px-6 py-3 border-b border-white/5 flex flex-wrap gap-4 text-[9px] uppercase font-bold tracking-widest",children:[o.jsxs("span",{className:"text-yellow-400",children:["Tact: ",N.hook_tactic]}),o.jsxs("span",{className:"text-blue-400",children:["Pace: ",N.pacing_instruction]}),o.jsxs("span",{className:"text-zinc-500 ml-auto",children:["EST: ",N.word_count_target," WORDS"]})]}),o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"flex justify-between items-start mb-4",children:[o.jsx("h4",{className:"text-lg font-bold text-white",children:N.title}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("input",{type:"text",placeholder:"Instruction for this section...",value:N.custom_script_prompt||"",onChange:K=>h(N.id,{custom_script_prompt:K.target.value}),className:"bg-black/40 border border-zinc-700 rounded-lg px-3 py-1.5 text-xs text-white focus:border-blue-500 focus:outline-none w-[180px]"}),o.jsxs("button",{onClick:()=>b(N.id),disabled:g===N.id,className:`px-3 py-1.5 rounded-lg text-[9px] font-bold uppercase tracking-widest transition-all flex items-center gap-2 ${N.generated_content?"bg-zinc-800 text-zinc-400 hover:text-white":"bg-white text-black hover:bg-zinc-200"}`,children:[g===N.id?o.jsx(Mn,{className:"w-3 h-3 animate-spin"}):o.jsx(mn,{className:"w-3 h-3"}),N.generated_content?"Regen":"Draft"]})]})]}),o.jsx("textarea",{className:"w-full text-xs text-zinc-300 leading-relaxed bg-black/20 p-4 rounded-xl border border-white/5 focus:outline-none focus:border-blue-500/50 resize-y min-h-[100px]",value:N.content_plan||"",onChange:K=>h(N.id,{content_plan:K.target.value})}),N.generated_content&&o.jsxs("div",{className:"mt-4 p-4 bg-green-500/5 border border-green-500/10 rounded-xl",children:[o.jsxs("div",{className:"flex justify-between items-center mb-2",children:[o.jsx("h5",{className:"text-[9px] font-bold text-green-400 uppercase",children:"Draft Preview:"}),o.jsxs("span",{className:"text-[9px] font-mono text-zinc-500",children:[x(N.generated_content)," words"]})]}),o.jsx("p",{className:"text-xs text-zinc-300 line-clamp-3 italic",children:N.generated_content})]})]})]})]},N.id))})]})},mE=({section:a,index:n,onUpdate:i,onRefine:l,isProcessing:u})=>{var _;const[h,f]=ie.useState(""),g=async()=>{h.trim()&&(await l(a.id,h),f(""))},p=async()=>{await l(a.id,"Improve this section to be more engaging and punchy.")},x=(w=>{const S=w.trim();return S?S.split(/\s+/).length:0})(a.content),y=(_=a.scoringResult)==null?void 0:_.total_score,E=y?y>=80?"text-green-400":y>=60?"text-yellow-400":"text-red-400":"text-zinc-500";return o.jsxs("div",{className:"group relative pl-10 pb-10 last:pb-0",children:[o.jsx("div",{className:"absolute left-[15px] top-8 bottom-0 w-[1px] bg-gradient-to-b from-zinc-800 to-transparent last:hidden group-last:hidden"}),o.jsx("div",{className:`absolute left-0 top-8 w-8 h-8 rounded-full border flex items-center justify-center z-10 shadow-lg shadow-black/50 transition-colors ${y?y>=80?"bg-green-500/10 border-green-500 text-green-400":"bg-yellow-500/10 border-yellow-500 text-yellow-400":"bg-zinc-900 border-zinc-700 text-zinc-400"}`,children:o.jsx("span",{className:"text-[10px] font-mono font-bold",children:n+1})}),o.jsxs("div",{className:"bg-zinc-900/40 backdrop-blur-md border border-white/5 rounded-2xl overflow-hidden transition-all duration-300 hover:border-white/10 hover:shadow-xl hover:shadow-black/20",children:[o.jsxs("div",{className:"bg-white/5 border-b border-white/5 px-5 py-3 flex justify-between items-center",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("span",{className:"text-[9px] font-bold text-blue-300 bg-blue-500/10 border border-blue-500/20 px-2 py-0.5 rounded uppercase tracking-widest shadow-sm shadow-blue-900/20",children:a.type}),o.jsx("h4",{className:"text-sm font-semibold text-zinc-200 tracking-tight",children:a.title})]}),o.jsxs("div",{className:"flex items-center gap-4",children:[y!==void 0&&o.jsxs("div",{className:`text-xs font-black ${E}`,children:[y,"/100"]}),o.jsxs("div",{className:"flex items-center gap-1.5 px-2 py-1 bg-black/40 rounded border border-white/5",children:[o.jsx("span",{className:"text-[10px] font-bold text-zinc-500 uppercase",children:"Words:"}),o.jsx("span",{className:"text-[10px] font-mono font-bold text-white",children:x})]}),o.jsx("div",{className:"flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:o.jsx("button",{onClick:()=>navigator.clipboard.writeText(a.content),className:"p-1.5 hover:bg-white/10 rounded-md text-zinc-500 hover:text-white transition-colors",title:"Copy Section",children:o.jsx(Pi,{className:"w-3.5 h-3.5"})})})]})]}),o.jsx("div",{className:"p-1",children:o.jsx("textarea",{value:a.content,onChange:w=>i(a.id,w.target.value),className:"w-full bg-transparent text-zinc-300 resize-y focus:outline-none min-h-[120px] leading-relaxed p-4 text-sm font-light selection:bg-blue-500/30",spellCheck:!1})}),o.jsxs("div",{className:"px-4 py-3 bg-zinc-950/30 border-t border-white/5 flex items-center gap-3",children:[o.jsxs("div",{className:"flex-1 relative group/input",children:[o.jsx("input",{type:"text",placeholder:"AI Edit: e.g. 'Make it funnier' or 'Shorter'",value:h,onChange:w=>f(w.target.value),onKeyDown:w=>w.key==="Enter"&&g(),disabled:u,className:"w-full bg-black/50 border border-zinc-700 rounded-lg pl-9 pr-4 py-2 text-xs text-zinc-300 focus:outline-none focus:border-purple-500/50 focus:bg-black/70 transition-all placeholder-zinc-600 group-hover/input:border-zinc-600"}),o.jsx(mn,{className:"w-3.5 h-3.5 text-zinc-500 absolute left-3 top-1/2 -translate-y-1/2 group-hover/input:text-purple-400 transition-colors"})]}),o.jsx("button",{onClick:g,disabled:u||!h.trim(),className:"px-3 py-1.5 bg-white text-black text-xs font-bold rounded-md hover:bg-zinc-200 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:u?"...":"Run"}),o.jsx("button",{onClick:p,disabled:u,className:"flex items-center gap-1.5 px-3 py-2 rounded-lg border border-transparent hover:bg-white/5 text-xs font-medium text-zinc-500 hover:text-green-400 transition-colors whitespace-nowrap",title:"Auto Improve",children:o.jsx(Ps,{className:`w-3.5 h-3.5 ${u?"animate-spin":""}`})})]})]})]})},gE=({fullScript:a,dna:n,savedTemplates:i,lastScore:l,language:u,onSaveTemplate:h,onUpdateScore:f,onDeleteTemplate:g,apiKey:p,scriptSections:b,onRegenerateSection:x})=>{const[y,E]=ie.useState("dna"),[_,w]=ie.useState(!1),[S,N]=ie.useState(null),[k,K]=ie.useState(""),[H,P]=ie.useState(!1),[ee,te]=ie.useState({id:"",name:"",criteria:[{id:"1",name:"",description:""}]}),W=()=>{te({id:`tmpl-${Date.now()}`,name:"New Scoring Template",criteria:[{id:"1",name:"Engagement",description:"Is the script engaging from start to finish?"},{id:"2",name:"Clarity",description:"Is the message easy to understand?"}]}),P(!0),K(""),E("custom")},ye=()=>{ee.name&&(h(ee),P(!1),K(ee.id))},pe=(oe,z,J)=>{const Y=[...ee.criteria];Y[oe]={...Y[oe],[z]:J},te({...ee,criteria:Y})},Be=()=>{te({...ee,criteria:[...ee.criteria,{id:Date.now().toString(),name:"",description:""}]})},Ve=oe=>{const z=ee.criteria.filter((J,Y)=>Y!==oe);te({...ee,criteria:z})},De=oe=>oe>=80?"text-green-400 border-green-500/50 bg-green-500/10":oe>=60?"text-yellow-400 border-yellow-500/50 bg-yellow-500/10":"text-red-400 border-red-500/50 bg-red-500/10",Ke=async(oe,z)=>{if(!x)return;N(oe);const J=`Improve this section to address the following:

**Current Issue**: ${z.reasoning}

**Required Improvement**: ${z.improvement_tip||z.reasoning}

Rewrite the section maintaining the overall message but implementing the suggested improvements. Keep the tone and style consistent with the rest of the script.`;try{await x(oe,J)}catch(Y){alert("Regeneration failed: "+Y.message)}finally{N(null)}},Le=i.find(oe=>oe.id===k);return o.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-3xl p-6 shadow-2xl animate-in fade-in slide-in-from-bottom-4",children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsxs("h3",{className:"text-xl font-bold text-white flex items-center gap-2",children:[o.jsx(Pl,{className:"w-5 h-5 text-purple-400"})," Scoring & Audit"]}),o.jsxs("div",{className:"flex bg-black rounded-lg p-1 border border-zinc-800",children:[o.jsx("button",{onClick:()=>E("dna"),className:`px-4 py-1.5 rounded-md text-xs font-bold transition-all ${y==="dna"?"bg-zinc-800 text-white shadow-sm":"text-zinc-500 hover:text-zinc-300"}`,children:"DNA Match"}),o.jsx("button",{onClick:()=>E("custom"),className:`px-4 py-1.5 rounded-md text-xs font-bold transition-all ${y==="custom"?"bg-zinc-800 text-white shadow-sm":"text-zinc-500 hover:text-zinc-300"}`,children:"Custom Rules"})]})]}),o.jsxs("div",{className:"mb-8 space-y-4",children:[y==="dna"&&(n?o.jsxs("div",{className:"p-4 bg-purple-500/5 border border-purple-500/20 rounded-xl",children:[o.jsxs("p",{className:"text-sm text-purple-200 mb-2 font-medium",children:["Analyzing against: ",o.jsx("span",{className:"font-bold",children:n.name})]}),o.jsxs("div",{className:"flex gap-2 text-xs text-zinc-400",children:[o.jsxs("span",{className:"bg-black/30 px-2 py-1 rounded",children:["Tone: ",n.analysis.tone]}),o.jsxs("span",{className:"bg-black/30 px-2 py-1 rounded",children:["Pacing: ",n.analysis.pacing]})]})]}):o.jsxs("div",{className:"p-6 bg-zinc-800/50 border border-zinc-700 border-dashed rounded-xl text-center",children:[o.jsx("p",{className:"text-sm text-zinc-400 font-medium mb-1",children:"No DNA Template Selected"}),o.jsx("p",{className:"text-xs text-zinc-600",children:"Select a DNA in the Input step to score against it."})]})),y==="custom"&&o.jsx("div",{className:"space-y-4",children:H?o.jsxs("div",{className:"bg-black/40 border border-zinc-700 rounded-xl p-4 animate-in fade-in",children:[o.jsxs("div",{className:"flex justify-between items-start mb-4",children:[o.jsx("input",{className:"bg-transparent border-b border-zinc-700 text-white font-bold text-lg focus:outline-none focus:border-blue-500 w-full mr-4",placeholder:"Template Name",value:ee.name,onChange:oe=>te({...ee,name:oe.target.value})}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{onClick:()=>P(!1),className:"text-xs text-zinc-500 hover:text-white px-3 py-1",children:"Cancel"}),o.jsx("button",{onClick:ye,className:"text-xs bg-white text-black font-bold px-3 py-1 rounded hover:bg-zinc-200",children:"Save"})]})]}),o.jsxs("div",{className:"space-y-3 max-h-[300px] overflow-y-auto pr-2 custom-scrollbar",children:[ee.criteria.map((oe,z)=>o.jsxs("div",{className:"flex gap-2 items-start",children:[o.jsxs("span",{className:"text-zinc-600 text-xs mt-2.5 font-mono",children:[z+1,"."]}),o.jsxs("div",{className:"flex-1 space-y-1",children:[o.jsx("input",{className:"w-full bg-zinc-900 border border-zinc-800 rounded px-2 py-1.5 text-sm text-white focus:border-zinc-600 focus:outline-none placeholder-zinc-700",placeholder:"Criterion Name",value:oe.name,onChange:J=>pe(z,"name",J.target.value)}),o.jsx("input",{className:"w-full bg-zinc-900 border border-zinc-800 rounded px-2 py-1.5 text-xs text-zinc-400 focus:border-zinc-600 focus:outline-none placeholder-zinc-700",placeholder:"Description",value:oe.description,onChange:J=>pe(z,"description",J.target.value)})]}),o.jsx("button",{onClick:()=>Ve(z),className:"mt-2 text-zinc-600 hover:text-red-400",children:o.jsx(Zt,{className:"w-4 h-4"})})]},z)),o.jsxs("button",{onClick:Be,className:"w-full py-2 border border-dashed border-zinc-800 rounded text-xs text-zinc-500 hover:text-white hover:border-zinc-600 flex items-center justify-center gap-2",children:[o.jsx(on,{className:"w-3 h-3"})," Add Criterion"]})]})]}):o.jsxs("div",{className:"flex flex-col gap-3",children:[o.jsxs("div",{className:"flex gap-2",children:[o.jsxs("div",{className:"relative flex-1",children:[o.jsxs("select",{value:k,onChange:oe=>K(oe.target.value),className:"w-full bg-black border border-zinc-700 rounded-xl px-4 py-3 text-white appearance-none focus:outline-none focus:border-blue-500 cursor-pointer text-sm font-bold",children:[o.jsx("option",{value:"",disabled:!0,children:"-- Select a Rule Template --"}),i.map(oe=>o.jsxs("option",{value:oe.id,children:[oe.name," (",oe.criteria.length," criteria)"]},oe.id))]}),o.jsx("div",{className:"absolute right-4 top-1/2 -translate-y-1/2 pointer-events-none text-zinc-500",children:""})]}),o.jsx("button",{onClick:W,className:"px-4 bg-zinc-800 hover:bg-zinc-700 rounded-xl border border-zinc-700 text-white",title:"New Template",children:o.jsx(on,{className:"w-5 h-5"})})]}),Le&&o.jsxs("div",{className:"bg-zinc-950/50 rounded-xl p-4 border border-zinc-800 relative group",children:[o.jsxs("div",{className:"absolute top-2 right-2 flex gap-1 opacity-50 group-hover:opacity-100 transition-opacity",children:[o.jsx("button",{onClick:()=>{te(Le),P(!0)},className:"p-1.5 hover:bg-white/20 rounded text-zinc-400 hover:text-white",children:o.jsx(zl,{className:"w-4 h-4"})}),o.jsx("button",{onClick:()=>{g(Le.id),K("")},className:"p-1.5 hover:bg-red-500/20 rounded text-zinc-400 hover:text-red-400",children:o.jsx(Zt,{className:"w-4 h-4"})})]}),o.jsx("h4",{className:"font-bold text-white mb-2",children:Le.name}),o.jsxs("ul",{className:"space-y-1",children:[Le.criteria.slice(0,3).map((oe,z)=>o.jsxs("li",{className:"text-xs text-zinc-500 flex items-center gap-2",children:[o.jsx("span",{className:"w-1 h-1 bg-zinc-500 rounded-full"})," ",oe.name]},z)),Le.criteria.length>3&&o.jsxs("li",{className:"text-xs text-zinc-600 italic",children:["...and ",Le.criteria.length-3," more"]})]})]})]})})]}),l&&o.jsxs("div",{className:"border-t border-zinc-800 pt-6 animate-in slide-in-from-bottom-2",children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"text-zinc-400 text-xs font-bold uppercase tracking-widest mb-1",children:"Total Score"}),o.jsxs("div",{className:`text-4xl font-black ${De(l.total_score||0).split(" ")[0]}`,children:[typeof l.total_score=="number"?l.total_score:0,"/100"]})]}),o.jsxs("div",{className:"text-right",children:[o.jsx("span",{className:"text-[10px] text-zinc-600 block mb-1",children:"Analyzed at"}),o.jsx("span",{className:"text-xs text-zinc-400 font-mono",children:new Date(l.timestamp).toLocaleTimeString()})]})]}),o.jsx("div",{className:"space-y-4 mb-6",children:(l.breakdown||[]).map((oe,z)=>{const J=b==null?void 0:b[z];return o.jsxs("div",{className:"bg-black/30 rounded-xl p-4 border border-zinc-800",children:[o.jsxs("div",{className:"flex justify-between items-center mb-2",children:[o.jsx("span",{className:"font-bold text-sm text-white",children:oe.criteria}),o.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-bold border ${De(oe.score)}`,children:oe.score})]}),o.jsx("p",{className:"text-xs text-zinc-400 mb-2",children:oe.reasoning}),o.jsxs("div",{className:"flex gap-2 items-start bg-blue-500/5 p-2 rounded border border-blue-500/10",children:[o.jsx(mn,{className:"w-3 h-3 text-blue-400 mt-0.5 flex-shrink-0"}),o.jsxs("p",{className:"text-[10px] text-blue-300 font-medium",children:["Tip: ",oe.improvement_tip||oe.reasoning]})]}),oe.score<80&&J&&x&&o.jsx("button",{onClick:()=>Ke(J.id,oe),disabled:S===J.id,className:"mt-3 w-full py-2.5 bg-gradient-to-r from-purple-500 to-pink-500 rounded-lg text-white text-sm font-semibold hover:opacity-90 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 shadow-lg shadow-purple-500/20",children:S===J.id?o.jsxs(o.Fragment,{children:[o.jsx(Mn,{className:"w-4 h-4 animate-spin"}),"Regenerating..."]}):o.jsxs(o.Fragment,{children:[o.jsx(Ps,{className:"w-4 h-4"}),"Apply Suggestion & Regenerate"]})})]},z)})}),o.jsxs("div",{className:"bg-zinc-950 rounded-xl p-4 border border-zinc-800",children:[o.jsx("h5",{className:"text-[10px] font-bold text-zinc-500 uppercase tracking-widest mb-2",children:"Overall Verdict"}),o.jsxs("p",{className:"text-sm text-zinc-300 leading-relaxed italic",children:['"',l.overall_feedback||l.verdict,'"']})]})]})]})},bE=({dnas:a,selectedDNA:n,onSelect:i})=>{const[l,u]=ie.useState(""),h=a.filter(f=>{var g,p;return f.name.toLowerCase().includes(l.toLowerCase())||((p=(g=f.analysis)==null?void 0:g.tone)==null?void 0:p.toLowerCase().includes(l.toLowerCase()))});return o.jsxs("section",{children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-2",children:[o.jsx("span",{className:"w-2 h-2 bg-yellow-500 rounded-full shadow-[0_0_10px_rgba(234,179,8,0.5)]"}),"Target DNA (Style)"]}),o.jsx("button",{onClick:()=>i(void 0),className:`text-xs px-3 py-1.5 rounded-lg font-bold border transition-colors ${n?"text-zinc-500 border-zinc-800 hover:text-white":"bg-zinc-800 text-white border-zinc-600"}`,children:"No DNA"})]}),a.length>0?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"mb-3",children:o.jsxs("div",{className:"relative",children:[o.jsx(er,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-zinc-500"}),o.jsx("input",{type:"text",placeholder:"Search DNA templates...",value:l,onChange:f=>u(f.target.value),className:"w-full bg-zinc-900 border border-zinc-700 rounded-lg pl-10 pr-4 py-2.5 text-sm text-white placeholder-zinc-500 focus:border-yellow-500 focus:outline-none transition-colors"})]})}),o.jsx("div",{className:"grid grid-cols-2 gap-3 max-h-[200px] overflow-y-auto pr-2 custom-scrollbar",children:h.map(f=>{var g,p,b;return o.jsxs("div",{onClick:()=>i(f),className:`p-3 rounded-xl border cursor-pointer transition-all relative overflow-hidden group ${(n==null?void 0:n.id)===f.id?"bg-yellow-500/10 border-yellow-500 shadow-[0_0_20px_rgba(234,179,8,0.1)]":"bg-zinc-900 border-zinc-800 hover:border-zinc-600 hover:bg-zinc-900/80"}`,children:[o.jsx("div",{className:`absolute top-2 right-2 transition-opacity ${(n==null?void 0:n.id)===f.id?"opacity-100":"opacity-0 group-hover:opacity-100"}`,children:o.jsx(st,{className:`w-4 h-4 ${(n==null?void 0:n.id)===f.id?"text-yellow-400":"text-zinc-600"}`})}),o.jsx("h4",{className:`font-bold text-sm mb-2 pr-6 line-clamp-1 ${(n==null?void 0:n.id)===f.id?"text-yellow-400":"text-white"}`,children:f.name}),o.jsxs("div",{className:"flex flex-wrap gap-1 mb-1.5",children:[o.jsx("span",{className:"text-[9px] bg-black/40 px-1.5 py-0.5 rounded text-zinc-400 border border-white/5",children:((p=(g=f.analysis)==null?void 0:g.tone)==null?void 0:p.split(",")[0])||"No Tone"}),f.niche&&o.jsx("span",{className:"text-[9px] bg-blue-500/10 px-1.5 py-0.5 rounded text-blue-400 border border-blue-500/20",children:f.niche})]}),o.jsx("p",{className:"text-[10px] text-zinc-500 line-clamp-2",children:((b=f.analysis)==null?void 0:b.pacing)||"No pacing data"})]},f.id)})}),h.length===0&&o.jsx("div",{className:"p-6 border border-zinc-800 rounded-xl text-center bg-zinc-900/50",children:o.jsxs("p",{className:"text-zinc-500 text-sm",children:['No DNAs match "',l,'"']})})]}):o.jsx("div",{className:"p-8 border-2 border-dashed border-zinc-800 rounded-xl text-center bg-zinc-900/50",children:o.jsx("p",{className:"text-zinc-500 text-sm",children:"No DNA templates found. Go to DNA Lab to extract one."})})]})},yE=["English","Vietnamese","Spanish","Japanese","Korean"],Jm=({versions:a,onSelect:n})=>{const[i,l]=ie.useState(!1);return o.jsxs("div",{className:"relative z-20",children:[o.jsxs("button",{onClick:()=>l(!i),className:"flex items-center gap-2 px-3 py-1.5 bg-zinc-800 border border-zinc-700 rounded-lg text-[10px] font-bold uppercase hover:bg-zinc-700 transition-colors",children:[o.jsx(sw,{className:"w-3 h-3 text-zinc-400"})," History (",a.length,")"]}),i&&o.jsxs("div",{className:"absolute right-0 top-full mt-2 w-48 bg-zinc-900 border border-zinc-700 rounded-xl shadow-xl overflow-hidden animate-in fade-in zoom-in-95",children:[o.jsx("div",{className:"px-3 py-2 bg-black/20 border-b border-zinc-800 text-[9px] font-bold text-zinc-500 uppercase tracking-widest",children:"Restore Version"}),o.jsx("div",{className:"max-h-[200px] overflow-y-auto",children:[...a].reverse().map((u,h)=>o.jsxs("button",{onClick:()=>{n(u.data),l(!1)},className:"w-full text-left px-3 py-2 hover:bg-white/5 border-b border-zinc-800/50 last:border-0 flex flex-col gap-0.5",children:[o.jsx("span",{className:"text-xs font-bold text-white",children:u.name}),o.jsx("span",{className:"text-[9px] text-zinc-500 font-mono",children:new Date(u.timestamp).toLocaleTimeString()})]},u.id))})]}),i&&o.jsx("div",{className:"fixed inset-0 z-[-1]",onClick:()=>l(!1)})]})},vE=({project:a,onUpdateProject:n,globalDNAs:i,globalScoringTemplates:l,onSaveGlobalTemplate:u,onDeleteGlobalTemplate:h,userSettings:f})=>{const[g,p]=ie.useState(!1),[b,x]=ie.useState(null);if(!a)return o.jsx("div",{className:"text-zinc-500 text-center mt-20 text-lg",children:"Project not found."});const{data:y}=a,E=A=>{const L={...a,data:{...y,...A},updatedAt:Date.now()};n(L)},_=()=>f!=null&&f.openrouter_key?!0:(alert("Please enter your OpenRouter API Key in Settings (Sidebar) to use AI features."),!1),w=A=>{E({...A,blueprint:null,result:null})},S=A=>{const L={id:`${A}-${Date.now()}`,title:"",description:"",script:"",comments:""};w({[A]:[...y[A]||[],L]})},N=(A,L,$,C)=>{const B=(y[A]||[]).map(q=>q.id===L?{...q,[$]:C}:q);w({[A]:B})},k=(A,L)=>{w({[A]:(y[A]||[]).filter($=>$.id!==L)})},K=async(A,L,$)=>{if(!(f!=null&&f.youtube_key)){alert("Please enter your YouTube API Key in Settings to fetch comments.");return}try{const C=await Pg($,f.youtube_key),B=(y[A]||[]).map(q=>q.id===L?{...q,comments:C}:q);w({[A]:B})}catch(C){alert(`Error fetching comments: ${C.message}`)}},H=async()=>{var A;if(_()){p(!0);try{const L=(l||[]).find(B=>B.id===y.selectedScoringTemplateId),$=await Ow(y.mode,y.language,y.userDraft,y.virals||[],y.flops||[],parseInt(y.targetWordCount)||800,f.openrouter_key,y.customStructurePrompt,y.selectedDNA,L),C={id:`bp-v-${Date.now()}`,timestamp:Date.now(),name:`Draft ${(((A=y.blueprintVersions)==null?void 0:A.length)||0)+1}`,data:$};E({blueprint:$,blueprintVersions:[...y.blueprintVersions||[],C],step:"blueprint",result:null})}catch(L){console.error(L),alert(`Error: ${L.message}`)}finally{p(!1)}}},P=async()=>{var A;if(!(!y.blueprint||!_())){p(!0);try{const L=await dE(y.blueprint,y.userDraft,y.language,f.openrouter_key,y.customBlueprintPrompt,y.selectedModel),$={id:`rs-v-${Date.now()}`,timestamp:Date.now(),name:`Script ${(((A=y.resultVersions)==null?void 0:A.length)||0)+1}`,data:L};E({result:L,resultVersions:[...y.resultVersions||[],$],step:"result"})}catch(L){console.error(L),alert(`Error: ${L.message}`)}finally{p(!1)}}},ee=A=>{E({...A,result:null})},te=async A=>{if(!y.blueprint||!_())return;const L=y.blueprint.sections.findIndex($=>$.id===A);if(L!==-1)try{const $=y.blueprint.sections[L],C=await Gg($,y.blueprint,y.userDraft,y.language,f.openrouter_key,y.customBlueprintPrompt,y.selectedModel),B=[...y.blueprint.sections];B[L]={...$,generated_content:C},ee({blueprint:{...y.blueprint,sections:B}})}catch($){console.error($)}},W=(A,L)=>{if(!y.blueprint)return;const C=(y.blueprint.sections||[]).map(B=>B.id===A?{...B,...L}:B);ee({blueprint:{...y.blueprint,sections:C}})},ye=(A,L)=>{if(!y.result||!y.result.rewritten.script_sections)return;const $=y.result.rewritten.script_sections.map(C=>C.id===A?{...C,content:L,scoringResult:void 0}:C);E({result:{...y.result,rewritten:{...y.result.rewritten,script_sections:$}}})},pe=async(A,L)=>{if(!y.result||!_())return;const $=(y.result.rewritten.script_sections||[]).find(C=>C.id===A);if($){p(!0);try{const C=await hE($,L,"Full Script Context",y.language,f.openrouter_key,y.selectedModel);ye(A,C)}finally{p(!1)}}},Be=async(A,L)=>{var $;($=y.result)!=null&&$.fullScriptScore&&E({result:{...y.result,fullScriptScore:void 0}}),await pe(A,L)},Ve=async()=>{if(!(!y.result||!_())){p(!0);try{const A=(y.result.rewritten.script_sections||[]).map(q=>q.content).join(`

`);let L;if(y.selectedDNA)L=await Nu(A,"dna",y.language,f.openrouter_key,y.selectedDNA);else if(l&&l.length>0){const q=l.find(ne=>ne.id===y.selectedScoringTemplateId)||l[0];L=await Nu(A,"custom",y.language,f.openrouter_key,void 0,q)}else{const q={id:"generic",name:"Standard Viral",criteria:[{id:"1",name:"Engagement",description:"Is it boring?"},{id:"2",name:"Clarity",description:"Is the message clear?"}]};L=await Nu(A,"custom",y.language,f.openrouter_key,void 0,q)}const $=JSON.parse(JSON.stringify(L)),C={...y.result,fullScriptScore:$};let B=y.resultVersions||[];if(B.length>0){const q=B.length-1;B=B.map((ne,me)=>me===q?{...ne,data:{...ne.data,fullScriptScore:$}}:ne)}E({result:C,resultVersions:B})}catch(A){alert("Full Script Scoring Error: "+A.message)}finally{p(!1)}}},De=A=>{u(A)},Ke=A=>{h(A)},Le=A=>{if(!y.result)return;const L={...y.result,fullScriptScore:A};let $=y.resultVersions||[];if($.length>0){const C=$.length-1;$=$.map((B,q)=>q===C?{...B,data:{...B.data,fullScriptScore:A}}:B)}E({result:L,resultVersions:$})},oe=(A,L)=>{navigator.clipboard.writeText(A),x(L),setTimeout(()=>x(null),2e3)},z=()=>{if(!y.result)return;const A=(y.result.rewritten.script_sections||[]).map(L=>L.content).join(`

`);oe(A,"Full Script")},J=A=>E({blueprint:A,result:null}),Y=A=>E({result:A});if(!y.mode)return o.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[70vh] space-y-12 animate-in fade-in",children:[o.jsx("h2",{className:"text-4xl font-bold text-white tracking-tight",children:"Choose your workflow"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[o.jsxs("button",{onClick:()=>E({mode:"rewrite"}),className:"w-72 p-8 rounded-3xl bg-zinc-900 border border-zinc-800 hover:border-blue-500 hover:bg-zinc-800 hover:scale-105 transition-all group text-left shadow-2xl relative overflow-hidden",children:[o.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-blue-500 to-cyan-500"}),o.jsx("div",{className:"w-14 h-14 rounded-2xl bg-blue-500/10 flex items-center justify-center mb-6 group-hover:bg-blue-500/20 transition-colors",children:o.jsx(Ps,{className:"w-7 h-7 text-blue-400"})}),o.jsx("h3",{className:"text-xl font-bold text-white mb-3",children:"Rewrite Draft"}),o.jsx("p",{className:"text-sm text-zinc-400 leading-relaxed",children:"Optimize your existing draft using a selected DNA template or viral references."})]}),o.jsxs("button",{onClick:()=>E({mode:"idea"}),className:"w-72 p-8 rounded-3xl bg-zinc-900 border border-zinc-800 hover:border-purple-500 hover:bg-zinc-800 hover:scale-105 transition-all group text-left shadow-2xl relative overflow-hidden",children:[o.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-purple-500 to-pink-500"}),o.jsx("div",{className:"w-14 h-14 rounded-2xl bg-purple-500/10 flex items-center justify-center mb-6 group-hover:bg-purple-500/20 transition-colors",children:o.jsx(mn,{className:"w-7 h-7 text-purple-400"})}),o.jsx("h3",{className:"text-xl font-bold text-white mb-3",children:"New Idea"}),o.jsx("p",{className:"text-sm text-zinc-400 leading-relaxed",children:"Generate a fresh script from scratch using a DNA template structure."})]})]})]});const ae=["input","blueprint","result"],xe=y.mode==="idea",O=A=>A==="input"||A==="blueprint"&&!!y.blueprint||A==="result"&&!!y.result;return o.jsxs("div",{className:"animate-in fade-in",children:[o.jsxs("div",{className:"sticky top-0 z-50 bg-black/80 backdrop-blur-xl border-b border-white/5 mb-8 -mx-8 px-8 py-4 flex items-center justify-between",children:[o.jsx("div",{className:"flex items-center bg-zinc-900 p-1 rounded-full border border-zinc-800",children:["1. INPUT","2. BLUEPRINT","3. RESULT"].map((A,L)=>{const $=ae[L];return o.jsx("button",{onClick:()=>O($)&&E({step:$}),disabled:!O($),className:`px-5 py-2 rounded-full text-xs font-bold transition-all ${y.step===$?"bg-white text-black shadow-lg":O($)?"text-zinc-300 hover:text-white hover:bg-white/5":"text-zinc-600 cursor-not-allowed"}`,children:A},A)})}),o.jsxs("div",{className:"flex items-center gap-3 relative z-[60]",children:[o.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-zinc-900 border border-zinc-800 rounded-lg",children:[o.jsx("span",{className:"text-[10px] font-bold text-zinc-500 uppercase",children:"Writer AI:"}),o.jsx("select",{value:y.selectedModel||gn,onChange:A=>E({selectedModel:A.target.value}),className:"bg-zinc-900 text-white text-xs font-bold outline-none cursor-pointer border-none p-0 focus:ring-0 appearance-none min-w-[120px] [&>option]:bg-zinc-900 [&>option]:text-white [&>option]:py-2",children:Mu.map(A=>o.jsx("option",{value:A.id,children:A.name},A.id))})]}),o.jsx("button",{onClick:()=>E({mode:null,step:"input"}),className:"p-2 hover:bg-zinc-800 rounded-lg text-zinc-500 hover:text-white transition-colors",title:"Exit Project",children:o.jsx(Ga,{className:"w-4 h-4"})})]})]}),o.jsxs("div",{className:"w-full mx-auto pb-24 px-4",children:[y.step==="input"&&o.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-12 gap-8 animate-in slide-in-from-left-4 duration-500",children:[o.jsxs("div",{className:"xl:col-span-7 space-y-8",children:[o.jsx(bE,{dnas:i||[],selectedDNA:y.selectedDNA,onSelect:A=>w({selectedDNA:A})}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 pt-6 border-t border-white/5",children:[o.jsxs("section",{children:[o.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-2 mb-4",children:[o.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full"})," Viral References"]}),o.jsx("div",{className:"space-y-4",children:(y.virals||[]).map(A=>o.jsx(Ki,{data:A,onChange:(L,$,C)=>N("virals",L,$,C),onRemove:L=>k("virals",L),onFetchComments:(L,$)=>K("virals",L,$),isRemovable:!0,showUrl:!0,showComments:!0,compact:!0},A.id))}),o.jsxs("button",{onClick:()=>S("virals"),className:"mt-4 w-full text-xs bg-zinc-800 px-3 py-2.5 rounded-lg text-white hover:bg-zinc-700 flex items-center justify-center gap-1.5 border border-zinc-700 hover:border-zinc-600 transition-all",children:[o.jsx(on,{className:"w-3 h-3"})," Add Viral"]})]}),o.jsxs("section",{children:[o.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-2 mb-4",children:[o.jsx("span",{className:"w-2 h-2 bg-red-500 rounded-full"})," Flop References (Avoid)"]}),o.jsxs("div",{className:"space-y-4",children:[(y.flops||[]).map(A=>o.jsx(Ki,{data:A,onChange:(L,$,C)=>N("flops",L,$,C),onRemove:L=>k("flops",L),onFetchComments:(L,$)=>K("flops",L,$),isRemovable:!0,showUrl:!0,showComments:!0,compact:!0},A.id)),(!y.flops||y.flops.length===0)&&o.jsx("p",{className:"text-xs text-zinc-600 italic",children:"No flop references added. (Optional)"})]}),o.jsxs("button",{onClick:()=>S("flops"),className:"mt-4 w-full text-xs bg-zinc-800 px-3 py-2.5 rounded-lg text-white hover:bg-zinc-700 flex items-center justify-center gap-1.5 border border-zinc-700 hover:border-zinc-600 transition-all",children:[o.jsx(on,{className:"w-3 h-3"})," Add Flop"]})]})]})]}),o.jsxs("div",{className:"xl:col-span-5 space-y-8",children:[o.jsxs("section",{children:[o.jsxs("h3",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[o.jsx("span",{className:`w-2 h-2 ${xe?"bg-purple-500":"bg-blue-500"} rounded-full shadow-[0_0_10px_currentColor]`})," ",xe?"Your Idea (The Seed)":"Your Draft (The Source)"]}),o.jsxs("div",{className:"bg-zinc-900 border border-zinc-700 rounded-2xl p-6 shadow-xl relative",children:[o.jsx(Ki,{data:y.userDraft,onChange:(A,L,$)=>w({userDraft:{...y.userDraft,[L]:$}}),className:"bg-transparent border-none p-0 shadow-none hover:shadow-none hover:border-none",fieldLabels:xe?{title:"Idea Topic",script:"Detailed Prompt / Concept Description"}:void 0,placeholders:xe?{title:"e.g. 5 Ways to use AI",script:"e.g. I want to make a video about... The key points are... The tone should be..."}:void 0}),xe&&o.jsxs("div",{className:"mt-4 p-3 bg-purple-500/10 border border-purple-500/20 rounded-lg text-xs text-purple-300",children:[o.jsx("strong",{children:"Tip:"}),' In "New Idea" mode, this prompt is the primary instruction.']})]})]}),o.jsxs("div",{className:"bg-zinc-900 border border-zinc-700 rounded-2xl p-6 shadow-2xl sticky top-24",children:[o.jsx("h3",{className:"text-xs font-bold text-zinc-500 uppercase tracking-widest mb-4",children:"Output Config"}),o.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] font-bold text-zinc-400 uppercase mb-1 block",children:"Language"}),o.jsx("select",{value:y.language,onChange:A=>w({language:A.target.value}),className:"w-full bg-black border border-zinc-700 rounded-lg px-3 py-2 text-sm text-white focus:border-blue-500",children:yE.map(A=>o.jsx("option",{value:A,children:A},A))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] font-bold text-zinc-400 uppercase mb-1 block",children:"Word Count"}),o.jsx("input",{type:"number",value:y.targetWordCount,onChange:A=>w({targetWordCount:A.target.value}),placeholder:"800",className:"w-full bg-black border border-zinc-700 rounded-lg px-3 py-2 text-sm text-white focus:border-blue-500"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] font-bold text-zinc-400 uppercase mb-1 block",children:"Additional Instructions"}),o.jsx("textarea",{value:y.customStructurePrompt||"",onChange:A=>w({customStructurePrompt:A.target.value}),placeholder:"e.g. 'Ensure strict word count limits' or 'Make it very funny'",className:"w-full bg-black border border-zinc-700 rounded-lg px-3 py-2 text-sm text-white focus:border-blue-500 min-h-[80px]"})]}),o.jsxs("button",{onClick:H,disabled:g||!y.userDraft.script,className:"w-full py-4 rounded-xl bg-white text-black font-black text-sm hover:bg-zinc-200 disabled:opacity-50 transition-all flex items-center justify-center gap-2 shadow-[0_0_20px_rgba(255,255,255,0.2)]",children:[g?o.jsx(Mn,{className:"w-4 h-4 animate-spin"}):o.jsx(mn,{className:"w-4 h-4"})," GENERATE BLUEPRINT"]})]})]})]}),y.step==="blueprint"&&y.blueprint&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"mb-4 flex justify-end",children:y.blueprintVersions&&y.blueprintVersions.length>0&&o.jsx(Jm,{versions:y.blueprintVersions,onSelect:J})}),o.jsx(pE,{blueprint:y.blueprint,customBlueprintPrompt:y.customBlueprintPrompt||"",onUpdateBlueprintPrompt:A=>ee({customBlueprintPrompt:A}),onProceed:P,onBack:()=>E({step:"input"}),onWriteSection:te,onUpdateSection:W,isWriting:g})]}),y.step==="result"&&y.result&&o.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-12 gap-8 animate-in slide-in-from-right-4 duration-500",children:[o.jsxs("div",{className:"xl:col-span-9 space-y-8",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("h3",{className:"text-xl font-bold text-white",children:"Final Output"}),o.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-zinc-900 border border-zinc-700 rounded-lg shadow-sm",children:[o.jsx("span",{className:"text-[10px] font-bold text-zinc-500 uppercase",children:"Total Words:"}),o.jsx("span",{className:"text-sm font-mono font-bold text-white",children:(y.result.rewritten.script_sections||[]).reduce((A,L)=>A+(L.content.trim()?L.content.trim().split(/\s+/).length:0),0)})]}),y.resultVersions&&y.resultVersions.length>0&&o.jsx(Jm,{versions:y.resultVersions,onSelect:Y})]}),o.jsxs("div",{className:"flex gap-3",children:[o.jsxs("button",{onClick:Ve,disabled:g,className:"flex items-center gap-2 px-4 py-2 bg-zinc-800 text-white border border-zinc-700 rounded-lg font-bold hover:bg-zinc-700 hover:text-white transition-colors shadow-lg disabled:opacity-50",children:[g?o.jsx(Mn,{className:"w-4 h-4 animate-spin"}):o.jsx(Pl,{className:"w-4 h-4"}),"Audit Full Script"]}),o.jsxs("button",{onClick:z,className:"flex items-center gap-2 px-4 py-2 bg-white text-black rounded-lg font-bold hover:bg-zinc-200 transition-colors shadow-lg",children:[b==="Full Script"?o.jsx(st,{className:"w-4 h-4"}):o.jsx(Pi,{className:"w-4 h-4"}),b==="Full Script"?"Copied!":"Copy Full Script"]})]})]}),o.jsxs("div",{className:"bg-zinc-900 border border-zinc-700 rounded-3xl p-8 shadow-2xl space-y-6",children:[o.jsxs("div",{className:"group relative",children:[o.jsxs("div",{className:"flex justify-between items-start",children:[o.jsx("h1",{className:"text-3xl font-black text-white leading-tight pr-8",children:y.result.rewritten.title}),o.jsx("button",{onClick:()=>{var A;return oe(((A=y.result)==null?void 0:A.rewritten.title)||"","Title")},className:"opacity-0 group-hover:opacity-100 p-2 text-zinc-500 hover:text-white transition-all bg-black/50 rounded-lg",children:o.jsx(Pi,{className:"w-4 h-4"})})]}),b==="Title"&&o.jsx("span",{className:"absolute -top-6 right-0 text-xs text-green-400 font-bold",children:"Copied!"})]}),o.jsxs("div",{className:"group relative",children:[o.jsx("p",{className:"text-zinc-400 leading-relaxed pr-8",children:y.result.rewritten.description}),o.jsx("button",{onClick:()=>{var A;return oe(((A=y.result)==null?void 0:A.rewritten.description)||"","Description")},className:"absolute top-0 right-0 opacity-0 group-hover:opacity-100 p-1.5 text-zinc-500 hover:text-white transition-all bg-black/50 rounded-lg",children:o.jsx(Pi,{className:"w-3 h-3"})}),b==="Description"&&o.jsx("span",{className:"absolute -top-6 right-0 text-xs text-green-400 font-bold",children:"Copied!"})]}),o.jsxs("div",{className:"group relative",children:[o.jsx("div",{className:"flex flex-wrap gap-2 pr-8",children:(y.result.rewritten.tags||"").split(",").map(A=>o.jsx("span",{className:"px-3 py-1 bg-zinc-800 rounded-full text-xs text-zinc-300 font-bold border border-zinc-700",children:A.trim().replace(/^#/,"")},A))}),o.jsx("button",{onClick:()=>{var A;return oe(((A=y.result)==null?void 0:A.rewritten.tags)||"","Tags")},className:"absolute top-0 right-0 opacity-0 group-hover:opacity-100 p-1.5 text-zinc-500 hover:text-white transition-all bg-black/50 rounded-lg",children:o.jsx(Pi,{className:"w-3 h-3"})}),b==="Tags"&&o.jsx("span",{className:"absolute -top-6 right-0 text-xs text-green-400 font-bold",children:"Copied!"})]})]}),o.jsx("div",{className:"space-y-0",children:(y.result.rewritten.script_sections||[]).map((A,L)=>o.jsx(mE,{section:A,index:L,onUpdate:($,C)=>ye($,C),onRefine:pe,isProcessing:g},A.id))})]}),o.jsx("div",{className:"xl:col-span-3",children:o.jsx("div",{className:"sticky top-24",children:o.jsx(gE,{fullScript:(y.result.rewritten.script_sections||[]).map(A=>A.content).join(`

`),dna:y.selectedDNA,savedTemplates:l||[],lastScore:y.result.fullScriptScore,language:y.language,onSaveTemplate:De,onUpdateScore:Le,onDeleteTemplate:Ke,apiKey:(f==null?void 0:f.openrouter_key)||"",scriptSections:y.result.rewritten.script_sections,onRegenerateSection:Be})})})]})]})]})},Su={yellow:"bg-yellow-500/10 border-yellow-500/20 text-yellow-200 selection:bg-yellow-500/30",blue:"bg-blue-500/10 border-blue-500/20 text-blue-200 selection:bg-blue-500/30",green:"bg-green-500/10 border-green-500/20 text-green-200 selection:bg-green-500/30",purple:"bg-purple-500/10 border-purple-500/20 text-purple-200 selection:bg-purple-500/30",red:"bg-red-500/10 border-red-500/20 text-red-200 selection:bg-red-500/30",gray:"bg-zinc-800/50 border-zinc-700 text-zinc-300 selection:bg-zinc-600/30"},xE=({notes:a,onCreate:n,onUpdate:i,onDelete:l})=>{const[u,h]=ie.useState(""),[f,g]=ie.useState(null),[p,b]=ie.useState({isOpen:!1,noteId:"",noteTitle:""}),x=a.filter(_=>_.title.toLowerCase().includes(u.toLowerCase())||_.content.toLowerCase().includes(u.toLowerCase())),y=a.find(_=>_.id===f),E=({noteId:_,current:w})=>o.jsx("div",{className:"flex gap-1.5 p-1 bg-black/50 rounded-full border border-white/10 backdrop-blur-md shadow-xl",children:Object.keys(Su).map(S=>o.jsx("button",{onClick:N=>{N.stopPropagation(),i(_,{color:S})},className:`w-3 h-3 rounded-full transition-all border border-transparent hover:scale-125 ${S==="yellow"?"bg-yellow-400":S==="blue"?"bg-blue-400":S==="green"?"bg-green-400":S==="purple"?"bg-purple-400":S==="red"?"bg-red-400":"bg-zinc-400"} ${w===S?"ring-2 ring-white scale-110":"opacity-70 hover:opacity-100"}`},S))});return o.jsxs("div",{className:"animate-in fade-in duration-500",children:[o.jsxs("div",{className:"flex items-center justify-between mb-8",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-3xl font-bold text-white tracking-tight",children:"Quick Notes"}),o.jsx("p",{className:"text-zinc-500 mt-2",children:"Capture ideas, hooks, and snippets."})]}),o.jsxs("button",{onClick:n,className:"bg-white text-black px-6 py-3 rounded-full font-bold hover:bg-zinc-200 transition-colors flex items-center gap-2 shadow-lg shadow-white/10",children:[o.jsx(on,{className:"w-4 h-4"})," New Note"]})]}),o.jsxs("div",{className:"relative mb-8",children:[o.jsx(er,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-zinc-500"}),o.jsx("input",{type:"text",placeholder:"Search notes...",className:"w-full bg-zinc-900/50 border border-white/5 rounded-xl py-4 pl-12 pr-4 text-white focus:outline-none focus:ring-1 focus:ring-white/20 transition-all placeholder-zinc-600",value:u,onChange:_=>h(_.target.value)})]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:x.map(_=>{const w=Su[_.color||"yellow"];return o.jsxs("div",{className:`group ${w} border rounded-xl p-5 transition-all relative flex flex-col h-[280px] hover:shadow-lg hover:-translate-y-1`,children:[o.jsxs("div",{className:"absolute top-3 right-3 flex gap-1 opacity-0 group-hover:opacity-100 transition-all z-20",children:[o.jsxs("div",{className:"relative group/palette",children:[o.jsx("button",{className:"p-1.5 rounded bg-black/20 hover:bg-black/40 text-current transition-colors",children:o.jsx(nw,{className:"w-3.5 h-3.5"})}),o.jsx("div",{className:"absolute right-0 top-full mt-2 opacity-0 group-hover/palette:opacity-100 pointer-events-none group-hover/palette:pointer-events-auto transition-all",children:o.jsx(E,{noteId:_.id,current:_.color})})]}),o.jsx("button",{onClick:()=>g(_.id),className:"p-1.5 rounded bg-black/20 hover:bg-black/40 text-current transition-colors",children:o.jsx(ew,{className:"w-3.5 h-3.5"})}),o.jsx("button",{onClick:()=>b({isOpen:!0,noteId:_.id,noteTitle:_.title||"Untitled Note"}),className:"p-1.5 rounded bg-black/20 hover:bg-red-500 text-current hover:text-white transition-colors",children:o.jsx(Zt,{className:"w-3.5 h-3.5"})})]}),o.jsx("input",{className:`bg-transparent text-lg font-bold placeholder-current/50 focus:outline-none mb-3 w-full pr-16 ${_.color==="gray"?"text-white":""}`,placeholder:"Untitled Note",value:_.title,onChange:S=>i(_.id,{title:S.target.value})}),o.jsx("textarea",{className:`flex-1 bg-transparent text-sm placeholder-current/40 focus:outline-none resize-none leading-relaxed custom-scrollbar ${_.color==="gray"?"text-zinc-300":""}`,placeholder:"Type something...",value:_.content,onChange:S=>i(_.id,{content:S.target.value})}),o.jsxs("div",{className:"mt-4 pt-3 border-t border-black/5 flex justify-between items-center text-[10px] opacity-60 font-medium",children:[o.jsx("span",{children:new Date(_.updatedAt).toLocaleDateString()}),o.jsxs("span",{className:"font-mono",children:[_.content.length," chars"]})]})]},_.id)})}),y&&o.jsxs("div",{className:"fixed inset-0 z-[100] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 sm:p-8 animate-in fade-in duration-200",children:[o.jsx("div",{className:"absolute inset-0",onClick:()=>g(null)}),o.jsxs("div",{className:`relative w-full max-w-4xl h-[85vh] ${Su[y.color||"yellow"]} border rounded-3xl p-8 sm:p-12 shadow-2xl flex flex-col transform transition-all animate-in zoom-in-95 duration-300`,children:[o.jsxs("div",{className:"flex items-center justify-between mb-8 pb-6 border-b border-black/5",children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx(E,{noteId:y.id,current:y.color}),o.jsx("span",{className:"text-xs font-mono opacity-50 uppercase tracking-widest",children:new Date(y.updatedAt).toLocaleString()})]}),o.jsx("button",{onClick:()=>g(null),className:"p-2 rounded-full bg-black/10 hover:bg-black/20 text-current transition-colors",children:o.jsx(tw,{className:"w-5 h-5"})})]}),o.jsx("input",{className:`bg-transparent text-3xl sm:text-4xl font-black placeholder-current/50 focus:outline-none mb-6 w-full ${y.color==="gray"?"text-white":""}`,placeholder:"Untitled Note",value:y.title,onChange:_=>i(y.id,{title:_.target.value}),autoFocus:!0}),o.jsx("textarea",{className:`flex-1 bg-transparent text-lg sm:text-xl font-light placeholder-current/40 focus:outline-none resize-none leading-relaxed custom-scrollbar ${y.color==="gray"?"text-zinc-300":""}`,placeholder:"Start writing...",value:y.content,onChange:_=>i(y.id,{content:_.target.value})})]})]}),o.jsx(Xu,{isOpen:p.isOpen,title:"Delete Note?",message:`Are you sure you want to delete "${p.noteTitle}"? This action cannot be undone.`,confirmText:"Delete",cancelText:"Cancel",danger:!0,onConfirm:()=>{l(p.noteId),b({isOpen:!1,noteId:"",noteTitle:""})},onCancel:()=>b({isOpen:!1,noteId:"",noteTitle:""})})]})},_E=()=>{const[a,n]=ie.useState("monthly"),i=[{name:"Startup",description:"Perfect for solo founders getting started",price:49,features:["Single User Seat","50 AI Script Generations/mo","Basic DNA Extraction","Standard Speed"],isPopular:!1},{name:"Growth",description:"For growing teams that need collaboration",price:149,features:["5 User Seats","Unlimited AI Generations","Advanced DNA Analysis","Priority Support","Team Folders"],isPopular:!0},{name:"Pro",description:"Custom solution for large organizations",price:299,features:["Unlimited Seats","Custom Model Fine-tuning","API Access","Dedicated Account Manager","SSO & Security Audit"],isPopular:!1}],l=u=>a==="yearly"?Math.floor(u*.8):u;return o.jsxs("div",{className:"max-w-7xl mx-auto pb-20 px-4 animate-in fade-in duration-700",children:[o.jsx("div",{className:"text-center mb-16 space-y-8",children:o.jsxs("div",{className:"flex justify-center items-center gap-4",children:[o.jsx("span",{className:`text-sm font-bold ${a==="monthly"?"text-white":"text-zinc-500"}`,children:"MONTHLY"}),o.jsx("button",{onClick:()=>n(u=>u==="monthly"?"yearly":"monthly"),className:"w-14 h-7 bg-zinc-800 rounded-full relative border border-zinc-700 transition-colors",children:o.jsx("div",{className:`absolute top-1 w-5 h-5 bg-white rounded-full transition-all duration-300 ${a==="monthly"?"left-1":"left-8"}`})}),o.jsxs("span",{className:`text-sm font-bold flex items-center gap-2 ${a==="yearly"?"text-white":"text-zinc-500"}`,children:["YEARLY ",o.jsx("span",{className:"bg-green-500/20 text-green-400 text-[10px] px-2 py-0.5 rounded-full border border-green-500/20",children:"Save 20%"})]})]})}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8 mb-20",children:i.map(u=>o.jsxs("div",{className:`relative flex flex-col p-8 rounded-3xl border transition-all hover:scale-105 duration-300 ${u.isPopular?"bg-zinc-900 border-purple-500/50 shadow-[0_0_30px_rgba(168,85,247,0.15)]":"bg-black border-zinc-800"}`,children:[u.isPopular&&o.jsx("div",{className:"absolute -top-4 left-1/2 -translate-x-1/2 bg-white text-black text-[10px] font-black uppercase tracking-widest px-3 py-1.5 rounded-full shadow-lg",children:"Most Popular"}),o.jsxs("div",{className:"mb-6",children:[o.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:u.name}),o.jsx("p",{className:"text-xs text-zinc-500 h-8",children:u.description})]}),o.jsxs("div",{className:"mb-8",children:[o.jsxs("div",{className:"flex items-end gap-1",children:[o.jsxs("span",{className:"text-5xl font-black text-white tracking-tighter",children:["$",l(u.price)]}),o.jsx("span",{className:"text-sm text-zinc-500 font-medium mb-1",children:"/seat/mo"})]}),a==="yearly"&&o.jsxs("p",{className:"text-[10px] text-green-400 mt-1",children:["Billed $",l(u.price)*12," yearly"]}),o.jsx("p",{className:"text-[10px] text-zinc-600 mt-1 uppercase tracking-widest",children:a==="monthly"?"Billed Monthly":""})]}),o.jsx("button",{className:`w-full py-4 rounded-xl font-bold text-sm mb-8 transition-colors ${u.isPopular?"bg-white text-black hover:bg-zinc-200":"bg-zinc-900 text-white border border-zinc-800 hover:bg-zinc-800"}`,children:"START FREE TRIAL"}),o.jsx("div",{className:"space-y-4 flex-1",children:u.features.map((h,f)=>o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx("div",{className:`mt-0.5 p-0.5 rounded-full ${u.isPopular?"bg-purple-500/20 text-purple-400":"bg-zinc-800 text-zinc-400"}`,children:o.jsx(st,{className:"w-3 h-3"})}),o.jsx("span",{className:"text-sm text-zinc-300",children:h})]},f))})]},u.name))}),o.jsxs("div",{className:"border-t border-white/10 pt-16 text-center",children:[o.jsx("h3",{className:"text-xl font-bold text-white mb-8",children:"Need help deciding?"}),o.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-center gap-6 md:gap-12",children:[o.jsxs("a",{href:"mailto:longdd.pitre@gmail.com",className:"flex items-center gap-3 text-zinc-400 hover:text-white transition-colors group",children:[o.jsx("div",{className:"w-10 h-10 rounded-full bg-zinc-900 flex items-center justify-center border border-zinc-800 group-hover:border-zinc-600",children:o.jsx(aw,{className:"w-5 h-5"})}),o.jsxs("div",{className:"text-left",children:[o.jsx("div",{className:"text-[10px] font-bold uppercase text-zinc-600",children:"Email Us"}),o.jsx("div",{className:"text-sm",children:"longdd.pitre@gmail.com"})]})]}),o.jsxs("a",{href:"https://www.facebook.com/logdd.pitre",target:"_blank",rel:"noreferrer",className:"flex items-center gap-3 text-zinc-400 hover:text-blue-400 transition-colors group",children:[o.jsx("div",{className:"w-10 h-10 rounded-full bg-zinc-900 flex items-center justify-center border border-zinc-800 group-hover:border-blue-500/50",children:o.jsx(yg,{className:"w-5 h-5"})}),o.jsxs("div",{className:"text-left",children:[o.jsx("div",{className:"text-[10px] font-bold uppercase text-zinc-600",children:"Connect on Facebook"}),o.jsx("div",{className:"text-sm",children:"Duong Dinh Long"})]})]})]})]})]})},wE=({items:a,onChange:n})=>{const[i,l]=ie.useState([0]),u=a.length>0&&typeof a[0]=="string",h=w=>{l(S=>S.includes(w)?S.filter(N=>N!==w):[...S,w])},f=()=>{if(u)n([...a,"New Section"]);else{const w={section_name:"New Section",timing:"",word_count_range:"",tone:"",content_focus:""};n([...a,w]),l(S=>[...S,a.length])}},g=w=>{n(u?a.filter((S,N)=>N!==w):a.filter((S,N)=>N!==w))},p=(w,S)=>{const N=[...a];N[w]=S,n(N)},b=(w,S,N)=>{const k=[...a];k[w]={...k[w],[S]:N},n(k)},x=(w,S)=>{const N=S==="up"?w-1:w+1;if(!(N<0||N>=a.length))if(u){const k=[...a];[k[w],k[N]]=[k[N],k[w]],n(k)}else{const k=[...a];[k[w],k[N]]=[k[N],k[w]],n(k)}},y=()=>{if(!u)return;const w=a.map(S=>({section_name:S,timing:"",word_count_range:"",tone:"",content_focus:""}));n(w)};if(u&&a.length>0)return o.jsxs("div",{className:"bg-zinc-900/80 border border-white/5 rounded-3xl p-5 h-full flex flex-col relative overflow-hidden",children:[o.jsx("div",{className:"absolute top-0 left-0 w-full h-1 opacity-50 bg-blue-400"}),o.jsxs("div",{className:"flex justify-between items-center mb-4",children:[o.jsxs("label",{className:"text-xs font-black uppercase tracking-widest text-blue-400 flex items-center gap-2",children:[o.jsx(Ul,{className:"w-4 h-4"})," Structural Skeleton (Simple)"]}),o.jsx("button",{onClick:y,className:"text-[10px] bg-blue-500/10 text-blue-400 px-2 py-1 rounded hover:bg-blue-500/20 transition-colors",children:"Upgrade to Detailed Mode"})]}),o.jsx("div",{className:"flex-1 overflow-y-auto pr-2 custom-scrollbar space-y-3",children:a.map((w,S)=>o.jsxs("div",{className:"flex gap-2 items-start group/item",children:[o.jsxs("span",{className:"text-[10px] font-mono text-zinc-600 w-4 text-right mt-3",children:[S+1,"."]}),o.jsx("textarea",{className:"w-full bg-zinc-950/50 border border-zinc-800 rounded-xl px-4 py-3 text-xs text-zinc-200 focus:outline-none focus:border-blue-500/50 min-h-[50px] resize-y",value:w,onChange:N=>p(S,N.target.value)}),o.jsx("button",{onClick:()=>g(S),className:"p-2 opacity-0 group-hover/item:opacity-100 text-zinc-600 hover:text-red-400 transition-opacity",children:o.jsx(Zt,{className:"w-4 h-4"})})]},S))}),o.jsx("div",{className:"pt-4 mt-2 border-t border-white/5",children:o.jsxs("button",{onClick:f,className:"w-full py-2 bg-white/5 hover:bg-white/10 rounded-xl text-xs text-zinc-400 flex items-center justify-center gap-2",children:[o.jsx(on,{className:"w-3 h-3"})," Add Section"]})})]});const E=a,_=E.reduce((w,S)=>{if(!S.word_count_range)return w;const N=S.word_count_range.match(/(\d+)/g);if(N){const k=N.map(Number),K=k.reduce((H,P)=>H+P,0)/k.length;return w+K}return w},0);return o.jsxs("div",{className:"bg-zinc-900/80 border border-white/5 rounded-3xl p-5 h-full flex flex-col relative overflow-hidden",children:[o.jsx("div",{className:"absolute top-0 left-0 w-full h-1 opacity-50 bg-blue-400"}),o.jsxs("div",{className:"flex justify-between items-center mb-4",children:[o.jsxs("label",{className:"text-xs font-black uppercase tracking-widest flex items-center gap-2 text-blue-400",children:[o.jsx(Ul,{className:"w-4 h-4"})," Structural Skeleton (Advanced)"]}),o.jsxs("div",{className:"text-[10px] font-mono text-zinc-500 bg-zinc-950/50 px-2 py-1 rounded border border-white/5",children:["Est. Total: ",o.jsxs("span",{className:"text-zinc-200 font-bold",children:[Math.round(_)," words"]})]})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto pr-2 custom-scrollbar space-y-4",children:[E.length===0&&o.jsx("div",{className:"text-center py-8 opacity-30 text-xs italic",children:"No sections yet."}),E.map((w,S)=>o.jsxs("div",{className:"bg-zinc-950/50 border border-zinc-800 rounded-xl overflow-hidden transition-all",children:[o.jsxs("div",{className:"p-3 flex items-center justify-between cursor-pointer hover:bg-white/5 transition-colors",onClick:()=>h(S),children:[o.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[o.jsxs("span",{className:"text-[10px] font-mono text-zinc-600 w-4",children:[S+1,"."]}),o.jsx("input",{className:"bg-transparent text-sm font-bold text-zinc-200 focus:outline-none focus:text-blue-400 flex-1 min-w-0",value:w.section_name,onChange:N=>{N.stopPropagation(),b(S,"section_name",N.target.value)},placeholder:"Section Name",onClick:N=>N.stopPropagation()})]}),o.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[o.jsx("span",{className:"text-[10px] text-zinc-500 bg-black/40 px-2 py-0.5 rounded border border-white/5 whitespace-nowrap",children:w.word_count_range||"0 words"}),o.jsx("button",{onClick:N=>{N.stopPropagation(),x(S,"up")},disabled:S===0,className:"text-zinc-600 hover:text-blue-400 p-1 disabled:opacity-30 disabled:cursor-not-allowed",title:"Move Up",children:o.jsx(z0,{className:"w-3 h-3"})}),o.jsx("button",{onClick:N=>{N.stopPropagation(),x(S,"down")},disabled:S===E.length-1,className:"text-zinc-600 hover:text-blue-400 p-1 disabled:opacity-30 disabled:cursor-not-allowed",title:"Move Down",children:o.jsx(U0,{className:"w-3 h-3"})}),o.jsx("button",{onClick:N=>{N.stopPropagation(),g(S)},className:"text-zinc-600 hover:text-red-400 p-1",children:o.jsx(Zt,{className:"w-3 h-3"})}),i.includes(S)?o.jsx(z0,{className:"w-4 h-4 text-zinc-500"}):o.jsx(U0,{className:"w-4 h-4 text-zinc-500"})]})]}),i.includes(S)&&o.jsxs("div",{className:"p-4 border-t border-white/5 bg-black/20 space-y-4 animate-in slide-in-from-top-2 duration-200",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-[9px] text-zinc-500 uppercase font-bold block mb-1",children:"Target Word Count (Primary)"}),o.jsx("input",{className:"w-full bg-zinc-900 border border-zinc-700 rounded-lg px-3 py-2 text-sm text-white font-bold focus:border-blue-500/50 outline-none",value:w.word_count_range||"",onChange:N=>b(S,"word_count_range",N.target.value),placeholder:"e.g. 40-60"})]}),o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-[9px] text-zinc-500 uppercase font-bold block mb-1",children:"Tone"}),o.jsx("textarea",{className:"w-full bg-zinc-900 border border-zinc-700 rounded-lg px-2 py-1.5 text-xs text-zinc-300 focus:border-blue-500/50 outline-none min-h-[40px] resize-y",value:w.tone||"",onChange:N=>b(S,"tone",N.target.value),placeholder:"Urgent, Sarcastic..."})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-[9px] text-zinc-500 uppercase font-bold block mb-1",children:"Pacing"}),o.jsx("textarea",{className:"w-full bg-zinc-900 border border-zinc-700 rounded-lg px-2 py-1.5 text-xs text-zinc-300 focus:border-blue-500/50 outline-none min-h-[40px] resize-y",value:w.pacing||"",onChange:N=>b(S,"pacing",N.target.value),placeholder:"Fast cuts, staccato..."})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-[9px] text-zinc-500 uppercase font-bold block mb-1",children:"Content Focus"}),o.jsx("textarea",{className:"w-full bg-zinc-900 border border-zinc-700 rounded-lg px-2 py-1.5 text-xs text-zinc-300 focus:border-blue-500/50 outline-none min-h-[40px]",value:w.content_focus||"",onChange:N=>b(S,"content_focus",N.target.value),placeholder:"What happens here?"})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-[9px] text-zinc-500 uppercase font-bold block mb-1",children:"Micro Hook (First 5s)"}),o.jsx("input",{className:"w-full bg-zinc-900 border border-zinc-700 rounded-lg px-2 py-1.5 text-xs text-yellow-300 focus:border-yellow-500/50 outline-none",value:w.micro_hook||"",onChange:N=>b(S,"micro_hook",N.target.value),placeholder:"Mini-hook strategy..."})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-[9px] text-zinc-500 uppercase font-bold block mb-1",children:"Open Loop (Optional)"}),o.jsx("input",{className:"w-full bg-zinc-900 border border-zinc-700 rounded-lg px-2 py-1.5 text-xs text-purple-300 focus:border-purple-500/50 outline-none",value:w.open_loop||"",onChange:N=>b(S,"open_loop",N.target.value),placeholder:"Curiosity gap..."})]})]}),o.jsx("div",{className:"grid grid-cols-2 gap-4",children:o.jsxs("div",{children:[o.jsx("label",{className:"text-[9px] text-zinc-500 uppercase font-bold block mb-1",children:"Viral Trigger (Optional)"}),o.jsx("input",{className:"w-full bg-zinc-900 border border-zinc-700 rounded-lg px-2 py-1.5 text-xs text-green-300 focus:border-green-500/50 outline-none",value:w.viral_triggers||"",onChange:N=>b(S,"viral_triggers",N.target.value),placeholder:"Specific element..."})]})}),o.jsxs("div",{children:[o.jsx("label",{className:"text-[9px] text-zinc-500 uppercase font-bold block mb-1",children:"Must Include Elements (Optional, comma-separated)"}),o.jsx("input",{className:"w-full bg-zinc-900 border border-zinc-700 rounded-lg px-2 py-1.5 text-xs text-orange-300 focus:border-orange-500/50 outline-none",value:Array.isArray(w.must_include)?w.must_include.join(", "):w.must_include||"",onChange:N=>b(S,"must_include",N.target.value.split(",").map(k=>k.trim()).filter(Boolean)),placeholder:"e.g. Sound effect, Visual metaphor, Specific phrase"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-[9px] text-zinc-500 uppercase font-bold block mb-1 flex items-center gap-1",children:"Audience Interaction / CTA (Optional)"}),o.jsx("textarea",{className:"w-full bg-zinc-900 border border-zinc-700 rounded-lg px-2 py-1.5 text-xs text-yellow-300 focus:border-yellow-500/50 outline-none min-h-[40px]",value:w.audience_interaction||"",onChange:N=>b(S,"audience_interaction",N.target.value),placeholder:"Specific CTA or engagement prompt (e.g. 'Comment YES below')"})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"text-[9px] text-zinc-500 uppercase font-bold block mb-1 flex items-center gap-1",children:["Audience Value (Takeaway) ",o.jsx("span",{className:"text-red-400",children:"*"})]}),o.jsx("textarea",{className:"w-full bg-zinc-900 border border-zinc-700 rounded-lg px-2 py-1.5 text-xs text-blue-300 focus:border-blue-500/50 outline-none min-h-[40px]",value:w.audience_value||"",onChange:N=>b(S,"audience_value",N.target.value),placeholder:"What they learn, feel, or get..."})]})]})]})]},S))]}),o.jsx("div",{className:"pt-4 mt-2 border-t border-white/5",children:o.jsxs("button",{onClick:f,className:"w-full py-2 bg-white/5 hover:bg-white/10 rounded-xl text-xs text-zinc-400 flex items-center justify-center gap-2",children:[o.jsx(on,{className:"w-3 h-3"})," Add Detailed Section"]})})]})},EE=({message:a,type:n,onClose:i,duration:l=3e3})=>{ie.useEffect(()=>{const f=setTimeout(()=>{i()},l);return()=>clearTimeout(f)},[l,i]);const u={success:"bg-green-500/10 border-green-500/20 text-green-400",error:"bg-red-500/10 border-red-500/20 text-red-400",info:"bg-blue-500/10 border-blue-500/20 text-blue-400"},h={success:o.jsx(st,{className:"w-5 h-5"}),error:o.jsx(Zt,{className:"w-5 h-5"}),info:o.jsx("span",{className:"text-xl font-bold",children:"i"})};return o.jsxs("div",{className:`fixed top-8 right-8 z-[100] flex items-center gap-3 px-6 py-4 rounded-xl border backdrop-blur-md shadow-2xl animate-in fade-in slide-in-from-top-4 duration-300 ${u[n]}`,children:[h[n],o.jsx("p",{className:"text-sm font-semibold",children:a}),o.jsx("button",{onClick:i,className:"ml-4 opacity-50 hover:opacity-100 transition-opacity",children:""})]})},NE=async(a,n,i)=>{const l=i||gn,u=a.map((f,g)=>`
SCRIPT #${g+1}:
Title: ${f.title||"Untitled"}
Content: 
${f.script.slice(0,5e3)}... (Truncated for analysis)
`).join(`

----------------

`),h=`
You are a Content Niche Classifier. Your task is to analyze these ${a.length} video scripts and classify their NICHE (Industry/Topic) and TONE/STYLE.

INPUT SCRIPTS:
${u}

TASK:
For EACH script, determine the:
1. Niche: The specific industry or category (e.g. "Crypto", "Health", "Gaming", "Personal Finance", "Cooking", "Self-Help"). Be specific.
2. Tone: The dominant emotional tone (e.g. "Urgent", "Calm", "Funny", "Serious", "Dramatic").

OUTPUT FORMAT:
Return PURE JSON ARRAY. No markdown.
[
  { "scriptIndex": 1, "niche": "Crypto", "tone": "Urgent" },
  { "scriptIndex": 2, "niche": "Health", "tone": "Calm" }
]
`;try{const g=(await Hn(l,"You are a helpful JSON bot.",h,n,!0)).replace(/```json/g,"").replace(/```/g,"").trim();return JSON.parse(g)}catch(f){return console.error("Niche detection failed:",f),a.map((g,p)=>({scriptIndex:p+1,niche:"Unknown",tone:"Unknown"}))}},SE=a=>{if(a.length===0)return{majorityNiche:"",matchedIndices:[],mismatchedIndices:[]};const n={};a.forEach(f=>{const g=f.niche||"Unknown";n[g]=(n[g]||0)+1});let i="",l=-1;for(const[f,g]of Object.entries(n))g>l&&(l=g,i=f);const u=[],h=[];return a.forEach(f=>{(f.niche||"Unknown")===i?u.push(f.scriptIndex):h.push(f.scriptIndex)}),{majorityNiche:i,matchedIndices:u,mismatchedIndices:h}},TE=({isOpen:a,analysis:n,scriptDetails:i,onContinueAll:l,onUseMatchedOnly:u,onCancel:h})=>{if(!a)return null;const f=i.filter(p=>n.matchedIndices.includes(p.scriptIndex)),g=i.filter(p=>n.mismatchedIndices.includes(p.scriptIndex));return o.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm animate-in fade-in duration-200",children:o.jsxs("div",{className:"bg-zinc-900 border border-yellow-500/30 w-full max-w-lg rounded-2xl p-6 shadow-2xl space-y-6 relative animate-in zoom-in-95 duration-200",children:[o.jsxs("div",{className:"flex items-start gap-4",children:[o.jsx("div",{className:"p-3 bg-yellow-500/10 rounded-xl text-yellow-500",children:o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:o.jsx("path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"})})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-xl font-bold text-white mb-1",children:"Niche Mismatch Detected"}),o.jsx("p",{className:"text-sm text-zinc-400",children:"We detected different content niches in your selected viral scripts. For best DNA results, consistency is key."})]})]}),o.jsxs("div",{className:"bg-black/40 rounded-xl p-4 border border-zinc-800 space-y-4",children:[o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsxs("span",{className:"text-xs font-bold text-green-400 uppercase tracking-wider",children:["Majority Niche: ",n.majorityNiche]}),o.jsxs("span",{className:"text-xs text-zinc-500",children:[f.length," scripts"]})]}),o.jsx("div",{className:"space-y-2",children:f.map(p=>o.jsxs("div",{className:"flex items-center gap-3 text-sm bg-green-500/5 p-2 rounded border border-green-500/10",children:[o.jsxs("span",{className:"font-mono font-bold text-green-500 w-6",children:["#",p.scriptIndex]}),o.jsx("span",{className:"text-zinc-200",children:p.niche}),o.jsx("span",{className:"text-xs text-zinc-500 ml-auto border border-zinc-800 px-1.5 py-0.5 rounded",children:p.tone})]},p.scriptIndex))})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("span",{className:"text-xs font-bold text-yellow-500 uppercase tracking-wider",children:"Outliers / Different Niche"}),o.jsxs("span",{className:"text-xs text-zinc-500",children:[g.length," scripts"]})]}),o.jsx("div",{className:"space-y-2",children:g.map(p=>o.jsxs("div",{className:"flex items-center gap-3 text-sm bg-yellow-500/5 p-2 rounded border border-yellow-500/10",children:[o.jsxs("span",{className:"font-mono font-bold text-yellow-500 w-6",children:["#",p.scriptIndex]}),o.jsx("span",{className:"text-zinc-200",children:p.niche}),o.jsx("span",{className:"text-xs text-zinc-500 ml-auto border border-zinc-800 px-1.5 py-0.5 rounded",children:p.tone})]},p.scriptIndex))})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3 pt-2",children:[o.jsx("button",{onClick:l,className:"py-3 px-4 rounded-xl bg-zinc-800 hover:bg-zinc-700 text-zinc-300 font-medium text-sm transition-colors border border-zinc-700",children:"Continue with All"}),o.jsxs("button",{onClick:u,className:"py-3 px-4 rounded-xl bg-green-600 hover:bg-green-500 text-white font-bold text-sm transition-colors shadow-lg shadow-green-900/20",children:["Use Only #",n.matchedIndices.join(", #")]})]}),o.jsx("button",{onClick:h,className:"w-full text-center text-xs text-zinc-500 hover:text-zinc-400 mt-2",children:"Cancel Analysis"})]})})},AE=["English","Vietnamese","Spanish","Japanese","Korean"],OE=({savedDNAs:a,onSaveDNA:n,onDeleteDNA:i,onUpdateDNA:l,userSettings:u})=>{var q,ne,me,bt,cn;const[h,f]=ie.useState("library"),[g,p]=ie.useState(!1),[b,x]=ie.useState(null),[y,E]=ie.useState(null),[_,w]=ie.useState([]),[S,N]=ie.useState([]),[k,K]=ie.useState("English"),[H,P]=ie.useState(""),[ee,te]=ie.useState(Mu[0].id),[W,ye]=ie.useState({isOpen:!1,dnaId:"",dnaName:""}),[pe,Be]=ie.useState(""),[Ve,De]=ie.useState({isOpen:!1,analysis:{majorityNiche:"",matchedIndices:[],mismatchedIndices:[]},scriptDetails:[]}),[Ke,Le]=ie.useState(null),oe=(Q,X)=>{X([...Q,{id:`ref-${Date.now()}`,title:"",description:"",script:"",comments:""}])},z=(Q,X,Z,Se,re)=>{X(Q.map(yt=>yt.id===Z?{...yt,[Se]:re}:yt))},J=async(Q,X,Z,Se)=>{if(!(u!=null&&u.youtube_key)){alert("Please enter YouTube API Key in Settings.");return}try{const re=await Pg(Se,u.youtube_key);z(Q,X,Z,"comments",re)}catch{}},Y=async()=>{if(!(u!=null&&u.openrouter_key)){alert("Please enter OpenRouter API Key in Settings.");return}if(p(!0),!y&&_.length>1)try{const Q=await NE(_,u.openrouter_key,ee),X=SE(Q);if(X.mismatchedIndices.length>0){p(!1),De({isOpen:!0,analysis:X,scriptDetails:Q});return}}catch(Q){console.error("Pre-scan failed, continuing anyway:",Q)}await ae(_,S)},ae=async(Q,X)=>{p(!0),Le(null);try{let Z;y?Z=await Tw(y,Q,X,k,(u==null?void 0:u.openrouter_key)||"",H,ee):Z=await Sw(Q,X,k,(u==null?void 0:u.openrouter_key)||"",H,ee,(Se,re)=>Le({current:Se,total:re})),x(Z),f("editor")}catch(Z){alert("Failed to process DNA: "+Z.message)}finally{p(!1),Le(null)}},xe=()=>{if(!b)return;(a||[]).find(X=>X.id===b.id)?l(b):n(b),f("library"),x(null),E(null),w([]),N([]),P("")},[O,A]=ie.useState(null),L=(Q,X)=>{A({message:Q,type:X})},$=Q=>{const X="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(Q,null,2)),Z=document.createElement("a");Z.setAttribute("href",X),Z.setAttribute("download",`${Q.name.replace(/\s+/g,"_")}_DNA.json`),document.body.appendChild(Z),Z.click(),Z.remove(),L(`Exported "${Q.name}" successfully`,"success")},C=Q=>{const X=new FileReader;Q.target.files&&Q.target.files.length>0&&(X.readAsText(Q.target.files[0],"UTF-8"),X.onload=Z=>{var Se;try{if((Se=Z.target)!=null&&Se.result){const re=JSON.parse(Z.target.result);if(typeof re=="object"&&re.name){const yt={...re,id:`dna-import-${Date.now()}`,name:`${re.name} (Imported)`};n(yt),L(`Successfully imported "${yt.name}"`,"success")}else L("Invalid DNA file format.","error")}}catch{L("Error parsing JSON file.","error")}})},B=({label:Q,items:X,onChange:Z,colorClass:Se,placeholder:re})=>{const yt=(bn,yn)=>{const Gn=[...X];Gn[bn]=yn,Z(Gn)},ar=()=>Z([...X,""]),Vs=bn=>Z(X.filter((yn,Gn)=>Gn!==bn)),$a=Se.replace("text-","bg-");return o.jsxs("div",{className:"bg-zinc-900/80 border border-white/5 rounded-3xl p-5 h-full flex flex-col group hover:border-white/10 transition-all shadow-xl backdrop-blur-sm relative overflow-hidden",children:[o.jsx("div",{className:`absolute top-0 left-0 w-full h-1 opacity-50 ${$a}`}),o.jsxs("label",{className:`text-xs font-black uppercase tracking-widest mb-4 block ${Se} flex items-center gap-2`,children:[o.jsx(Ul,{className:"w-4 h-4"})," ",Q]}),o.jsxs("div",{className:"flex-1 overflow-y-auto pr-2 custom-scrollbar space-y-3 max-h-[250px] lg:max-h-none",children:[X.length===0&&o.jsx("div",{className:"text-center py-8 opacity-30 text-xs italic",children:"No items yet. Add one below."}),X.map((bn,yn)=>o.jsxs("div",{className:"flex gap-2 items-start group/item animate-in slide-in-from-bottom-2 duration-300",children:[o.jsxs("span",{className:"text-[10px] font-mono text-zinc-600 w-4 text-right mt-3",children:[yn+1,"."]}),o.jsxs("div",{className:"flex-1 relative",children:[o.jsx("textarea",{className:"w-full bg-zinc-950/50 border border-zinc-800 rounded-xl px-4 py-3 text-xs text-zinc-200 focus:outline-none focus:border-zinc-600 focus:bg-zinc-900 transition-all placeholder-zinc-700 shadow-inner min-h-[70px] resize-y leading-relaxed",value:bn,onChange:Gn=>yt(yn,Gn.target.value),placeholder:re||"Enter detail..."}),o.jsx("div",{className:`absolute right-3 top-4 w-1.5 h-1.5 rounded-full opacity-0 group-focus-within/item:opacity-100 transition-opacity ${$a}`})]}),o.jsx("button",{onClick:()=>Vs(yn),className:"p-2.5 mt-1 text-zinc-600 hover:text-red-400 hover:bg-red-500/10 rounded-xl transition-all opacity-0 group-hover/item:opacity-100 scale-90 hover:scale-100",title:"Remove Item",children:o.jsx(Zt,{className:"w-4 h-4"})})]},yn))]}),o.jsx("div",{className:"pt-4 mt-2 border-t border-white/5",children:o.jsxs("button",{onClick:ar,className:"w-full py-3 rounded-xl text-xs font-bold transition-all flex items-center justify-center gap-2 bg-white/5 hover:bg-white/10 text-zinc-400 hover:text-white border border-transparent hover:border-white/10 group/btn",children:[o.jsx("div",{className:"p-0.5 rounded-full border border-zinc-600 group-hover/btn:border-white/50 transition-colors",children:o.jsx("div",{className:"p-0.5 rounded-full border border-zinc-600 group-hover/btn:border-white/50 transition-colors",children:o.jsx(on,{className:"w-3 h-3"})})}),"Add ",Q.split(" ")[0]]})})]})};if(h==="library"){const Q=(a||[]).filter(X=>{var Z,Se;return X.name.toLowerCase().includes(pe.toLowerCase())||((Se=(Z=X.analysis)==null?void 0:Z.tone)==null?void 0:Se.toLowerCase().includes(pe.toLowerCase()))});return o.jsxs(o.Fragment,{children:[O&&o.jsx(EE,{message:O.message,type:O.type,onClose:()=>A(null)}),o.jsxs("div",{className:"animate-in fade-in duration-500",children:[o.jsxs("div",{className:"flex items-center justify-between mb-8",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-bold text-white",children:"DNA Library"}),o.jsx("p",{className:"text-zinc-500 text-sm mt-1",children:"Manage your extracted viral patterns"})]}),o.jsxs("div",{className:"flex gap-3",children:[o.jsxs("label",{className:"flex items-center gap-2 px-4 py-2 bg-zinc-800 border border-zinc-700 hover:border-zinc-500 rounded-lg text-zinc-300 hover:text-white hover:bg-zinc-700 transition-colors cursor-pointer",children:[o.jsx(Ga,{className:"w-4 h-4 rotate-90"})," Import DNA",o.jsx("input",{type:"file",accept:".json",onChange:C,className:"hidden"})]}),o.jsxs("button",{onClick:()=>{x({id:`dna-${Date.now()}`,name:"",source_urls:[],analysis:{},raw_transcript_summary:""}),E(null),f("editor")},className:"flex items-center gap-2 px-4 py-2 bg-zinc-800 border border-zinc-700 rounded-lg text-white hover:bg-zinc-700 transition-colors",children:[o.jsx(ma,{className:"w-4 h-4"})," Manual Template"]}),o.jsxs("button",{onClick:()=>{x(null),E(null),w([]),N([]),f("extractor")},className:"flex items-center gap-2 px-4 py-2 bg-white text-black rounded-lg font-bold hover:bg-zinc-200 transition-colors",children:[o.jsx(mn,{className:"w-4 h-4"})," AI Extraction"]})]})]}),o.jsx("div",{className:"mb-6",children:o.jsxs("div",{className:"relative",children:[o.jsx(er,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-zinc-500"}),o.jsx("input",{type:"text",placeholder:"Search DNA templates by name or tone...",value:pe,onChange:X=>Be(X.target.value),className:"w-full bg-zinc-900 border border-zinc-700 rounded-xl pl-12 pr-4 py-3.5 text-white placeholder-zinc-500 focus:border-purple-500 focus:outline-none transition-colors"}),pe&&o.jsx("button",{onClick:()=>Be(""),className:"absolute right-4 top-1/2 -translate-y-1/2 text-zinc-500 hover:text-white transition-colors",children:""})]})}),Q.length>0?o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3",children:Q.map(X=>{var Z,Se;return o.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-lg p-3 hover:border-zinc-600 transition-all group relative",children:[o.jsxs("div",{className:"flex items-start justify-between mb-2",children:[o.jsx("div",{className:"w-8 h-8 bg-purple-500/10 rounded-md flex items-center justify-center",children:o.jsx(tr,{className:"w-4 h-4 text-purple-400"})}),o.jsxs("div",{className:"flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[o.jsx("button",{onClick:()=>$(X),className:"p-1 bg-zinc-800 hover:bg-blue-500/20 rounded text-zinc-400 hover:text-blue-400 transition-colors",title:"Export JSON",children:o.jsx(Ga,{className:"w-3 h-3 rotate-[270deg]"})}),o.jsx("button",{onClick:()=>{x(X),E(null),f("editor")},className:"p-1 bg-zinc-800 hover:bg-zinc-700 rounded text-zinc-400 hover:text-white transition-colors",title:"Edit",children:o.jsx(ma,{className:"w-3 h-3"})}),o.jsx("button",{onClick:()=>ye({isOpen:!0,dnaId:X.id,dnaName:X.name}),className:"p-1 bg-zinc-800 hover:bg-red-500/20 rounded text-zinc-400 hover:text-red-400 transition-colors",title:"Delete",children:o.jsx(Zt,{className:"w-3 h-3"})})]})]}),o.jsx("h3",{className:"text-sm font-bold text-white mb-1.5 line-clamp-1",children:X.name}),o.jsxs("div",{className:"flex flex-wrap gap-1 mb-1.5",children:[X.source_urls&&X.source_urls.length>0&&o.jsxs("span",{className:"text-[8px] bg-black/40 px-1 py-0.5 rounded text-zinc-500 border border-white/5",children:["~",X.source_urls.length," Sources"]}),((Z=X.analysis)==null?void 0:Z.tone)&&o.jsx("span",{className:"text-[8px] bg-purple-500/10 px-1 py-0.5 rounded text-purple-400 border border-purple-500/20",children:X.analysis.tone.split(",")[0]})]}),o.jsx("p",{className:"text-[10px] text-zinc-500 line-clamp-2 mb-2",children:((Se=X.analysis)==null?void 0:Se.pacing)||"No pacing data"}),o.jsxs("button",{onClick:()=>{x(null),E(X),w([]),N([]),f("extractor")},className:"w-full py-1 bg-zinc-800 hover:bg-purple-500/20 border border-zinc-700 hover:border-purple-500/50 rounded text-[9px] text-zinc-300 hover:text-purple-300 transition-all flex items-center justify-center gap-1",children:[o.jsx(Ps,{className:"w-2.5 h-2.5"})," Evolve / Retrain"]})]},X.id)})}):pe?o.jsxs("div",{className:"text-center py-20",children:[o.jsxs("p",{className:"text-zinc-500",children:['No DNAs match "',pe,'"']}),o.jsx("button",{onClick:()=>Be(""),className:"mt-3 text-purple-400 hover:text-purple-300 text-sm",children:"Clear search"})]}):o.jsxs("div",{className:"text-center py-12 text-zinc-500",children:[o.jsx("p",{className:"text-lg mb-2",children:"No DNA templates found."}),o.jsx("p",{className:"text-sm",children:"Try adjusting your search or create a new template."})]})]}),o.jsx(Xu,{isOpen:W.isOpen,title:"Delete DNA Template?",message:`Are you sure you want to delete "${W.dnaName}"? This action cannot be undone.`,confirmText:"Delete",cancelText:"Cancel",danger:!0,onConfirm:()=>{i(W.dnaId),ye({isOpen:!1,dnaId:"",dnaName:""})},onCancel:()=>ye({isOpen:!1,dnaId:"",dnaName:""})})]})}if(h==="extractor")return o.jsxs("div",{className:"w-full mx-auto pb-24 animate-in fade-in",children:[o.jsxs("div",{className:"flex items-center justify-between mb-8",children:[o.jsxs("button",{onClick:()=>f("library"),className:"flex items-center gap-2 text-zinc-400 hover:text-white transition-colors",children:[o.jsx(Ga,{className:"w-4 h-4 rotate-180"})," Back to Library"]}),o.jsxs("div",{className:"text-right",children:[o.jsx("h2",{className:"text-2xl font-bold text-white",children:y?"Evolve Existing DNA":"New DNA Extraction"}),y&&o.jsxs("p",{className:"text-sm text-yellow-500 font-medium",children:["Training Base: ",y.name]})]})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-12",children:[o.jsxs("div",{className:"space-y-6",children:[o.jsx("div",{className:"mb-4",children:o.jsxs("h3",{className:"text-lg font-bold text-green-400 flex items-center gap-2",children:[o.jsx(st,{className:"w-5 h-5"})," ",y?"New Virals":"Virals"]})}),o.jsx("div",{className:"space-y-4",children:_.map((Q,X)=>o.jsx(Ki,{data:Q,scriptNumber:X+1,onChange:(Z,Se,re)=>z(_,w,Z,Se,re),onRemove:()=>w(_.filter(Z=>Z.id!==Q.id)),onFetchComments:(Z,Se)=>J(_,w,Z,Se),isRemovable:!0,showUrl:!0,showComments:!0,fieldLabels:{script:"Transcript",comments:"Audience Comments"},placeholders:{script:"Paste content here..."}},Q.id))}),o.jsxs("button",{onClick:()=>oe(_,w),className:"w-full py-3 bg-zinc-800 border border-zinc-700 rounded-lg hover:bg-zinc-700 text-white font-medium transition-colors flex items-center justify-center gap-2",children:[o.jsx(on,{className:"w-4 h-4"}),"Add Viral"]})]}),o.jsxs("div",{className:"space-y-6",children:[o.jsx("div",{className:"mb-4",children:o.jsxs("h3",{className:"text-lg font-bold text-red-400 flex items-center gap-2",children:[o.jsx(Zt,{className:"w-5 h-5"})," ",y?"New Flops":"Flops"]})}),o.jsx("div",{className:"space-y-4",children:S.map((Q,X)=>o.jsx(Ki,{data:Q,scriptNumber:X+1,onChange:(Z,Se,re)=>z(S,N,Z,Se,re),onRemove:()=>N(S.filter(Z=>Z.id!==Q.id)),onFetchComments:(Z,Se)=>J(S,N,Z,Se),isRemovable:!0,showUrl:!0,showComments:!0,fieldLabels:{script:"Transcript",comments:"Audience Comments"},placeholders:{script:"Paste content here..."}},Q.id))}),o.jsxs("button",{onClick:()=>oe(S,N),className:"w-full py-3 bg-zinc-800 border border-zinc-700 rounded-lg hover:bg-zinc-700 text-white font-medium transition-colors flex items-center justify-center gap-2",children:[o.jsx(on,{className:"w-4 h-4"}),"Add Flop"]})]})]}),o.jsxs("div",{className:"bg-zinc-900 sticky bottom-8 p-4 rounded-2xl border border-zinc-800 shadow-2xl flex flex-col md:flex-row items-center justify-between z-50 gap-4",children:[o.jsxs("div",{className:"flex-1 w-full md:w-auto relative group",children:[o.jsx(ma,{className:"absolute top-3 left-3 w-4 h-4 text-zinc-500"}),o.jsx("textarea",{value:H,onChange:Q=>P(Q.target.value),placeholder:"Override default analysis logic...",className:"w-full bg-black border border-zinc-700 rounded-xl pl-10 pr-4 py-2 text-sm text-zinc-300 focus:outline-none focus:border-yellow-500/50 min-h-[50px] resize-none leading-relaxed placeholder-zinc-600"}),o.jsx("div",{className:"absolute -top-3 left-3 px-1 bg-zinc-900 text-[9px] font-bold text-zinc-500 uppercase",children:"Override Logic"})]}),o.jsxs("div",{className:"flex items-center gap-4 shrink-0",children:[o.jsxs("div",{className:"flex flex-col",children:[o.jsx("label",{className:"text-[9px] font-bold text-zinc-500 uppercase mb-1",children:"AI Model"}),o.jsx("select",{value:ee,onChange:Q=>te(Q.target.value),className:"bg-black border border-zinc-700 text-white text-sm rounded-lg px-3 py-2 outline-none h-[42px] min-w-[180px]",children:Mu.map(Q=>o.jsx("option",{value:Q.id,children:Q.name},Q.id))})]}),o.jsxs("div",{className:"flex flex-col",children:[o.jsx("label",{className:"text-[9px] font-bold text-zinc-500 uppercase mb-1",children:"Language"}),o.jsx("select",{value:k,onChange:Q=>K(Q.target.value),className:"bg-black border border-zinc-700 text-white text-sm rounded-lg px-3 py-2 outline-none h-[42px]",children:AE.map(Q=>o.jsx("option",{value:Q,children:Q},Q))})]}),Ke&&o.jsxs("div",{className:"flex flex-col items-center",children:[o.jsx("span",{className:"text-[9px] font-bold text-purple-400 uppercase mb-1",children:"Processing"}),o.jsxs("span",{className:"text-white text-sm font-mono",children:["Batch ",Ke.current,"/",Ke.total]})]}),o.jsxs("button",{onClick:Y,disabled:g||_.length===0,className:`h-[42px] px-8 font-bold rounded-xl transition-colors disabled:opacity-50 flex items-center gap-2 mt-auto ${y?"bg-green-500 text-black hover:bg-green-400":"bg-white text-black hover:bg-yellow-400"}`,children:[g?o.jsx(Mn,{className:"w-5 h-5 animate-spin"}):y?o.jsx(Ps,{className:"w-5 h-5"}):o.jsx(tr,{className:"w-5 h-5"}),g&&Ke?`Batch ${Ke.current}/${Ke.total}`:y?"Run Evolution":"Analyze & Extract DNA"]})]})]}),o.jsx(TE,{isOpen:Ve.isOpen,analysis:Ve.analysis,scriptDetails:Ve.scriptDetails,onContinueAll:()=>{De(Q=>({...Q,isOpen:!1})),ae(_,S)},onUseMatchedOnly:()=>{De(Z=>({...Z,isOpen:!1}));const Q=new Set(Ve.analysis.matchedIndices),X=_.filter((Z,Se)=>Q.has(Se+1));ae(X,S)},onCancel:()=>{De(Q=>({...Q,isOpen:!1})),p(!1)}})]});if(h==="editor"&&b){const Q=(re,yt)=>{x({...b,analysis:{...b.analysis,[re]:yt}})},X=(re,yt)=>{x({...b,analysis:{...b.analysis,audience_sentiment:{...b.analysis.audience_sentiment,[re]:yt}}})},Z=b.analysis||{structure_skeleton:[],flop_reasons:[],pacing:"",tone:"",audience_psychology:"",audience_sentiment:{high_dopamine_triggers:[],confusion_points:[],objections:[]}},Se=Z.audience_sentiment||{high_dopamine_triggers:[],confusion_points:[],objections:[]};return o.jsxs("div",{className:"w-full mx-auto pb-48 animate-in fade-in",children:[o.jsxs("div",{className:"flex items-center justify-between mb-8 sticky top-0 bg-black/80 backdrop-blur-md py-4 z-40 border-b border-white/5",children:[o.jsxs("button",{onClick:()=>f("library"),className:"text-zinc-400 hover:text-white text-sm flex items-center gap-2",children:[o.jsx(Ga,{className:"w-4 h-4 rotate-180"})," Cancel"]}),o.jsx("input",{className:"bg-transparent border-b border-zinc-700 text-2xl font-bold text-white text-center focus:border-yellow-500 focus:outline-none w-[300px]",value:b.name,onChange:re=>x({...b,name:re.target.value}),placeholder:"Untitled DNA"}),o.jsxs("button",{onClick:xe,className:"px-6 py-2 bg-white text-black font-bold rounded-lg hover:bg-green-400 transition-colors shadow-lg shadow-white/10 flex items-center gap-2",children:[o.jsx(st,{className:"w-4 h-4"})," Save DNA"]})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-8",children:[o.jsxs("div",{className:"lg:col-span-4 xl:col-span-3 space-y-6",children:[o.jsxs("div",{className:"bg-zinc-900 border border-zinc-700 rounded-2xl p-6 shadow-xl relative group",children:[o.jsxs("label",{className:"text-[10px] font-bold text-yellow-400 uppercase mb-4 block flex items-center gap-2",children:[o.jsx(ma,{className:"w-3 h-3"})," My Notes / Constraints"]}),o.jsx("textarea",{className:"w-full bg-black/40 border border-zinc-700 rounded-xl px-4 py-3 text-white text-sm min-h-[120px] focus:outline-none focus:border-yellow-500 transition-all placeholder-zinc-600",placeholder:"Add your own mandatory elements or notes here (optional)...",value:b.user_notes||"",onChange:re=>x({...b,user_notes:re.target.value})}),o.jsx("div",{className:"absolute top-4 right-4 text-[9px] text-zinc-600 bg-black/50 px-2 py-1 rounded",children:"Optional"})]}),o.jsxs("div",{className:"bg-zinc-900 border border-zinc-700 rounded-2xl p-6 shadow-xl",children:[o.jsxs("label",{className:"text-[10px] font-bold text-blue-400 uppercase mb-4 block flex items-center gap-2",children:[o.jsx(Lu,{className:"w-3 h-3"})," Niche / Category"]}),o.jsx("input",{className:"w-full bg-black/40 border border-zinc-700 rounded-xl px-4 py-3 text-white text-sm focus:outline-none focus:border-blue-500 transition-all placeholder-zinc-600",placeholder:"e.g. Health & Fitness, Crypto, Gaming...",value:b.niche||"",onChange:re=>x({...b,niche:re.target.value})})]}),o.jsxs("div",{className:"bg-zinc-900 border border-green-500/30 rounded-2xl p-6 shadow-xl",children:[o.jsx("label",{className:"text-[10px] font-bold text-green-400 uppercase mb-4 block flex items-center gap-2",children:" Target Word Count"}),o.jsx("input",{className:"w-full bg-black/40 border border-zinc-700 rounded-xl px-4 py-3 text-white text-sm focus:outline-none focus:border-green-500 transition-all placeholder-zinc-600",placeholder:"e.g. 3000-3400",value:Z.target_word_count_range||"",onChange:re=>Q("target_word_count_range",re.target.value)}),o.jsx("p",{className:"text-[9px] text-zinc-500 mt-2",children:"Calculated from viral scripts. Scripts generated will aim for this range."})]}),o.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-2xl p-6 shadow-xl",children:[o.jsxs("label",{className:"text-[10px] font-bold text-zinc-500 uppercase mb-4 block flex items-center gap-2",children:[o.jsx(mn,{className:"w-3 h-3 text-purple-400"})," Linguistic Fingerprint (The Voice)"]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("span",{className:"text-[9px] text-zinc-600 uppercase font-bold block mb-1",children:"Persona / Role"}),o.jsx("input",{className:"w-full bg-black/40 border border-zinc-700 rounded-xl px-3 py-2 text-zinc-300 text-xs focus:outline-none focus:border-purple-500/50",placeholder:"e.g. The Rebel, The Wise Mentor",value:((q=Z.linguistic_fingerprint)==null?void 0:q.role_persona)||"",onChange:re=>Q("linguistic_fingerprint",{...Z.linguistic_fingerprint,role_persona:re.target.value})})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-[9px] text-zinc-600 uppercase font-bold block mb-1",children:"Tone Analysis"}),o.jsx("textarea",{className:"w-full bg-black/40 border border-zinc-700 rounded-xl px-3 py-2 text-zinc-300 text-xs min-h-[60px] focus:outline-none focus:border-purple-500/50",value:((ne=Z.linguistic_fingerprint)==null?void 0:ne.tone_description)||"",onChange:re=>Q("linguistic_fingerprint",{...Z.linguistic_fingerprint,tone_description:re.target.value})})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-[9px] text-zinc-600 uppercase font-bold block mb-1",children:"Signature Keywords"}),o.jsx("input",{className:"w-full bg-black/40 border border-zinc-700 rounded-xl px-3 py-2 text-zinc-300 text-xs focus:outline-none focus:border-purple-500/50 font-mono",placeholder:"Comma separated: e.g. Honestly, Listen...",value:(((me=Z.linguistic_fingerprint)==null?void 0:me.keywords)||[]).join(", "),onChange:re=>Q("linguistic_fingerprint",{...Z.linguistic_fingerprint,keywords:re.target.value.split(",").map(yt=>yt.trim())})})]})]})]}),o.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-2xl p-6 shadow-xl",children:[o.jsxs("label",{className:"text-[10px] font-bold text-zinc-500 uppercase mb-4 block flex items-center gap-2",children:[o.jsx(st,{className:"w-3 h-3 text-blue-400"})," Hook Angle (Psychology)"]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("span",{className:"text-[9px] text-zinc-600 uppercase font-bold block mb-1",children:"Angle / Category"}),o.jsx("input",{className:"w-full bg-black/40 border border-zinc-700 rounded-xl px-3 py-2 text-zinc-300 text-xs focus:outline-none focus:border-blue-500/50",placeholder:"e.g. Negative, Curiosity, Paradox...",value:((bt=Z.hook_angle)==null?void 0:bt.type)||"",onChange:re=>Q("hook_angle",{...Z.hook_angle,type:re.target.value})})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-[9px] text-zinc-600 uppercase font-bold block mb-1",children:"Deconstruction"}),o.jsx("textarea",{className:"w-full bg-black/40 border border-zinc-700 rounded-xl px-3 py-2 text-zinc-300 text-xs min-h-[80px] focus:outline-none focus:border-blue-500/50",placeholder:"Explain WHY this hook works...",value:((cn=Z.hook_angle)==null?void 0:cn.description)||"",onChange:re=>Q("hook_angle",{...Z.hook_angle,description:re.target.value})})]})]})]}),o.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-2xl p-6 shadow-xl",children:[o.jsxs("label",{className:"text-[10px] font-bold text-zinc-500 uppercase mb-4 block flex items-center gap-2",children:[o.jsx(Ps,{className:"w-3 h-3 text-yellow-400"})," Pacing & Tone"]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("span",{className:"text-[9px] text-zinc-600 uppercase font-bold block mb-1",children:"Pacing"}),o.jsx("textarea",{className:"w-full bg-black/40 border border-zinc-700 rounded-xl px-3 py-2 text-zinc-300 text-xs min-h-[60px] focus:outline-none focus:border-yellow-500/50",value:Z.pacing,onChange:re=>Q("pacing",re.target.value)})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-[9px] text-zinc-600 uppercase font-bold block mb-1",children:"Tone"}),o.jsx("textarea",{className:"w-full bg-black/40 border border-zinc-700 rounded-xl px-3 py-2 text-zinc-300 text-xs min-h-[60px] focus:outline-none focus:border-yellow-500/50",value:Z.tone,onChange:re=>Q("tone",re.target.value)})]})]})]})]}),o.jsxs("div",{className:"lg:col-span-8 xl:col-span-9 space-y-6",children:[o.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-2xl p-6 shadow-xl relative overflow-hidden",children:[o.jsx("div",{className:"absolute top-0 right-0 p-6 opacity-10",children:o.jsx(er,{className:"w-24 h-24 text-white"})}),o.jsx("label",{className:"text-[10px] font-bold text-zinc-500 uppercase mb-3 block",children:"Audience Psychology Overview"}),o.jsx("textarea",{className:"w-full bg-transparent border-none text-white text-lg font-medium min-h-[80px] focus:outline-none placeholder-zinc-700 resize-none leading-relaxed",value:Z.audience_psychology,onChange:re=>Q("audience_psychology",re.target.value)})]}),o.jsx("div",{className:"h-[auto] min-h-[500px]",children:o.jsx(wE,{items:Z.structure_skeleton||[],onChange:re=>Q("structure_skeleton",re)})}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 lg:h-[300px]",children:[o.jsx(B,{label:"High Dopamine (Keep)",items:Se.high_dopamine_triggers||[],onChange:re=>X("high_dopamine_triggers",re),colorClass:"text-green-400",placeholder:"e.g. 'Unexpected plot twist'"}),o.jsx(B,{label:"Confusion Points (Fix)",items:Se.confusion_points||[],onChange:re=>X("confusion_points",re),colorClass:"text-yellow-400",placeholder:"e.g. 'Jargon used too early'"}),o.jsx(B,{label:"Objections (Address)",items:Se.objections||[],onChange:re=>X("objections",re),colorClass:"text-red-400",placeholder:"e.g. 'Price is too high'"})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 lg:h-[300px]",children:[o.jsx(B,{label:"Core Patterns (70% Safe)",items:Z.core_patterns||[],onChange:re=>Q("core_patterns",re),colorClass:"text-blue-400",placeholder:"e.g. 'Standard 3-act structure'"}),o.jsx(B,{label:"Viral X-Factors (30% Magic)",items:Z.viral_x_factors||[],onChange:re=>Q("viral_x_factors",re),colorClass:"text-purple-400",placeholder:"e.g. 'Silent intro'"}),o.jsx(B,{label:"Flop Avoidance",items:Z.flop_reasons||[],onChange:re=>Q("flop_reasons",re),colorClass:"text-red-400",placeholder:"e.g. 'Slow Intro'"})]})]})]})]})}return null};function jE(){const[a,n]=ie.useState(null),[i,l]=ie.useState(!0),[u,h]=ie.useState(!1),[f,g]=ie.useState("/home/dashboard"),[p,b]=ie.useState([]),[x,y]=ie.useState([]),[E,_]=ie.useState([]),[w,S]=ie.useState([]),[N,k]=ie.useState([]),[K,H]=ie.useState(null),[P,ee]=ie.useState(null);ie.useEffect(()=>{Re.auth.getSession().then(({data:{session:B}})=>{n(B),B?te(B.user.id):l(!1)}).catch(B=>{console.warn("Session check failed",B),l(!1)});const{data:{subscription:C}}=Re.auth.onAuthStateChange((B,q)=>{n(q),B==="SIGNED_IN"||B==="USER_UPDATED"?q&&te(q.user.id,!0):B==="SIGNED_OUT"&&(b([]),y([]),_([]),S([]),k([]),l(!1))});return()=>C.unsubscribe()},[]),ie.useEffect(()=>{if(!a)return;const C=Re.channel("dna_changes").on("postgres_changes",{event:"*",schema:"public",table:"dnas",filter:`user_id=eq.${a.user.id}`},async()=>{const{data:B}=await Re.from("dnas").select("*").eq("user_id",a.user.id).order("created_at",{ascending:!1});B&&S(B.map(q=>({id:q.id,name:q.name,source_urls:q.source_urls,analysis:q.analysis,raw_transcript_summary:q.raw_transcript_summary})))}).subscribe();return()=>{Re.removeChannel(C)}},[a==null?void 0:a.user.id]),ie.useEffect(()=>{if(!a)return;const C=Re.channel("project_changes").on("postgres_changes",{event:"*",schema:"public",table:"projects",filter:`user_id=eq.${a.user.id}`},async()=>{const{data:B}=await Re.from("projects").select("*").eq("user_id",a.user.id).order("updated_at",{ascending:!1});B&&b(B.map(q=>({id:q.id,name:q.name,updatedAt:q.updated_at,folderId:q.folder_id,data:q.data})))}).subscribe();return()=>{Re.removeChannel(C)}},[a==null?void 0:a.user.id]);const te=async(C,B=!1)=>{B||l(!0);try{const{data:q}=await Re.from("user_settings").select("*").eq("user_id",C).single();ee(q||{openrouter_key:"",youtube_key:""});const[ne,me,bt,cn,Q]=await Promise.all([Re.from("projects").select("*").eq("user_id",C).order("updated_at",{ascending:!1}),Re.from("folders").select("*").eq("user_id",C).order("created_at",{ascending:!0}),Re.from("notes").select("*").eq("user_id",C).order("updated_at",{ascending:!1}),Re.from("dnas").select("*").eq("user_id",C).order("created_at",{ascending:!1}),Re.from("scoring_templates").select("*").eq("user_id",C).order("created_at",{ascending:!1})]);ne.data&&b(ne.data.map(X=>({id:X.id,folderId:X.folder_id,name:X.name,updatedAt:X.updated_at,data:X.data}))),me.data&&y(me.data.map(X=>({id:X.id,name:X.name}))),bt.data&&_(bt.data.map(X=>({id:X.id,title:X.title,content:X.content,color:X.color,updatedAt:X.updated_at}))),cn.data&&S(cn.data.map(X=>({id:X.id,name:X.name,source_urls:X.source_urls,analysis:X.analysis,raw_transcript_summary:X.raw_transcript_summary}))),Q.data&&k(Q.data.map(X=>({id:X.id,name:X.name,criteria:X.criteria})))}catch(q){console.error("Error loading user data:",q)}finally{B||l(!1)}},W=async(C,B,q)=>{h(!0);try{if(q){const{error:ne}=await Re.auth.signUp({email:C,password:B});if(ne)throw ne;alert("ng k thnh cng! Hy kim tra email xc thc hoc ng nhp.")}else{const{error:ne}=await Re.auth.signInWithPassword({email:C,password:B});if(ne)throw ne}}catch(ne){alert(ne.message)}finally{h(!1)}},ye=async()=>{await Re.auth.signOut(),n(null)},pe=async C=>{if(b(q=>q.find(me=>me.id===C.id)?q.map(me=>me.id===C.id?C:me):[C,...q]),!a)return;const{error:B}=await Re.from("projects").upsert({id:C.id,user_id:a.user.id,folder_id:C.folderId||null,name:C.name,updated_at:C.updatedAt,data:C.data});B&&console.error("Update project error:",JSON.stringify(B,null,2))},Be=async C=>{if(!a)return;const B={id:`proj-${Date.now()}`,name:"Untitled Project",updatedAt:Date.now(),folderId:C,data:{mode:null,language:"English",userDraft:{id:"draft",title:"",description:"",script:"",uniquePoints:""},virals:[],flops:[],targetWordCount:"",blueprint:null,result:null,step:"input",availableDNAs:[],scoringTemplates:[]}};await pe(B),H(B.id),$("/home/creating")},Ve=async(C,B)=>{C.stopPropagation(),b(q=>q.filter(ne=>ne.id!==B)),K===B&&H(null),a&&await Re.from("projects").delete().eq("id",B).eq("user_id",a.user.id)},De=async(C,B)=>{const q=p.find(me=>me.id===C);if(!q)return;const ne={...q,name:B};await pe(ne)},Ke=async(C,B)=>{const q=p.find(me=>me.id===C);if(!q)return;const ne={...q,folderId:B};await pe(ne)},Le=async C=>{if(!a)return;const B=`folder-${Date.now()}`;y(q=>[...q,{id:B,name:C}]),await Re.from("folders").insert({id:B,user_id:a.user.id,name:C})},oe=async C=>{a&&(y(B=>B.filter(q=>q.id!==C)),b(B=>B.map(q=>q.folderId===C?{...q,folderId:void 0}:q)),await Re.from("folders").delete().eq("id",C).eq("user_id",a.user.id),await Re.from("projects").update({folderId:null}).eq("folderId",C).eq("user_id",a.user.id))},z=async(C,B)=>{const q=E.find(me=>me.id===C);if(!q||!a)return;const ne={...q,...B,updatedAt:Date.now()};_(me=>me.map(bt=>bt.id===C?ne:bt)),await Re.from("notes").upsert({id:ne.id,user_id:a.user.id,title:ne.title,content:ne.content,color:ne.color,updated_at:ne.updatedAt})},J=async()=>{if(!a)return;const C={id:`note-${Date.now()}`,title:"",content:"",updatedAt:Date.now(),color:"yellow"};_(B=>[C,...B]),await Re.from("notes").insert({id:C.id,user_id:a.user.id,title:"",content:"",color:"yellow",updated_at:C.updatedAt})},Y=async C=>{a&&(_(B=>B.filter(q=>q.id!==C)),await Re.from("notes").delete().eq("id",C).eq("user_id",a.user.id))},ae=async C=>{if(!a){console.error("No session when trying to save DNA"),alert("Bn cn ng nhp  lu DNA");return}console.log("=== SAVING DNA ==="),console.log("DNA ID:",C.id),console.log("DNA Name:",C.name),console.log("User ID:",a.user.id),console.log("DNA Data:",C),S(B=>B.find(ne=>ne.id===C.id)?(console.log("DNA exists, updating..."),B.map(ne=>ne.id===C.id?C:ne)):(console.log("DNA is new, adding..."),[C,...B]));try{const B={id:C.id,user_id:a.user.id,name:C.name,source_urls:C.source_urls||[],analysis:C.analysis||{},raw_transcript_summary:C.raw_transcript_summary||null};console.log("Payload to Supabase:",B);const{data:q,error:ne}=await Re.from("dnas").upsert(B).select();ne?(console.error("=== DATABASE ERROR ==="),console.error("Error Code:",ne.code),console.error("Error Message:",ne.message),console.error("Error Details:",ne.details),console.error("Error Hint:",ne.hint),alert(`LI LU DNA:
${ne.message}

Chi tit: ${ne.details||"Khng c"}

Gi : ${ne.hint||"Kim tra RLS policies"}`),S(me=>me.filter(bt=>bt.id!==C.id))):(console.log("=== SUCCESS ==="),console.log("Saved DNA:",q))}catch(B){console.error("=== EXCEPTION ==="),console.error("Exception:",B),alert(`Li khng xc nh: ${B.message}`),S(q=>q.filter(ne=>ne.id!==C.id))}},xe=async C=>{a&&(S(B=>B.map(q=>q.id===C.id?C:q)),await Re.from("dnas").upsert({id:C.id,user_id:a.user.id,name:C.name,source_urls:C.source_urls,analysis:C.analysis,raw_transcript_summary:C.raw_transcript_summary}))},O=async C=>{a&&(S(B=>B.filter(q=>q.id!==C)),await Re.from("dnas").delete().eq("id",C).eq("user_id",a.user.id))},A=async C=>{if(!a)return;const B=N.some(q=>q.id===C.id);k(B?q=>q.map(ne=>ne.id===C.id?C:ne):q=>[C,...q]),await Re.from("scoring_templates").upsert({id:C.id,user_id:a.user.id,name:C.name,criteria:C.criteria})},L=async C=>{a&&(k(B=>B.filter(q=>q.id!==C)),await Re.from("scoring_templates").delete().eq("id",C).eq("user_id",a.user.id))},$=C=>{g(C),window.scrollTo({top:0,behavior:"smooth"})};return i?o.jsx("div",{className:"min-h-screen flex items-center justify-center bg-black text-white",children:o.jsx(Mn,{className:"w-8 h-8 animate-spin text-zinc-500"})}):a?o.jsxs("div",{className:"min-h-screen flex bg-black text-white",children:[o.jsx(lw,{currentRoute:f,onNavigate:$,onLogout:ye,userEmail:a.user.email,openRouterKey:P==null?void 0:P.openrouter_key}),o.jsxs("main",{className:"flex-1 md:ml-64 p-4 md:p-6 overflow-y-auto min-h-screen",children:[o.jsxs("div",{className:"w-full max-w-[98%] mx-auto mt-16 md:mt-0",children:[f==="/home/dashboard"&&o.jsx(hw,{projects:p,folders:x,dnas:w,onOpenProject:C=>{H(C),$("/home/creating")},onNewProject:Be,onDeleteProject:Ve,onRenameProject:De,onCreateFolder:Le,onDeleteFolder:oe,onMoveProject:Ke}),f==="/home/creating"&&o.jsx(vE,{project:p.find(C=>C.id===K),onUpdateProject:pe,globalDNAs:w,globalScoringTemplates:N,onSaveGlobalTemplate:A,onDeleteGlobalTemplate:L,userSettings:P},K||"new-creation"),f==="/home/dna"&&o.jsx(OE,{savedDNAs:w,onSaveDNA:ae,onDeleteDNA:O,onUpdateDNA:xe,userSettings:P}),f==="/home/notes"&&o.jsx(xE,{notes:E,onCreate:J,onUpdate:z,onDelete:Y}),f==="/home/pricing"&&o.jsx(_E,{})]}),o.jsx(k0,{simple:!0})]})]}):o.jsxs("div",{className:"min-h-screen flex flex-col bg-black",children:[o.jsx(ow,{onNavigate:()=>{}}),o.jsx("main",{className:"flex-grow pt-24 pb-20",children:o.jsx(cw,{onNavigate:()=>{},onAuth:W,authLoading:u})}),o.jsx(k0,{})]})}const $g=document.getElementById("root");if(!$g)throw new Error("Could not find root element to mount to");const RE=_v.createRoot($g);RE.render(o.jsx(fv.StrictMode,{children:o.jsx(jE,{})}));
